---
title: 状态反馈与状态控制器
tags: 现代控制理论
article_header:
  type: cover
  image:
    src: /assets/images/control.png
---

<!--more-->

## 一、反馈的结构与形式

### (一) 输出反馈

$$
\begin{cases}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\
\boldsymbol y=\boldsymbol {Cx}+\boldsymbol {Du}
\end{cases}\\
\boldsymbol u=\boldsymbol v-\boldsymbol {Hy}
$$

<img src="/assets/images/状态反馈与状态控制器.assets/image-20200426092509921.png" alt="image-20200426092509921" style="zoom:50%;" />

### (二) 状态反馈

$$
\begin{cases}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\
\boldsymbol y=\boldsymbol {Cx}+\boldsymbol {Du}
\end{cases}\\
\boldsymbol u=\boldsymbol v-\boldsymbol {Kx}
$$

<img src="/assets/images/状态反馈与状态控制器.assets/image-20200426092625381.png" alt="image-20200426092625381" style="zoom:50%;" />



### (三) 输出内反馈

$$
\begin{cases}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\
\boldsymbol y=\boldsymbol {Cx}+\boldsymbol {Du}
\end{cases}\\
\dot{\boldsymbol  x}=\boldsymbol {Ax}+\boldsymbol {Bu}+\boldsymbol {Ly}
$$

<img src="/assets/images/状态反馈与状态控制器.assets/image-20200426092734817.png" alt="image-20200426092734817" style="zoom:50%;" />

### (四) 反馈结构

$$
\begin{cases}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\
\boldsymbol y=\boldsymbol {Cx}+\boldsymbol {Du}
\end{cases}\\
\boldsymbol u=\boldsymbol v-\boldsymbol {Hy}\\
\boldsymbol  u=\boldsymbol v-\boldsymbol {Kx}\\
\dot{\boldsymbol  x}=\boldsymbol {Ax}+\boldsymbol {Bu}+\boldsymbol {Ly}
$$

<img src="/assets/images/状态反馈与状态控制器.assets/image-20200426092900945.png" alt="image-20200426092900945" style="zoom:50%;" />

## 二、状态反馈与极点配置

### (一) 状态反馈定理

状态反馈不改变系统的能控性

<img src="/assets/images/状态反馈与状态控制器.assets/image-20200426093023993.png" alt="image-20200426093023993" style="zoom:50%;" />
$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol bu\\
y=\boldsymbol {cx}\\
u=r-\boldsymbol {kx}
\end{cases}
\Rightarrow
\begin{cases}
\dot{\boldsymbol x}=(\boldsymbol A-\boldsymbol {bk})\boldsymbol x+\boldsymbol br\\
y=\boldsymbol {cx}
\end{cases}
$$

### (二) 极点配置定理

状态反馈可任意配置系统闭环极点的充要条件是系统能控

若$\{\boldsymbol A,\boldsymbol b\}$能控，则通过选择合适的$\boldsymbol k$，就可以任意指定$(\boldsymbol A-\boldsymbol {bk})$的特征值

**注意：**

* 状态反馈不改变传递函数的零点，这一结论也可以用来解释为什么状态反馈可以改变状态方程的能观性
* 对于完全不能控系统，状态反馈可以任意配置其能控子空间的特征值，而对不能控子空间的特征值没用影响

### (三) 状态反馈增益阵的求取

#### 1、标准型法

$$
\boldsymbol k=\overline{\boldsymbol k}\boldsymbol P=(\overline{\boldsymbol \alpha}-\boldsymbol \alpha)\boldsymbol M_{CC}\boldsymbol M_C^{-1}
$$

* 行向量$\boldsymbol \alpha$和$\overline{\boldsymbol \alpha}$分别是状态反馈前后系统特征多项式系数的升幂排列
* $\boldsymbol M_C$是原系统的能控性矩阵
* $\boldsymbol M_{CC}$是其相应能控标准型系统的能控性矩阵

它的依据是极点配置定理的构造性证明。关键是状态变换阵$\boldsymbol P$的求取，其背景是  
$$
\begin{align}
\boldsymbol M_{CC}&=\begin{bmatrix}\overline{\boldsymbol B}&\overline{\boldsymbol A}\overline{\boldsymbol B}&\overline{\boldsymbol A^2}\overline{\boldsymbol B}&\cdots&\overline{\boldsymbol A}^{n-1}\overline{\boldsymbol B} \end{bmatrix}\\
&=\begin{bmatrix}\boldsymbol {PB}&\boldsymbol {PAP}^{-1}\boldsymbol {PB}&\boldsymbol {PA}^2\boldsymbol P^{-1}\boldsymbol {PB}&\cdots&\boldsymbol {PA}^{n-1}\boldsymbol P^{-1}\boldsymbol {PB} \end{bmatrix}\\
&=\boldsymbol P\begin{bmatrix}\boldsymbol B&\boldsymbol {AB}&\boldsymbol A^2\boldsymbol B&\cdots&\boldsymbol A^{n-1}\boldsymbol B \end{bmatrix}=\boldsymbol {PM}_C
\end{align}
$$

#### 2、待定系数法

$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\
y=\boldsymbol {Cx}
\end{cases},\boldsymbol x\in R^n,\boldsymbol u\in R^p

\xrightarrow{\boldsymbol u=\boldsymbol r-\boldsymbol {Kx}}

\begin{cases}
\dot{\boldsymbol x}=(\boldsymbol A-\boldsymbol {BK})\boldsymbol x+\boldsymbol B\boldsymbol r\\
y=\boldsymbol {Cx}
\end{cases}
$$

## 三、全维状态观测器

### (一) 状态观测器的概念

* 状态反馈功能强大（如：极点配置等）
* 欲实现状态反馈须有实时准确的状态值
* 但直接量测所有状态很困难甚至不可能  

设法利用来自系统的实时可用的信息，通过构造一个模拟系统来实现对状态变量的实时估计。就是所谓的状态估计或叫状态观测问题  
$$
\begin{matrix}
\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol bu\\
y=\boldsymbol {cx}
\end{matrix}\\
\{\boldsymbol A,\boldsymbol b,\boldsymbol c,\boldsymbol u(\cdot),y(\cdot)\}\Rightarrow \boldsymbol x(t)
$$

### (二) 全维渐进状态观测器

**闭环观测器**

<img src="/assets/images/状态反馈与状态控制器.assets/image-20200426100422458.png" alt="image-20200426100422458" style="zoom:50%;" />
$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol bu\\
y=\boldsymbol {cx}
\end{cases}
$$

$$
\begin{align}
\dot{\hat{\boldsymbol x}}&=\boldsymbol A\hat{\boldsymbol x}+\boldsymbol bu+\boldsymbol l(y-\boldsymbol c\hat{\boldsymbol x})\\
&=(\boldsymbol A-\boldsymbol {lc})\hat{\boldsymbol x}+\boldsymbol bu+\boldsymbol {ly}
\end{align}
$$

$$
\begin{align}
\dot{\boldsymbol e}&=\dot{\boldsymbol x}-\dot{\hat{\boldsymbol x}}\\
&=\boldsymbol {Ax}+\boldsymbol bu-(\boldsymbol A-\boldsymbol {lc})\hat{\boldsymbol x}-\boldsymbol bu+\boldsymbol l(\boldsymbol {cx})\\
&=(\boldsymbol A-\boldsymbol {lc})\boldsymbol x-(\boldsymbol A-\boldsymbol {lc})\hat{\boldsymbol x}\\
&=(\boldsymbol A-\boldsymbol {lc})(\boldsymbol x-\hat{\boldsymbol x})\\
&=(\boldsymbol A-\boldsymbol {lc})\boldsymbol e
\end{align}
$$

即：
$$
\boldsymbol e(t)=e^{(\boldsymbol A-\boldsymbol {lc})t}\boldsymbol e(0)
$$
期望：
$$
e(t)\rightarrow 0\\
\uparrow\\
Re(\lambda_{\boldsymbol A-\boldsymbol {lc}})<0\\
\updownarrow\\
Re(\lambda_{(\boldsymbol A-\boldsymbol {lc})^T})<0\\
\updownarrow\\
(\boldsymbol A^T,\boldsymbol c^T)能正定\\
\updownarrow\\ (\boldsymbol c,\boldsymbol A)能检测
$$

### (三) 存在性定理

渐进状态观测器存在的充要条件是系统能检测
$$
\begin{matrix}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol bu\\y=\boldsymbol {cx}\end{matrix}\ \ \ \ \ 
\Bigg\{\begin{matrix}\boldsymbol A,\boldsymbol B,\boldsymbol c\\ u(\cdot),y(\cdot)\end{matrix}\Bigg\}
$$

$$
\dot{\hat{\boldsymbol x}}=(\boldsymbol A-\boldsymbol {lc})\hat{\boldsymbol x}+\boldsymbol bu+\boldsymbol ly
$$

状态观测器事实上是一个与被观测系统同时运行的一个人工系统（该系统的所有信息都可及时准确得到，激励信号也可以施加在任何需要的地方）， 输入是被观测系统的输入和输出，输出是被观测系统状态的估计值  

## 四、分离定理与复合控制

### (一) 复合系统的结构

<img src="/assets/images/状态反馈与状态控制器.assets/image-20200426105033251.png" alt="image-20200426105033251" style="zoom:50%;" />
$$
\begin{matrix}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol bu\\y=\boldsymbol {cx}\end{matrix}\ \ \ \ 
\dot{\hat{\boldsymbol x}}=(\boldsymbol A-\boldsymbol {lc})\hat{\boldsymbol x}+\boldsymbol bu+\boldsymbol ly\ \ \ \ u=r-\boldsymbol k\hat{\boldsymbol x}
$$

$$
\dot{\boldsymbol x}=\boldsymbol {Ax}-\boldsymbol {bk}\hat{\boldsymbol x}+\boldsymbol {br}\\
\dot{\hat{\boldsymbol x}}=(\boldsymbol A-\boldsymbol {lc})\hat{\boldsymbol x}+\boldsymbol b(r-\boldsymbol k\hat{\boldsymbol x})+\boldsymbol {lcx}
$$

$$
\begin{bmatrix}\dot{\boldsymbol x}\\\dot{\hat{\boldsymbol x}} \end{bmatrix}=
\begin{bmatrix}
\boldsymbol A&-\boldsymbol {bk}\\
\boldsymbol {lc}&\boldsymbol A-\boldsymbol {lc}-\boldsymbol {bk}
\end{bmatrix}
\begin{bmatrix}
\boldsymbol x\\ \hat{\boldsymbol x}
\end{bmatrix}+\begin{bmatrix}
\boldsymbol b\\\boldsymbol b
\end{bmatrix}r\\
y=\begin{bmatrix}\boldsymbol c&\boldsymbol 0  \end{bmatrix}
\begin{bmatrix}\boldsymbol x\\\hat{\boldsymbol x}\end{bmatrix}
$$

### (二) 分离特性

$$
\begin{align}
\dot{\boldsymbol x}&=\boldsymbol {Ax}-\boldsymbol {bk}\hat{\boldsymbol x}+\boldsymbol br\\
\boldsymbol e&=\boldsymbol x-\hat{\boldsymbol x}\\

\dot{\boldsymbol x}&=\boldsymbol {Ax}-\boldsymbol {bkx}-\boldsymbol {bk}\hat{\boldsymbol x}+\boldsymbol br\\
&=(\boldsymbol A-\boldsymbol {bk})\boldsymbol x+\boldsymbol {bk}(\boldsymbol x-\hat{\boldsymbol x})+\boldsymbol br\\
\dot{\boldsymbol e}&=(\boldsymbol A-\boldsymbol {lc})\boldsymbol e
\end{align}
$$

$$
\begin{bmatrix}\dot{\boldsymbol x}\\\dot{\boldsymbol e} \end{bmatrix}=\begin{bmatrix}
\boldsymbol A-\boldsymbol {bk}&\boldsymbol {bk}\\
\boldsymbol 0&\boldsymbol {A-\boldsymbol {lc}}
\end{bmatrix}\begin{bmatrix}
\boldsymbol x\\\boldsymbol e
\end{bmatrix}+
\begin{bmatrix}\boldsymbol b\\\boldsymbol 0\end{bmatrix}r\\
y=\begin{bmatrix}\boldsymbol c&\boldsymbol 0\end{bmatrix}
\begin{bmatrix}\boldsymbol x\\\boldsymbol e\end{bmatrix}
$$

估计误差收敛：$\boldsymbol e(t)\rightarrow 0\Leftarrow Re(\lambda_{\boldsymbol A-\boldsymbol {lc}})<0$

稳定性：$\boldsymbol x(t)\rightarrow 0\Leftarrow Re(\lambda_{\boldsymbol A-\boldsymbol {bk}})<0$

## 五、降维状态观测器

### (一) 状态观测器的一般形式

$$
\begin{cases}
\dot{\boldsymbol z}=\boldsymbol {Fz}+\boldsymbol Gu+\boldsymbol Hy\\
\hat{\boldsymbol x}+\boldsymbol {Pz}+\boldsymbol Qu+\boldsymbol Ry
\end{cases}
$$

$$
\dot{\hat{\boldsymbol x}}=(\boldsymbol A-\boldsymbol {lc})\hat{\boldsymbol x}+\boldsymbol bu+\boldsymbol ly
$$

### (二) 降维观测器

若状态观测器系统S1的维数小于被观测系统S2的维数，则称S1是S2的降维观测器  

### (三) 最小维状态观测器

对$n$维线性定常系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C\}$，若$\{\boldsymbol A,\boldsymbol C\}$能观，且
$$
rank(\boldsymbol C)=q
$$
则该系统状态观测器的最小维数是$n-q$

### (四) 龙伯格观测器

$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\
\boldsymbol y=\boldsymbol {Cx}
\end{cases}
\begin{matrix}\dim \boldsymbol x=n\\\mathrm{rank} \ \boldsymbol C=q\end{matrix}
$$

定义坐标变换：$\overline{\boldsymbol x}=\boldsymbol {Px}$
$$
\begin{matrix}
\begin{cases}
\dot{\overline{\boldsymbol x}}=\boldsymbol {\overline{A}\overline{x}}+\boldsymbol {\overline{B}u}\\
\boldsymbol y=\boldsymbol {\overline{C}\overline{x}}
\end{cases}&
\begin{matrix}
\overline{\boldsymbol A}=\boldsymbol{PAP}^{-1}&\overline{\boldsymbol B}=\boldsymbol{PB}\\
\overline{\boldsymbol C}=\boldsymbol{CP}^{-1}
\end{matrix}
\end{matrix}
$$
从$\boldsymbol C$阵中抽取互不相关的$ q $行，称之为$\boldsymbol C_2$（或不妨假设$\boldsymbol C $满秩，这样$\boldsymbol C＝\boldsymbol C_2$），再寻$(n-q)× n $维矩阵$\boldsymbol C_1 $使$\boldsymbol  P $非奇异，这样  
$$
\begin{matrix}
\boldsymbol P=\begin{bmatrix}
\boldsymbol C_1\\\boldsymbol C_2
\end{bmatrix}\begin{matrix}n-q\\q\end{matrix}&
\overline{\boldsymbol x}=\begin{bmatrix}\overline{\boldsymbol x}_1\\\overline{\boldsymbol x}_2\end{bmatrix}\\
\overline{\boldsymbol A}=\boldsymbol {PAP}^{-1}=\begin{bmatrix}\boldsymbol A_{11}&\boldsymbol A_{12}\\\boldsymbol A_{21}&\boldsymbol A_{22}\end{bmatrix}&
\overline{\boldsymbol B}=\boldsymbol {PB}=\begin{bmatrix}\boldsymbol B_1\\\boldsymbol B_2\end{bmatrix}\\
\overline{\boldsymbol C}=\boldsymbol C_2\boldsymbol P^{-1}=\boldsymbol C_2\begin{bmatrix}\boldsymbol C_1\\\boldsymbol C_2\end{bmatrix}^{-1}=\begin{bmatrix}\boldsymbol O&\boldsymbol I\end{bmatrix}&\boldsymbol y=\overline{\boldsymbol C}\overline{\boldsymbol x}=\begin{bmatrix}\boldsymbol O&\boldsymbol I\end{bmatrix}
\begin{bmatrix}\overline{\boldsymbol x}_1\\\overline{\boldsymbol x}_2 \end{bmatrix}=\overline{\boldsymbol x}_2
\end{matrix}
$$
故有：
$$
\begin{align}
\dot{\overline{\boldsymbol x}}_1&=\boldsymbol A_{11}\overline{\boldsymbol x}_1+\boldsymbol A_{12}\overline{\boldsymbol x}_2+\boldsymbol B_1\boldsymbol u\\
\dot{\overline{\boldsymbol x}}_2&=\boldsymbol A_{21}\overline{\boldsymbol x}_1+\boldsymbol A_{22}\overline{\boldsymbol x}_2+\boldsymbol B_2\boldsymbol u\\
\boldsymbol y&=\overline{\boldsymbol C}\overline{\boldsymbol x}=\overline{\boldsymbol x}_2
\end{align}
$$
记$\boldsymbol w=\boldsymbol A_{21}\overline{\boldsymbol x}_1$ ，则有
$$
\begin{align}
\dot{\overline{\boldsymbol x}}_1&=\boldsymbol A_{11}\overline{\boldsymbol x}_1+(\boldsymbol A_{12}\boldsymbol y+\boldsymbol B_1\boldsymbol u)=\boldsymbol A_{11}\overline{\boldsymbol x}_1+\boldsymbol v\\
\boldsymbol w&=\boldsymbol A_{21}\overline{\boldsymbol x}_1=\dot{\boldsymbol y}-\boldsymbol A_{22}\boldsymbol y-\boldsymbol B_2\boldsymbol u
\end{align}
$$
至此可以用全维状态观测器的设计方法构造$\overline{\boldsymbol x}_1$的观测器
$$
\dot{\hat{\overline{\boldsymbol x}}}_1=(\boldsymbol A_{11}-\boldsymbol {LA}_{21})\hat{\overline{\boldsymbol x}}_1+(\boldsymbol A_{12}\boldsymbol y+\boldsymbol B_1\boldsymbol u)+\boldsymbol L(\dot{\boldsymbol y}-\boldsymbol A_{22}\boldsymbol y-\boldsymbol B_2\boldsymbol u)
$$
为消除式中$\dot{\boldsymbol y}$项，取
$$
\boldsymbol z=\hat{\overline{\boldsymbol x}}_1-\boldsymbol {Ly}\Rightarrow\hat{\overline{\boldsymbol x}}_1=\boldsymbol z+\boldsymbol {Ly}
$$
这样，有
$$
\dot{\boldsymbol z}=(\boldsymbol A_{11}-\boldsymbol {LA}_{21})(\boldsymbol z+\boldsymbol {Ly})+(\boldsymbol A_{12}\boldsymbol y+\boldsymbol B_1\boldsymbol u)-\boldsymbol L(\boldsymbol A_{22}\boldsymbol y+\boldsymbol B_2\boldsymbol u)
$$
即：
$$
\dot{\boldsymbol z}=(\boldsymbol A_{11}-\boldsymbol {LA}_{21})\boldsymbol z+(\boldsymbol B_1-\boldsymbol {LB}_2)\boldsymbol u+[(\boldsymbol A_{11}-\boldsymbol {LA}_{21})\boldsymbol L+\boldsymbol A_{12}-\boldsymbol {LA}_{22}]\boldsymbol y
$$

$$
\begin{matrix}
\hat{\overline{\boldsymbol x}}=\begin{bmatrix}\hat{\overline{\boldsymbol x}}_1\\ \hat{\overline{\boldsymbol x}}_2 \end{bmatrix}=\begin{bmatrix}\boldsymbol z+\boldsymbol {Ly}\\\boldsymbol y\end{bmatrix}=\begin{bmatrix}\boldsymbol I&\boldsymbol L\\\boldsymbol O&\boldsymbol I\end{bmatrix}\begin{bmatrix}\boldsymbol z\\\boldsymbol y\end{bmatrix}&

\hat{\boldsymbol x}=\boldsymbol P^{-1}\hat{\overline{\boldsymbol x}}=\boldsymbol P^{-1}\begin{bmatrix}\boldsymbol I&\boldsymbol L\\\boldsymbol O&\boldsymbol I\end{bmatrix}\begin{bmatrix}\boldsymbol z\\\boldsymbol y\end{bmatrix}
\end{matrix}
$$

**一般步骤：**

1. 检查系统的能控性，确定最小维观测器的阶数

2. 定义坐标变换$\overline{\boldsymbol x}=\boldsymbol {Px}$ 
	$$
	\boldsymbol P=\begin{bmatrix}
	\boldsymbol C_1\\\boldsymbol C_2
	\end{bmatrix}\begin{matrix}n-q\\q\end{matrix}
	$$
	从$\boldsymbol C$阵中抽取互不相关的$ q $行，称之为$\boldsymbol C_2$（或不妨假设$\boldsymbol C $满秩，这样$\boldsymbol C＝\boldsymbol C_2$），再寻$(n-q)× n $维矩阵$\boldsymbol C_1 $使$\boldsymbol  P $非奇异

3. 进行状态变换
	$$
	\begin{matrix}
	\begin{matrix}
	\dot{\overline{\boldsymbol x}}_1=\boldsymbol A_{11}\overline{\boldsymbol x}_1+\boldsymbol A_{12}\overline{\boldsymbol x}_2+\boldsymbol B_1\boldsymbol u\\
	\dot{\overline{\boldsymbol x}}_2=\boldsymbol A_{21}\overline{\boldsymbol x}_1+\boldsymbol A_{22}\overline{\boldsymbol x}_2+\boldsymbol B_2\boldsymbol u
	\end{matrix}&
	\boldsymbol y=\overline{\boldsymbol C}\overline{\boldsymbol x}=\overline{\boldsymbol x}_2&
	\begin{matrix}
	\dot{\overline{\boldsymbol x}}_1=\boldsymbol A_{11}\overline{\boldsymbol x}_1+\boldsymbol v\\
	\boldsymbol w=\boldsymbol A_{21}\overline{\boldsymbol x}_1
	\end{matrix}
	\begin{matrix}
	\boldsymbol v=\boldsymbol A_{21}\boldsymbol y+\boldsymbol B_1\boldsymbol u\\
	\boldsymbol w=\dot{\boldsymbol y}-\boldsymbol A_{22}\boldsymbol y-\boldsymbol B_2\boldsymbol u
	\end{matrix}
	\end{matrix}
	$$

4. 构造全维状态观测器
	$$
	\dot{\hat{\overline{\boldsymbol x}}}_1=(\boldsymbol A_{11}-\boldsymbol {LA}_{21})\hat{\overline{\boldsymbol x}}_1+(\boldsymbol A_{12}\boldsymbol y+\boldsymbol B_1\boldsymbol u)+\boldsymbol L(\dot{\boldsymbol y}-\boldsymbol A_{22}\boldsymbol y-\boldsymbol B_2\boldsymbol u)
	$$

5. 消除微分项
	$$
	\boldsymbol z=\hat{\overline{\boldsymbol x}}_1-\boldsymbol {Ly}\\
	\dot{\boldsymbol z}=(\boldsymbol A_{11}-\boldsymbol {LA}_{21})(\boldsymbol z+\boldsymbol {Ly})+(\boldsymbol A_{12}\boldsymbol y+\boldsymbol B_1\boldsymbol u)-\boldsymbol L(\boldsymbol A_{22}\boldsymbol y+\boldsymbol B_2\boldsymbol u)\\
	\dot{\boldsymbol z}=(\boldsymbol A_{11}-\boldsymbol {LA}_{21})\boldsymbol z+(\boldsymbol B_1-\boldsymbol {LB}_2)\boldsymbol u+[(\boldsymbol A_{11}-\boldsymbol {LA}_{21})\boldsymbol L+\boldsymbol A_{21}-\boldsymbol {LA}_{22}]\boldsymbol y
	$$

6. 还原观测目标
	$$
	\begin{matrix}
	\hat{\boldsymbol x}=\boldsymbol P^{-1}\hat{\overline{\boldsymbol x}}=\boldsymbol P^{-1}\begin{bmatrix}\hat{\overline{\boldsymbol x}}_1\\ \hat{\overline{\boldsymbol x}}_2 \end{bmatrix}=\boldsymbol P^{-1}\begin{bmatrix}\boldsymbol z+\boldsymbol {Ly}\\\boldsymbol y\end{bmatrix} =\boldsymbol P^{-1}\begin{bmatrix}\boldsymbol I&\boldsymbol L\\\boldsymbol O&\boldsymbol I\end{bmatrix}\begin{bmatrix}\boldsymbol z\\\boldsymbol y\end{bmatrix}
	\end{matrix}
	$$

### (五) 李雅普诺夫方程法

$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\
\boldsymbol y=\boldsymbol {Cx}
\end{cases}
\begin{matrix}\dim \boldsymbol x=n\\\mathrm{rank} \ \boldsymbol C=q\end{matrix}
$$

**一般步骤：**

1. 选择任一$(n-q)\times(n-q)$稳定矩阵$\boldsymbol F$，但其特征值与$\boldsymbol A$不同

2. 选择任一$(n-q)\times q$的矩阵$\boldsymbol L$，使得$(\boldsymbol F,\boldsymbol L)$能控

3. 求解李雅普诺夫方程$\boldsymbol {TA}-\boldsymbol {FT}=\boldsymbol {LC}$的唯一解（$\boldsymbol T$为$(n-q)\times n$的矩阵）

4. 如果$n$阶方阵$\boldsymbol P=\begin{bmatrix}\boldsymbol T\\\boldsymbol C\end{bmatrix}$奇异，退回第2步重新选择

	如果$\boldsymbol P$非奇异，则该系统的$n-q$维状态观测器为
	$$
	\dot{\boldsymbol z}=\boldsymbol {Fz}+\boldsymbol {TBu}+\boldsymbol {Ly}\\
	\hat{\boldsymbol x}=\begin{bmatrix}\boldsymbol T\\\boldsymbol C\end{bmatrix}^{-1}\begin{bmatrix}\boldsymbol z\\\boldsymbol y\end{bmatrix}
	$$

**正确性说明：**

状态观测器的输出方程：
$$
\begin{bmatrix}\boldsymbol z\\\boldsymbol y\end{bmatrix}=\begin{bmatrix}\boldsymbol T\\\boldsymbol C\end{bmatrix}\hat{\boldsymbol x}
$$
意味着：$\boldsymbol z=\boldsymbol T\hat{\boldsymbol x}$，$\boldsymbol y=\boldsymbol C\hat{\boldsymbol x}$，显然$\boldsymbol y$是$\boldsymbol {Cx}$的估计，于是只须证明$\boldsymbol z$是$\boldsymbol {Tx}$的一个估计，定义$\boldsymbol e=\boldsymbol z-\boldsymbol {Tx}$，这样
$$
\begin{align}
\dot{\boldsymbol e}&=\dot{\boldsymbol z}-\boldsymbol T\dot{\boldsymbol x}=\boldsymbol {Fz}+\boldsymbol {TBu}+\boldsymbol {LCx}-\boldsymbol {TAx}-\boldsymbol {TBu}\\
&=\boldsymbol {Fz}+(\boldsymbol {LC-\boldsymbol {TA}})\boldsymbol x=\boldsymbol F(\boldsymbol z-\boldsymbol {Tx})=\boldsymbol {Fe}
\end{align}
$$
**定理：**

若$\boldsymbol A$与$\boldsymbol L$没有相同的特征值，且$\boldsymbol T$是方程$\boldsymbol {TA}-\boldsymbol {FT}=\boldsymbol {LC}$的唯一解，则矩阵$\boldsymbol P=\begin{bmatrix}\boldsymbol T\\\boldsymbol C\end{bmatrix}$非奇异的必要条件为$(\boldsymbol A,\boldsymbol C)$能观且$(\boldsymbol F,\boldsymbol L)$能控。对单输出系统，上述条件为充要条件