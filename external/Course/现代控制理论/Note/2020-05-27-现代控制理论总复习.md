# 现代控制理论总复习

[TOC] 

## 基本大纲

- [x] 数学基础
	- [x] 线性空间和线性变换
	- [x] 特征值、特征向量和约尔当标准型
	- [x] 线性变换结构和线性代数方程组
	- [x] 矩阵指数
- [x] 系统的状态空间模型
	- [x] 状态与状态空间的概念
	- [x] 状态空间方程的建立方法
	- [x] 状态空间的线性变换
	- [x] 作业复习
- [ ] 状态空间方程的解
	- [x] 状态转移矩阵
	- [x] 模态与模态分解
	- [x] 状态空间方程的解
	- [x] 预解矩阵与频域求解
	- [x] 作业复习
- [ ] 系统的稳定性
	- [ ] 外部稳定性(BIBO)
	- [ ] 内部稳定性(李雅普诺夫稳定性)
	- [ ] 李雅普诺夫直接法
	- [ ] 李雅普诺夫函数的构造方法
	- [ ] 线性非时变离散系统的稳定性
	- [ ] 作业复习
- [ ] 能观性与能控性
	- [ ] 能控性与能达性
	- [ ] 能观性与能构性
	- [ ] 能观性与能控性的比较
	- [ ] 线性系统状态空间结构
	- [ ] 线性离散系统的能观性和能控性
	- [ ] 作业复习
- [ ] 传递函数的状态空间实现
	- [ ] 实现和最小实现
	- [ ] 传递函数的串联实现
	- [ ] 传递函数的并联实现
	- [ ] 作业复习
- [ ] 状态反馈和状态观测器
	- [ ] 反馈的结构与形式
	- [ ] 状态反馈与极点配置
	- [ ] 全维状态观测器
	- [ ] 分离定理与复合控制
	- [ ] 降维状态观测器
	- [ ] 作业复习
- [ ] 最优性原理与动态规划
	- [ ] 最优控制问题的描述
	- [ ] 动态规划例题
- [ ] 极小值原理
	- [ ] 静态最优化问题及解
	- [ ] 泛函极值与变分法
	- [ ] 极小值原理
	- [ ] 作业复习
- [ ] 二次型指标的线性最优控制
  - [ ] 最优跟踪问题
  - [ ] 有限时间状态调节器
  - [ ] 无限时间状态调节器
  - [ ] 离散系统状态调节器
  - [ ] 线性最优输出调节器
  - [ ] 线性最优跟踪问题
  - [ ] 作业复习

## 1. 数学基础

### 1.1. 线性空间与线性变换

#### 1.1.1. 代数结构简介

**集**

定义为具有相同属性事物的全体

**群**

设$\pmb F$为一非空集，如果在$\pmb F$中存在某种运算$\ast $，使得$\forall a,b\in \pmb F,\exists c=a\ast b\in \pmb F$，且满足下列条件则称为群：

1. 结合律：$\forall a_1,a_2,a_3\in \pmb F$，总有$(a_1\ast a_2)\ast a_3=a_1\ast (a_2\ast a_3)$
2. $\pmb F$中存在单位元素$e$，即$\forall a\in \pmb F$，总有$e\ast a=a\ast e=a$
3. $\pmb F$中有逆元素，即$\forall a\neq 0\in \pmb F$，总有元素$\overline{a}$，使得$\overline{a}\ast a=a\ast \overline{a}=e$ 

*半群*：集$\pmb F$与运算$\ast $只满足结合律

*可交换群*：群$\pmb F$及其运算$\ast $满足交换律，即$\forall a,b\in\pmb F$，总有$a\ast b=b\ast a$

*加法群*：运算$\ast $为加法

*乘法群*：运算$\ast $为乘法

**环**

设非空集$\pmb F$中规定了加法运算“+”和乘法运算"$\times$"，即$\forall a,b\in \pmb F,\exists \alpha=a+b\in\pmb F$和$\exists \beta=a\times b\in \pmb F$，且满足下列条件则称为环

1. 对加法运算而言，$\pmb F$为可交换群
2. 对乘法运算而言，$\pmb F$为半群
3. 加法和乘法联合运算时，乘法对于加法满足分配律，即

$$
a_1\times(a_2+a_3)=a_1\times a_2+a_1\times a_3,\forall a_1,a_2,a_3\in\pmb F
$$

若环$\pmb F$满足乘法交换律，则称为可交换环

**域**

若$\pmb F$不仅是可交换环，而且对乘法而言又是可交换群，则$\pmb F$称为域。

显然，域$\pmb F$具有单位元素$e=1$和逆元素$\overline{a}=a^{-1}$

#### 1.1.2. 线性空间的基本概念

当向量集$\pmb X$和数域$\pmb F$中元素进行的向量加和标量乘满足下面条件时，称$\pmb X$为域$\pmb F$上的线性空间，记为$(\pmb X,\pmb F)$

1. 向量加和标量乘具有封闭性和唯一性

2. 向量加满足交换律和结合律
3. $\pmb X$中存在零向量$\pmb 0$
4. 对于$\pmb X$中任何一个向量$\pmb x$，总存在一个向量$\overline{\pmb x}$，使得$\pmb x+\overline{\pmb x}=\pmb 0$
5. 标量乘满足结合律
6. 向量加和标量乘联合运算时满足分配律
7. $\pmb F$中有标量1，使得

$$
1\cdot \pmb x=\pmb x\cdot 1=\pmb x,\ \ \forall \pmb x\in \pmb X
$$

#### 1.1.3. 线性变换

**基底变换**

$\pmb n$维向量空间$\pmb X$中两组基$\pmb E=(\pmb e_1,\pmb e_2,\pmb e_3,\cdots,\pmb e_n)$ 和 $$\overline{\pmb E}=(\overline{\pmb e}_1,\overline{\pmb e}_2,\overline{\pmb e}_3,\cdots,\overline{\pmb e}_n)$$ ，$\pmb X$中某个向量$\pmb x$在两组基下表示为：
$$
\begin{align}
\pmb x&=(\pmb e_1,\pmb e_2,\pmb e_3,\cdots,\pmb e_n)\pmb \alpha\\
\overline{\pmb x}&=(\overline{\pmb e}_1,\overline{\pmb e}_2,\overline{\pmb e}_3,\cdots,\overline{\pmb e}_n)\overline{\pmb \alpha}
\end{align}
$$
设$\pmb e_j$在基$\overline{\pmb E}$下的坐标为$\pmb p_j=(p_{1j},p_{2j},\dots,p_{nj})^T$，有：
$$
\begin{align}
\pmb e_j=(\overline{\pmb e}_1,\overline{\pmb e}_2,\overline{\pmb e}_3,\cdots,\overline{\pmb e}_n)\begin{bmatrix}p_{1j}\\p_{2j}\\\vdots\\ p_{nj} \end{bmatrix}=\overline{\pmb E}\pmb p_j,j=1,2,\cdots,n
\end{align}
$$
故
$$
\begin{align}
\begin{bmatrix}\pmb e_1&\pmb e_2&\cdots&\pmb e_n\end{bmatrix}&=\begin{bmatrix}
\overline{\pmb E}\pmb p_1&\overline{\pmb E}\pmb p_2&\cdots&\overline{\pmb E}\pmb p_n \end{bmatrix}\\
&=\overline{\pmb E}\begin{bmatrix}\pmb p_1&\pmb p_2&\cdots&\pmb p_n\end{bmatrix}\\
&=\overline{\pmb E}\pmb P
\end{align}
$$
代入前式有
$$
\begin{align}
\pmb x=\overline{\pmb E}\pmb P\pmb \alpha=\overline{\pmb E}\overline{\pmb \alpha}
\end{align}
$$
解得：
$$
\begin{align}
\overline{\pmb \alpha}=\pmb{P\alpha}
\end{align}
$$
同理有
$$
\begin{align}
\pmb \alpha=\pmb Q\overline{\pmb \alpha}\\
\pmb Q\pmb P=\pmb I
\end{align}
$$
**线性变换**

设$(\pmb X,\pmb F)$和$(\pmb Y,\pmb F)$为同一个域$\pmb F$的$n$维和$m$维向量空间，$\pmb X$的基为$(\pmb x_1,\pmb x_2,\cdots,\pmb x_n)$，$\pmb Y$的基为$(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)$

线性变换$\pmb L:(\pmb X,\pmb F)\rightarrow(\pmb Y,\pmb F)$ 将$\pmb x$映射为：
$$
\begin{align}
\pmb L(\pmb x)&=\alpha_1\pmb L(\pmb x_1)+\alpha_2\pmb L(\pmb x_2)+\cdots+\alpha_n\pmb L(\pmb x_n)\\
&=\alpha_1\pmb y_1+\alpha_2\pmb y_2+\cdots+\alpha_n\pmb y_n
\end{align}
$$
假定$\pmb y_i$相对于$\pmb Y$的基$(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)$的坐标为$(a_{1j},a_{2j},\cdots,a_{mj})^T=\pmb a_j$，即
$$
\begin{align}
\pmb y_j=(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)\pmb a_j,j=1,2,\cdots,n
\end{align}
$$
其中系数$a_{ij},i=1,2,\cdots,m,j=1,2,\cdots,n$

有
$$
\begin{align}
\pmb L(\pmb x_1,\pmb x_2,\cdots,\pmb x_n)&=(\pmb y_1,\pmb y_2,\cdots,\pmb y_n)\\
&=(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)(\pmb a_1,\pmb a_2,\cdots,\pmb a_n)\\
&=(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)\pmb A
\end{align}
$$
其中，$\pmb A=(a_{ij})_{m\times n}$，$\pmb A$的第$j$列$\pmb a_j$表示$$\pmb y_j=\pmb L(\pmb x_j)$$相对于$$\pmb Y$$的基德坐标

若向量$\pmb x$和$\pmb y=\pmb L(\pmb x)$在各自的基下坐标为$\pmb \alpha=(\alpha_1,\alpha_2,\cdots,\alpha_n)^T$和$\pmb \beta=(\beta_1,\beta_2,\cdots,\beta_m)^T$ 

对于线性变换$$\pmb y=\pmb L(\pmb x)$$，可表示为
$$
\begin{align}
(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)\pmb \beta&=\pmb L[(\pmb x_1,\pmb x_2,\cdots,\pmb x_n)\pmb \alpha]\\
&=L[\pmb x_1,\pmb x_2,\cdots,\pmb x_n]\pmb \alpha\\
&=(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)\pmb A\pmb \alpha
\end{align}
$$
由向量的唯一性得到：
$$
\begin{align}\pmb \beta=\pmb A\pmb\alpha\end{align}
$$
**线性变换的矩阵形式**

设$n$维空间$(\pmb X,\pmb F)$有两组不同的基$\pmb E=(\pmb e_1,\pmb e_2,\pmb e_3,\cdots,\pmb e_n)$ 和 $$\overline{\pmb E}=(\overline{\pmb e}_1,\overline{\pmb e}_2,\overline{\pmb e}_3,\cdots,\overline{\pmb e}_n)$$ ，$m$维空间$(\pmb Y,\pmb F)$有两组不同的基$$\pmb \varepsilon=(\pmb \varepsilon_1,\pmb \varepsilon_2,\pmb \varepsilon_3,\cdots,\pmb \varepsilon_n)$$和$$\overline{\pmb \varepsilon}=(\overline{\pmb \varepsilon}_1,\overline{\pmb \varepsilon}_2,\overline{\pmb \varepsilon}_3,\cdots,\overline{\pmb \varepsilon}_n)$$ ，$\forall \pmb x\in\pmb X$和$\pmb y=\pmb L(\pmb x)\in \pmb Y$ 在各自基下的表达式为：
$$
\begin{align}
\pmb x=\pmb{E\alpha}=\overline{\pmb E}\overline{\pmb \alpha}\\
\pmb y=\pmb{\varepsilon\beta}=\overline{\pmb \varepsilon}\overline{\pmb \beta}
\end{align}
$$
由前式可知
$$
\begin{align}
\begin{matrix}
\overline{\pmb \alpha}=\pmb{P\alpha}&
\pmb \alpha=\pmb P^{-1}\overline{\pmb \alpha}\\
\overline{\pmb \beta}=\pmb {Q\beta}&
\pmb\beta=\pmb Q^{-1}\overline{\pmb\beta}
\end{matrix}
\end{align}
$$
用基$\pmb E$和$\pmb \varepsilon$表示线性变换的表达式为：
$$
\begin{align}
\pmb\beta=\pmb{A\alpha}
\end{align}
$$
用基$\overline{\pmb E}$和$\overline{\pmb \varepsilon}$表示线性变换的表达式为：
$$
\begin{align}
\overline{\pmb \beta}=\overline{\pmb A}\overline{\pmb \alpha}
\end{align}
$$
其中，
$$
\begin{align}
\overline{\pmb A}=\pmb {QAP}^{-1}\\
\pmb A=\pmb Q^{-1}\overline{\pmb A}\pmb{P}
\end{align}
$$

特别地，对于映射到自身的线性变换$\pmb L:(\pmb X,\pmb F)\rightarrow(\pmb X,\pmb F)$，两组基下表达同一个线性变换的矩阵$\pmb A$和$\overline{\pmb A}$有
$$
\begin{align}
\overline{\pmb A}=\pmb {PAP}^{-1}\\
\pmb A=\pmb{P}^{-1}\overline{\pmb{A}}\pmb{P}
\end{align}
$$

### 1.2. 特征值、特征向量和约尔当标准型

#### 1.2.1. 特征值与特征向量

设矩阵$\pmb A$表示一个将$(\pmb C^n,\pmb C)$映射到自身的线性变换，$\lambda\in \pmb C$，若$\exists x\in\pmb C^m$，使得
$$
\pmb {Ax}=\lambda\pmb x
$$
则称$\lambda$为$\pmb A$的特征值，$\pmb x$为伴随特征值$\lambda$的特征向量，$\det(\lambda\pmb I-\pmb {A})=0$称为$\pmb A$的特征方程

#### 1.2.2. 若尔当标准型求法

**<span id='对角化'>n个特征值、n个特征向量</span>**

*特征方程*：
$$
|s\boldsymbol I-\boldsymbol A|=(s-\lambda_1)(s-\lambda_2)\cdots(s-\lambda_n)
$$
具有$n$个相异特征值：$\lambda_i\neq \lambda_j$

*特征向量*：
$$
\lambda_i\rightarrow \boldsymbol A \boldsymbol q_i=\lambda_i\boldsymbol q_i
$$
$n$个线性无关的特征向量：$\{\boldsymbol q_1,\boldsymbol q_2,\cdots,\boldsymbol q_n\}$

*变换矩阵：*
$$
\boldsymbol Q= \begin{bmatrix}\boldsymbol q_1& \boldsymbol q_2& \cdots&\boldsymbol q_n\end{bmatrix}
$$
*标准型：*
$$
\pmb Q^{-1}\pmb {AQ}=\pmb \Lambda=\mathrm {diag}(\lambda_1,\lambda_2,\cdots,\lambda_n)
$$
注意：$n$个特征值可相异

**<span id='若尔当'>p(p<n)个特征值</span>**

*特征方程*：
$$
|s\boldsymbol I-\boldsymbol A|=(s-\lambda_1)^{m_1}(s-\lambda_2)^{m_2}\cdots(s-\lambda_l)^{m_l}
$$
$\mu_i$：$\lambda_i$的代数重数，$\sum\limits_{i=1}^p\mu_i=n$ 

*特征向量*：
$$
\lambda_i\rightarrow \boldsymbol A \boldsymbol q_{i,1/2/\cdots/n_i}=\lambda_i\boldsymbol q_{i,1/2/\cdots/n_i}
$$
从每个特征向量出发，求取$m_i-1$个增广特征向量

*增广特征向量*：
$$
\begin{align}
\pmb A\pmb q_{j}^{(1)}&=\lambda_j\pmb q_{j}^{(1)}\\
\pmb {Aq}_{j}^{(2)}&=\lambda_j\pmb q_{j}^{(2)}+\pmb q_{j}^{(1)}\\
\cdots\\
\pmb{Aq}_{j}^{(i)}&=\lambda_j\pmb q_{j}^{(i)}+\pmb q_{j}^{(i-1)}
\end{align}
$$
由此得到$n_i$组增广特征向量串
$$
\boldsymbol q_{i,1}^{(m_{i,1})}\rightarrow\boldsymbol q_{i,1}^{(m_{i,1}-1)}\rightarrow\cdots\rightarrow\boldsymbol q_{i,1}^{(1)}\Rightarrow m_{i,1}阶约当块\boldsymbol J_{i,1}\\

\boldsymbol q_{i,2}^{(m_{i,2})}\rightarrow\boldsymbol q_{i,2}^{(m_{i,2}-1)}\rightarrow\cdots\rightarrow\boldsymbol q_{i,2}^{(1)}\Rightarrow m_{i,2}阶约当块\boldsymbol J_{i,2}\\

\vdots\\

\boldsymbol q_{i,n_i}^{(m_{i,n_i})}\rightarrow\boldsymbol q_{i,n_i}^{(m_{i,n_i}-1)}\rightarrow\cdots\rightarrow\boldsymbol q_{i,n_i}^{(1)}\Rightarrow m_{i,n_i}阶约当块\boldsymbol J_{i,n_i}\\
$$
*变换矩阵*：
$$
\boldsymbol Q=\begin{bmatrix}\boldsymbol Q_!&\boldsymbol Q_2 &\cdots&\boldsymbol Q_l\end{bmatrix}
$$
其中，
$$
\boldsymbol Q_i=\begin{bmatrix}\boldsymbol q_{i,1}^{(1)}&\cdots&\boldsymbol q_{i,1}^{(m_{i,1})}&\cdots&\boldsymbol q_{i,n_i}^{(1)}&\cdots& \boldsymbol q_{1,n_i}^{(m_{i,n_i})} \end{bmatrix}
$$
*标准型*：
$$
\boldsymbol Q^{-1}\boldsymbol A\boldsymbol Q=\boldsymbol J=\begin{bmatrix}\boldsymbol J_1\\&\ddots\\&&\boldsymbol J_l\end{bmatrix}
$$
其中，
$$
\boldsymbol J_i=\begin{bmatrix}\boldsymbol J_{i,1}\\&\ddots\\&&\boldsymbol J_{i,n_i} \end{bmatrix}
$$
而
$$
\boldsymbol J_i=\begin{bmatrix}\lambda_i&1\\ &\lambda_i&1\\&&\lambda_i&\ddots\\&&&\ddots&\ddots\\&&&&\lambda_i\end{bmatrix}_{m_i\times m_i}
$$
其实就是把每个特征值对应的线性无关特征向量先算出来，对有重数的特征值对应的特征向量算约尔当链，将每一个特征值对应的若尔当链先凑起来成为$\pmb Q_i$，再把所有的$\pmb Q_i$凑成变换矩阵$\pmb Q$ 

**<span id='模式规范化'>模式规范化</span>** 

针对于具有复特征值的情况，实方阵的非实复特征值以共轭形式成对出现，相应的特征向量也是共轭的

设$n$阶方阵$\pmb A$有特征值$\sigma\pm j\omega$，对应的特征向量为$\pmb u\pm j\pmb v$

将对角化变换矩阵$\boldsymbol Q$中的共轭非实复特征值$\lambda=\sigma+j\omega$和$\overline{\lambda}=\sigma-j\omega$对应的共轭非实复特征向量$\boldsymbol q=\boldsymbol u+j \boldsymbol v$和$\overline{\boldsymbol q}=\boldsymbol u-j\boldsymbol v$分别用实向量$\boldsymbol u$和$\boldsymbol v$取代

变换后结果为：
$$
\begin{bmatrix}
\sigma+j\omega &0\\
0&\sigma-j\omega
\end{bmatrix}
\Rightarrow
\begin{bmatrix}
\sigma&\omega\\
-\omega&\sigma
\end{bmatrix}
$$
**其他情况**

基本可以通过模式规范化和若尔当标准型一般形式进行转换

### 1.3. 线性变换结构和线性代数方程组

#### 1.3.1. 线性变换结构

**值域空间**

$m\times n$矩阵$\pmb A$表示线性变换$\R^n\rightarrow\R^m$
$$
R(\pmb A)\mathop=\limits^{def}\{\pmb y\in \R^m:\pmb y=\pmb{Ax},\forall \pmb x\in \R^n\}
$$
*性质：*

1. $R(\pmb A)=\mathrm{span}(\pmb A)$
2. $R(\pmb A)$为$\R^n$的子空间，由$\pmb A$的各个列向量张成，故$R(\pmb A)$又称$\pmb A$的列空间
3. $\dim R(\pmb A)=\mathrm{rank}(\pmb A)\mathop{=}\limits^{def}\rho(\pmb A)\leq \min(n,m)$ 
	* 当$\rho(\pmb A)=\min(n,m)$时，$\pmb A$为满秩矩阵
	* 若$m=n$，满秩矩阵即为可逆矩阵或非奇异矩阵
4. $R(\pmb A)=R(\pmb {AA}^T)$
5. $\rho(\pmb A)=\rho(\pmb {AA}^T)$

**化零空间**
$$
N(\pmb A)\mathop=\limits^{def}\{\pmb x\in \R^n:\pmb {Ax}=\pmb 0\}
$$
*性质*：

1. $N(\pmb A)$为$\R^n$的子空间，由与$\pmb A$的各个行向量正交的向量$\pmb x$张成，又称零空间
2. $N(\pmb A)=[\mathrm {span}(\pmb A)^T]^{\perp}=R(\pmb A^T)^\perp$ 
3. $\R^n=R(\pmb A^T)\oplus N(\pmb A)$ ；$\R^m=R(\pmb A)\oplus N(\pmb A^T)$ 
4. 零度$\nu(\pmb A)=\dim N(\pmb A)$
5. $\rho(\pmb A^T)+\nu(\pmb A)=\rho(\pmb A)+\nu(\pmb A)=n$
6. $N(\pmb A)=N(\pmb A^T\pmb A)$
7. $\nu(\pmb A)=\nu(\pmb A^T\pmb A)$ 

#### 1.3.2. 线性代数方程组

$$
\pmb{Ax}=\pmb b,\pmb x\in\R^n,\pmb b\in \R^m
$$

1. 方程组有解的充要条件
	$$
	\pmb b\in R(\pmb A)=R(\pmb {AA^T})
	$$
	或
	$$
	\pmb b\perp N(\pmb A^T)=N(\pmb {AA}^T)\\
	\rho(\pmb A)=\rho(\pmb A|\pmb b)
	$$

2. 方程组具有最多一个解的充要条件是
	$$
	N(\pmb A)=N(\pmb A^T\pmb A)=\{\pmb 0\}
	$$
	或
	$$
	\rho(\pmb A)=n
	$$
	否则，若$\pmb x$为一个解，则对任何$\hat{\pmb x}\in N(\pmb A)$，$\pmb x+\hat{\pmb x}$也为其解

3. 方程组对每一个$\pmb b\in \R^m$有解的充要条件为
	$$
	R(\pmb A)=R(\pmb{AA}^T)=\R^m
	$$
	或
	$$
	\rho(\pmb A)=m
	$$

4. 方程组对每一个$\pmb b\in \R^m$有唯一解的充要条件为
	$$
	\pmb x=\pmb A^{-1}\pmb b
	$$

### 1.3. 矩阵指数

#### 1.3.1. <span id='矩阵指数'>矩阵指数的定义</span>

对方阵$\pmb A$，矩阵指数定义为：
$$
e^{\pmb A t}=\sum\limits_{k=0}^{\infty} \pmb A^kt^k=\pmb I+\pmb A t+\frac{1}{2!}\pmb A^2t^2+\frac{1}{3!}\pmb A^3t^3+\cdots
$$

#### 1.3.2. <span id='矩阵指数的求取'>计算方法</span> 

**直接计算法**

1. 若矩阵$\boldsymbol A$呈对角线形，即：$\boldsymbol A=\mathrm{diag}(a_1,a_2,\cdots,a_m)$则
	$$
	e^{\boldsymbol A t}=\mathrm{diag}(e^{a_1t},e^{a_2t},\cdots,e^{a_mt})
	$$

2. 若矩阵$\boldsymbol A$呈对角块形，即：$\boldsymbol A=\mathrm{Diag}(\boldsymbol A_1,\boldsymbol A_2,\cdots,\boldsymbol A_m)$则
	$$
	e^{\boldsymbol At}=\mathrm{Diag}(e^{\boldsymbol A_1t},e^{\boldsymbol A_2t},\cdots,e^{\boldsymbol A_mt})
	$$

**拉氏变换法**
$$
e^{\pmb At}=\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]
$$
**标准型法**
$$
e^{\pmb At}=\pmb Qe^{\pmb Q^{-1}\pmb{AQ}}\pmb Q^{-1}=\pmb Qe^{\pmb \Lambda t}\pmb Q^{-1}
$$
当矩阵$\pmb A $有$n $个互不相关的特征向量时，可以通过相似变换将$\pmb A $变换为对角线形

**待定系数法**

凯利-哈密顿定理：方阵满足自身的特征方程

对$n\times n$的方阵$\pmb A$，设其特征多项式为：
$$
f(\lambda)=|\lambda\pmb I-\pmb A|=\lambda^n+a_{n-1}\lambda^{n-1}+\cdots+a_1\lambda+a_0
$$
则凯利-哈密顿定理保证如下矩阵方程成立：
$$
f(\pmb A)=a_0\pmb I+a_1\pmb A+a_2\pmb A^2+\cdots+a_{n-1}\pmb A^{n-1}+\pmb A^n=\pmb 0
$$
为求解矩阵指数$e^{\pmb At}$，先求解特征方程$f(\lambda)=0$得到特征值$\lambda_1,\lambda_2,\cdots,\lambda_n$

设$g(\lambda)=\alpha_0+\alpha_1\lambda+\alpha_2\lambda^2+\cdots+\alpha_{n-1}\lambda^{n-1}$ ，$h(\lambda)=e^{\lambda t}$，其中$\alpha_i=\alpha_i(t),i=1,2,\cdots,n$  

解方程组
$$
g(\lambda_i)=f(\lambda_i),i=1,2,\cdots,n
$$
求得参变量$\alpha_i=\alpha_i(t),i=1,2,\cdots,n$ ，可求得矩阵指数：
$$
e^{\pmb At}=\sum\limits_{k=1}^{k=n}\alpha_{k-1}\pmb A^{k-1}
$$

#### 1.3.3. 常用标准型对应的矩阵指数

**系统矩阵为对角线矩阵**

系统矩阵：
$$
\boldsymbol A=\mathrm{diag}(\lambda_1,\lambda_2,\cdots,\lambda_n)
$$
矩阵指数：
$$
e^{\boldsymbol At}=\mathrm{diag}(e^{\lambda_1t},e^{\lambda_2t},\cdots,e^{\lambda_nt})
$$
**系统矩阵为对角分块矩阵**

系统矩阵：
$$
\boldsymbol A=\mathrm{diag}(\boldsymbol A_1,\boldsymbol A_2,\cdots,\boldsymbol A_l)
$$
矩阵指数：
$$
e^{\boldsymbol At}=\mathrm{diag}(e^{\boldsymbol A_1t},e^{\boldsymbol A_2t},\cdots,e^{\boldsymbol A_lt})
$$
**特殊类型系统矩阵(1)**

系统矩阵：
$$
\boldsymbol A=\begin{bmatrix}
0&1\\
&0&1&&\boldsymbol 0\\
&&0&1\\
&&&0&\ddots\\&\boldsymbol 0&&&\ddots&1\\&&&&&0\end{bmatrix}
$$
$\boldsymbol A$仅右上方次对角线上的元素为1，其余元素为零

矩阵指数：
$$
e^{\boldsymbol At}=\begin{bmatrix}
1&t&\frac{t^2}{2!}&\frac{t^3}{3!}&\cdots&\frac{t^{n-1}}{(n-1)!}\\
&1&t&\frac{t^2}{2!}&\cdots&\frac{t^{n-1}}{(n-1)!}\\
&&1&t&&\vdots\\
&&&1&\ddots&\frac{t^2}{2!}\\
\boldsymbol 0&&&&\ddots&t\\
&&&&&1
\end{bmatrix}
$$
**特殊类型系统矩阵(2)**

系统矩阵：
$$
\boldsymbol A=\begin{bmatrix}\lambda&1\\&\lambda&1&&\boldsymbol 0\\&&\lambda&1\\&&&\lambda&\ddots\\&\boldsymbol 0&&&\ddots&1\\&&&&&\lambda\end{bmatrix}
$$
可以分解为以下形式：
$$
\boldsymbol A=\begin{bmatrix}0&1\\&0&1&&\boldsymbol 0\\&&0&1\\&&&0&\ddots\\&\boldsymbol 0&&&\ddots&1\\&&&&&0\end{bmatrix}+\begin{bmatrix}\lambda&\\&\lambda&&&\boldsymbol 0\\&&\lambda&\\&&&\lambda&\ddots\\&\boldsymbol 0&&&\ddots&\\&&&&&\lambda\end{bmatrix}
$$
矩阵指数：
$$
e^{\boldsymbol At}=\begin{bmatrix}
e^{\lambda t}&te^{\lambda t}&\frac{t^2}{2!}e^{\lambda t}&\frac{t^3}{3!}e^{\lambda t}&\cdots&\frac{t^{n-1}}{(n-1)!}e^{\lambda t}\\
&e^{\lambda t}&te^{\lambda t}&\frac{t^2}{2!}e^{\lambda t}&\cdots&\frac{t^{n-1}}{(n-1)!}e^{\lambda t}\\
&&e^{\lambda t}&te^{\lambda t}&&\vdots\\
&&&e^{\lambda t}&\ddots&\frac{t^2}{2!}e^{\lambda t}\\
\boldsymbol 0&&&&\ddots&te^{\lambda t}\\
&&&&&e^{\lambda t}
\end{bmatrix}
$$
**特殊类型系统矩阵(3)**

系统矩阵：
$$
\boldsymbol A=\begin{bmatrix}0&\omega\\-\omega&0\end{bmatrix}
$$
矩阵指数：
$$
e^{\boldsymbol A}=\begin{bmatrix}\cos\omega t&\sin\omega t\\-\sin\omega t&\cos\omega t\end{bmatrix}
$$
**特殊类型系统矩阵(4)**

系统矩阵：
$$
\boldsymbol A=\begin{bmatrix}\sigma&\omega\\-\omega&\sigma\end{bmatrix}
$$
矩阵指数：
$$
e^{\boldsymbol A}=\begin{bmatrix}e^{\sigma t}\cos\omega t&e^{\sigma t}\sin\omega t\\-e^{\sigma t}\sin\omega t&e^{\sigma t}\cos\omega t\end{bmatrix}
$$

## 2. 系统的状态空间模型

### 2.1. 状态与状态空间的概念

#### 2.1.1. 基本概念

**输入**

作用于系统的所有（外界）激励统称为系统的输入

**输出**

可以量测的、能表征系统行为的响应统称为系统的输出

**状态**

动态系统的状态可定义为一组信息的集合。在已知未来外部输入的情况下，这些信息对于确定系统未来的行为是充分的。可以理解为状态空间的一组基，减少其中的一个变量就会破坏它们对系统行为表征的完全性，而增加一个变量将不增加行为表征的信息量

**状态变量**

用于确定动态系统状态的一组变量称作状态变量

**状态向量**

$n$个状态变量依次用$ x_1(t)，x_2(t), \cdots , x_n(t) $表 示，再把这些状态变量看作是向量$ x(t) $的分量，则x(t) 就称为状态向量，记作
$$
\boldsymbol{x}(t)=\begin{bmatrix}x_1(t)\\x_2(t)\\ \vdots \\x_n(t) \end{bmatrix}
$$
**状态空间**

以状态变量用$x_1(t)，x_2(t), \cdots , x_n(t)$为坐标轴所为基张成的$n$维空间，称为状态空间。在特定的时刻$t$，状态向量$x(t)$在状态空间中是一点  

**状态轨线**

随着时间的推移，$x(t)$在状态空间中描绘出一条轨迹，称为状态轨线  

#### 2.1.2. 状态空间描述

**状态方程**
$$
\begin{matrix}
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u,t)&\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B\boldsymbol u
\end{matrix}
$$
**输出方程**
$$
\begin{matrix}
\boldsymbol y=\boldsymbol g(\boldsymbol x,\boldsymbol u,t)&\boldsymbol y=\boldsymbol C\boldsymbol x+\boldsymbol D\boldsymbol u
\end{matrix}
$$
**状态空间方程**

1. 一般形式
	$$
	\begin{cases}
	\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u,t)\\
	\boldsymbol y=\boldsymbol g(\boldsymbol x,\boldsymbol u,t)
	\end{cases}
	$$

2. 线性定常系统
	$$
	\begin{cases}
	\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B\boldsymbol u\\
	\boldsymbol y=\boldsymbol C\boldsymbol x+\boldsymbol D\boldsymbol u
	\end{cases}
	$$

#### 2.1.3. 连续时间线性系统

**连续时间线性系统状态空间方程的系数矩阵**
$$
\begin{matrix}
\begin{matrix}
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A(t)\boldsymbol x+\boldsymbol B(t) \boldsymbol u\\
\boldsymbol y=\boldsymbol C(t) \boldsymbol x+\boldsymbol D(t) \boldsymbol u
\end{cases}\\
\dim \boldsymbol x=n\\
\dim \boldsymbol u=p\\
\dim \boldsymbol y=q
\end{matrix}&&&&
\begin{align}
\boldsymbol A&=(a_{ij})_{n\times n}——系统矩阵（状态矩阵）\\
\boldsymbol B&=(b_{ij})_{n\times p}——控制矩阵（输入矩阵）\\
\boldsymbol C&=(c_{ij})_{q\times n}——观测矩阵（输出矩阵）\\
\boldsymbol D&=(d_{ij})_{q\times p}——输入-输出矩阵
\end{align}
\end{matrix}
$$
**叠加原理**

系统被称作为线性系统是指对每一个及任意两个状态-输入－输出组：
$$
\left.\begin{align}
&\boldsymbol x_i(t_0)\\
&\boldsymbol u_i(t),\ t\geq t_0
\end{align}\right\}
\rightarrow 
y_i(t),\ t\geq t_0\ \ \ \ i=1,2
$$
一定有（$\alpha$为任意实常数）：

1. 可加性
	$$
	\left.\begin{align}
	&\boldsymbol x_1(t_0)+\boldsymbol x_2(t_0)\\
	&\boldsymbol u_1(t)+\boldsymbol u_2(t),\ t\geq t_0
	\end{align}\right\}
	\rightarrow 
	y_1(t)+y_2(t),\ t\geq t_0
	$$

2. 均匀性
	$$
	\left.\begin{align}
	&\alpha \boldsymbol x_i(t_0)\\
	&\alpha\boldsymbol u_i(t),\ t\geq t_0
	\end{align}\right\}
	\rightarrow 
	\alpha y_i(t),\ t\geq t_0,\ \ \ \ i=1,2
	$$

3. 叠加性=可加性+均匀性
	$$
	\left.\begin{align}
	\alpha_1&\boldsymbol x_1(t_0)+\alpha_2\boldsymbol x_2(t_0)\\
	&\alpha_1\boldsymbol u_1(t)+\alpha_2\boldsymbol u_2(t),\ t\geq t_0
	\end{align}\right\}
	\rightarrow 
	\alpha_1y_1(t)+\alpha_2y_2(t),\ t\geq t_0
	$$

根据可加性，线性系统响应=零输入响应+零状态响应
$$
\begin{cases}
\pmb x(t_0)\\
\pmb u(t),t\geq t_0
\end{cases}
的输出=
\begin{cases}
\pmb x(t_0)\\
\pmb u(t)\equiv 0,t\geq t_0
\end{cases}
的输出+
\begin{cases}
\pmb x(t_0)=0\\
\pmb u(t),t\geq t_0
\end{cases}
的输出
$$
**系统结构图**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105253116.png)  

传递函数矩阵为：
$$
\pmb G(s)=\pmb C(s\pmb I-\pmb A)^{-1}\pmb B+\pmb D
$$
**连续时间线性系统的输入—输出描述**

1. 脉冲输入响应

	![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105544659.png)

2. 齐次性

	![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105603952.png)

3. 可加性

	![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105703592.png)

4. 极限

	![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105717060.png)

5. 脉冲响应
	$$
	y(t)=\int_{-\infty}^{+\infty}g(t,\tau)u(\tau)\mathrm d\tau
	$$

	* 因果
		$$
		因果的\Leftrightarrow g(t,\tau)=0\ \ \ \ \forall t<\tau
		$$

	* 系统在$t_0$时刻松弛
		$$
		\begin{matrix}
		y(t)=\int_{t_0}^tg(t,\tau)u(\tau)d\tau&
		\boldsymbol y(t)=\int^t_{t_0}\boldsymbol G(t,\tau)\boldsymbol u(\tau)d\tau
		\end{matrix}
		$$

#### 2.1.4. 离散时间系统

**状态空间描述**
$$
\begin{align}
\boldsymbol x[k+1]&=\boldsymbol F\boldsymbol x[k]+\boldsymbol H \boldsymbol u[k]\\
\boldsymbol y[k]&=\boldsymbol C\boldsymbol x[k]+\boldsymbol D \boldsymbol u[k]
\end{align}
$$
**传递函数矩阵**
$$
\pmb G(z)=\pmb C(z\pmb I-\pmb F)^{-1}\pmb H+\pmb D
$$
**连续系统离散化**
$$
\pmb u[k]:=\pmb u(kT)\\
\pmb y[k]:=\pmb y(kT)
$$

#### 2.1.5. 分布系统与非线性系统

**集总系统**

集总系统的状态是有限维向量

**分布系统**

分布系统具有无限多个状态变量

**非线性系统**

不满足叠加原理的系统即为非线性系统

集总的非线性系统的状态空间方程一般只能写作：
$$
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u,t)\\
\boldsymbol y=\boldsymbol g(\boldsymbol x, \boldsymbol u,t)
$$
状态方程及输出方程不显含时间$t$又称为自治系统，如：
$$
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u)\\
\boldsymbol y=\boldsymbol g(\boldsymbol x, \boldsymbol u)
$$

### 2.2. 状态空间方程的建立方法

#### 2.2.1. 从系统的机理出发

**步骤：**

1. 寻找合适的最大线性无关组，作为系统的状态变量
2. 列写微分方程/差分方程
3. 转为矩阵表达形式

#### 2.2.2. 从传递函数求状态空间方程

见**传递函数的状态空间实现**一节

#### 2.2.3. 由动态结构图求状态空间方程

**步骤：**

1. 选择各个积分器输出为状态变量
2. 求解各个状态变量之间、状态变量与输入输出变量之间的关系式
3. 整理为矩阵形式

#### 2.2.4. 系统互连状态方程

设有两个互连线性子系统
$$
S_1:\begin{cases}
\dot{\pmb x}_1=\pmb A_1\pmb x_1+\pmb B_1\pmb u_1\\
\pmb y_1=\pmb C_1\pmb x_1+\pmb D_1\pmb u_1
\end{cases}\\
S_2:\begin{cases}
\dot{\pmb x}_2=\pmb A_2\pmb x_2+\pmb B_2\pmb u_2\\
\pmb y_2=\pmb C_2\pmb x_2+\pmb D_2\pmb u_2
\end{cases}
$$
总系统状态表示为：
$$
\pmb x=\begin{bmatrix}\pmb x_1\\ \pmb x_2\end{bmatrix}
$$
**串联**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200309101406894.png)

连接关系：
$$
\begin{cases}
\pmb u_1=\pmb u\\
\pmb u_2=\pmb y_1=\pmb C_1\pmb x_1+\pmb D_1\pmb u\\
\pmb y=\pmb y_2
\end{cases}
$$
状态空间方程：
$$
\begin{align}
\dot{\pmb x}&=\begin{bmatrix}
\pmb A_1&\pmb 0\\ \pmb B_2\pmb C_1&\pmb A_2
\end{bmatrix}\pmb x+\begin{bmatrix}\pmb B_1\\ \pmb B_2\pmb D_1\end{bmatrix}\pmb u\\
\pmb y&=\begin{bmatrix}\pmb D_1\pmb C_1& \pmb C_2\end{bmatrix}\pmb x+\pmb D_2\pmb D_1 \pmb u
\end{align}
$$
**分流**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200309125930193.png)

连接关系：
$$
\begin{cases}
\pmb u_1=\pmb u\\
\pmb u_2=\pmb u\\
\pmb y=\begin{bmatrix}\pmb y_1\\ \pmb y_2\end{bmatrix}
\end{cases}
$$
状态空间方程：
$$
\begin{align}
\dot{\pmb x}&=\begin{bmatrix}
\pmb A_1&\pmb 0\\ \pmb 0&\pmb A_2
\end{bmatrix}\pmb x+\begin{bmatrix}\pmb B_1\\ \pmb B_2\end{bmatrix}\pmb u\\
\pmb y&=\begin{bmatrix}\pmb C_1&\pmb 0\\ \pmb 0&\pmb C_2\end{bmatrix}\pmb x+\begin{bmatrix}\pmb D_1\\ \pmb D_2\end{bmatrix} \pmb u
\end{align}
$$
**并联**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200309130031220.png)

连接关系：
$$
\begin{cases}
\pmb u_1=\pmb u\\
\pmb u_2=\pmb u\\
\pmb y=\pmb y_1+\pmb y_2
\end{cases}
$$
状态空间方程：
$$
\begin{align}
\dot{\pmb x}&=\begin{bmatrix}
\pmb A_1&\pmb 0\\ \pmb 0&\pmb A_2
\end{bmatrix}\pmb x+\begin{bmatrix}\pmb B_1\\ \pmb B_2\end{bmatrix}\pmb u\\
\pmb y&=\begin{bmatrix}\pmb C_1&\pmb C_2\end{bmatrix}\pmb x+(\pmb D_1+\pmb D_2) \pmb u
\end{align}
$$
**反馈**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200309130219788.png)

连接关系：
$$
\begin{cases}
\pmb u_1=\pmb u-\pmb y_2=\pmb u-\pmb C_2\pmb x_2-\pmb D_2\pmb u_2\\
\pmb u_2=\pmb y_1=\pmb C_1\pmb x_1+\pmb D_1\pmb u_1\\
\pmb y=\pmb y_1
\end{cases}
$$
状态空间方程：
$$
\begin{cases}
\dot{\pmb x}=\begin{bmatrix}\pmb A_1-\pmb B_1\pmb \Delta \pmb D_2\pmb C_1&-\pmb B_1\pmb \Delta \pmb C_2\\
\pmb B_2(\pmb C_1-\pmb D_1\pmb \Delta \pmb D_2\pmb C_1)&\pmb A_2-\pmb B_2\pmb D_1\pmb \Delta \pmb C_2
\end{bmatrix}\pmb x+\begin{bmatrix}\pmb B_1\pmb \Delta\\ \pmb B_2\pmb D_1\pmb \Delta\end{bmatrix}\pmb u\\
\pmb y=\begin{bmatrix}\pmb C_1-\pmb D_1\pmb \Delta \pmb D_2\pmb C_1&\pmb D_1\pmb \Delta \pmb C_2\end{bmatrix}\pmb x+(\pmb D_1\pmb \Delta )\pmb u
\end{cases}
$$
其中，$\pmb \Delta=(\pmb I-\pmb D_2\pmb D_1)^{-1}$

### 2.3. 状态空间的线性变换

#### 2.3.1. 坐标变换对状态空间方程的影响

$$
\begin{align}
\begin{matrix}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+\boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x + \boldsymbol D \boldsymbol u
\end{matrix}
\xrightarrow[\overline{\boldsymbol x}=\boldsymbol P \boldsymbol x=\boldsymbol Q^{-1} \boldsymbol x]{\boldsymbol x= \boldsymbol Q \overline{\boldsymbol x}}
\begin{matrix}
\dot{\overline{\boldsymbol x}}=\overline{\boldsymbol A} \overline{\boldsymbol x}+\overline{\boldsymbol B} \overline{\boldsymbol u}\\
\boldsymbol y=\overline{\boldsymbol C} \overline{\boldsymbol x} + \overline{\boldsymbol D} \overline{\boldsymbol u}
\end{matrix}


\end{align}
$$

$$
\boldsymbol Q \dot{\overline{\boldsymbol x}}=\boldsymbol A \boldsymbol Q \overline{\boldsymbol x}+\boldsymbol B \boldsymbol u\\
\dot{\overline{\boldsymbol x}}=\boldsymbol Q^{-1} \boldsymbol A \boldsymbol Q \overline{\boldsymbol x}+\boldsymbol Q^{-1}\boldsymbol B \boldsymbol u
$$

$$
\begin{matrix}
\overline{\boldsymbol A}=\boldsymbol Q^{-1}\boldsymbol A \boldsymbol Q & \overline{\boldsymbol B}=\boldsymbol Q^{-1}\boldsymbol B\\
\overline{\boldsymbol C}=\boldsymbol C \boldsymbol Q & \overline{\boldsymbol D}=\boldsymbol D

\end{matrix}
$$

令$\pmb P=\pmb Q^{-1}$得
$$
\begin{matrix}
\overline{\boldsymbol A}=\boldsymbol P\boldsymbol A \boldsymbol P^{-1} & \overline{\boldsymbol B}=\boldsymbol P\boldsymbol B\\
\overline{\boldsymbol C}=\boldsymbol C \boldsymbol P^{-1} & \overline{\boldsymbol D}=\boldsymbol D

\end{matrix}
$$

#### 2.3.2. 矩阵的规范化

**对角规范化**

* [对角化](#对角化)
* [若尔当标准型](#若尔当)

**模式规范化**

* [针对复特征值的规范化](#模式规范化)

### 2.4. 作业复习

#### 2.4.1. 建模问题

**缓冲器模型：** $F=f\dot{x}$

**弹簧模型：** $F=kx$

**水槽排水模型：**

设断面积为$S$，水位高度为$x$，管道单位时间流出量为$y$，输入量$u$，管道阻力为$R$
$$
S\dot{x}=u-y=u-\frac{x}{R}
$$

#### 2.4.2. 由系统微分方程导出状态空间描述式

**法一：** 直接选取状态变量

*例：*
$$
\ddot{y}(t)+5\dot{y}(t)+6y(t)=u(t)
$$
直接取$x_1=y$和$x_2=\dot{y}$即可求解

**法二：** 拉普拉斯变换(输入函数存在导数)

*例：*
$$
\ddot{y}(t)+2\dot{y}(t)+y(t)=\dot{u}(t)+3u(t)
$$
做拉普拉斯变换：
$$
(s^2+2s+1)\hat{y}=(s+3)\hat u
$$
令$\hat v=\frac{1}{s^2+2s+1}\hat u$ ，取$v=\mathcal L^{-1}\hat v$，定义状态变量$x_1=v$和$x_2=\dot{v}$即可解决问题

**法三：** 利用动态结构图求状态空间方程

将微分方程转为动态结构图，选取积分器后为状态变量构造状态空间方程

## 3. 状态空间方程的解

### 3.1. 状态转移矩阵

#### 3.1.1. 状态转移矩阵的概念

对于时变线性系统的齐次状态方程
$$
\dot{\boldsymbol x}(t)=\boldsymbol A(t)\boldsymbol x(t),\ \ \boldsymbol x(t_0)=\boldsymbol x_0
$$
的解可写作
$$
\boldsymbol x(t,t_0)=\Phi(t,t_0)\boldsymbol x_0
$$
则称矩阵$\Phi(t,t_0)$为该系统的状态转移矩阵。对于线性定常系统，$t_0$总可移至零，即$\Phi(t,t_0)=\Phi(t-t_0,0)$，故又可记为$\Phi(t)$

#### 3.1.2. 状态转移矩阵的表达式

仅考虑线性定常系统

对方程
$$
\dot{\boldsymbol x}(t)=\boldsymbol A\boldsymbol x(t)
$$
做拉普拉斯变换，得到：
$$
s\hat{\boldsymbol x}(s)-\pmb x(0)=\boldsymbol A\hat{\boldsymbol x}(s)
$$
即：
$$
\hat{\pmb x}(s)=(s\pmb I-\pmb A)^{-1}\pmb x_0
$$
逆变换得到：
$$
\pmb x(t)=\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]\pmb x_0=\Phi(t)\pmb x_0
$$
得到状态转移矩阵的表达式：
$$
\phi(t)=\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]
$$
进一步，对于$\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]$ ，我们注意到标量系统：
$$
\mathcal L^{-1}[\frac{1}{s-a}]=e^{at}=\sum\limits_{k=0}^\infty \frac{1}{k!}(at)^k
$$
定义[矩阵指数](#矩阵指数)$e^{\pmb At}$ ，有$\Phi(t)=e^{\pmb At}$

#### 3.1.3. 状态转移矩阵的性质

1. $\Phi(t)=e^{\pmb At}=\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]$

2. $\Phi(0)=e^{\pmb A0}=\pmb I$

3. $\Phi(t)=\pmb A\Phi(t)=\Phi(t)\pmb A$ ，解释：$\frac{\mathrm d}{\mathrm dt}(e^{\pmb At})=\pmb Ae^{\pmb At}=e^{\pmb At}\pmb A$ 

4. $\Phi(t)\Phi(\tau)=\Phi(t+\tau)$ ，解释：$e^{\pmb At}e^{\pmb A\tau}=e^{\pmb A(t+\tau)}$ 

	推论：

	1. 状态转移矩阵是可逆阵，且总有

		​	$[\Phi(t)]^{-1}=\Phi(-t)$，解释：$[e^{\pmb At}]^{-1}=e^{-\pmb At}$

	2. 对一切整数$k$，总有

		​	$[\Phi(t)]^k=\Phi(kt)$，解释：$[e^{\pmb At}]^k=e^{\pmb Akt}$

5. $\pmb {AB}=\pmb {BA}\Leftrightarrow e^{\pmb At}e^{\pmb Bt}=e^{(\pmb A+\pmb B)t}$ 

	​	推论：对标量$\sigma$和方阵$\pmb B$，有$\pmb A=\sigma \pmb I+\pmb B$，则：$e^{\pmb At}=e^{\sigma t}e^{\pmb Bt}$

6. 对任一非奇异矩阵$\pmb P$有：
	$$
	e^{\pmb P^{-1}\pmb A\pmb P}=\pmb P^{-1}e^{\pmb At}\pmb P
	$$

#### 3.1.4. 状态转移矩阵的求取

详见[矩阵指数的计算方法](#矩阵指数的求取)

### 3.2. 模态与模态分解

考察齐次状态空间方程的解，以互不相同的特征值为例：
$$
\begin{align}
\boldsymbol x(t)&=e^{\boldsymbol At}\boldsymbol x_0=e^{(\boldsymbol Q \boldsymbol \Lambda \boldsymbol Q^{-1})t}\boldsymbol x_0=\boldsymbol Q e^{\boldsymbol \Lambda t}\boldsymbol Q^{-1}\boldsymbol x_0\\
&=\begin{bmatrix}\boldsymbol q_1&\boldsymbol q_2&\cdots&\boldsymbol q_n\end{bmatrix}
\begin{bmatrix}e^{\lambda_1 t}\\&e^{\lambda_2 t}\\&&\ddots\\&&& e^{\lambda_n t} \end{bmatrix}\begin{bmatrix}\boldsymbol p_1\\ \boldsymbol p_2\\ \vdots\\ \boldsymbol p_n\end{bmatrix}\boldsymbol x_0\\
&=\begin{bmatrix}e^{\lambda_1 t}\boldsymbol q_1&e^{\lambda_2 t}\boldsymbol q_2\cdots e^{\lambda_nt}\boldsymbol q_n \end{bmatrix}\begin{bmatrix}\boldsymbol p_1\boldsymbol x_0\\ \boldsymbol p_2\boldsymbol x_0\\ \vdots\\ \boldsymbol p_n \boldsymbol x_0 \end{bmatrix}\\
&=(\boldsymbol p_1 \boldsymbol x_0)e^{\lambda_1 t}\boldsymbol q_1+(\boldsymbol p_2 \boldsymbol x_0)e^{\lambda_2 t}\boldsymbol q_2+\cdots+(\boldsymbol p_n \boldsymbol x_0)e^{\lambda_n t}\boldsymbol q_n
\end{align}
$$
其中，$\boldsymbol p$为行向量，$\boldsymbol q$、$\boldsymbol x$为列向量，$\boldsymbol p\boldsymbol x$为标量

对于一个给定的线性定常系统，不论进行怎样的状态变换，系统矩阵$\pmb A$的特征值及其相应的特征向量是不会改变的。

由于$e^{\lambda_i t}$体现了系统的固有属性，一般将$e^{\lambda_i t},(i=1,2,\cdots,n)$称作系统的模态，或者称作振荡振型，简称振型。 也称将系统矩阵约当化的状态变换阵$Q$为该系统的模态矩阵，称该状态变换过程及结果为模态分解。

### 3.3. 状态空间方程的解

#### 3.3.1. 线性定常非齐次状态方程的解

状态方程：
$$
\begin{matrix}\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B \boldsymbol u&\boldsymbol x(0)=\boldsymbol x_0 \end{matrix}
$$
同时左乘$e^{-\boldsymbol A t}$并移项
$$
e^{-\boldsymbol A t}\dot{\boldsymbol x}-e^{-\boldsymbol A t}\boldsymbol A \boldsymbol x(t)=e^{-\boldsymbol A t}\boldsymbol B \boldsymbol u(t)
$$
此即
$$
\frac{\mathrm{d}}{\mathrm{d}t}(e^{-\boldsymbol A t}\boldsymbol x(t))=e^{-\boldsymbol A t}\boldsymbol B \boldsymbol u(t)
$$
对此式从0至$t$积分
$$
e^{-\boldsymbol At}\boldsymbol x(t)-e^0 \boldsymbol x(0)=\int^t_0 e^{-\boldsymbol A \tau}\boldsymbol B \boldsymbol u(\tau)d\tau
$$
移项，等式两边同左乘$e^{\boldsymbol A t}$
$$
\boldsymbol x(t)=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A(t-\tau)}\boldsymbol B \boldsymbol u(\tau)d\tau
$$
变量代换得
$$
\boldsymbol x(t)=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau
$$
当初始时刻非零时，从$t_0$积分到$t$，得
$$
\boldsymbol x(t)=e^{\boldsymbol A (t-t_0)}\boldsymbol x(t_0) +\int^t_{t_0} e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau
$$

第二项可以看成是卷积$l(t-t_0)e^{\pmb At}\ast\pmb B\pmb u(t)$ 

#### 3.3.2. 状态空间的解

状态方程：
$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+ \boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x+\boldsymbol D \boldsymbol u
\end{cases}
$$
初始条件：
$$
\boldsymbol x(0)=\boldsymbol x_0
$$
解得：
$$
\begin{align}
\boldsymbol x(t)&=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A(t-\tau)}\boldsymbol B\boldsymbol u(\tau)d\tau\\
&=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau\\
\boldsymbol y(t)&=\boldsymbol C e^{\boldsymbol At}\boldsymbol x_0+\boldsymbol C\int^t_0 e^{\boldsymbol A(t-\tau)}\boldsymbol B\boldsymbol u(\tau)d\tau+\boldsymbol D \boldsymbol u\\
&=\boldsymbol C e^{\boldsymbol A t}\boldsymbol x_0+\boldsymbol C\int ^t_0 e^{\boldsymbol A\tau}\boldsymbol B\boldsymbol u(t-\tau)d\tau+\boldsymbol D\boldsymbol u
\end{align}
$$

#### 3.3.3. 状态空间方程的离散化

$$
\begin{matrix}
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+ \boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x+\boldsymbol D \boldsymbol u
\end{cases}
&
\Rightarrow
&
\begin{cases}
\pmb x[k+1]=\pmb {Fx}[k]+\pmb {Hu}[k]\\
\pmb y[k]=\pmb C_d \pmb x[k]+\pmb D_d\pmb u[k]
\end{cases}
\end{matrix}
$$

设$\pmb u(t)$分段定常，且对所有的$k=0,1,2,\cdots$有
$$
\begin{matrix}
\pmb u(t)=\pmb u(kT):=\pmb u[k]&\forall kT\leq t\leq (k+1)T
\end{matrix}
$$
以$kT$为时间起点应用状态方程解公式，有：
$$
\pmb x((k+1)T)=e^{\pmb At}\pmb x(kT)+\int_{kT}^{(k+1)T}e^{\pmb A((k+1)T-t)}\pmb {Bu}(\tau)\mathrm d\tau
$$
定义：
$$
\pmb x[k]:=\pmb x(kT)
$$
又
$$
\int_{kT}^{(k+1)T}e^{\pmb A((k+1)T-\tau)}\mathrm d\tau\cdot \pmb B=-\int_{T}^{0}e^{\pmb A\alpha}\mathrm d\alpha\cdot \pmb B=\int_0^Te^{\pmb A\tau}\mathrm d\tau\cdot \pmb B
$$
其中，$\alpha=(k+1)T-\tau$

令
$$
\begin{matrix}
\pmb F=e^{\pmb AT}&\pmb H=(\int_0^Te^{\pmb A\tau}\mathrm d\tau)\pmb B&\pmb C_d=\pmb C&\pmb D_d=\pmb D
\end{matrix}
$$
可以得到
$$
\begin{matrix}
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+ \boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x+\boldsymbol D \boldsymbol u
\end{cases}
&
\Rightarrow
&
\begin{cases}
\pmb x[k+1]=\pmb {Fx}[k]+\pmb {Hu}[k]\\
\pmb y[k]=\pmb C_d \pmb x[k]+\pmb D_d\pmb u[k]
\end{cases}
\end{matrix}
$$
特别的，当$\pmb A$非奇异时，$\pmb H=\pmb A^{-1}(e^{\pmb AT-\pmb I})\pmb B$，下面是简单证明：

令方阵函数$\pmb M(t)=\pmb A^{-1}(e^{\pmb At}-\pmb I)$，则$\pmb M(0)=\pmb 0$，且
$$
\frac{\mathrm d}{\mathrm dt}\pmb M(t)=\frac{\mathrm d}{\mathrm dt}(\pmb A^{-1}(e^{\pmb At}-\pmb I))=e^{\pmb At}
$$
于是，
$$
\begin{align}
\pmb H&=(\int_0^Te^{\pmb A\tau}\mathrm d\tau)\pmb B=\int_0^T\Big(\frac{\mathrm d}{\mathrm d\tau}\pmb M(\tau)\Big)\mathrm d\tau\cdot \pmb B\\
&=[\pmb M(T)-\pmb M(0)]\pmb B=\pmb M(T)\pmb B=\pmb A^{-1}(e^{\pmb AT}-\pmb I)\pmb B
\end{align}
$$

### 3.4. 预解矩阵与频域求解

#### 3.4.1. Souriau-Frame-Faddeev算法

$$
\begin{align}
(s\boldsymbol I-\boldsymbol A)^{-1}&=\frac{\mathrm{adj}(s\boldsymbol I-\boldsymbol A)}{\mathrm{det}(s\boldsymbol I-\boldsymbol A)}\\
&=\frac{\sum\limits^{n-1}_{k=0}\boldsymbol Q_k\boldsymbol S^k}{s^n+a_{n-1}s^{n-1}+\cdots+a_1s+a_0}
\end{align}
$$

其中，各步$\pmb Q_k$和$a_k$由下列迭代公式给出：
$$
\begin{matrix}
\pmb Q_{n-1}=\pmb I&a_{n-1}=-\mathrm {tr}(\pmb Q_{n-1}\pmb A)\\
\pmb Q_{k-1}=\pmb Q_k\pmb A+a_k\pmb I&a_{k-1}=-\frac{1}{n-k}\mathrm{tr}(\pmb Q_k\pmb A)&k=n-1,n-2,\cdots,2,1
\end{matrix}
$$
此算法用于比较方便地求出$(s\pmb I-\pmb A)^{-1}$ ，以便进一步求出传递函数矩阵$\pmb G(s)=\pmb C(s\pmb I-\pmb A)^{-1}\pmb B+\pmb D=\sum\limits_{k=0}^{n-1}\frac{\pmb C\pmb Q_k\pmb Bs^k}{\Delta(s)}+\pmb D$  

#### 3.4.2. S-F-F算法的推论

$$
(s\boldsymbol I-\boldsymbol A)^{-1}=\sum\limits^{n-1}_{k=0}a_k(s)\boldsymbol A^k
$$

其中，
$$
a_k(s)=\frac{1}{\Delta (s)}(s^{n-k-1}+a_{n-1}s^{n-k-2}+\cdots+a_{k+2}s+a_{k+1}),k=0,1,2,\cdots,n-1
$$
其中，$\Delta (s)=\det(s \boldsymbol I-\boldsymbol A)$ 

对两边取拉普拉斯逆变换得凯莱-哈密顿定理表示下的$e^{\pmb At}$的幂级数表达式
$$
\begin{align}
e^{\pmb At}&=\mathcal L^{-1}\Big[\sum\limits_{k=0}^{n-1}\alpha_k(s)\pmb A^k \Big]=\sum\limits_{k=0}^{n-1}\alpha_k(t)\pmb A^k\\
\alpha_k(t)&=\mathcal L^{-1}[\alpha_k(s)],k=0,1,2,\cdots,n-1
\end{align}
$$
进一步代入传递函数矩阵得：
$$
\pmb G(s)=\sum\limits_{k=0}^{n-1}\alpha_k(s)\pmb {CA}^k\pmb B+\pmb D
$$

### 3.5. 作业复习

#### 3.5.1. 已知状态转移矩阵，求系统矩阵$\pmb A$

系统状态方程为$\dot{\pmb x}=\pmb {Ax}(t)$

状态转移矩阵为：$\Phi(t)$

求系统矩阵$\pmb A$，只需：
$$
A=\frac{\mathrm d}{\mathrm dt}\Phi(t)\Big|_{t=0}=\pmb Ae^{\pmb A0}
$$

#### 3.5.2. 已知两对系统状态，求系统矩阵$\pmb A$

系统状态方程为$\dot{\pmb x}=\pmb {Ax}(t)$

现已知$\pmb x_1(0)$，$\pmb x_1(t)$，$\pmb x_2(0)$，$\pmb x_2(t)$

由$\pmb x(t)=\Phi(t)\pmb x(0)$可得：
$$
\begin{bmatrix}\pmb x_1(t)&\pmb x_2(t) \end{bmatrix}=\Phi(t)\begin{bmatrix}\pmb x_1(0)&\pmb x_2(0) \end{bmatrix}
$$
求得系统状态转移方程：
$$
\Phi(t)=\begin{bmatrix}\pmb x_1(t)&\pmb x_2(t) \end{bmatrix}\begin{bmatrix}\pmb x_1(0)&\pmb x_2(0) \end{bmatrix}^{-1}
$$
求系统矩阵$\pmb A$，只需：
$$
A=\frac{\mathrm d}{\mathrm dt}\Phi(t)\Big|_{t=0}=\begin{bmatrix}\dot{\pmb x}_1(0)&\dot{\pmb x}_2(0) \end{bmatrix}\begin{bmatrix}\pmb x_1(0)&\pmb x_2(0) \end{bmatrix}^{-1}
$$

#### 3.5.3. 已知状态方程和系统输入求状态响应

已知：
$$
\begin{matrix}\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B \boldsymbol u&\boldsymbol x(0)=\boldsymbol x_0 \end{matrix}
$$
求输入$\pmb u(t)$下的状态响应

先求状态转移矩阵$\Phi(t)=e^{\pmb At}$(待定系数法、拉普拉斯变换法、标准型法)

代公式：
$$
\boldsymbol x(t)=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau
$$
若输入$\pmb u(t)=\delta(t)$，则
$$
\pmb x(t)=e^{\pmb At}(\pmb x(0)+\pmb B)
$$

#### 3.5.4. 模态分解

已知：
$$
\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B \boldsymbol u
$$
先计算$\pmb A$的特征值和特征向量得到变换矩阵$\pmb Q$，进一步得到$e^{\pmb At}=\pmb Qe^{\pmb \Lambda t}\pmb Q^{-1}$ 

#### 3.5.5. 预解矩阵的应用

利用预解矩阵可以很方便的求解$(s\pmb I-\pmb A)^{-1}$，$\pmb A^{-1}$和$\det \pmb A$
$$
(s\pmb I-\pmb A)^{-1}=\sum\limits_{k=0}^{n-1}\frac{s^{n-k-1}+a_{n-1}s^{n-k-2}+\cdots+a_{k+2}s+a_{k+1}}{\Delta (s)}\pmb A^k
$$
其中，
$$
\Delta (s)=\det(s \boldsymbol I-\boldsymbol A)
$$
令$s=0$即可求得$\pmb A^{-1}$和$\det \pmb A$

#### 3.5.6. 状态空间离散化

套公式：
$$
\begin{matrix}
\pmb F=e^{\pmb AT}&\pmb H=(\int_0^Te^{\pmb A\tau}\mathrm d\tau)\pmb B&\pmb C_d=\pmb C&\pmb D_d=\pmb D
\end{matrix}
$$

#### 3.5.7. 凯勒-哈密顿定理证明题

若$\pmb A\in \R^{m\times n}$，则对所有$k\in \N$，有$\pmb A^k=\sum\limits_{m=0}^{n-1}\alpha_m\pmb A^m$

**证明：**

1. 当$k<n$时，显然有$\pmb A^k=\sum\limits_{m=0}^{n-1}\alpha_m\pmb A^m$

2. 当$k=n$时，由凯勒-哈密顿定理，方阵满足自身特征多项式
	$$
	f(\lambda)=\det(\lambda\pmb I-\pmb A)=\lambda^n+a_1\lambda^{n-1}+\cdots+a_{n-1}\lambda+a_n=0
	$$
	则一定有：
	$$
	\pmb A^n+a_1\pmb A^{n-1}+\cdots+a_{n-1}\pmb A+a_n=0\Rightarrow \pmb A^n=-(a_1\pmb A^{n-1}+\cdots+a_{n-1}\pmb A+a_n)
	$$

3. 当$k>n$时，可用数学归纳法证明，这里证明$k=n+1$存在
	$$
	\begin{align}
	\pmb A^{n+1}&=\pmb A\cdot \pmb A^n=-\pmb A(a_1\pmb A^{n-1}+\cdots+a_{n-1}\pmb A+a_n)\\
	&=-a_1\pmb A^n-a_2\pmb A^{n-1}-\cdots-a_{n-1}\pmb A^2-a_n\pmb A\\
	&=-a_1(-a_1\pmb A^{n-1}-\cdots-a_{n-1}\pmb A-a_n)-a_2\pmb A^{n-1}-\cdots-a_{n-1}\pmb A^2-a_n\pmb A\\
	&=\sum\limits_{m=0}^{n-1}\alpha_m\pmb A^m
	\end{align}
	$$
	

