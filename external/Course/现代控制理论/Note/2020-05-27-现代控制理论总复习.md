# 现代控制理论总复习

[TOC] 

## 基本大纲

- [x] 数学基础
	- [x] 线性空间和线性变换
	- [x] 特征值、特征向量和约尔当标准型
	- [x] 线性变换结构和线性代数方程组
	- [x] 矩阵指数
	- [x] 时间函数的线性关系
- [x] 系统的状态空间模型
	- [x] 状态与状态空间的概念
	- [x] 状态空间方程的建立方法
	- [x] 状态空间的线性变换
	- [x] 作业复习
- [x] 状态空间方程的解
	- [x] 状态转移矩阵
	- [x] 模态与模态分解
	- [x] 状态空间方程的解
	- [x] 预解矩阵与频域求解
	- [x] 作业复习
- [x] 系统的稳定性
	- [x] 外部稳定性(BIBO)
	- [x] 内部稳定性(李雅普诺夫稳定性)
	- [x] 线性系统平衡状态稳定性判据
	- [x] 李雅普诺夫直接法
	- [x] 李雅普诺夫函数的构造方法
	- [x] 线性非时变离散系统的稳定性
	- [x] 作业复习
- [ ] 能观性与能控性
	- [x] 能控性与能达性
	- [ ] 能观性与能构性
	- [ ] 能观性与能控性的比较
	- [ ] 线性系统状态空间结构
	- [ ] 线性离散系统的能观性和能控性
	- [ ] 作业复习
- [ ] 传递函数的状态空间实现
	- [ ] 实现和最小实现
	- [ ] 传递函数的串联实现
	- [ ] 传递函数的并联实现
	- [ ] 作业复习
- [ ] 状态反馈和状态观测器
	- [ ] 反馈的结构与形式
	- [ ] 状态反馈与极点配置
	- [ ] 全维状态观测器
	- [ ] 分离定理与复合控制
	- [ ] 降维状态观测器
	- [ ] 作业复习
- [ ] 最优性原理与动态规划
	- [ ] 最优控制问题的描述
	- [ ] 动态规划例题
- [ ] 极小值原理
	- [ ] 静态最优化问题及解
	- [ ] 泛函极值与变分法
	- [ ] 极小值原理
	- [ ] 作业复习
- [ ] 二次型指标的线性最优控制
  - [ ] 最优跟踪问题
  - [ ] 有限时间状态调节器
  - [ ] 无限时间状态调节器
  - [ ] 离散系统状态调节器
  - [ ] 线性最优输出调节器
  - [ ] 线性最优跟踪问题
  - [ ] 作业复习

## 1. 数学基础

### 1.1. 线性空间与线性变换

#### 1.1.1. 代数结构简介

**集**

定义为具有相同属性事物的全体

**群**

设$\pmb F$为一非空集，如果在$\pmb F$中存在某种运算$\ast $，使得$\forall a,b\in \pmb F,\exists c=a\ast b\in \pmb F$，且满足下列条件则称为群：

1. 结合律：$\forall a_1,a_2,a_3\in \pmb F$，总有$(a_1\ast a_2)\ast a_3=a_1\ast (a_2\ast a_3)$
2. $\pmb F$中存在单位元素$e$，即$\forall a\in \pmb F$，总有$e\ast a=a\ast e=a$
3. $\pmb F$中有逆元素，即$\forall a\neq 0\in \pmb F$，总有元素$\overline{a}$，使得$\overline{a}\ast a=a\ast \overline{a}=e$ 

*半群*：集$\pmb F$与运算$\ast $只满足结合律

*可交换群*：群$\pmb F$及其运算$\ast $满足交换律，即$\forall a,b\in\pmb F$，总有$a\ast b=b\ast a$

*加法群*：运算$\ast $为加法

*乘法群*：运算$\ast $为乘法

**环**

设非空集$\pmb F$中规定了加法运算“+”和乘法运算"$\times$"，即$\forall a,b\in \pmb F,\exists \alpha=a+b\in\pmb F$和$\exists \beta=a\times b\in \pmb F$，且满足下列条件则称为环

1. 对加法运算而言，$\pmb F$为可交换群
2. 对乘法运算而言，$\pmb F$为半群
3. 加法和乘法联合运算时，乘法对于加法满足分配律，即

$$
a_1\times(a_2+a_3)=a_1\times a_2+a_1\times a_3,\forall a_1,a_2,a_3\in\pmb F
$$

若环$\pmb F$满足乘法交换律，则称为可交换环

**域**

若$\pmb F$不仅是可交换环，而且对乘法而言又是可交换群，则$\pmb F$称为域。

显然，域$\pmb F$具有单位元素$e=1$和逆元素$\overline{a}=a^{-1}$

#### 1.1.2. 线性空间的基本概念

当向量集$\pmb X$和数域$\pmb F$中元素进行的向量加和标量乘满足下面条件时，称$\pmb X$为域$\pmb F$上的线性空间，记为$(\pmb X,\pmb F)$

1. 向量加和标量乘具有封闭性和唯一性

2. 向量加满足交换律和结合律
3. $\pmb X$中存在零向量$\pmb 0$
4. 对于$\pmb X$中任何一个向量$\pmb x$，总存在一个向量$\overline{\pmb x}$，使得$\pmb x+\overline{\pmb x}=\pmb 0$
5. 标量乘满足结合律
6. 向量加和标量乘联合运算时满足分配律
7. $\pmb F$中有标量1，使得

$$
1\cdot \pmb x=\pmb x\cdot 1=\pmb x,\ \ \forall \pmb x\in \pmb X
$$

#### 1.1.3. 线性变换

**基底变换**

$\pmb n$维向量空间$\pmb X$中两组基$\pmb E=(\pmb e_1,\pmb e_2,\pmb e_3,\cdots,\pmb e_n)$ 和 $$\overline{\pmb E}=(\overline{\pmb e}_1,\overline{\pmb e}_2,\overline{\pmb e}_3,\cdots,\overline{\pmb e}_n)$$ ，$\pmb X$中某个向量$\pmb x$在两组基下表示为：
$$
\begin{align}
\pmb x&=(\pmb e_1,\pmb e_2,\pmb e_3,\cdots,\pmb e_n)\pmb \alpha\\
\overline{\pmb x}&=(\overline{\pmb e}_1,\overline{\pmb e}_2,\overline{\pmb e}_3,\cdots,\overline{\pmb e}_n)\overline{\pmb \alpha}
\end{align}
$$
设$\pmb e_j$在基$\overline{\pmb E}$下的坐标为$\pmb p_j=(p_{1j},p_{2j},\dots,p_{nj})^T$，有：
$$
\begin{align}
\pmb e_j=(\overline{\pmb e}_1,\overline{\pmb e}_2,\overline{\pmb e}_3,\cdots,\overline{\pmb e}_n)\begin{bmatrix}p_{1j}\\p_{2j}\\\vdots\\ p_{nj} \end{bmatrix}=\overline{\pmb E}\pmb p_j,j=1,2,\cdots,n
\end{align}
$$
故
$$
\begin{align}
\begin{bmatrix}\pmb e_1&\pmb e_2&\cdots&\pmb e_n\end{bmatrix}&=\begin{bmatrix}
\overline{\pmb E}\pmb p_1&\overline{\pmb E}\pmb p_2&\cdots&\overline{\pmb E}\pmb p_n \end{bmatrix}\\
&=\overline{\pmb E}\begin{bmatrix}\pmb p_1&\pmb p_2&\cdots&\pmb p_n\end{bmatrix}\\
&=\overline{\pmb E}\pmb P
\end{align}
$$
代入前式有
$$
\begin{align}
\pmb x=\overline{\pmb E}\pmb P\pmb \alpha=\overline{\pmb E}\overline{\pmb \alpha}
\end{align}
$$
解得：
$$
\begin{align}
\overline{\pmb \alpha}=\pmb{P\alpha}
\end{align}
$$
同理有
$$
\begin{align}
\pmb \alpha=\pmb Q\overline{\pmb \alpha}\\
\pmb Q\pmb P=\pmb I
\end{align}
$$
**线性变换**

设$(\pmb X,\pmb F)$和$(\pmb Y,\pmb F)$为同一个域$\pmb F$的$n$维和$m$维向量空间，$\pmb X$的基为$(\pmb x_1,\pmb x_2,\cdots,\pmb x_n)$，$\pmb Y$的基为$(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)$

线性变换$\pmb L:(\pmb X,\pmb F)\rightarrow(\pmb Y,\pmb F)$ 将$\pmb x$映射为：
$$
\begin{align}
\pmb L(\pmb x)&=\alpha_1\pmb L(\pmb x_1)+\alpha_2\pmb L(\pmb x_2)+\cdots+\alpha_n\pmb L(\pmb x_n)\\
&=\alpha_1\pmb y_1+\alpha_2\pmb y_2+\cdots+\alpha_n\pmb y_n
\end{align}
$$
假定$\pmb y_i$相对于$\pmb Y$的基$(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)$的坐标为$(a_{1j},a_{2j},\cdots,a_{mj})^T=\pmb a_j$，即
$$
\begin{align}
\pmb y_j=(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)\pmb a_j,j=1,2,\cdots,n
\end{align}
$$
其中系数$a_{ij},i=1,2,\cdots,m,j=1,2,\cdots,n$

有
$$
\begin{align}
\pmb L(\pmb x_1,\pmb x_2,\cdots,\pmb x_n)&=(\pmb y_1,\pmb y_2,\cdots,\pmb y_n)\\
&=(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)(\pmb a_1,\pmb a_2,\cdots,\pmb a_n)\\
&=(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)\pmb A
\end{align}
$$
其中，$\pmb A=(a_{ij})_{m\times n}$，$\pmb A$的第$j$列$\pmb a_j$表示$$\pmb y_j=\pmb L(\pmb x_j)$$相对于$$\pmb Y$$的基德坐标

若向量$\pmb x$和$\pmb y=\pmb L(\pmb x)$在各自的基下坐标为$\pmb \alpha=(\alpha_1,\alpha_2,\cdots,\alpha_n)^T$和$\pmb \beta=(\beta_1,\beta_2,\cdots,\beta_m)^T$ 

对于线性变换$$\pmb y=\pmb L(\pmb x)$$，可表示为
$$
\begin{align}
(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)\pmb \beta&=\pmb L[(\pmb x_1,\pmb x_2,\cdots,\pmb x_n)\pmb \alpha]\\
&=L[\pmb x_1,\pmb x_2,\cdots,\pmb x_n]\pmb \alpha\\
&=(\pmb u_1,\pmb u_2,\cdots,\pmb u_m)\pmb A\pmb \alpha
\end{align}
$$
由向量的唯一性得到：
$$
\begin{align}\pmb \beta=\pmb A\pmb\alpha\end{align}
$$
**线性变换的矩阵形式**

设$n$维空间$(\pmb X,\pmb F)$有两组不同的基$\pmb E=(\pmb e_1,\pmb e_2,\pmb e_3,\cdots,\pmb e_n)$ 和 $$\overline{\pmb E}=(\overline{\pmb e}_1,\overline{\pmb e}_2,\overline{\pmb e}_3,\cdots,\overline{\pmb e}_n)$$ ，$m$维空间$(\pmb Y,\pmb F)$有两组不同的基$$\pmb \varepsilon=(\pmb \varepsilon_1,\pmb \varepsilon_2,\pmb \varepsilon_3,\cdots,\pmb \varepsilon_n)$$和$$\overline{\pmb \varepsilon}=(\overline{\pmb \varepsilon}_1,\overline{\pmb \varepsilon}_2,\overline{\pmb \varepsilon}_3,\cdots,\overline{\pmb \varepsilon}_n)$$ ，$\forall \pmb x\in\pmb X$和$\pmb y=\pmb L(\pmb x)\in \pmb Y$ 在各自基下的表达式为：
$$
\begin{align}
\pmb x=\pmb{E\alpha}=\overline{\pmb E}\overline{\pmb \alpha}\\
\pmb y=\pmb{\varepsilon\beta}=\overline{\pmb \varepsilon}\overline{\pmb \beta}
\end{align}
$$
由前式可知
$$
\begin{align}
\begin{matrix}
\overline{\pmb \alpha}=\pmb{P\alpha}&
\pmb \alpha=\pmb P^{-1}\overline{\pmb \alpha}\\
\overline{\pmb \beta}=\pmb {Q\beta}&
\pmb\beta=\pmb Q^{-1}\overline{\pmb\beta}
\end{matrix}
\end{align}
$$
用基$\pmb E$和$\pmb \varepsilon$表示线性变换的表达式为：
$$
\begin{align}
\pmb\beta=\pmb{A\alpha}
\end{align}
$$
用基$\overline{\pmb E}$和$\overline{\pmb \varepsilon}$表示线性变换的表达式为：
$$
\begin{align}
\overline{\pmb \beta}=\overline{\pmb A}\overline{\pmb \alpha}
\end{align}
$$
其中，
$$
\begin{align}
\overline{\pmb A}=\pmb {QAP}^{-1}\\
\pmb A=\pmb Q^{-1}\overline{\pmb A}\pmb{P}
\end{align}
$$

特别地，对于映射到自身的线性变换$\pmb L:(\pmb X,\pmb F)\rightarrow(\pmb X,\pmb F)$，两组基下表达同一个线性变换的矩阵$\pmb A$和$\overline{\pmb A}$有
$$
\begin{align}
\overline{\pmb A}=\pmb {PAP}^{-1}\\
\pmb A=\pmb{P}^{-1}\overline{\pmb{A}}\pmb{P}
\end{align}
$$

### 1.2. 特征值、特征向量和约尔当标准型

#### 1.2.1. 特征值与特征向量

设矩阵$\pmb A$表示一个将$(\pmb C^n,\pmb C)$映射到自身的线性变换，$\lambda\in \pmb C$，若$\exists x\in\pmb C^m$，使得
$$
\pmb {Ax}=\lambda\pmb x
$$
则称$\lambda$为$\pmb A$的特征值，$\pmb x$为伴随特征值$\lambda$的特征向量，$\det(\lambda\pmb I-\pmb {A})=0$称为$\pmb A$的特征方程

#### 1.2.2. 若尔当标准型求法

**<span id='对角化'>n个特征值、n个特征向量</span>**

*特征方程*：
$$
|s\boldsymbol I-\boldsymbol A|=(s-\lambda_1)(s-\lambda_2)\cdots(s-\lambda_n)
$$
具有$n$个相异特征值：$\lambda_i\neq \lambda_j$

*特征向量*：
$$
\lambda_i\rightarrow \boldsymbol A \boldsymbol q_i=\lambda_i\boldsymbol q_i
$$
$n$个线性无关的特征向量：$\{\boldsymbol q_1,\boldsymbol q_2,\cdots,\boldsymbol q_n\}$

*变换矩阵：*
$$
\boldsymbol Q= \begin{bmatrix}\boldsymbol q_1& \boldsymbol q_2& \cdots&\boldsymbol q_n\end{bmatrix}
$$
*标准型：*
$$
\pmb Q^{-1}\pmb {AQ}=\pmb \Lambda=\mathrm {diag}(\lambda_1,\lambda_2,\cdots,\lambda_n)
$$
注意：$n$个特征值可相异

**<span id='若尔当'>p(p<n)个特征值</span>**

*特征方程*：
$$
|s\boldsymbol I-\boldsymbol A|=(s-\lambda_1)^{m_1}(s-\lambda_2)^{m_2}\cdots(s-\lambda_l)^{m_l}
$$
$\mu_i$：$\lambda_i$的代数重数，$\sum\limits_{i=1}^p\mu_i=n$ 

*特征向量*：
$$
\lambda_i\rightarrow \boldsymbol A \boldsymbol q_{i,1/2/\cdots/n_i}=\lambda_i\boldsymbol q_{i,1/2/\cdots/n_i}
$$
从每个特征向量出发，求取$m_i-1$个增广特征向量

*增广特征向量*：
$$
\begin{align}
\pmb A\pmb q_{j}^{(1)}&=\lambda_j\pmb q_{j}^{(1)}\\
\pmb {Aq}_{j}^{(2)}&=\lambda_j\pmb q_{j}^{(2)}+\pmb q_{j}^{(1)}\\
\cdots\\
\pmb{Aq}_{j}^{(i)}&=\lambda_j\pmb q_{j}^{(i)}+\pmb q_{j}^{(i-1)}
\end{align}
$$
由此得到$n_i$组增广特征向量串
$$
\boldsymbol q_{i,1}^{(m_{i,1})}\rightarrow\boldsymbol q_{i,1}^{(m_{i,1}-1)}\rightarrow\cdots\rightarrow\boldsymbol q_{i,1}^{(1)}\Rightarrow m_{i,1}阶约当块\boldsymbol J_{i,1}\\

\boldsymbol q_{i,2}^{(m_{i,2})}\rightarrow\boldsymbol q_{i,2}^{(m_{i,2}-1)}\rightarrow\cdots\rightarrow\boldsymbol q_{i,2}^{(1)}\Rightarrow m_{i,2}阶约当块\boldsymbol J_{i,2}\\

\vdots\\

\boldsymbol q_{i,n_i}^{(m_{i,n_i})}\rightarrow\boldsymbol q_{i,n_i}^{(m_{i,n_i}-1)}\rightarrow\cdots\rightarrow\boldsymbol q_{i,n_i}^{(1)}\Rightarrow m_{i,n_i}阶约当块\boldsymbol J_{i,n_i}\\
$$
*变换矩阵*：
$$
\boldsymbol Q=\begin{bmatrix}\boldsymbol Q_!&\boldsymbol Q_2 &\cdots&\boldsymbol Q_l\end{bmatrix}
$$
其中，
$$
\boldsymbol Q_i=\begin{bmatrix}\boldsymbol q_{i,1}^{(1)}&\cdots&\boldsymbol q_{i,1}^{(m_{i,1})}&\cdots&\boldsymbol q_{i,n_i}^{(1)}&\cdots& \boldsymbol q_{1,n_i}^{(m_{i,n_i})} \end{bmatrix}
$$
*标准型*：
$$
\boldsymbol Q^{-1}\boldsymbol A\boldsymbol Q=\boldsymbol J=\begin{bmatrix}\boldsymbol J_1\\&\ddots\\&&\boldsymbol J_l\end{bmatrix}
$$
其中，
$$
\boldsymbol J_i=\begin{bmatrix}\boldsymbol J_{i,1}\\&\ddots\\&&\boldsymbol J_{i,n_i} \end{bmatrix}
$$
而
$$
\boldsymbol J_i=\begin{bmatrix}\lambda_i&1\\ &\lambda_i&1\\&&\lambda_i&\ddots\\&&&\ddots&\ddots\\&&&&\lambda_i\end{bmatrix}_{m_i\times m_i}
$$
其实就是把每个特征值对应的线性无关特征向量先算出来，对有重数的特征值对应的特征向量算约尔当链，将每一个特征值对应的若尔当链先凑起来成为$\pmb Q_i$，再把所有的$\pmb Q_i$凑成变换矩阵$\pmb Q$ 

**<span id='模式规范化'>模式规范化</span>** 

针对于具有复特征值的情况，实方阵的非实复特征值以共轭形式成对出现，相应的特征向量也是共轭的

设$n$阶方阵$\pmb A$有特征值$\sigma\pm j\omega$，对应的特征向量为$\pmb u\pm j\pmb v$

将对角化变换矩阵$\boldsymbol Q$中的共轭非实复特征值$\lambda=\sigma+j\omega$和$\overline{\lambda}=\sigma-j\omega$对应的共轭非实复特征向量$\boldsymbol q=\boldsymbol u+j \boldsymbol v$和$\overline{\boldsymbol q}=\boldsymbol u-j\boldsymbol v$分别用实向量$\boldsymbol u$和$\boldsymbol v$取代

变换后结果为：
$$
\begin{bmatrix}
\sigma+j\omega &0\\
0&\sigma-j\omega
\end{bmatrix}
\Rightarrow
\begin{bmatrix}
\sigma&\omega\\
-\omega&\sigma
\end{bmatrix}
$$
**其他情况**

基本可以通过模式规范化和若尔当标准型一般形式进行转换

### 1.3. 线性变换结构和线性代数方程组

#### 1.3.1. 线性变换结构

**值域空间(象空间)**

$m\times n$矩阵$\pmb A$表示线性变换$\R^n\rightarrow\R^m$
$$
R(\pmb A)\mathop=\limits^{def}\{\pmb y\in \R^m:\pmb y=\pmb{Ax},\forall \pmb x\in \R^n\}
$$
*性质：*

1. $R(\pmb A)=\mathrm{span}(\pmb A)$
2. $R(\pmb A)$为$\R^n$的子空间，由$\pmb A$的各个列向量张成，故$R(\pmb A)$又称$\pmb A$的列空间
3. $\dim R(\pmb A)=\mathrm{rank}(\pmb A)\mathop{=}\limits^{def}\rho(\pmb A)\leq \min(n,m)$ 
	* 当$\rho(\pmb A)=\min(n,m)$时，$\pmb A$为满秩矩阵
	* 若$m=n$，满秩矩阵即为可逆矩阵或非奇异矩阵
4. $R(\pmb A)=R(\pmb {AA}^T)$
5. $\rho(\pmb A)=\rho(\pmb {AA}^T)$

**化零空间**
$$
N(\pmb A)\mathop=\limits^{def}\{\pmb x\in \R^n:\pmb {Ax}=\pmb 0\}
$$
*性质*：

1. $N(\pmb A)$为$\R^n$的子空间，由与$\pmb A$的各个行向量正交的向量$\pmb x$张成，又称零空间
2. $N(\pmb A)=[\mathrm {span}(\pmb A)^T]^{\perp}=R(\pmb A^T)^\perp$ 
3. $\R^n=R(\pmb A^T)\oplus N(\pmb A)$ ；$\R^m=R(\pmb A)\oplus N(\pmb A^T)$ 
4. 零度$\nu(\pmb A)=\dim N(\pmb A)$
5. $\rho(\pmb A^T)+\nu(\pmb A)=\rho(\pmb A)+\nu(\pmb A)=n$
6. $N(\pmb A)=N(\pmb A^T\pmb A)$
7. $\nu(\pmb A)=\nu(\pmb A^T\pmb A)$ 

#### 1.3.2. 线性代数方程组

$$
\pmb{Ax}=\pmb b,\pmb x\in\R^n,\pmb b\in \R^m
$$

1. 方程组有解的充要条件
	$$
	\pmb b\in R(\pmb A)=R(\pmb {AA^T})
	$$
	或
	$$
	\pmb b\perp N(\pmb A^T)=N(\pmb {AA}^T)\\
	\rho(\pmb A)=\rho(\pmb A|\pmb b)
	$$

2. 方程组具有最多一个解的充要条件是
	$$
	N(\pmb A)=N(\pmb A^T\pmb A)=\{\pmb 0\}
	$$
	或
	$$
	\rho(\pmb A)=n
	$$
	否则，若$\pmb x$为一个解，则对任何$\hat{\pmb x}\in N(\pmb A)$，$\pmb x+\hat{\pmb x}$也为其解

3. 方程组对每一个$\pmb b\in \R^m$有解的充要条件为
	$$
	R(\pmb A)=R(\pmb{AA}^T)=\R^m
	$$
	或
	$$
	\rho(\pmb A)=m
	$$

4. 方程组对每一个$\pmb b\in \R^m$有唯一解的充要条件为
	$$
	\pmb x=\pmb A^{-1}\pmb b
	$$

### 1.3. 矩阵指数

#### 1.3.1. <span id='矩阵指数'>矩阵指数的定义</span>

对方阵$\pmb A$，矩阵指数定义为：
$$
e^{\pmb A t}=\sum\limits_{k=0}^{\infty} \pmb A^kt^k=\pmb I+\pmb A t+\frac{1}{2!}\pmb A^2t^2+\frac{1}{3!}\pmb A^3t^3+\cdots
$$

#### 1.3.2. <span id='矩阵指数的求取'>计算方法</span> 

**直接计算法**

1. 若矩阵$\boldsymbol A$呈对角线形，即：$\boldsymbol A=\mathrm{diag}(a_1,a_2,\cdots,a_m)$则
	$$
	e^{\boldsymbol A t}=\mathrm{diag}(e^{a_1t},e^{a_2t},\cdots,e^{a_mt})
	$$

2. 若矩阵$\boldsymbol A$呈对角块形，即：$\boldsymbol A=\mathrm{Diag}(\boldsymbol A_1,\boldsymbol A_2,\cdots,\boldsymbol A_m)$则
	$$
	e^{\boldsymbol At}=\mathrm{Diag}(e^{\boldsymbol A_1t},e^{\boldsymbol A_2t},\cdots,e^{\boldsymbol A_mt})
	$$

**拉氏变换法**
$$
e^{\pmb At}=\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]
$$
**标准型法**
$$
e^{\pmb At}=\pmb Qe^{\pmb Q^{-1}\pmb{AQ}}\pmb Q^{-1}=\pmb Qe^{\pmb \Lambda t}\pmb Q^{-1}
$$
当矩阵$\pmb A $有$n $个互不相关的特征向量时，可以通过相似变换将$\pmb A $变换为对角线形

**待定系数法**

凯利-哈密顿定理：方阵满足自身的特征方程

对$n\times n$的方阵$\pmb A$，设其特征多项式为：
$$
f(\lambda)=|\lambda\pmb I-\pmb A|=\lambda^n+a_{n-1}\lambda^{n-1}+\cdots+a_1\lambda+a_0
$$
则凯利-哈密顿定理保证如下矩阵方程成立：
$$
f(\pmb A)=a_0\pmb I+a_1\pmb A+a_2\pmb A^2+\cdots+a_{n-1}\pmb A^{n-1}+\pmb A^n=\pmb 0
$$
为求解矩阵指数$e^{\pmb At}$，先求解特征方程$f(\lambda)=0$得到特征值$\lambda_1,\lambda_2,\cdots,\lambda_n$

设$g(\lambda)=\alpha_0+\alpha_1\lambda+\alpha_2\lambda^2+\cdots+\alpha_{n-1}\lambda^{n-1}$ ，$h(\lambda)=e^{\lambda t}$，其中$\alpha_i=\alpha_i(t),i=1,2,\cdots,n$  

解方程组
$$
g(\lambda_i)=f(\lambda_i),i=1,2,\cdots,n
$$
求得参变量$\alpha_i=\alpha_i(t),i=1,2,\cdots,n$ ，可求得矩阵指数：
$$
e^{\pmb At}=\sum\limits_{k=1}^{k=n}\alpha_{k-1}\pmb A^{k-1}
$$

#### 1.3.3. 常用标准型对应的矩阵指数

**系统矩阵为对角线矩阵**

系统矩阵：
$$
\boldsymbol A=\mathrm{diag}(\lambda_1,\lambda_2,\cdots,\lambda_n)
$$
矩阵指数：
$$
e^{\boldsymbol At}=\mathrm{diag}(e^{\lambda_1t},e^{\lambda_2t},\cdots,e^{\lambda_nt})
$$
**系统矩阵为对角分块矩阵**

系统矩阵：
$$
\boldsymbol A=\mathrm{diag}(\boldsymbol A_1,\boldsymbol A_2,\cdots,\boldsymbol A_l)
$$
矩阵指数：
$$
e^{\boldsymbol At}=\mathrm{diag}(e^{\boldsymbol A_1t},e^{\boldsymbol A_2t},\cdots,e^{\boldsymbol A_lt})
$$
**特殊类型系统矩阵(1)**

系统矩阵：
$$
\boldsymbol A=\begin{bmatrix}
0&1\\
&0&1&&\boldsymbol 0\\
&&0&1\\
&&&0&\ddots\\&\boldsymbol 0&&&\ddots&1\\&&&&&0\end{bmatrix}
$$
$\boldsymbol A$仅右上方次对角线上的元素为1，其余元素为零

矩阵指数：
$$
e^{\boldsymbol At}=\begin{bmatrix}
1&t&\frac{t^2}{2!}&\frac{t^3}{3!}&\cdots&\frac{t^{n-1}}{(n-1)!}\\
&1&t&\frac{t^2}{2!}&\cdots&\frac{t^{n-1}}{(n-1)!}\\
&&1&t&&\vdots\\
&&&1&\ddots&\frac{t^2}{2!}\\
\boldsymbol 0&&&&\ddots&t\\
&&&&&1
\end{bmatrix}
$$
**特殊类型系统矩阵(2)**

系统矩阵：
$$
\boldsymbol A=\begin{bmatrix}\lambda&1\\&\lambda&1&&\boldsymbol 0\\&&\lambda&1\\&&&\lambda&\ddots\\&\boldsymbol 0&&&\ddots&1\\&&&&&\lambda\end{bmatrix}
$$
可以分解为以下形式：
$$
\boldsymbol A=\begin{bmatrix}0&1\\&0&1&&\boldsymbol 0\\&&0&1\\&&&0&\ddots\\&\boldsymbol 0&&&\ddots&1\\&&&&&0\end{bmatrix}+\begin{bmatrix}\lambda&\\&\lambda&&&\boldsymbol 0\\&&\lambda&\\&&&\lambda&\ddots\\&\boldsymbol 0&&&\ddots&\\&&&&&\lambda\end{bmatrix}
$$
矩阵指数：
$$
e^{\boldsymbol At}=\begin{bmatrix}
e^{\lambda t}&te^{\lambda t}&\frac{t^2}{2!}e^{\lambda t}&\frac{t^3}{3!}e^{\lambda t}&\cdots&\frac{t^{n-1}}{(n-1)!}e^{\lambda t}\\
&e^{\lambda t}&te^{\lambda t}&\frac{t^2}{2!}e^{\lambda t}&\cdots&\frac{t^{n-1}}{(n-1)!}e^{\lambda t}\\
&&e^{\lambda t}&te^{\lambda t}&&\vdots\\
&&&e^{\lambda t}&\ddots&\frac{t^2}{2!}e^{\lambda t}\\
\boldsymbol 0&&&&\ddots&te^{\lambda t}\\
&&&&&e^{\lambda t}
\end{bmatrix}
$$
**特殊类型系统矩阵(3)**

系统矩阵：
$$
\boldsymbol A=\begin{bmatrix}0&\omega\\-\omega&0\end{bmatrix}
$$
矩阵指数：
$$
e^{\boldsymbol A}=\begin{bmatrix}\cos\omega t&\sin\omega t\\-\sin\omega t&\cos\omega t\end{bmatrix}
$$
**特殊类型系统矩阵(4)**

系统矩阵：
$$
\boldsymbol A=\begin{bmatrix}\sigma&\omega\\-\omega&\sigma\end{bmatrix}
$$
矩阵指数：
$$
e^{\boldsymbol A}=\begin{bmatrix}e^{\sigma t}\cos\omega t&e^{\sigma t}\sin\omega t\\-e^{\sigma t}\sin\omega t&e^{\sigma t}\cos\omega t\end{bmatrix}
$$

### 1.4. 时间函数的线性关系

#### 1.4.1. 一组时间函数的线性相关与无关

假设$f_1(t),f_2(t),\cdots,f_n(t)$是一组复值函数，倘若在复数域$\pmb C$中存在一组不全为零的复数$\alpha_1,\alpha_2,\cdots,\alpha_n$使得
$$
\sum\limits_{i=1}^n\alpha_if_i(t)=0,\ \ \ \ \forall t\in[t_1,t_2]
$$
则称这组复值函数在区间$[t_1,t_2]$内线性相关，否则它们在$[t_1,t_2]$内线性无关。同理可推广到复值函数向量，令$\pmb f_i(t)$，$i=1,2,\cdots,n$是一组$p$维复值行向量，如果在复数域$\pmb C$中存在一组不全为零的复数$\alpha_1,\alpha_2,\cdots,\alpha_n$使得
$$
\sum\limits_{i=1}^n\alpha_i\pmb f_i(t)=\pmb {\alpha F}(t)=\pmb0,\ \ \ \ \forall t\in[t_1,t_2]
$$
其中，$\pmb \alpha=\begin{bmatrix}\alpha_1&\alpha_2&\cdots&\alpha_n\end{bmatrix}$为$n$维向量，$\pmb F(t)=\begin{bmatrix}\pmb f_1^T(t)&f_2^T(t)&\cdots&f_n^T(t)\end{bmatrix}^T$为$n\times p$矩阵

就称这组时间函数复值向量在区间$[t_1,t_2]$内线性相关，否则线性无关

#### 1.4.2. 时间函数线性无关的判定方法

**格拉姆矩阵判定法**

令$\pmb f_i(t)$，$i=1,2,\cdots,n$是定义在$[t_1,t_2]$内的$p$维连续复值函数行向量，$\pmb F(t)$是以它们为行构成的$n\times p$矩阵，规定$\pmb F(t)$的格拉姆矩阵如下：
$$
\pmb W(t_1,t_2)\mathop=\limits^{def}\int_{t_1}^{t_2}\pmb F(t)\pmb F^*(t)\mathrm dt
$$
则这组复值函数行向量线性无关的充要条件是常值矩阵$\pmb W(t_1,t_2)$非奇异

*证明:*

必要性

假设这组函数行向量在$[t_1,t_2]$内线性无关，但$\pmb W(t_1,t_2)$奇异，因此存在一个非零$n$维行向量$\pmb \alpha$使得$\pmb \alpha\pmb W(t_1,t_2)=\pmb 0$，也就有
$$
\begin{align}
\pmb {\alpha W}(t_1,t_2)\pmb \alpha^*&=\int_{t_1}^{t_2}\pmb {\alpha F}(t)[\pmb {\alpha F}(t)]^*\mathrm dt\\
&=\int_{t_1}^{t_2}\|\pmb {\alpha F}(t)\|^2\mathrm dt=0
\end{align}
$$
函数向量的连续性保证了$\pmb F(t)$的连续性，$\|\pmb {\alpha F}(t)\|^2$是非负的数，上式意味着
$$
\pmb {\alpha F}(t)=\pmb 0,\ \ \ \ \forall t\in[t_1,t_2]
$$
这与$n$个函数行向量在区间$[t_1,t_2]$内线性无关矛盾，所以必要性成立

充分性

假设$\pmb W(t_1,t_2)$非奇异但$n$个函数行向量线性相关，那么存在一个非零$n$维行向量$\pmb \alpha$使得$\pmb {\alpha F}(t)=\pmb 0$，$\forall t\in[t_1,t_2]$，于是
$$
\pmb {\alpha W}(t_1,t_2)=\int_{t_1}^{t_2}\pmb {\alpha F}(t)\pmb F^*(t)\mathrm dt=\pmb 0
$$
即$\pmb W(t_1,t_2)$奇异，与假设矛盾，所以充分性成立

**导数矩阵判定法(充分条件)**

假设$n$个$p$维复值函数行向量$\pmb f_1(t)$，$\pmb f_2(t)$，$\cdots$，$\pmb f_n(t)$在区间$[t_1,t_2]$内具有直到$n-1$阶的连续导数，$\pmb F(t)$是以它们为行构成的$n\times p$矩阵，以$\pmb F^{(k)}(t)$表示$\pmb F(t)$的$k$阶导数。倘若在区间$[t_1,t_2]$内存在某一个时刻$t'$，使得矩阵
$$
\begin{bmatrix}
\pmb F(t')&\pmb F^{(1)}(t')&\pmb F^{(2)}(t')&\cdots&\pmb F^{(n-1)}(t')
\end{bmatrix}
$$
的秩为$n$,则$\pmb f_1(t)$，$\pmb f_2(t)$，$\cdots$，$\pmb f_n(t)$在区间$[t_1,t_2]$内线性无关

*证明：*

反证法证明，假设确有$t'\in [t_1,t_2]$使得
$$
\rho \begin{bmatrix}
\pmb F(t')&\pmb F^{(1)}(t')&\pmb F^{(2)}(t')&\cdots&\pmb F^{(n-1)}(t')
\end{bmatrix}=n
$$
但函数向量$\pmb f_1,\pmb f_2,\cdots,\pmb f_n$在$[t_1,t_2]$内线性相关，这表明存在一个非零行向量$\pmb \alpha$使得
$$
\pmb {\alpha F}(t)=\pmb 0,\ \ \ \ \forall t\in[t_1,t_2]
$$
因而
$$
\pmb {\alpha F}^{(k)}(t)=\pmb 0,\ \ \ \ k=1,2,\cdots,n-1,\ \ \ \ \forall t\in [t_1,t_2]\\
\pmb \alpha \begin{bmatrix}
\pmb F(t')&\pmb F^{(1)}(t)&\pmb F^{(2)}(t)&\cdots&\pmb F^{(n-1)}(t)
\end{bmatrix}=\pmb 0,\ \ \ \ \forall t\in[t_1,t_2]
$$
当然对于$t'\in[t_1,t_2]$有
$$
\pmb \alpha \begin{bmatrix}
\pmb F(t')&\pmb F^{(1)}(t')&\pmb F^{(2)}(t')&\cdots&\pmb F^{(n-1)}(t')
\end{bmatrix}=n
$$
这与$\rho \begin{bmatrix}
\pmb F(t')&\pmb F^{(1)}(t')&\pmb F^{(2)}(t')&\cdots&\pmb F^{(n-1)}(t')
\end{bmatrix}=n$ 相矛盾，所以这组函数向量组线性无关

**解析函数的线性无关(充要条件)**

假设$n$个$p$维复值函数行向量$\pmb f_1(t)$，$\pmb f_2(t)$，$\cdots$，$\pmb f_n(t)$在区间$[t_1,t_2]$内解析，$\pmb F(t)$是以它们为行构成的$n\times p$矩阵，以$\pmb F^{(k)}(t)$表示$\pmb F(t)$的$k$阶导数。则这组解析函数向量线性无关的充要条件是
$$
\rho\begin{bmatrix}
\pmb F(t')&\pmb F^{(1)}(t')&\pmb F^{(2)}(t')&\cdots&\pmb F^{(n-1)}(t')
\end{bmatrix}=n,\ \ \ \ \forall t'\in[t_1,t_2]
$$

## 2. 系统的状态空间模型

### 2.1. 状态与状态空间的概念

#### 2.1.1. 基本概念

**输入**

作用于系统的所有（外界）激励统称为系统的输入

**输出**

可以量测的、能表征系统行为的响应统称为系统的输出

**状态**

动态系统的状态可定义为一组信息的集合。在已知未来外部输入的情况下，这些信息对于确定系统未来的行为是充分的。可以理解为状态空间的一组基，减少其中的一个变量就会破坏它们对系统行为表征的完全性，而增加一个变量将不增加行为表征的信息量

**状态变量**

用于确定动态系统状态的一组变量称作状态变量

**状态向量**

$n$个状态变量依次用$ x_1(t)，x_2(t), \cdots , x_n(t) $表 示，再把这些状态变量看作是向量$ x(t) $的分量，则x(t) 就称为状态向量，记作
$$
\boldsymbol{x}(t)=\begin{bmatrix}x_1(t)\\x_2(t)\\ \vdots \\x_n(t) \end{bmatrix}
$$
**状态空间**

以状态变量用$x_1(t)，x_2(t), \cdots , x_n(t)$为坐标轴所为基张成的$n$维空间，称为状态空间。在特定的时刻$t$，状态向量$x(t)$在状态空间中是一点  

**状态轨线**

随着时间的推移，$x(t)$在状态空间中描绘出一条轨迹，称为状态轨线  

#### 2.1.2. 状态空间描述

**状态方程**
$$
\begin{matrix}
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u,t)&\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B\boldsymbol u
\end{matrix}
$$
**输出方程**
$$
\begin{matrix}
\boldsymbol y=\boldsymbol g(\boldsymbol x,\boldsymbol u,t)&\boldsymbol y=\boldsymbol C\boldsymbol x+\boldsymbol D\boldsymbol u
\end{matrix}
$$
**状态空间方程**

1. 一般形式
	$$
	\begin{cases}
	\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u,t)\\
	\boldsymbol y=\boldsymbol g(\boldsymbol x,\boldsymbol u,t)
	\end{cases}
	$$

2. 线性定常系统
	$$
	\begin{cases}
	\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B\boldsymbol u\\
	\boldsymbol y=\boldsymbol C\boldsymbol x+\boldsymbol D\boldsymbol u
	\end{cases}
	$$

#### 2.1.3. 连续时间线性系统

**连续时间线性系统状态空间方程的系数矩阵**
$$
\begin{matrix}
\begin{matrix}
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A(t)\boldsymbol x+\boldsymbol B(t) \boldsymbol u\\
\boldsymbol y=\boldsymbol C(t) \boldsymbol x+\boldsymbol D(t) \boldsymbol u
\end{cases}\\
\dim \boldsymbol x=n\\
\dim \boldsymbol u=p\\
\dim \boldsymbol y=q
\end{matrix}&&&&
\begin{align}
\boldsymbol A&=(a_{ij})_{n\times n}——系统矩阵（状态矩阵）\\
\boldsymbol B&=(b_{ij})_{n\times p}——控制矩阵（输入矩阵）\\
\boldsymbol C&=(c_{ij})_{q\times n}——观测矩阵（输出矩阵）\\
\boldsymbol D&=(d_{ij})_{q\times p}——输入-输出矩阵
\end{align}
\end{matrix}
$$
**叠加原理**

系统被称作为线性系统是指对每一个及任意两个状态-输入－输出组：
$$
\left.\begin{align}
&\boldsymbol x_i(t_0)\\
&\boldsymbol u_i(t),\ t\geq t_0
\end{align}\right\}
\rightarrow 
y_i(t),\ t\geq t_0\ \ \ \ i=1,2
$$
一定有（$\alpha$为任意实常数）：

1. 可加性
	$$
	\left.\begin{align}
	&\boldsymbol x_1(t_0)+\boldsymbol x_2(t_0)\\
	&\boldsymbol u_1(t)+\boldsymbol u_2(t),\ t\geq t_0
	\end{align}\right\}
	\rightarrow 
	y_1(t)+y_2(t),\ t\geq t_0
	$$

2. 均匀性
	$$
	\left.\begin{align}
	&\alpha \boldsymbol x_i(t_0)\\
	&\alpha\boldsymbol u_i(t),\ t\geq t_0
	\end{align}\right\}
	\rightarrow 
	\alpha y_i(t),\ t\geq t_0,\ \ \ \ i=1,2
	$$

3. 叠加性=可加性+均匀性
	$$
	\left.\begin{align}
	\alpha_1&\boldsymbol x_1(t_0)+\alpha_2\boldsymbol x_2(t_0)\\
	&\alpha_1\boldsymbol u_1(t)+\alpha_2\boldsymbol u_2(t),\ t\geq t_0
	\end{align}\right\}
	\rightarrow 
	\alpha_1y_1(t)+\alpha_2y_2(t),\ t\geq t_0
	$$

根据可加性，线性系统响应=零输入响应+零状态响应
$$
\begin{cases}
\pmb x(t_0)\\
\pmb u(t),t\geq t_0
\end{cases}
的输出=
\begin{cases}
\pmb x(t_0)\\
\pmb u(t)\equiv 0,t\geq t_0
\end{cases}
的输出+
\begin{cases}
\pmb x(t_0)=0\\
\pmb u(t),t\geq t_0
\end{cases}
的输出
$$
**系统结构图**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105253116.png)  

传递函数矩阵为：
$$
\pmb G(s)=\pmb C(s\pmb I-\pmb A)^{-1}\pmb B+\pmb D
$$
**连续时间线性系统的输入—输出描述**

1. 脉冲输入响应

	![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105544659.png)

2. 齐次性

	![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105603952.png)

3. 可加性

	![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105703592.png)

4. 极限

	![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200302105717060.png)

5. 脉冲响应
	$$
	y(t)=\int_{-\infty}^{+\infty}g(t,\tau)u(\tau)\mathrm d\tau
	$$

	* 因果
		$$
		因果的\Leftrightarrow g(t,\tau)=0\ \ \ \ \forall t<\tau
		$$

	* 系统在$t_0$时刻松弛
		$$
		\begin{matrix}
		y(t)=\int_{t_0}^tg(t,\tau)u(\tau)d\tau&
		\boldsymbol y(t)=\int^t_{t_0}\boldsymbol G(t,\tau)\boldsymbol u(\tau)d\tau
		\end{matrix}
		$$

#### 2.1.4. 离散时间系统

**状态空间描述**
$$
\begin{align}
\boldsymbol x[k+1]&=\boldsymbol F\boldsymbol x[k]+\boldsymbol H \boldsymbol u[k]\\
\boldsymbol y[k]&=\boldsymbol C\boldsymbol x[k]+\boldsymbol D \boldsymbol u[k]
\end{align}
$$
**传递函数矩阵**
$$
\pmb G(z)=\pmb C(z\pmb I-\pmb F)^{-1}\pmb H+\pmb D
$$
**连续系统离散化**
$$
\pmb u[k]:=\pmb u(kT)\\
\pmb y[k]:=\pmb y(kT)
$$

#### 2.1.5. 分布系统与非线性系统

**集总系统**

集总系统的状态是有限维向量

**分布系统**

分布系统具有无限多个状态变量

**非线性系统**

不满足叠加原理的系统即为非线性系统

集总的非线性系统的状态空间方程一般只能写作：
$$
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u,t)\\
\boldsymbol y=\boldsymbol g(\boldsymbol x, \boldsymbol u,t)
$$
状态方程及输出方程不显含时间$t$又称为自治系统，如：
$$
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u)\\
\boldsymbol y=\boldsymbol g(\boldsymbol x, \boldsymbol u)
$$

### 2.2. 状态空间方程的建立方法

#### 2.2.1. 从系统的机理出发

**步骤：**

1. 寻找合适的最大线性无关组，作为系统的状态变量
2. 列写微分方程/差分方程
3. 转为矩阵表达形式

#### 2.2.2. 从传递函数求状态空间方程

见**传递函数的状态空间实现**一节

#### 2.2.3. 由动态结构图求状态空间方程

**步骤：**

1. 选择各个积分器输出为状态变量
2. 求解各个状态变量之间、状态变量与输入输出变量之间的关系式
3. 整理为矩阵形式

#### 2.2.4. 系统互连状态方程

设有两个互连线性子系统
$$
S_1:\begin{cases}
\dot{\pmb x}_1=\pmb A_1\pmb x_1+\pmb B_1\pmb u_1\\
\pmb y_1=\pmb C_1\pmb x_1+\pmb D_1\pmb u_1
\end{cases}\\
S_2:\begin{cases}
\dot{\pmb x}_2=\pmb A_2\pmb x_2+\pmb B_2\pmb u_2\\
\pmb y_2=\pmb C_2\pmb x_2+\pmb D_2\pmb u_2
\end{cases}
$$
总系统状态表示为：
$$
\pmb x=\begin{bmatrix}\pmb x_1\\ \pmb x_2\end{bmatrix}
$$
**串联**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200309101406894.png)

连接关系：
$$
\begin{cases}
\pmb u_1=\pmb u\\
\pmb u_2=\pmb y_1=\pmb C_1\pmb x_1+\pmb D_1\pmb u\\
\pmb y=\pmb y_2
\end{cases}
$$
状态空间方程：
$$
\begin{align}
\dot{\pmb x}&=\begin{bmatrix}
\pmb A_1&\pmb 0\\ \pmb B_2\pmb C_1&\pmb A_2
\end{bmatrix}\pmb x+\begin{bmatrix}\pmb B_1\\ \pmb B_2\pmb D_1\end{bmatrix}\pmb u\\
\pmb y&=\begin{bmatrix}\pmb D_1\pmb C_1& \pmb C_2\end{bmatrix}\pmb x+\pmb D_2\pmb D_1 \pmb u
\end{align}
$$
**分流**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200309125930193.png)

连接关系：
$$
\begin{cases}
\pmb u_1=\pmb u\\
\pmb u_2=\pmb u\\
\pmb y=\begin{bmatrix}\pmb y_1\\ \pmb y_2\end{bmatrix}
\end{cases}
$$
状态空间方程：
$$
\begin{align}
\dot{\pmb x}&=\begin{bmatrix}
\pmb A_1&\pmb 0\\ \pmb 0&\pmb A_2
\end{bmatrix}\pmb x+\begin{bmatrix}\pmb B_1\\ \pmb B_2\end{bmatrix}\pmb u\\
\pmb y&=\begin{bmatrix}\pmb C_1&\pmb 0\\ \pmb 0&\pmb C_2\end{bmatrix}\pmb x+\begin{bmatrix}\pmb D_1\\ \pmb D_2\end{bmatrix} \pmb u
\end{align}
$$
**并联**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200309130031220.png)

连接关系：
$$
\begin{cases}
\pmb u_1=\pmb u\\
\pmb u_2=\pmb u\\
\pmb y=\pmb y_1+\pmb y_2
\end{cases}
$$
状态空间方程：
$$
\begin{align}
\dot{\pmb x}&=\begin{bmatrix}
\pmb A_1&\pmb 0\\ \pmb 0&\pmb A_2
\end{bmatrix}\pmb x+\begin{bmatrix}\pmb B_1\\ \pmb B_2\end{bmatrix}\pmb u\\
\pmb y&=\begin{bmatrix}\pmb C_1&\pmb C_2\end{bmatrix}\pmb x+(\pmb D_1+\pmb D_2) \pmb u
\end{align}
$$
**反馈**

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B.assets/image-20200309130219788.png)

连接关系：
$$
\begin{cases}
\pmb u_1=\pmb u-\pmb y_2=\pmb u-\pmb C_2\pmb x_2-\pmb D_2\pmb u_2\\
\pmb u_2=\pmb y_1=\pmb C_1\pmb x_1+\pmb D_1\pmb u_1\\
\pmb y=\pmb y_1
\end{cases}
$$
状态空间方程：
$$
\begin{cases}
\dot{\pmb x}=\begin{bmatrix}\pmb A_1-\pmb B_1\pmb \Delta \pmb D_2\pmb C_1&-\pmb B_1\pmb \Delta \pmb C_2\\
\pmb B_2(\pmb C_1-\pmb D_1\pmb \Delta \pmb D_2\pmb C_1)&\pmb A_2-\pmb B_2\pmb D_1\pmb \Delta \pmb C_2
\end{bmatrix}\pmb x+\begin{bmatrix}\pmb B_1\pmb \Delta\\ \pmb B_2\pmb D_1\pmb \Delta\end{bmatrix}\pmb u\\
\pmb y=\begin{bmatrix}\pmb C_1-\pmb D_1\pmb \Delta \pmb D_2\pmb C_1&\pmb D_1\pmb \Delta \pmb C_2\end{bmatrix}\pmb x+(\pmb D_1\pmb \Delta )\pmb u
\end{cases}
$$
其中，$\pmb \Delta=(\pmb I-\pmb D_2\pmb D_1)^{-1}$

### 2.3. 状态空间的线性变换

#### 2.3.1. 坐标变换对状态空间方程的影响

$$
\begin{align}
\begin{matrix}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+\boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x + \boldsymbol D \boldsymbol u
\end{matrix}
\xrightarrow[\overline{\boldsymbol x}=\boldsymbol P \boldsymbol x=\boldsymbol Q^{-1} \boldsymbol x]{\boldsymbol x= \boldsymbol Q \overline{\boldsymbol x}}
\begin{matrix}
\dot{\overline{\boldsymbol x}}=\overline{\boldsymbol A} \overline{\boldsymbol x}+\overline{\boldsymbol B} \overline{\boldsymbol u}\\
\boldsymbol y=\overline{\boldsymbol C} \overline{\boldsymbol x} + \overline{\boldsymbol D} \overline{\boldsymbol u}
\end{matrix}


\end{align}
$$

$$
\boldsymbol Q \dot{\overline{\boldsymbol x}}=\boldsymbol A \boldsymbol Q \overline{\boldsymbol x}+\boldsymbol B \boldsymbol u\\
\dot{\overline{\boldsymbol x}}=\boldsymbol Q^{-1} \boldsymbol A \boldsymbol Q \overline{\boldsymbol x}+\boldsymbol Q^{-1}\boldsymbol B \boldsymbol u
$$

$$
\begin{matrix}
\overline{\boldsymbol A}=\boldsymbol Q^{-1}\boldsymbol A \boldsymbol Q & \overline{\boldsymbol B}=\boldsymbol Q^{-1}\boldsymbol B\\
\overline{\boldsymbol C}=\boldsymbol C \boldsymbol Q & \overline{\boldsymbol D}=\boldsymbol D

\end{matrix}
$$

令$\pmb P=\pmb Q^{-1}$得
$$
\begin{matrix}
\overline{\boldsymbol A}=\boldsymbol P\boldsymbol A \boldsymbol P^{-1} & \overline{\boldsymbol B}=\boldsymbol P\boldsymbol B\\
\overline{\boldsymbol C}=\boldsymbol C \boldsymbol P^{-1} & \overline{\boldsymbol D}=\boldsymbol D

\end{matrix}
$$

#### 2.3.2. 矩阵的规范化

**对角规范化**

* [对角化](#对角化)
* [若尔当标准型](#若尔当)

**模式规范化**

* [针对复特征值的规范化](#模式规范化)

### 2.4. 作业复习

#### 2.4.1. 建模问题

**缓冲器模型：** $F=f\dot{x}$

**弹簧模型：** $F=kx$

**水槽排水模型：**

设断面积为$S$，水位高度为$x$，管道单位时间流出量为$y$，输入量$u$，管道阻力为$R$
$$
S\dot{x}=u-y=u-\frac{x}{R}
$$

#### 2.4.2. 由系统微分方程导出状态空间描述式

**法一：** 直接选取状态变量

*例：*
$$
\ddot{y}(t)+5\dot{y}(t)+6y(t)=u(t)
$$
直接取$x_1=y$和$x_2=\dot{y}$即可求解

**法二：** 拉普拉斯变换(输入函数存在导数)

*例：*
$$
\ddot{y}(t)+2\dot{y}(t)+y(t)=\dot{u}(t)+3u(t)
$$
做拉普拉斯变换：
$$
(s^2+2s+1)\hat{y}=(s+3)\hat u
$$
令$\hat v=\frac{1}{s^2+2s+1}\hat u$ ，取$v=\mathcal L^{-1}\hat v$，定义状态变量$x_1=v$和$x_2=\dot{v}$即可解决问题

**法三：** 利用动态结构图求状态空间方程

将微分方程转为动态结构图，选取积分器后为状态变量构造状态空间方程

## 3. 状态空间方程的解

### 3.1. 状态转移矩阵

#### 3.1.1. 状态转移矩阵的概念

对于时变线性系统的齐次状态方程
$$
\dot{\boldsymbol x}(t)=\boldsymbol A(t)\boldsymbol x(t),\ \ \boldsymbol x(t_0)=\boldsymbol x_0
$$
的解可写作
$$
\boldsymbol x(t,t_0)=\Phi(t,t_0)\boldsymbol x_0
$$
则称矩阵$\pmb \Phi(t,t_0)$为该系统的状态转移矩阵。对于线性定常系统，$t_0$总可移至零，即$\pmb \Phi(t,t_0)=\Phi(t-t_0,0)$，故又可记为$\pmb \Phi(t)$

#### 3.1.2. 状态转移矩阵的表达式

仅考虑线性定常系统

对方程
$$
\dot{\boldsymbol x}(t)=\boldsymbol A\boldsymbol x(t)
$$
做拉普拉斯变换，得到：
$$
s\hat{\boldsymbol x}(s)-\pmb x(0)=\boldsymbol A\hat{\boldsymbol x}(s)
$$
即：
$$
\hat{\pmb x}(s)=(s\pmb I-\pmb A)^{-1}\pmb x_0
$$
逆变换得到：
$$
\pmb x(t)=\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]\pmb x_0=\Phi(t)\pmb x_0
$$
得到状态转移矩阵的表达式：
$$
\phi(t)=\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]
$$
进一步，对于$\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]$ ，我们注意到标量系统：
$$
\mathcal L^{-1}[\frac{1}{s-a}]=e^{at}=\sum\limits_{k=0}^\infty \frac{1}{k!}(at)^k
$$
定义[矩阵指数](#矩阵指数)$e^{\pmb At}$ ，有$\pmb \Phi(t)=e^{\pmb At}$

#### 3.1.3. 状态转移矩阵的性质

1. $\pmb \Phi(t)=e^{\pmb At}=\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]$

2. $\pmb \Phi(0)=e^{\pmb A0}=\pmb I$

3. $\pmb \Phi(t)=\pmb A\Phi(t)=\Phi(t)\pmb A$ ，解释：$\frac{\mathrm d}{\mathrm dt}(e^{\pmb At})=\pmb Ae^{\pmb At}=e^{\pmb At}\pmb A$ 

4. $\pmb \Phi(t)\pmb \Phi(\tau)=\Phi(t+\tau)$ ，解释：$e^{\pmb At}e^{\pmb A\tau}=e^{\pmb A(t+\tau)}$ 

	推论：

	1. 状态转移矩阵是可逆阵，且总有

		​	$[\Phi(t)]^{-1}=\Phi(-t)$，解释：$[e^{\pmb At}]^{-1}=e^{-\pmb At}$

	2. 对一切整数$k$，总有

		​	$[\Phi(t)]^k=\Phi(kt)$，解释：$[e^{\pmb At}]^k=e^{\pmb Akt}$

5. $\pmb {AB}=\pmb {BA}\Leftrightarrow e^{\pmb At}e^{\pmb Bt}=e^{(\pmb A+\pmb B)t}$ 

	​	推论：对标量$\sigma$和方阵$\pmb B$，有$\pmb A=\sigma \pmb I+\pmb B$，则：$e^{\pmb At}=e^{\sigma t}e^{\pmb Bt}$

6. 对任一非奇异矩阵$\pmb P$有：
	$$
	e^{\pmb P^{-1}\pmb A\pmb P}=\pmb P^{-1}e^{\pmb At}\pmb P
	$$

#### 3.1.4. 状态转移矩阵的求取

详见[矩阵指数的计算方法](#矩阵指数的求取)

### 3.2. 模态与模态分解

考察齐次状态空间方程的解，以互不相同的特征值为例：
$$
\begin{align}
\boldsymbol x(t)&=e^{\boldsymbol At}\boldsymbol x_0=e^{(\boldsymbol Q \boldsymbol \Lambda \boldsymbol Q^{-1})t}\boldsymbol x_0=\boldsymbol Q e^{\boldsymbol \Lambda t}\boldsymbol Q^{-1}\boldsymbol x_0\\
&=\begin{bmatrix}\boldsymbol q_1&\boldsymbol q_2&\cdots&\boldsymbol q_n\end{bmatrix}
\begin{bmatrix}e^{\lambda_1 t}\\&e^{\lambda_2 t}\\&&\ddots\\&&& e^{\lambda_n t} \end{bmatrix}\begin{bmatrix}\boldsymbol p_1\\ \boldsymbol p_2\\ \vdots\\ \boldsymbol p_n\end{bmatrix}\boldsymbol x_0\\
&=\begin{bmatrix}e^{\lambda_1 t}\boldsymbol q_1&e^{\lambda_2 t}\boldsymbol q_2\cdots e^{\lambda_nt}\boldsymbol q_n \end{bmatrix}\begin{bmatrix}\boldsymbol p_1\boldsymbol x_0\\ \boldsymbol p_2\boldsymbol x_0\\ \vdots\\ \boldsymbol p_n \boldsymbol x_0 \end{bmatrix}\\
&=(\boldsymbol p_1 \boldsymbol x_0)e^{\lambda_1 t}\boldsymbol q_1+(\boldsymbol p_2 \boldsymbol x_0)e^{\lambda_2 t}\boldsymbol q_2+\cdots+(\boldsymbol p_n \boldsymbol x_0)e^{\lambda_n t}\boldsymbol q_n
\end{align}
$$
其中，$\boldsymbol p$为行向量，$\boldsymbol q$、$\boldsymbol x$为列向量，$\boldsymbol p\boldsymbol x$为标量

对于一个给定的线性定常系统，不论进行怎样的状态变换，系统矩阵$\pmb A$的特征值及其相应的特征向量是不会改变的。

由于$e^{\lambda_i t}$体现了系统的固有属性，一般将$e^{\lambda_i t},(i=1,2,\cdots,n)$称作系统的模态，或者称作振荡振型，简称振型。 也称将系统矩阵约当化的状态变换阵$Q$为该系统的模态矩阵，称该状态变换过程及结果为模态分解。

### 3.3. 状态空间方程的解

#### 3.3.1. 线性定常非齐次状态方程的解

状态方程：
$$
\begin{matrix}\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B \boldsymbol u&\boldsymbol x(0)=\boldsymbol x_0 \end{matrix}
$$
同时左乘$e^{-\boldsymbol A t}$并移项
$$
e^{-\boldsymbol A t}\dot{\boldsymbol x}-e^{-\boldsymbol A t}\boldsymbol A \boldsymbol x(t)=e^{-\boldsymbol A t}\boldsymbol B \boldsymbol u(t)
$$
此即
$$
\frac{\mathrm{d}}{\mathrm{d}t}(e^{-\boldsymbol A t}\boldsymbol x(t))=e^{-\boldsymbol A t}\boldsymbol B \boldsymbol u(t)
$$
对此式从0至$t$积分
$$
e^{-\boldsymbol At}\boldsymbol x(t)-e^0 \boldsymbol x(0)=\int^t_0 e^{-\boldsymbol A \tau}\boldsymbol B \boldsymbol u(\tau)d\tau
$$
移项，等式两边同左乘$e^{\boldsymbol A t}$
$$
\boldsymbol x(t)=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A(t-\tau)}\boldsymbol B \boldsymbol u(\tau)d\tau
$$
变量代换得
$$
\boldsymbol x(t)=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau
$$
当初始时刻非零时，从$t_0$积分到$t$，得
$$
\boldsymbol x(t)=e^{\boldsymbol A (t-t_0)}\boldsymbol x(t_0) +\int^t_{t_0} e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau
$$

第二项可以看成是卷积$l(t-t_0)e^{\pmb At}\ast\pmb B\pmb u(t)$ 

#### 3.3.2. 状态空间的解

状态方程：
$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+ \boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x+\boldsymbol D \boldsymbol u
\end{cases}
$$
初始条件：
$$
\boldsymbol x(0)=\boldsymbol x_0
$$
解得：
$$
\begin{align}
\boldsymbol x(t)&=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A(t-\tau)}\boldsymbol B\boldsymbol u(\tau)d\tau\\
&=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau\\
\boldsymbol y(t)&=\boldsymbol C e^{\boldsymbol At}\boldsymbol x_0+\boldsymbol C\int^t_0 e^{\boldsymbol A(t-\tau)}\boldsymbol B\boldsymbol u(\tau)d\tau+\boldsymbol D \boldsymbol u\\
&=\boldsymbol C e^{\boldsymbol A t}\boldsymbol x_0+\boldsymbol C\int ^t_0 e^{\boldsymbol A\tau}\boldsymbol B\boldsymbol u(t-\tau)d\tau+\boldsymbol D\boldsymbol u
\end{align}
$$

#### 3.3.3. 状态空间方程的离散化

$$
\begin{matrix}
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+ \boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x+\boldsymbol D \boldsymbol u
\end{cases}
&
\Rightarrow
&
\begin{cases}
\pmb x[k+1]=\pmb {Fx}[k]+\pmb {Hu}[k]\\
\pmb y[k]=\pmb C_d \pmb x[k]+\pmb D_d\pmb u[k]
\end{cases}
\end{matrix}
$$

设$\pmb u(t)$分段定常，且对所有的$k=0,1,2,\cdots$有
$$
\begin{matrix}
\pmb u(t)=\pmb u(kT):=\pmb u[k]&\forall kT\leq t\leq (k+1)T
\end{matrix}
$$
以$kT$为时间起点应用状态方程解公式，有：
$$
\pmb x((k+1)T)=e^{\pmb At}\pmb x(kT)+\int_{kT}^{(k+1)T}e^{\pmb A((k+1)T-t)}\pmb {Bu}(\tau)\mathrm d\tau
$$
定义：
$$
\pmb x[k]:=\pmb x(kT)
$$
又
$$
\int_{kT}^{(k+1)T}e^{\pmb A((k+1)T-\tau)}\mathrm d\tau\cdot \pmb B=-\int_{T}^{0}e^{\pmb A\alpha}\mathrm d\alpha\cdot \pmb B=\int_0^Te^{\pmb A\tau}\mathrm d\tau\cdot \pmb B
$$
其中，$\alpha=(k+1)T-\tau$

令
$$
\begin{matrix}
\pmb F=e^{\pmb AT}&\pmb H=(\int_0^Te^{\pmb A\tau}\mathrm d\tau)\pmb B&\pmb C_d=\pmb C&\pmb D_d=\pmb D
\end{matrix}
$$
可以得到
$$
\begin{matrix}
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+ \boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x+\boldsymbol D \boldsymbol u
\end{cases}
&
\Rightarrow
&
\begin{cases}
\pmb x[k+1]=\pmb {Fx}[k]+\pmb {Hu}[k]\\
\pmb y[k]=\pmb C_d \pmb x[k]+\pmb D_d\pmb u[k]
\end{cases}
\end{matrix}
$$
特别的，当$\pmb A$非奇异时，$\pmb H=\pmb A^{-1}(e^{\pmb AT-\pmb I})\pmb B$，下面是简单证明：

令方阵函数$\pmb M(t)=\pmb A^{-1}(e^{\pmb At}-\pmb I)$，则$\pmb M(0)=\pmb 0$，且
$$
\frac{\mathrm d}{\mathrm dt}\pmb M(t)=\frac{\mathrm d}{\mathrm dt}(\pmb A^{-1}(e^{\pmb At}-\pmb I))=e^{\pmb At}
$$
于是，
$$
\begin{align}
\pmb H&=(\int_0^Te^{\pmb A\tau}\mathrm d\tau)\pmb B=\int_0^T\Big(\frac{\mathrm d}{\mathrm d\tau}\pmb M(\tau)\Big)\mathrm d\tau\cdot \pmb B\\
&=[\pmb M(T)-\pmb M(0)]\pmb B=\pmb M(T)\pmb B=\pmb A^{-1}(e^{\pmb AT}-\pmb I)\pmb B
\end{align}
$$

### 3.4. 预解矩阵与频域求解

#### 3.4.1. Souriau-Frame-Faddeev算法

$$
\begin{align}
(s\boldsymbol I-\boldsymbol A)^{-1}&=\frac{\mathrm{adj}(s\boldsymbol I-\boldsymbol A)}{\mathrm{det}(s\boldsymbol I-\boldsymbol A)}\\
&=\frac{\sum\limits^{n-1}_{k=0}\boldsymbol Q_k\boldsymbol S^k}{s^n+a_{n-1}s^{n-1}+\cdots+a_1s+a_0}
\end{align}
$$

其中，各步$\pmb Q_k$和$a_k$由下列迭代公式给出：
$$
\begin{matrix}
\pmb Q_{n-1}=\pmb I&a_{n-1}=-\mathrm {tr}(\pmb Q_{n-1}\pmb A)\\
\pmb Q_{k-1}=\pmb Q_k\pmb A+a_k\pmb I&a_{k-1}=-\frac{1}{n-k}\mathrm{tr}(\pmb Q_k\pmb A)&k=n-1,n-2,\cdots,2,1
\end{matrix}
$$
此算法用于比较方便地求出$(s\pmb I-\pmb A)^{-1}$ ，以便进一步求出传递函数矩阵$\pmb G(s)=\pmb C(s\pmb I-\pmb A)^{-1}\pmb B+\pmb D=\sum\limits_{k=0}^{n-1}\frac{\pmb C\pmb Q_k\pmb Bs^k}{\Delta(s)}+\pmb D$  

#### 3.4.2. S-F-F算法的推论

$$
(s\boldsymbol I-\boldsymbol A)^{-1}=\sum\limits^{n-1}_{k=0}a_k(s)\boldsymbol A^k
$$

其中，
$$
a_k(s)=\frac{1}{\Delta (s)}(s^{n-k-1}+a_{n-1}s^{n-k-2}+\cdots+a_{k+2}s+a_{k+1}),k=0,1,2,\cdots,n-1
$$
其中，$\Delta (s)=\det(s \boldsymbol I-\boldsymbol A)$ 

对两边取拉普拉斯逆变换得凯莱-哈密顿定理表示下的$e^{\pmb At}$的幂级数表达式
$$
\begin{align}
e^{\pmb At}&=\mathcal L^{-1}\Big[\sum\limits_{k=0}^{n-1}\alpha_k(s)\pmb A^k \Big]=\sum\limits_{k=0}^{n-1}\alpha_k(t)\pmb A^k\\
\alpha_k(t)&=\mathcal L^{-1}[\alpha_k(s)],k=0,1,2,\cdots,n-1
\end{align}
$$
进一步代入传递函数矩阵得：
$$
\pmb G(s)=\sum\limits_{k=0}^{n-1}\alpha_k(s)\pmb {CA}^k\pmb B+\pmb D
$$

### 3.5. 作业复习

#### 3.5.1. 已知状态转移矩阵，求系统矩阵$\pmb A$

系统状态方程为$\dot{\pmb x}=\pmb {Ax}(t)$

状态转移矩阵为：$\pmb \Phi(t)$

求系统矩阵$\pmb A$，只需：
$$
A=\frac{\mathrm d}{\mathrm dt}\pmb \Phi(t)\Big|_{t=0}=\pmb Ae^{\pmb A0}
$$

#### 3.5.2. 已知两对系统状态，求系统矩阵$\pmb A$

系统状态方程为$\dot{\pmb x}=\pmb {Ax}(t)$

现已知$\pmb x_1(0)$，$\pmb x_1(t)$，$\pmb x_2(0)$，$\pmb x_2(t)$

由$\pmb x(t)=\Phi(t)\pmb x(0)$可得：
$$
\begin{bmatrix}\pmb x_1(t)&\pmb x_2(t) \end{bmatrix}=\Phi(t)\begin{bmatrix}\pmb x_1(0)&\pmb x_2(0) \end{bmatrix}
$$
求得系统状态转移方程：
$$
\pmb \Phi(t)=\begin{bmatrix}\pmb x_1(t)&\pmb x_2(t) \end{bmatrix}\begin{bmatrix}\pmb x_1(0)&\pmb x_2(0) \end{bmatrix}^{-1}
$$
求系统矩阵$\pmb A$，只需：
$$
A=\frac{\mathrm d}{\mathrm dt}\pmb \Phi(t)\Big|_{t=0}=\begin{bmatrix}\dot{\pmb x}_1(0)&\dot{\pmb x}_2(0) \end{bmatrix}\begin{bmatrix}\pmb x_1(0)&\pmb x_2(0) \end{bmatrix}^{-1}
$$

#### 3.5.3. 已知状态方程和系统输入求状态响应

已知：
$$
\begin{matrix}\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B \boldsymbol u&\boldsymbol x(0)=\boldsymbol x_0 \end{matrix}
$$
求输入$\pmb u(t)$下的状态响应

先求状态转移矩阵$\pmb \Phi(t)=e^{\pmb At}$(待定系数法、拉普拉斯变换法、标准型法)

代公式：
$$
\boldsymbol x(t)=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau
$$
若输入$\pmb u(t)=\delta(t)$，则
$$
\pmb x(t)=e^{\pmb At}(\pmb x(0)+\pmb B)
$$

#### 3.5.4. 模态分解

已知：
$$
\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B \boldsymbol u
$$
先计算$\pmb A$的特征值和特征向量得到变换矩阵$\pmb Q$，进一步得到$e^{\pmb At}=\pmb Qe^{\pmb \Lambda t}\pmb Q^{-1}$ 

#### 3.5.5. 预解矩阵的应用

利用预解矩阵可以很方便的求解$(s\pmb I-\pmb A)^{-1}$，$\pmb A^{-1}$和$\det \pmb A$
$$
(s\pmb I-\pmb A)^{-1}=\sum\limits_{k=0}^{n-1}\frac{s^{n-k-1}+a_{n-1}s^{n-k-2}+\cdots+a_{k+2}s+a_{k+1}}{\Delta (s)}\pmb A^k
$$
其中，
$$
\Delta (s)=\det(s \boldsymbol I-\boldsymbol A)
$$
令$s=0$即可求得$\pmb A^{-1}$和$\det \pmb A$

#### 3.5.6. 状态空间离散化

套公式：
$$
\begin{matrix}
\pmb F=e^{\pmb AT}&\pmb H=(\int_0^Te^{\pmb A\tau}\mathrm d\tau)\pmb B&\pmb C_d=\pmb C&\pmb D_d=\pmb D
\end{matrix}
$$

#### 3.5.7. 凯勒-哈密顿定理证明题

若$\pmb A\in \R^{m\times n}$，则对所有$k\in \N$，有$\pmb A^k=\sum\limits_{m=0}^{n-1}\alpha_m\pmb A^m$

**证明：**

1. 当$k<n$时，显然有$\pmb A^k=\sum\limits_{m=0}^{n-1}\alpha_m\pmb A^m$

2. 当$k=n$时，由凯勒-哈密顿定理，方阵满足自身特征多项式
	$$
	f(\lambda)=\det(\lambda\pmb I-\pmb A)=\lambda^n+a_1\lambda^{n-1}+\cdots+a_{n-1}\lambda+a_n=0
	$$
	则一定有：
	$$
	\pmb A^n+a_1\pmb A^{n-1}+\cdots+a_{n-1}\pmb A+a_n=0\Rightarrow \pmb A^n=-(a_1\pmb A^{n-1}+\cdots+a_{n-1}\pmb A+a_n)
	$$

3. 当$k>n$时，可用数学归纳法证明，这里证明$k=n+1$存在
	$$
	\begin{align}
	\pmb A^{n+1}&=\pmb A\cdot \pmb A^n=-\pmb A(a_1\pmb A^{n-1}+\cdots+a_{n-1}\pmb A+a_n)\\
	&=-a_1\pmb A^n-a_2\pmb A^{n-1}-\cdots-a_{n-1}\pmb A^2-a_n\pmb A\\
	&=-a_1(-a_1\pmb A^{n-1}-\cdots-a_{n-1}\pmb A-a_n)-a_2\pmb A^{n-1}-\cdots-a_{n-1}\pmb A^2-a_n\pmb A\\
	&=\sum\limits_{m=0}^{n-1}\alpha_m\pmb A^m
	\end{align}
	$$

## 4. 系统的稳定性

### 4.1. 外部稳定性(BIBO)

#### 4.1.1. BIBO稳定的概念

**定义**

BIBO稳定(有界输入有界输出稳定)：系统在每一个有界的输入信号激励下所引起的输出响应都有界

**特点**

* 系统在每一个有界的输入信号激励下所引起的输出响应都有界  

* BIBO稳定性是定义在零状态响应之上，即仅当系统初始松弛时才能使用  

* 系统的稳定性是一个与输入信号无关的概念 

#### 4.1.2. 系统的外部稳定性

**单输入单输出(SISO)系统的外部稳定性**

一个$t_0$时刻松弛的单变量系统为BIBO稳定系统的充要条件是其脉冲响应函数绝对可积，即存在有限正数$\pmb K_g\in \R_+$使得
$$
\int_{-\infty}^t|g(t,\tau)|\mathrm d\tau\leq K_g,0\leq \pmb K_g<\infty,t\in (-\infty,\infty)
$$
证明：

充分性：设系统的脉冲响应函数为$\overline g(t,\tau)=g(t-\tau)$则其绝对可积是指$\int^\infty_0|g(t)|dt\leq M<\infty$，当系统输入有界，即$|u(t)|\leq u_m<\infty,\forall t\geq 0$，时
$$
\begin{align}
|y(t)|&=|\int^t_0g(t-\tau)u(\tau)d\tau |=|\int^t_0g(\tau)u(t-\tau)d\tau |\\
&\leq \int^t_0|g(t)|\cdot |u(t-\tau)|d\tau\leq u_m\int^\infty_0|g(\tau)|d\tau\leq u_mM
\end{align}
$$
用反证法很容易证明此定理的必要性。只要取  
$$
u(t_1-\tau)=\begin{cases}1&g(\tau)\geq 0\\-1&g(\tau)<0\end{cases}
$$
**多变量系统的外部稳定性**

一个初始时刻$t_0$松弛的用$r\times m$冲激响应矩阵$\pmb G(t,\tau)=[g_{ij}(t,\tau)]$描述的多变量系统为BIBO稳定系统的充要条件是：存在有限正数$K_g$使得对于$\pmb G(t,\tau)$中每一个元素$g_{ij}(t,\tau)$满足
$$
\int_{-\infty}^t|g_{ij}(t,\tau)|\mathrm d\tau\leq K_g,0\leq K_g<\infty,t\in(-\infty,\infty)
$$
推广：

一个初始时刻$t_0$松弛的用$r\times m$冲激响应矩阵$\pmb G(t,\tau)$描述的多变量系统为BIBO稳定系统的充要条件是：
$$
\int_{-\infty}^t\|\pmb G(t,\tau)\|\mathrm d\tau\leq K_g,0\leq K_g<\infty,t\in(-\infty,\infty)
$$
特别地，对于定常系统，有
$$
\int_{-\infty}^t\|\pmb G(\tau)\|\mathrm d\tau\leq K_g,0\leq K_g<\infty
$$
**由真有理传递函数描述的系统的外部稳定性**

一个由真有理传递函数$g(s)$描述的松弛的线性非时变系统为BIBO稳定系统的充要条件是$g(s)$的所有极点位于$s$开平面左半部分内，或等价地说$g(s)$的所有极点具有复实部。

**由真有理传递函数矩阵描述的系统的外部稳定性**

一个由真有理传递函数矩阵$\pmb G(s)$描述的松弛的线性非时变多变量系统为BIBO稳定系统的充要条件是$\pmb G(s)$的每个元素的全部极点具有复实部。

### 4.2. 内部稳定性(李雅普诺夫稳定性)

#### 4.2.1. 系统的平衡状态及其特征

**相关概念**

自治系统：一个没有输入信号的系统

平衡状态：自治系统的静止状态

受扰运动：由于外界扰动$\delta(t)$及其导数导致自治系统偏离平衡状态后的运动

**平衡状态**

对于零输入条件下的自由运动，若系统达到某状态时，系统将维持在此状态而不再发生变化，则称状态为该系统的一个平衡状态  
$$
\begin{matrix}
\dot{\pmb x}=\pmb f(t,\pmb x,\pmb u)&\dot{\pmb x}_e=f(t,\pmb x_e,\pmb 0)=0\\
\dot{\pmb x}=\pmb A\pmb x&\pmb A\pmb x_e=0
\end{matrix}
$$
$\pmb x_e=\pmb 0$一定是线性系统的一个平衡状态

连续时间线性系统有且仅有一个平衡状态的充要条件是：系统矩阵$A$非奇异，或者说$A$没有零特征值。

#### 4.2.2. 李雅普诺夫意义下的稳定性

**李雅普诺夫意义下稳定的平衡状态(限界稳定)**

平衡状态$\pmb x_e$称为在$t_0$时刻是李雅普诺夫意义下稳定的，是指：对于每个$\varepsilon>0$，存在着一依赖于$\varepsilon $的正数$\delta$，使得若$\|\pmb x_0-\pmb x_e\|\leq \delta $，则总有
$$
\|\pmb x(t)-\pmb x_e \|\leq \varepsilon,\forall t\geq t_0
$$
其中，$\pmb x(t)=\pmb x(t,t_0,\pmb x_0)$是系统始于初态$\pmb x(t_0)=\pmb x_0$的零输入响应

对于线性系统，李雅普诺夫意义下稳定或限界稳定的定义可表述得更为简单：若任一有限的初态所引起的零输入响应有界， 则称该线性系统是李雅普诺夫意义下稳定的或称是限界稳定的 

*另一种定义(课本定义的说法)*

对于任意给定的一个正数$\varepsilon>0$，存在另外一个正数$\delta(\varepsilon,t_0)>0$使得所有$\|\pmb x(t_0)\|<\delta$的初态$\pmb x(t_0)$引起的受扰运动$\|\pmb x(t)\|=\|\Phi(t,t_0,\pmb x_0,\pmb 0)\|$满足
$$
\|\pmb x(t)\|<\varepsilon,t>t_0,t_0\in(-\infty,\infty)
$$
则状态空间的原点$\pmb 0_x$称为李雅普诺夫意义下$t_0$时刻的平衡状态。若$\delta$与$t_0$无关，则称为一致稳定的平衡状态。老师课件中默认一致稳定=限界稳定。

**不稳定的平衡状态**

平衡状态不稳定指它不满足李雅普诺夫稳定的定义。即：

平衡状态$x_e$是不稳定的指：若有某个$\varepsilon>0$，无论$\delta>0$如何小，尽管$\|\pmb x_0-\pmb x_e\|\leq \delta$，也总有某时刻$t_1>t_0$，使得$\|\pmb x(t_1,\pmb x_0,t_0)-\pmb x_e\|>\varepsilon $ 

*另一种定义(课本定义的说法)*

对于任意给定的一个正数$\varepsilon>0$，不论选取另外一个正数$\delta>0$如何小，在所有$\|\pmb x(t_0)\|<\delta$的初态$\pmb x(t_0)$中，至少有一个$\pmb x(t_0)$引起的运动使得
$$
\|\pmb x(t)\|>\varepsilon,t\geq t_0+T\\
T\in \R_+,t_0\in(-\infty,\infty)
$$
**渐近稳定平衡状态**

稳定，且该在$\pmb x_e  $附近任一由有限初态所引起的零输入响应，当$t\rightarrow \infty $时趋于零。即  
$$
\lim\limits_{t\rightarrow\infty}\|\pmb x(t)-\pmb x_e\|=0
$$

*另一种定义(课本定义的说法)*

若状态空间原点不仅是李雅普诺夫稳定平衡状态，且存在某个正数$\delta'(t_0)>0$，只要$\|\pmb x(t_0)\|<\delta'(t_0)$，由$\pmb x(t_0)$引起的受扰运动$\|\pmb x(t)\|=\|\pmb \Phi(t,t_0,\pmb x_0,\pmb 0_u)\|$满足
$$
\lim\limits_{t\rightarrow \infty}\|\pmb \Phi(t,t_0,\pmb x_0,\pmb 0_u)\|=\pmb 0_x,t>t_0,t_0\in(-\infty,\infty)
$$
则称状态空间原点为$t_0$时刻渐近稳定的平衡状态

若$\delta'$与$t_0$无关，称为一致渐近稳定的平衡状态

在所有的$\delta'(t_0)$或$\delta'$中，将$\max \delta'(t_0)$或$\max \delta'$所确定的超球体称为平衡状态的吸引域或渐近稳定区域

**大范围渐近稳定**

平衡状态$\pmb x_e$是大范围渐近稳定的是指：对于从状态空间中的所有点出发的轨迹都能收敛到$\pmb x_e$。此时也称系统是大范围渐近稳定的或全局渐近稳定的  

若线性系统是渐近稳定的，则一定是大范围渐近稳定的

全局渐近稳定的必要条件是系统在状态空间中只有一个平衡状态  

**注：古典控制理论下的稳定 vs 李雅普诺夫意义下的稳定**

李雅普诺夫意义下的稳定（通常也简称为稳定）与在古典控制理论中所提的稳定，在概念上有所不同：

* 古典控制理论中的临界稳定属于不稳定的一种，而在李雅普诺夫意义下它却是稳定的
* 古典理论中所指的稳定性就是这里所述的渐近稳定性

![](https://chaphlagical.github.io/assets/images/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%A8%B3%E5%AE%9A%E6%80%A7.assets/image-20200318214612955.png) 

### 4.3. 线性系统平衡状态稳定性判据

#### 4.3.1. 线性时变系统的稳定性判据

**线性时变系统李雅普诺夫稳定性判据**

线性时变系统每一个平衡状态为$t_0$时刻李雅普诺夫稳定平衡状态的充要条件是，存在一个正数$K(t_0)$，使得
$$
\|\pmb \Phi(t,t_0)\|\leq K(t_0)<\infty,t\geq t_0,t_0\in(-\infty,\infty)
$$

若$K$与$t_0$无关，则为一致稳定平衡状态

**线性时变系统渐近稳定与一致渐近稳定判据**

线性时变系统为渐近稳定的充要条件是
$$
\|\pmb \Phi(t,t_0)\|\leq K(t_0)
$$
且$\lim\limits_{t\rightarrow \infty}\|\pmb \Phi(t,t_0)\|=0$

其中，$0\leq K(t_0)<\infty,t\geq t_0,t_0\in(-\infty,\infty)$

线性时变系统为一致渐近稳定的充要条件是
$$
\|\pmb \Phi(t,t_0)\|\leq K_1e^{-k_2(t-t_0)}\\
0\leq K_1<\infty,0\leq K_2<\infty,t\geq t_0,t_0\in(-\infty,\infty)
$$

#### 4.3.2. 线性非时变系统的稳定性判据(间接法)

**线性非时变系统李雅普诺夫稳定性判据**

线性非时变系统$\dot{\pmb x}(t)=\pmb {Ax}(t)$的每一个平衡状态是李雅普诺夫稳定平衡状态的充要条件是，$\pmb A$的所有特征值实部$\alpha_i\leq 0$，实部$\alpha_i=0$的特征值是$\pmb A$的最小多项式的简单零点

*说明：*

* 最小多项式

	* 特征方程无重根时最小多项式与特征多项式完全一致

	* 特征根重数与相应的互不相关特征向量数相同时，该特征值仍是最小多项式的单根  

	* 示例：
		$$
		\begin{matrix}
		\dot{\pmb x}=\begin{bmatrix}0&0&0\\0&0&0\\0&0&-1\end{bmatrix}\pmb x
		&
		\begin{matrix}
		特征多项式\Delta(\lambda)=\lambda^2(\lambda+1)\\
		最小多项式\Psi(\lambda)=\lambda(\lambda+1)\  \ 
		\end{matrix}
		&
		\begin{matrix}
		0是最小多项式的单根\\
		系统限界稳定
		\end{matrix}
		\end{matrix}
		$$

		$$
		\begin{matrix}
		\dot{\pmb x}=\begin{bmatrix}0&1&0\\0&0&0\\0&0&-1\end{bmatrix}\pmb x
		&
		\begin{matrix}
		特征多项式\Delta(\lambda)=\lambda^2(\lambda+1)\\
		最小多项式\Psi(\lambda)=\lambda^2(\lambda+1) 
		\end{matrix}
		&
		\begin{matrix}
		0是最小多项式的单根\\
		系统非限界稳定
		\end{matrix}
		\end{matrix}
		$$

* 等价变换的影响

	* 等价变换不改变系统矩阵的特征值
	* 等价变换不改变系统矩阵的最小多项式
	* 等价变换不改变系统的稳定性  

**线性非时变系统的大范围渐近稳定判据**

线性非时变系统$\dot{\pmb x}(t)=\pmb {Ax}(t)$为大范围渐近稳定系统的充要条件是$\pmb A$的所有特征值的实部$\alpha_i<0$

#### 4.3.5. 线性化模型的稳定性判据

设非线性自治系统的状态方程为：
$$
\dot{\pmb x}(t)=\pmb f[\pmb x(t)]
$$
$\pmb x_e$表示某一平衡状态，经线性化得：
$$
\dot{\pmb x}_\sim(t)=\pmb J_x\pmb x_{\sim}(t)
$$
上式是在$\pmb x_e$作为状态空间原点的前提下，状态方程的线性化模型，其中$\pmb J_x$为$\pmb f[\pmb x(t),t]$关于状态向量$\pmb x(t)$的雅可比矩阵，即
$$
\pmb J_x=\frac{\mathrm d\pmb f}{\mathrm d\pmb x}\Bigg|_{\pmb x_e}
$$
亦可记作：
$$
\dot{\pmb x}(t)=\pmb {Ax}(t)
$$
李雅普诺夫指出：

1. 若线性化模型中$\pmb A$的所有特征值具有复实部，则平衡状态$\pmb x_e$为稳定的
2. 若$\pmb A$至少含有一个实部为正的特征值，平衡状态$\pmb x_e$不稳定
3. 若$\pmb A$的特征值中有的实部为零，其余的实部均为负值，则平衡状态$\pmb x_e$的稳定性取决于$\dot{\pmb x}(t)=\pmb f[\pmb x(t)]$的广义泰勒级数展开式中更高阶项

#### 4.3.4. 平衡状态稳定性 vs BIBO稳定性

**线性时变系统的BIBO稳定性**

线性时变系统$\{\pmb A(t),\pmb B(t),\pmb C(t) \}$为BIBO稳定系统的充要条件为
$$
\int_{-\infty}^t\|\pmb C(t)\pmb \Phi(t,\tau)\pmb B(\tau)\|\mathrm d\tau\leq K_g,0\leq K_g<\infty
$$
这里假定系统在$t_0$时刻松弛，$t_0\in (-\infty,\infty)$，$t\geq t_0$

**一致稳定性 vs BIBO稳定**

当线性系统$\{\pmb A(t),\pmb B(t),\pmb C(t) \}$中$\pmb B(t)$和$\pmb C(t)$在$(-\infty,\infty)$内有界，则系统的一致渐近稳定意味着系统BIBO稳定

当线性系统$\{\pmb A(t),\pmb B(t),\pmb C(t) \}$中$\pmb A(t)$，$\pmb B(t)$和$\pmb C(t)$在$(-\infty,\infty)$内有界，且系统是一致能控和一致能观的，则线性系统为BIBO稳定的充要条件是系统为一致渐近稳定系统

**完全稳定性**

定义：当且仅当对于任何初始状态和任何有界输入，线性系统的输出和每个状态分量均有界，称系统为完全稳定系统

线性系统$\{\pmb A(t),\pmb B(t),\pmb C(t) \}$完全稳定的充要条件是$\pmb C(t)$和$\pmb \Phi(t,t_0)$有界，且
$$
\int_{t_0}^t\|\pmb\Phi(t,\tau)\pmb B(\tau)\|\mathrm d\tau\leq K,0\leq K<\infty,t\geq t_0,t_0\in(-\infty,\infty)
$$
**能控能观线性非时变系统的性质**

如果线性非时变系统是既能控又能观的系统，则下述论断是等价的：

1. 系统是完全稳定的
2. 系统是BIBO稳定的
3. 系统是渐近稳定的
4. 系统传递函数矩阵的极点都具有复实部
5. 系统矩阵的特征值都具有复实部

### 4.4. 李雅普诺夫直接法

#### 4.4.1. 李雅普诺夫函数简介

李雅普诺夫函数$V(\pmb x)$表征某种虚拟的能量函数，李雅普诺夫函数必须是正定

**正定和半正定**

设$V(\boldsymbol x) $是定义在向量空间原点某领域$\Re$内的标量函数，称$V(\boldsymbol x)$是正定泛函是指：
$$
V(\boldsymbol x)\geq 0\ \ \ \ \forall x\in \Re,且V(\boldsymbol x)=0\Leftrightarrow \boldsymbol x=0
$$
而称$V(\boldsymbol x)$是半正定泛函指：
$$
V(\boldsymbol x)\geq 0\ \ \ \ \forall x\in \Re,且\boldsymbol x=0\Leftrightarrow V(\boldsymbol x)=0
$$

**负定和负半定**

若$-V(\boldsymbol x)$是正定泛函，则称$V(\boldsymbol x)$是负定泛函；同样，若$-V(\boldsymbol x)$是半正定的，则称$V(\boldsymbol x)$是半负定的

**不定**

设$V(\boldsymbol x)$是定义在向量空间原点某邻域$\Re$内的标量函数，若$\Re$内同时存在非零元素$x_1\neq 0$和$x_2\neq 0$，使得$V(\boldsymbol x_1)>0$而$V(\boldsymbol x_2)<0$，则称泛函$V(\boldsymbol x)$是$\Re$中不定的

#### 4.4.2. 李雅普诺夫稳定性定理

如果在状态空间原点邻域$\Re$内存在一个标量函数$V(\pmb x,t)$，$t\in(-\infty,\infty)$，它对于每个状态变量$x_i$，$i=1,2,\cdots,n$和$t$有连续一阶偏微商

1. $V(\pmb x,t)$正定，$\dot{V}(\pmb x,t)$半负定，原点是李雅普诺夫一致稳定平衡状态(限界稳定)
2. $V(\pmb x,t)$正定，$\dot{V}(\pmb x,t)$负定，原点为(一致)渐近稳定平衡状态
3. 邻域$\Re$扩张到整个状态空间，$V(\pmb x,t)$正定，$\dot{V}(\pmb x,t)$负定，而且随着$\|\dot{\pmb x}\|\rightarrow\infty$，$V(\pmb x,t)\rightarrow \infty$ ，原点是大范围一致渐近稳定平衡状态
4. 邻域$\Re$扩张到整个状态空间，$V(\pmb x,t)$正定，$\dot{V}(\pmb x,t)$半负定，而且对于任意$t_0\in(-\infty,\infty)$和任意$\pmb x_0\neq \pmb 0_x$，当$t\geq t_0$时除原点外，$\dot V[\Phi(t,t_0,\pmb x_0,\pmb 0_u),t]\not\equiv0$，原点是大范围一致渐近稳定平衡状态
5. $V(\pmb ,t)$正(负)定，$\dot{V}(\pmb x,t)$正(负)定，原点是不稳定平衡状态

### 4.5. 李雅普诺夫函数的构造方法

#### 4.5.1. 构造方法

线性非时变系统$\dot{\pmb x}=\pmb {Ax}$的$\pmb x_e=\pmb 0_x$是大范围渐近稳定平衡状态的充要条件是对于任意给定的正定实对称矩阵$\pmb Q$，存在另一个正定实对称矩阵$\pmb P$，满足下式表达的李雅普诺夫方程：
$$
\pmb A^T\pmb P+\pmb {PA}=-\pmb Q
$$
倘若$\dot{V}[\Phi(t,t_0,\pmb x_0,\pmb 0_u)]\not\equiv 0$，$\pmb Q$可放宽为半正定，李雅普诺夫函数构造为$V(\pmb x)=\pmb x^T\pmb {Px}$

*证明：*

充分性：

由于已经假设$\pmb Q$和$\pmb P$均为正定实对称矩阵且满足李雅普诺夫方程，不妨取$V(\pmb x)=\pmb x^T\pmb {Px}$，$\pmb P$保证了$V(\pmb x)$是正定函数
$$
\begin{align}
\dot{V}(\pmb x)&=\dot{\pmb x}^T\pmb {Px}+\pmb x^T\pmb {Px}\\
&=\pmb x^T\pmb A^T\pmb {Px}+\pmb x^T\pmb {PAx}\\
&=\pmb x^T(\pmb A^T\pmb P+\pmb {PA})\pmb x\\
&=-\pmb x^T\pmb {Qx}
\end{align}
$$
$\pmb Q$保证了$\dot V(\pmb x)$的负定性所以$\pmb x_e=\pmb 0_x$是大范围渐近稳定平衡状态

必要性：

设系统为大范围渐近稳定的，则$Re[\lambda_i(\pmb A)]<0$，$i=1,2,\cdots,n$，任意选取一正定对称矩阵$\pmb Q$，则$\pmb M(t)\mathop=\limits^{def}e^{\pmb A^Tt}\pmb Q e^{\pmb At}$是满足如下矩阵微分方程的唯一解，且$\pmb M(t)$是对称矩阵
$$
\begin{align}
\dot{\pmb M}(t)&=\pmb A^T\pmb M(t)+\pmb M(t)\pmb A\\
\pmb M(0)&=\pmb Q
\end{align}
$$
因为$Re[\lambda_i(\pmb A)]<0$，$i=1,2,\cdots,n$，
$$
\lim\limits_{t\rightarrow \infty}\pmb M(t)=\pmb 0
$$
即
$$
\int_0^\infty \dot{\pmb M}(t)\mathrm dt=\pmb M(\infty)-\pmb M(0)=-\pmb Q
$$
或者写成
$$
\pmb A^T\int_0^\infty {\pmb M}(t)\mathrm dt+\Big(\int_0^\infty \pmb M(t)\mathrm dt\Big)\pmb A=-\pmb Q
$$
令$\pmb P\mathop=\limits^{def}\int_0^\infty\pmb M(t)\mathrm dt$
$$
\pmb P^T=\Big(\int_0^\infty \pmb M(t)\mathrm dt\Big)^T=\int_0^\infty \pmb M^T(t)\mathrm dt=\pmb P
$$
最后考察$\pmb P$的正定性
$$
\begin{align}
<\pmb x,\pmb {px}>&=<\pmb x,\Big(\int_0^\infty e^{\pmb A^Tt}\pmb Qe^{\pmb At}\mathrm dt \Big)\pmb x>\\
&=\begin{cases}
0&\pmb x=\pmb 0_x\\
\int_0^\infty (e^{\pmb At}\pmb x)^T\pmb Q(e^{\pmb At}\pmb x)\mathrm dt>0&\pmb x\neq \pmb 0_x
\end{cases}
\end{align}
$$
所以$\pmb P$是满足李雅普诺夫方程的正定实对称矩阵，定理得证

#### 4.5.2. 克拉索夫斯基定理

设非线性系统$\dot{\pmb x}=\pmb f(\pmb x)$的雅可比矩阵为$\pmb J(\pmb x)$，定义李雅普诺夫函数$V(\pmb x)=<\pmb f(\pmb x),\pmb f(\pmb x)>$，和
$$
\hat{\pmb J}(\pmb x)=\mathop{\pmb J}^*+\pmb J(\pmb x)
$$
如果埃尔米特矩阵$\hat{\pmb J}(\pmb x)$负定，则状态空间原点$\pmb x_e=\pmb 0_x$是渐进稳定的平衡状态。如果$\|\pmb x\|\rightarrow \infty$，$V(\pmb x)\rightarrow\infty$，则$\pmb x_e=\pmb 0_x$是大范围渐进稳定平衡状态

#### 4.5.3. 变量梯度法

假设$V(\boldsymbol x)$是非线性系统$\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x)$的李雅普诺夫函数，则
$$
\dot{V}(\boldsymbol x)=[\nabla_xV(\boldsymbol x)]^T\dot{\boldsymbol x}\\
\int^{V(\boldsymbol x)}_{V(\boldsymbol 0)=0}dV(\boldsymbol x)=\int^x_0[\nabla_xV(\boldsymbol x)]^Td\boldsymbol x
$$

### 4.6. 线性非时变离散系统的稳定性

#### 4.6.1. BIBO稳定性

设线性非时变离散系统在时域和频域中分别由下式描述：
$$
\pmb y(k)=\sum\limits_{p=0}^k\pmb G(k-p)\pmb u(p),k=0,1,2,\cdots
$$

$$
\pmb y(z)=\pmb G(z)\pmb u(z)
$$

系统为BIBO稳定系统的充要条件为在时域中为：
$$
\sum\limits_{k=0}^\infty\|\pmb G(k)\|\leq K_g,K_g<\infty\in \R_+
$$
或
$$
\sum\limits_{k=0}^\infty |g_{ij}(k)|\leq K_g,\ i=1,2,\cdots,r,\ j=1,2,\cdots,m
$$
其中$r$，$m$分别表示输出向量$\pmb y(k)$和输入向量$\pmb u(k)$的维数，$g_{ij}(k)$是$\pmb G(k)$的元素。在频域中$\pmb G(z)$的每一个元素$g_{ij}(z)$的全部极点$z_i$都位于$Z$平面的单位圆内，即$|z_i|<1$ 

#### 4.6.2. 平衡状态及其稳定性

**大范围渐近稳定**

线性非时变离散系统$\pmb x(k+1)=\pmb {Ax}(k)$为大范围渐近稳定系统的充要条件是$\pmb A$的所有特征值的模均小于1

**限界稳定**

线性定常离散时间系统$\boldsymbol x[k+1]=\boldsymbol A \boldsymbol x[k]$限界稳定的充要条件：$\boldsymbol A$的所有特征值，其模都小于或等于1.且模为1的特征值是$\boldsymbol A$之最小多项式的单根

**Routh-Shur判据**

线性非时变离散系统$\pmb x(k+1)=\pmb {Ax}(k)$的特征多项式：
$$
\det(\pmb A-z\pmb I)=a_0z^n+a_1z^{n-1}+\cdots+a_{n-1}z+a_n,\ \ \ \ a_0>0
$$
只含有模小于1的特征值的充要条件是Routh-Shur阵列：
$$
\begin{matrix}
a_0^{(0)}&a_1^{(0)}&a_2^{(0)}&\cdots&a_{n-2}^{(0)}&a_{n-1}^{(0)}&a_n^{(0)}\\
a_0^{(1)}&a_1^{(1)}&a_2^{(1)}&\cdots&a_{n-2}^{(1)}&a_{n-1}^{(1)}\\
a_0^{(2)}&a_1^{(2)}&a_2^{(2)}&\cdots&a_{n-2}^{(2)}\\
&\cdots&\cdots&\cdots\\
a_0^{(n-2)}&a_1^{(n-2)}&a_2^{(n-2)}\\
a_0^{(n-1)}&a_1^{(n-1)}\\
a_0^{(n)}
\end{matrix}
$$
中第一列所有元素$a_0^{(i)}>0$，$i=0,1,2,\cdots,n$ 

#### 4.6.3. 线性非时变离散系统的李雅普诺夫函数构造

线性非时变离散系统$\pmb x(k+1)=\pmb {Ax}(k)$的平衡状态$\pmb x_e=\pmb 0_x$是大范围渐近稳定平衡状态的充分必要条件是，对于任意给定的正定对称实矩阵$\pmb Q$，存在另外一个正定对称实矩阵$\pmb P$满足李雅普诺夫方程
$$
\pmb A^T\pmb {PA}-\pmb P=-\pmb Q
$$

### 4.7. 作业复习

#### 4.7.1. 已知系统方程，确定不同稳定类型下的参数取值

设系统动态方程为：
$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+ \boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x+\boldsymbol D \boldsymbol u
\end{cases}
$$
计算传递函数矩阵$\pmb G(s)=\pmb C(s\pmb I-\pmb A)^{-1}\pmb B$ 

* BIBO稳定要求矩阵每个元素具有负实部
* 李雅普诺夫稳定要求$\pmb A$的所有特征值实部$\alpha_i\leq 0$，实部$\alpha_i=0$的特征值是$\pmb A$的最小多项式的简单零点
* 渐近稳定要求$\pmb A$的所有特征值实部小于0

#### 4.7.2. 李雅普诺夫直接法

可先用间接法判断属于哪种稳定(界限稳定、渐近稳定、大范围渐近稳定)作为检验，再构造李雅普诺夫函数

构造方法：

1. 经验法

	通常选用二次型如
	$$
	V(\pmb x)=\sum\limits_{i=1}^n \alpha_i x_i^2+\sum\limits_{j=1}^m(\sum\limits_{i=1}^n \beta_ix_i)^2+\sum\limits_{i=1,j=1,i\neq j}^{n}\gamma_{ij}x_ix_j
	$$

2. 公式构造法

	对任意给定的正定对称实矩阵$\pmb Q$，经常取$\pmb Q=\pmb I$ ，寻找另外一个正定对称实矩阵$\pmb P$满足

	连续：$\pmb A^T\pmb P+\pmb {PA}=-\pmb Q$

	离散：$\pmb A^T\pmb {PA}-\pmb P=-\pmb Q$

	李雅普诺夫函数即为$V(\pmb x)=\pmb x^T\pmb {Px}$

#### 4.7.3. 小结

**BIBO稳定**

1. 脉冲响应函数绝对可积(较少见)
2. 传递函数矩阵所有极点具有负实部

**李雅普诺夫稳定**

|                    |                            间接法                            |                            直接法                            |
| :----------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|      限界稳定      | $\pmb A$的所有特征值实部小于零<br>实部为0的特征值是$\pmb A$的最小多项式的简单零点 |                  $\dot{V}(\pmb x,t)$半负定                   |
|      渐近稳定      |                $\pmb A$的所有特征值实部小于0                 |                   $\dot{V}(\pmb x,t)$负定                    |
| 大范围一致渐近稳定 |                $\pmb A$的所有特征值实部小于0                 | $\dot{V}(\pmb x,t)$负定且$\lim\limits_{\|\dot{\pmb x}\|\rightarrow \infty}V(\pmb x,t)=\infty$<br>另一种情况见李雅普诺夫稳定性定理 |

## 5. 能观性与能控性

### 5.1. 能控性与能达性

#### 5.1.1. 能达与能控的概念

**状态能控**

对某系统的一个特定状态$\overline{\boldsymbol x}$，若存在一个有限的时间段$[t_0,t_f)$，以及定义在该时间段上的控制函数$\boldsymbol u(t)=\overline{\boldsymbol  u}(t)$,$t\in[t_0,t_f)$，能够把系统从初始状态$\boldsymbol  x(t_0)=\overline{\boldsymbol x}$推向状态$\boldsymbol  x(t_f)=\boldsymbol 0$，则称该系统的这一特定状态$\overline{\boldsymbol  x}$是$t_0$时刻能控的。($\boldsymbol  x(t_0)=\overline{\boldsymbol x}\Rightarrow  \boldsymbol  x(t_f)=\boldsymbol 0$) 

**状态能达**

若存在将系统从$\boldsymbol  x(t_0)=\boldsymbol 0$推向$\boldsymbol  x(t_f)=\overline{\boldsymbol x}$的控制作用，则称状态$\overline{\boldsymbol  x}$是$t_0$时刻能达的。($\boldsymbol  x(t_0)=\boldsymbol 0\Rightarrow \boldsymbol  x(t_f)=\overline{\boldsymbol x}$)

**系统的能控与能达**

如果系统状态空间中的每一个状态都是能控的，则称系统是状态完全能控的或简称系统是能控的；同样，若系统的每一个状态都是能控的则称系统是状态完全能达的，或简称系统是能达的。

特别地，对于连续时间系统，系统能控与系统能观完全等价

#### 5.1.2. 线性时变连续系统的能控性

设线性时变连续系统的动态方程为
$$
\begin{cases}
\dot{\pmb x}(t)=\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t),&\pmb x(t)=\pmb x_0\\
\pmb y(t)=\pmb C(t)\pmb x(t)
\end{cases}
$$
状态响应为：
$$
\pmb x(t)=\pmb \Phi(t,t_0)\pmb x_0+\int_{t_0}^t\pmb \Phi(t,\tau) \pmb B(\tau)\pmb u(\tau)\mathrm d\tau
$$
令时间区间$J=[t_0,t_1]$，对于能控系统即找到容许的控制函数$\pmb u_{[t_0,t_1]}$，使得下式成立
$$
\pmb x(t)=\pmb \Phi(t,t_0)\hat{\pmb x}+\int_{t_0}^t\pmb \Phi(t,\tau) \pmb B(\tau)\pmb u(\tau)\mathrm d\tau=\pmb 0_x
$$
或
$$
-\hat{\pmb x}=\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau)\pmb u(\tau)\mathrm d\tau,\ \ \ \ \forall \hat{\pmb x}\in X
$$
对于能达系统即找到容许的控制函数$\pmb u_{[t_0,t_1]}$，使得下式成立
$$
\pmb x(t_1)=\int_{t_0}^{t_1}\pmb \Phi(t_1,\tau) \pmb B(\tau)\pmb u(\tau)\mathrm d\tau=\hat{\pmb x} 
$$
或
$$
\pmb\Phi(t_0,t_1)\hat{\pmb x}=\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau)\pmb u(\tau)\mathrm d\tau, \ \ \ \ \forall \hat{\pmb x}\in X
$$
易证得对于线性连续系统，能控性与能观性等价，以下式考察能控性
$$
\overline{\pmb x}=\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau)\pmb u(\tau)\mathrm d\tau, \ \ \ \ \forall \overline{\pmb x}\in X
$$
**格拉姆矩阵判别法**

线性时变系统为$t_0$时刻完全能控系统得充要条件是$n\times m$矩阵$\pmb \Phi(t_0,t)\pmb B(t)$的$n$行在$[t_0,t_1]$内线性无关

*证明：*

充分性

由时间函数的线性无关判别方法可知，要证$\pmb \Phi(t_0,t)\pmb B(t)$的$n$行在$[t_1,t_2]$内线性无关，其能控格拉姆矩阵
$$
\pmb W_c(t_0,t_1)=\int_{t_0}^{t_1}[\pmb \Phi(t_0,\tau)\pmb B(\tau)][\pmb \Phi(t_0,\tau)\pmb B(\tau)]^*\mathrm d\tau
$$
非奇异，$\pmb W_c^{-1}(t_0,t_1)$存在，设$\forall \overline{\pmb x}=\pmb x(t_0)\in X$，令
$$
\pmb u(t)=[\pmb \Phi(t_0,\tau)\pmb B(\tau)]^*\pmb W_c^{-1}(t_0,t_1)\overline{\pmb x}
$$
代入
$$
\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau)\pmb u(\tau)\mathrm d\tau, \ \ \ \ \forall \overline{\pmb x}\in X
$$
得到
$$
\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau)\pmb u(\tau)\mathrm d\tau=\overline{\pmb x}
$$
说明控制函数$\pmb u(t)$可将系统由任意初态$\pmb x(t_0)$转移到$\pmb x(t_1)=\pmb 0$ 

必要性

假设系统是$t_0$时刻完全能控的，但是$\pmb \Phi(t_0,t)\pmb B(t)$的$n$行在$[t_1,t_2]$内线性相关，即存在非零$n$维向量$\pmb \alpha$使得
$$
\pmb {\alpha\Phi}(t_0,t)\pmb B(t)=\pmb 0,\ \ \ \ \forall t\in[t_0,t_1]
$$
选择$-\pmb x(t_0)=\pmb \alpha^*$，系统完全能控表明存在$\pmb u_{[t_0,t_1]}$使得
$$
\pmb \alpha^*=\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau)\pmb u(\tau)\mathrm d\tau
$$
成立，将上面等式两边同时乘以$\pmb \alpha$，有
$$
\pmb {\alpha\alpha}^*=\int_{t_0}^{t_1}\pmb \alpha\pmb \Phi(t_0,\tau)\pmb B(\tau)\pmb u(\tau)\mathrm d\tau=0
$$
这与$\pmb \alpha$非零矛盾，故$\pmb \Phi(t_0,t)\pmb B(t)$线性无关，得$\pmb \Phi(t_0,t)\pmb B(t)$在$[t_0,t_1]$线性无关$\Leftrightarrow$能控格拉姆矩阵非奇异

证毕

**能控性矩阵判别法**

假设线性连续系统得$\pmb A(t)$和$\pmb B(t)$均是$n-1$阶连续可导的函数矩阵，规定$\pmb M_0(t)=\pmb B(t)$，再按
$$
\pmb M_{k+1}(t)=-\pmb A(t)\pmb M_k(t)+\dot{\pmb M}_k(t),\ \ \ \ k=0,1,2,\cdots,n-1
$$
计算出另外$n-1$个$n\times m$矩阵$\pmb M_1(t)$，$\pmb M_2(t)$，$\cdots$，$\pmb M_{n-1}(t)$ 

那么系统是$t_0$时刻完全能控系统的充分条件是
$$
\rho\begin{bmatrix}\pmb M_0(t_1)&\pmb M_1(t_1)&\cdots&\pmb M_{n-1}(t_1)
\end{bmatrix}=n,
\ \ \ \ 
t_1>t_0
$$
*证明：*

考虑到$\partial \pmb \Phi(t_0,t)/\partial t=-\pmb \Phi(t_0,t)\pmb A(t)$，推导出
$$
\frac{\partial ^k}{\partial t^k}\pmb \Phi(t_0,t)\pmb B(t)=\pmb \Phi(t_0,t)\pmb M_k(t),\ \ \ \ k=0,1,2,\cdots,n-1
$$
定义：
$$
\frac{\partial ^k}{\partial t^k}\pmb \Phi(t_0,t)\pmb B(t)\Bigg|_{t=t_1}\mathop=\limits^{def}\frac{\partial ^k}{\partial t_1^k}\pmb \Phi(t_0,t_1)\pmb B(t_1),\ \ \ \ k=0,1,2,\cdots,n-1
$$
这样
$$
\begin{bmatrix}
\pmb \Phi(t_0,t_1)\pmb B(t_1)&\frac{\partial }{\partial t_1}\pmb \Phi(t_0,t_1)\pmb B(t_1)&\cdots&\frac{\partial^{n-1} }{\partial t_1^{n-1}}\pmb \Phi(t_0,t_1)\pmb B(t_1)
\end{bmatrix}\\
=\pmb \Phi(t_0,t_1)\begin{bmatrix}\pmb M_0(t_1)&\pmb M_1(t_1)&\cdots&\pmb M_{n-1}(t_1)
\end{bmatrix}
$$
因为$\pmb \Phi(t_0,t_1)$非奇异，上式可视为
$$
\rho\begin{bmatrix}
\pmb \Phi(t_0,t_1)\pmb B(t_1)&\frac{\partial }{\partial t_1}\pmb \Phi(t_0,t_1)\pmb B(t_1)&\cdots&\frac{\partial^{n-1} }{\partial t_1^{n-1}}\pmb \Phi(t_0,t_1)\pmb B(t_1)
\end{bmatrix}=n,\ \ \ \ t_1>t_0
$$
$\Rightarrow\Phi(t_0,t)\pmb B(t)$的$n$行在区间$[t_0,t_1]$内线性无关$\Leftrightarrow $系统能控

#### 5.1.3. 线性非时变连续系统的能控性

**线性非时变连续系统的能控性判据**

线性非时变系统$\{\pmb A,\pmb B\}$为完全能控系统的充要条件是下列等价条件任何一个：

1. $e^{\pmb At}\pmb B$或$e^{-\pmb At}\pmb B$的$n$行在时间区间$[0,\infty)$内线性无关

2. $(s\pmb I-\pmb A)^{-1}\pmb B$的$n$行在复数域$\pmb C$上线性无关

3. **能控性定理**

	能控格拉姆矩阵
	$$
	\boldsymbol W_c(t_f)=\int^{t_f}_0e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A'\tau}d\tau
	$$
	非奇异，或$\rho[\pmb W_c(t_f)]=n$，对于状态能控，要求状态$\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]$

4. **能控性判据**

	能控性矩阵
	$$
	\boldsymbol M_c=\begin{bmatrix}\boldsymbol B&\boldsymbol A\boldsymbol B&\boldsymbol A^2\boldsymbol B&\cdots&\boldsymbol A^{n-1}\boldsymbol B\end{bmatrix}
	$$
	满秩，即$\rho[\pmb M_c]=n$  

5. **能控性校验(PBH特征向量判别法)**

	对于系统矩阵$\pmb A$的每个特征值$\lambda$都有
	$$
	rank\begin{bmatrix}\lambda\boldsymbol I-\boldsymbol A & \boldsymbol B\end{bmatrix}=n
	$$

*证明：*

1. 由线性时变连续系统的结论可得：完全能控$\Leftrightarrow e^{\pmb At}\pmb B$的$n$行在$[0,\infty)$线性无关，$e^{\pmb At}\pmb B$解析，符号不影响行的线性无关性

2. 拉普拉斯变换一对一的性质不改变线性无关性

3. 线性时变连续系统能控性的格拉姆矩阵判别法可得，或按以下直接证明：

	充分性证明： $\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]\Rightarrow \boldsymbol x(t_f)=\boldsymbol 0$

	因$\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]$，故有向量$\boldsymbol z$满足$\overline{\boldsymbol x}=\boldsymbol W_C(t_f)\boldsymbol z$，于是，对初态$\boldsymbol x(0)=\overline{\boldsymbol x}$，只要选取输入
	$$
	\overline{\boldsymbol u}(t)=-\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z,t\in[0,t_f]
	$$
	则在$t_f$时刻，系统的状态响应是
	$$
	\begin{align}
	\boldsymbol x(t_f)&=e^{\boldsymbol At_f}\boldsymbol x(0)+\int^{t_f}_0e^{\boldsymbol A(t_f-\tau)}\boldsymbol B\overline{\boldsymbol u}(\tau)d\tau\\
	&=e^{\boldsymbol At_f}\boldsymbol x(0)+\int^{t_f}_0e^{\boldsymbol A(t_f-\tau)}\boldsymbol B(-\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol z)d\tau\\
	&=e^{\boldsymbol At_f}\overline{\boldsymbol x}-e^{\boldsymbol At_f}\left(\int^{t_f}_0e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A'\tau}d\tau \right)\boldsymbol z\\
	&=e^{\boldsymbol  At_f}\overline{\boldsymbol x}-e^{\boldsymbol At_f} \boldsymbol W_C(t_f)\boldsymbol z=e^{\boldsymbol At_f}\overline{\boldsymbol x}-e^{\boldsymbol At_f}\overline{\boldsymbol x}=\boldsymbol 0
	\end{align}
	$$
	此即表明，状态$\overline{\boldsymbol x}$是能控的，充分性得证

	必要性证明： 状态$\overline{\boldsymbol x}$能控$\Rightarrow$$\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]$($\Leftrightarrow\forall\boldsymbol v\in N[\boldsymbol W_C(t_f)],\boldsymbol v'\overline{\boldsymbol x}=0$)

	若状态$\overline{\boldsymbol x}$能控，有$\boldsymbol u(\cdot)$使得
	$$
	\begin{align}
	\boldsymbol x(t_f)&=e^{\boldsymbol At_f}\boldsymbol x(0)+\int^{t_f}_0e^{\boldsymbol A(t_f-\tau)}\boldsymbol B\boldsymbol u(\tau)d\tau\\
	&=e^{\boldsymbol At_f}\left[\overline{\boldsymbol x}+\int^{t_f}_0e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol u(\tau)d\tau \right]=\boldsymbol 0
	\end{align}
	$$
	因矩阵指数的非奇异性
	$$
	\int^{t_f}_0e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol u(\tau)d\tau=\boldsymbol 0
	$$
	对$\forall \tau\in (0,t_f)$

	有：
	$$
	\begin{align}
	0&=\boldsymbol v'\boldsymbol W_C(t_f)\boldsymbol v=\int^{t_f}_0\boldsymbol v'e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol vd\tau\\
	&=\int^{t_f}_0(\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol v)'(\boldsymbol  B'e^{-\boldsymbol A'\tau}\boldsymbol v)d\tau\\
	&=\int^{t_f}_0\|\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol v \|^2d\tau
	\end{align}
	$$
	即：
	$$
	\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol v=0
	$$
	因此，
	$$
	\boldsymbol v'\overline{\boldsymbol x}=-\int^{t_f}_0\boldsymbol v'e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol u(\tau)d\tau=-\int^{t_f}_0[\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol v]\boldsymbol u(\tau)d\tau=0
	$$
	即若状态$\overline{\boldsymbol x}$能控，则必然有$\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]$ 

4. $e^{\pmb At}\pmb B\Leftrightarrow e^{\pmb At}\pmb B$的$n$行在$[0,\infty)$线性无关$\Leftrightarrow $
	$$
	\begin{bmatrix}
	e^{\pmb At'}\pmb B&e^{\pmb At'}\pmb {AB}&e^{\pmb At'}\pmb A^2\pmb B&\cdots&e^{\pmb At'}\pmb A^{n-1}\pmb B
	\end{bmatrix}\\
	=e^{\pmb At'}\begin{bmatrix}
	\pmb B&\pmb {AB}&\pmb A^2\pmb B&\cdots&\pmb A^{n-1}\pmb B
	\end{bmatrix}
	$$
	非奇异$\Leftrightarrow$
	$$
	\rho\begin{bmatrix}
	\pmb B&\pmb {AB}&\pmb A^2\pmb B&\cdots&\pmb A^{n-1}\pmb B
	\end{bmatrix}=n
	$$
	或从线性系统状态空间结构角度证明：

	因$\boldsymbol W_C=\boldsymbol W_C' $，且$R(\boldsymbol M_C)^{\perp}=N(\boldsymbol M_C')$，$R(\boldsymbol W_C)^{\perp}=N(\boldsymbol W_C')=N(\boldsymbol W_C)$

	故只要证：$N(\boldsymbol W_C)=N(\boldsymbol M_C')\Leftrightarrow N(\boldsymbol W_C)\subset N(\boldsymbol M_C')$且$N(\boldsymbol W_C)\supset N(\boldsymbol M'_C)$

	先证$N(\boldsymbol W_C)\subset N(\boldsymbol M_C')$：

	设$z\in N(\boldsymbol W_C)$，则$\boldsymbol W_C\boldsymbol z=\boldsymbol 0$

	当然：
	$$
	\begin{align}
	0&=\boldsymbol z'\boldsymbol W_C\boldsymbol z=\int^{t_f}_0\boldsymbol z'e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol zdt\\
	&=\int^{t_f}_0(\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z)'(\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z)dt\\
	&=\int^{t_f}_0\|\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z \|^2dt
	\end{align}
	$$
	于是：$\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z=\boldsymbol 0,\forall t\in(0,t_f)$，等式两端同时对$t$求$k$阶导数并令$t=0$，可得
	$$
	\boldsymbol B'(\boldsymbol A')^k\boldsymbol z=\boldsymbol 0,k=0,1,2,\cdots,n-1
	$$
	于是
	$$
	\boldsymbol M'_C\boldsymbol z=
	\begin{bmatrix}\boldsymbol B'\\\boldsymbol B'\boldsymbol A'\\\vdots\\\boldsymbol B'(\boldsymbol A')^{n-1}\end{bmatrix}\boldsymbol z=\begin{bmatrix}\boldsymbol B'\boldsymbol z\\\boldsymbol B'\boldsymbol A'\boldsymbol z\\
	\vdots\\\boldsymbol B'(\boldsymbol A')^{n-1}\boldsymbol z\end{bmatrix}=\begin{bmatrix}\boldsymbol 0\\\boldsymbol 0\\\vdots\\\boldsymbol 0\end{bmatrix}=\boldsymbol 0
	$$
	此即$\boldsymbol z\in N(\boldsymbol M_C')$

	所以$N(\boldsymbol W_C)\subset N(\boldsymbol M'_C)$

	再证明$N(\boldsymbol W_C)\supset N(\boldsymbol M_c')$

	若$\boldsymbol z\in N(\boldsymbol M_C')$，即$\boldsymbol M'_C\boldsymbol z=\boldsymbol 0$ ，则
	$$
	\boldsymbol B'(\boldsymbol A')^k\boldsymbol z=\boldsymbol 0\ \ \ \ k=0,1,2,\cdots,n-1
	$$
	于是：
	$$
	\begin{align}
	\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z&=\boldsymbol B'\left(\sum\limits_{k=0}^{n-1}\alpha_k(t)(-\boldsymbol A')^k \right)\boldsymbol z\\
	&=\sum\limits_{k=0}^{n-1}(-1)^k\alpha_k(t)\boldsymbol B'(\boldsymbol A')^k\boldsymbol z=\boldsymbol 0,\forall t\in(0,t_f)
	\end{align}
	$$
	所以
	$$
	\begin{align}
	\boldsymbol W_C\boldsymbol z&=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}dt\cdot \boldsymbol z\\
	&=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B(\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z)dt=\boldsymbol 0
	\end{align}
	$$
	此即$\boldsymbol z\in N(\boldsymbol W_C)$

	所以$N(\boldsymbol W_C)\supset N(\boldsymbol M_C')$

	证毕

5. 即证
	$$
	rank(\boldsymbol M_C)=rank[\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B]=n
	$$
	充分性证明：

	已知$rank[\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B]=n$

	当$\lambda$不是$\boldsymbol A$的特征值，$|\lambda\boldsymbol I-\boldsymbol A|\neq 0\Rightarrow rank([\lambda\boldsymbol I-\boldsymbol A,\boldsymbol B])=n$

	当$\lambda$是$\boldsymbol A$的特征值，$|\lambda\boldsymbol I-\boldsymbol A|=0\Rightarrow rank(\lambda\boldsymbol I-\boldsymbol A)<n$

	假设$rank([\lambda\boldsymbol I-\boldsymbol A,\boldsymbol B])<0$，则存在非0向量$\boldsymbol v$，使得
	$$
	\boldsymbol v^T[\lambda\boldsymbol I-\boldsymbol A,\boldsymbol B]=0\Rightarrow \boldsymbol v^T\boldsymbol B=0,\lambda \boldsymbol v^T=\boldsymbol v^T\boldsymbol A\\
	\Rightarrow\boldsymbol v^T\boldsymbol {AB}=\lambda\boldsymbol v^T\boldsymbol B=0\Rightarrow\boldsymbol v^T\boldsymbol A^k\boldsymbol B=0,k=0,1,2,\cdots\\
	\Rightarrow\boldsymbol v^T[\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B]=0
	$$
	得到矛盾

	必要性证明：

	已知$rank([\lambda\boldsymbol I-\boldsymbol A,\boldsymbol B])=n,\forall \lambda$

	假设$rank([\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B])<n$

	存在非0向量$\boldsymbol v$使得：

	$\boldsymbol v^T[\boldsymbol B,\boldsymbol {AB,\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B}]=0\Rightarrow \boldsymbol v^T\boldsymbol B=0,\cdots,\boldsymbol v^T\boldsymbol A^{n-1}\boldsymbol B=0$

	$\Rightarrow\boldsymbol v^T\boldsymbol A^l\boldsymbol B=0,l\geq n$ 

	$V=\{\boldsymbol v|\boldsymbol v^T\boldsymbol A^l\boldsymbol B=0,\forall l\in N\}$是一个线性空间，$V$非空

	$V$有一组基$\{\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\}$，$V=span\{\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\}$

	对任意向量$\boldsymbol v\in V$，有如下坐标展开
	$$
	\boldsymbol v=\sum\limits_{j=1}^sy_j\boldsymbol v_j=\begin{bmatrix}\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\end{bmatrix}\boldsymbol y,\boldsymbol y=\begin{bmatrix}y_1\\\vdots\\y_s\end{bmatrix}
	$$
	可以验证：$\boldsymbol v\in V$
	$$
	\boldsymbol A^T\boldsymbol v\in V,(\boldsymbol A^T\boldsymbol v)^T\boldsymbol A^l\boldsymbol B=v^T\boldsymbol A^{l+1}\boldsymbol B=0,\forall l\in N
	$$
	因此
	$$
	\begin{cases}
	\boldsymbol A^T\boldsymbol v_1=\begin{bmatrix}\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\end{bmatrix}\begin{bmatrix}z_{11}\\z_{21}\\\vdots\\z_{s1} \end{bmatrix}\\
	\boldsymbol A^T\boldsymbol v_s=\begin{bmatrix}\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\end{bmatrix}\begin{bmatrix}z_{1s}\\z_{2s}\\\vdots\\z_{ss} \end{bmatrix}
	\end{cases}
	\Rightarrow
	\begin{matrix}
	\boldsymbol A^T[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]=[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol Z\\
	Z=\begin{bmatrix}z_{11}&\cdots&z_{1s}\\\vdots&\ddots&\vdots\\z_{s1}&\cdots&z_{ss} \end{bmatrix}
	\end{matrix}
	$$
	$Z$至少有一个特征值$\alpha$和一个特征向量$\boldsymbol u$

	$\boldsymbol Z\boldsymbol u=\alpha\boldsymbol u,\boldsymbol u\neq 0$

	定义$\overline{\boldsymbol v}=[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol u，\overline{\boldsymbol v}\neq 0$
	$$
	\begin{align}
	\boldsymbol A^T\overline{\boldsymbol v}&=\boldsymbol A^T[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol u\\
	&=[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol {Zu}\\
	&=[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s](\alpha\boldsymbol u)\\
	&=\alpha[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol u\\
	&=\alpha\overline{\boldsymbol v}
	\end{align}
	$$

	$$
	\begin{align}
	\begin{cases}\overline{\boldsymbol v}\boldsymbol A=\alpha\overline{\boldsymbol v}\\ \overline{\boldsymbol v}\in V\Rightarrow\overline{\boldsymbol v}^T\boldsymbol B=0 \end{cases}
	&\Rightarrow \overline{\boldsymbol v}\begin{bmatrix}\alpha\boldsymbol I-\boldsymbol A&\boldsymbol B\end{bmatrix}=0,\overline{\boldsymbol v}\neq 0\\
	&\Rightarrow rank([\lambda \boldsymbol I-\boldsymbol A,\boldsymbol B])<n,\lambda=\alpha
	\end{align}
	$$

	因此
	$$
	rank([\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B])=n\Leftrightarrow rank([\lambda \boldsymbol I-\boldsymbol A,\boldsymbol B])=n,\forall \lambda
	$$

**吉尔伯特判别准则**

当线性非时变连续系统的系统矩阵$\pmb A$为$n$个互异特征值组成的对角线阵时，系统为完全能控的充要条件是输入矩阵$\pmb B$没有零行；若$\pmb A$为约尔当标准型，充要条件是$\pmb B$中对应每一约尔当子块的最后一行的行向量中没有零行，且对应同一特征值的这些行分别线性无关

**等价变换对能控性的影响**

线性非时变系统的能控性在代数等价变换下保持不变

*证明：*

设原系统由$\{\pmb A,\pmb B\}$描述，等价变换后系统由$\{\overline{A}=\pmb {PAP}^{-1},\overline{\pmb B}=\pmb {PB} \}$描述，$\pmb P$非奇异，由于
$$
\begin{align}
\rho[\overline{\pmb M}_c]&=\rho\begin{bmatrix}\overline{\pmb B}&\overline{\pmb A}\overline{\pmb B}&\overline{\pmb A}^2\overline{\pmb B}&\cdots&\overline{\pmb A}^{n-1}\overline{\pmb B} \end{bmatrix}\\
&=\rho\Big(\pmb P\begin{bmatrix}{\pmb B}&{\pmb A}{\pmb B}&{\pmb A}^2{\pmb B}&\cdots&{\pmb A}^{n-1}{\pmb B}\end{bmatrix}\Big)\\
&=\rho\begin{bmatrix}{\pmb B}&{\pmb A}{\pmb B}&{\pmb A}^2{\pmb B}&\cdots&{\pmb A}^{n-1}{\pmb B}\end{bmatrix}\\
&=\rho[\pmb M_c]
\end{align}
$$

#### 5.1.4. 能控标准型

单输入系统$\dot{\boldsymbol x}=\boldsymbol A_C\boldsymbol x+\boldsymbol b_c\boldsymbol u$，若矩阵对$(\boldsymbol A_C,\boldsymbol b_C)$具有如下标准形式：
$$
\boldsymbol A_c=\begin{bmatrix}0&1&0&\cdots&0\\
0&0&1&\cdots&0\\
\vdots&\vdots&\vdots&\ddots&\vdots\\
0&0&0&\cdots&1\\
-\alpha_0&-\alpha_1&-\alpha_2&\cdots&-\alpha_{n-1}
\end{bmatrix};\boldsymbol b_c=\begin{bmatrix}0\\0\\\vdots\\0\\1\end{bmatrix}
$$
则系统$\{\boldsymbol A_C,\boldsymbol b_C\}$称作能控标准型系统，矩阵对$(\boldsymbol A_C,\boldsymbol b_C)$称作能控标准型

单输入系统能控的充要条件是：存在一个线性变换，可将系统变换为能控标准型系统  

**常见形式的能控标准型：**
$$
\begin{matrix}
\begin{matrix}
\boldsymbol A_c=\begin{bmatrix}0&1&0&\cdots&0\\
0&0&1&\cdots&0\\
\vdots&\vdots&\vdots&\ddots&\vdots\\
0&0&0&\cdots&1\\
-\alpha_0&-\alpha_1&-\alpha_2&\cdots&-\alpha_{n-1}
\end{bmatrix};\boldsymbol b_c=\begin{bmatrix}0\\0\\\vdots\\0\\1\end{bmatrix}\\
下友型能控标准型
\end{matrix}
&
\begin{matrix}
\boldsymbol A_c=\begin{bmatrix}
0&0&\cdots&0&-\alpha_0\\
1&0&\cdots&0&-\alpha_1\\
0&1&\cdots&0&-\alpha_2\\
\vdots&\vdots&\ddots&\vdots&\vdots\\
0&0&\cdots&1&-\alpha_{n-1}
\end{bmatrix};\boldsymbol b_c=\begin{bmatrix}1\\0\\\vdots\\0\\0\end{bmatrix}\\
右友型能控标准型
\end{matrix}
\\
\begin{matrix}
\boldsymbol A_c=\begin{bmatrix}
-\alpha_{n-1}&-\alpha_{n-2}&\cdots&-\alpha_1&-\alpha_0\\
1&0&\cdots&0&0\\
0&1&\cdots&0&0\\
\vdots&\vdots&\ddots&\vdots&\vdots\\
0&0&\cdots&1&0
\end{bmatrix};\boldsymbol b_c=\begin{bmatrix}1\\0\\\vdots\\0\\0\end{bmatrix}\\
上友型能控标准型
\end{matrix}
&
\begin{matrix}
\boldsymbol A_c=\begin{bmatrix}
-\alpha_{n-1}&1&0&\cdots&0\\
-\alpha_{n-2}&0&1&\cdots&0\\
\vdots&\vdots&\vdots&\ddots&\vdots\\
-\alpha_1&0&0&\cdots&1\\
-\alpha_0&0&0&\cdots&0
\end{bmatrix};\boldsymbol b_c=\begin{bmatrix}0\\0\\\vdots\\0\\1\end{bmatrix}\\
左友型能控标准型
\end{matrix}
\end{matrix}
$$
**右友型能控标准型的求取方法**

令
$$
\pmb Q=\begin{bmatrix}\pmb b&\pmb {Ab}&\pmb {A}^2\pmb b&\cdots&\pmb A^{n-1}\pmb b\end{bmatrix}
$$
解：
$$
\pmb v^T=\begin{bmatrix}0&0&0&1\end{bmatrix}\begin{bmatrix}\pmb b&\pmb {Ab}&\pmb A^2\pmb b&\pmb A^3\pmb b\end{bmatrix}^{-1}
$$
构造变换矩阵：
$$
\pmb P=\begin{bmatrix}
\pmb v^T\\
\pmb v^T\pmb A\\
\pmb v^T\pmb A^2\\
\pmb v^T\pmb A^3
\end{bmatrix}
$$
做等价变换$\overline{\pmb A}=\pmb P\pmb {AP}^{-1}$和$\overline{\pmb b}=\pmb P\pmb b$ ，即可得到右友型能控标准型

#### 5.1.5. 输出能控性

**定义：系统的输出能控性**

对系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$，若存在一个有限时间$t_f>0$，及控制函数
$$
\boldsymbol u(t)=\overline{\boldsymbol u}(t),t\in[0,t_f]
$$
能够把系统的输出从任一初始输出$\boldsymbol y(0)=\boldsymbol y_1$推向$t_f$时刻的任意指定输出$\boldsymbol y(t_f)=\boldsymbol y_2$，则称该系统是输出能控的

**定理：系统输出能控的条件**

系统输出能控的充要条件为系统的输出能控性矩满秩
$$
\boldsymbol M_{Cy}=\begin{bmatrix}\boldsymbol D&\boldsymbol {CB}&\boldsymbol {CAB}&\cdots&\boldsymbol C \boldsymbol A^{n-1}\boldsymbol B \end{bmatrix}=\begin{bmatrix}\boldsymbol D&\boldsymbol C\boldsymbol M_C\end{bmatrix}
$$

### 5.2. 能观性与能构性

#### 5.2.1. 能观性和能构性的概念

假设系统初始状态$\pmb x(t_0)=\hat{\pmb x}$，$\forall \hat{\pmb x}\in X$，若依据有限时间区间$J$内所测得的$\pmb y_J$和外加的$\pmb u_J$能够确定出系统初态$\pmb x(t_0)$ 

**能观系统**

若$J$是$t_0$开始以后的区间，称系统在$t_0$时刻完全能观，简称为能观系统，否则为不能观系统

**能控系统**

若$J$是$t_0$以前到$t_0$的区间，称系统在$t_0$时刻完全能构，简称为能构系统，否则为不能构系统

#### 5.2.2. 线性时变连续系统的能观性

**能观性格拉姆矩阵判别法**

线性时变连续系统$\{\pmb A(t),\pmb C(t) \}$在$t_0$时刻完全能观的充要条件是$\pmb C(t)\pmb \Phi(t,t_0)$在有限时间区间$[t_0,t]$内列线性无关，即能观格兰姆矩阵非奇异

*证明：*

充分性

因为
$$
\pmb y_{zi}(t)=\pmb C(t)\pmb \Phi(t,t_0)\pmb x(t_0)
$$
对等式两边乘以$\pmb \Phi^*(t,t_0)\pmb C^*(t)$并在$[t_0,t_1]$内积分
$$
\int_{t_0}^{t_1}\pmb \Phi^*(t,t_0)\pmb C^*(t)\pmb y_{zi}(t)\mathrm dt=\int_{t_0}^{t_1}\pmb \Phi^*(t,t_0)\pmb C^*(t)\pmb C(t)\pmb \Phi(t,t_0)\pmb x(t_0)\mathrm dt
$$
规定能观性格拉姆矩阵为
$$
\pmb W_o(t_0,t_1)\mathop=\limits^{def}\int_{t_0}^{t_1}[\pmb C(t)\pmb \Phi(t,t_0)]^*[\pmb C(t)\pmb \Phi(t,t_0)]\mathrm dt
$$
由前定理知$\pmb W_o(t_0,t_1)$非奇异$\Leftrightarrow\pmb C(t)\pmb \Phi(t,t_0)$的$n$列在$[t_0,t_1]$内线性无关，可由前式得到
$$
\pmb x(t_0)=\pmb W_o^{-1}(t_0,t_1)\int_{t_0}^{t_1}\pmb \Phi^*(t,t_0)\pmb C^*(t)\pmb y_{zi}(t)\mathrm dt
$$
即只要测量出$\pmb y_{zi[t_0,t_1]}$ 就可由上式计算$\pmb x(t_0)$

必要性

采用反证法，假设系统能观但不存在有限区间$[t_0,t_1]$使得$\pmb C(t)\pmb \Phi(t,t_0)$的$n$列线性无关。存在一个非零的$n$维列向量$\pmb \alpha$使得
$$
\pmb C(t)\pmb \Phi(t,t_0)\pmb \alpha=\pmb 0_{r\times 1},\ \ \ \ \forall t>t_0
$$
现在选择$\pmb x(t_0)=\pmb \alpha$，则
$$
\pmb y_{zi}(t)=\pmb C(t)\pmb \Phi(t,t_0)\pmb x(t_0)=\pmb 0_{r\times 1}\ \ \ \ \forall t>t_0
$$
与系统能观假设矛盾，必要性得证

**能观性矩阵判别法**

假设线性连续系统的$\pmb A(t)$和$\pmb C(t)$均是$n-1$阶连续可导的函数矩阵，则系统是$t_0$时刻完全能观系统的充分条件是
$$
\rho\begin{bmatrix}
\pmb N_0(t_1)\\
\pmb N_1(t_1)\\
\vdots\\
\pmb N_{n-1}(t_1)
\end{bmatrix}
=n,\ \ t_1>t_0
$$
其中
$$
\pmb N_0(t)=\pmb C(t),\ \ \pmb N_{k+1}(t)=\pmb N_k(t)\pmb A(t)+\frac{\mathrm d}{\mathrm dt}\pmb N_{k}(t),\ \ \ \ k=0,1,2,\cdots,n-1
$$

#### 5.2.3. 线性非时变连续系统的能观性

**线性非时变连续系统的能观性判据**

线性非时变连续系统$\{\pmb A,\pmb C\}$为完全能观系统的充要条件是下列等价条件的任何一个成立：

1. $\pmb Ce^{\pmb At}$的$n$列在时间区间$[0,\infty)$内线性无关

2. $\pmb C(s\pmb I-\pmb A)^{-1}$的$n$列在复数域$\pmb C$上线性无关

3. **能观性原理**

	能观性格拉姆矩阵
	$$
	\pmb W_o(t_f)=\int_0^{t_f}e^{\pmb A't}\pmb C'\pmb Ce^{\pmb At}\mathrm dt,\ \ \ \ t_f>0
	$$
	非奇异，或$\rho[\pmb W_o(t_f)]=n$ 

4. **能观性判据**

	能观性矩阵
	$$
	\pmb M_o=\begin{bmatrix}
	\pmb C\\
	\pmb {CA}\\
	\pmb C\pmb A^2\\
	\vdots\\
	\pmb {CA}^{n-1}
	\end{bmatrix}
	$$
	满秩，即$\rho[\pmb M_o]=n$

5. $n$维系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$能观的充要条件是：对系统矩阵$\boldsymbol A$的每个特征值$\lambda$都有
	$$
	\rho\begin{bmatrix}\lambda\boldsymbol I-\boldsymbol A\\\boldsymbol C\end{bmatrix}=n
	$$


**吉尔伯特判据**

当线性非时变连续系统的系统矩阵$\pmb A$为$n$个互异特征值组成的对角线阵时，系统为完全能观的充要条件是输出矩阵$\pmb C$没有零列；若$\pmb A$为约尔当标准型，充要条件是$\pmb C$中对应每一约尔当子块的最后一行的行向量中没有零列，且对应同一特征值的这些列分别线性无关

**等价变换对系统能观性的影响**

线性非时变连续系统$\{\pmb A(t) ,\pmb C(t) \}$的能观性在等价变换下保持不变

#### 5.2.4. 能观标准型

能控标准型系统的对偶系统是能观标准型系统，能观标准型系统的系统矩阵和输出矩阵组成的矩阵对称为能观标准型。对$n$维单输出系统$\{\boldsymbol A_o,\boldsymbol B_o,\boldsymbol c_o,\boldsymbol d_o\}$，若其中矩阵$\boldsymbol A_o$和$\boldsymbol c_o$具有如下型式：
$$
\boldsymbol A_o=\begin{bmatrix}0&0&\cdots&0&-\alpha_0\\
1&0&\cdots&0&-\alpha_1\\0&1&\cdots&0&-\alpha_2\\
\vdots&\vdots&\ddots&\vdots&\vdots\\
0&0&\cdots&1&-\alpha_{n-1}
\end{bmatrix},\boldsymbol c_o=\begin{bmatrix}0&0&\cdots&0&1\end{bmatrix}
$$
则系统$\{\boldsymbol A_o,\boldsymbol B_o,\boldsymbol c_o,\boldsymbol d_o\}$称为能观标准型系统，矩阵对$(\boldsymbol A_o,\boldsymbol c_o)$称作能观标准型

单输出系统能观的充要条件是，存在一个线性变换，将之变换成能观标准型系统

能观标准型也可分为右友型、左友型、下友型、上友型四种，它们的型式可由相应的能控标准型的对偶系统得到；

化能观系统为能观标准型系统的变换阵也可由同样方式得到  

### 5.3.线性系统状态空间结构

#### 5.3.1. 不完全能控系统的状态空间结构

**能控子空间的概念**

若线性系统不完全能控，则状态空间$X=X_c\oplus X_{\overline{c}}$，且
$$
\begin{matrix}
X_c=R[\pmb W_c(t_0,t_1)]\\
X_{\overline{c}}=N[\pmb W_c(t_0,t_1)]
\end{matrix}，\ \ \ \ 
t_1>t_0
$$
$X_c$称为能控状态子空间，$X_{\overline{c}}$称为不能控状态子空间。特别地，对于非时变连续系统，当$t_0=0$时，还有
$$
\begin{matrix}
X_c=R[\pmb W_c(0,t_1)]=R[\pmb M_c]\\
X_{\overline{c}}=N[\pmb W_c(0,t_1)]=N[\pmb M_c^T]
\end{matrix}，\ \ \ \ 
t_1>0
$$
*证明：*

简单认为$\pmb W_c(t_0,t_1)$为实函数，有
$$
\pmb W_c(t_0,t_1)=\pmb W^T(t_0,t_1)
$$
将$\pmb W_c(t_0,t_1)$视为将$X$映射为$X$的线性算子，则
$$
\begin{align}
X&=R[\pmb W_c(t_0,t_1)]\oplus R[\pmb W_c^T(t_0,t_1)]\\
&=R[\pmb W_c(t_0,t_1)]\oplus R[\pmb W_c(t_0,t_1)]
\end{align}
$$
假设$\pmb x(t_0)=\hat{\pmb x}$，$\forall \hat{\pmb x}\in R[\pmb W_c(t_0,t_1)]$，则$\exists z\in X$满足
$$
\begin{align}
\hat{\pmb x}&=\pmb W_c(t_0,t_1)\pmb z\\
&=\int_{t_0}^{t_1}[\pmb \Phi(t_0,\tau)\pmb B(\tau)][\pmb \Phi(t_0,\tau)\pmb B(\tau)]^Tz\mathrm dz
\end{align}
$$
上式说明存在某个输入函数$[\pmb \Phi(t_0,\tau)\pmb B(\tau)]^Tz$将$\pmb x(t_0)=\hat{\pmb x}$转移到$\pmb 0_x=\pmb x(t_1)$，即凡$\pmb W_c(t_0,t_1)$值域空间中的状态均为能控状态

假设$\overline{\pmb x}=\pmb x(t_0)$为任意一个能控状态，即存在输入函数$\overline{\pmb u}(t)$使得
$$
\overline{\pmb x}=\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau)\overline{\pmb u}(\tau)\mathrm d\tau
$$
另一方面，$\overline{\pmb x}=\pmb x_R\oplus \pmb x_N$，$\pmb x_R$和$\pmb x_N$分别为$\overline{\pmb x}$分解在$R[\pmb W_c(t_0,t_1)]$和$N[\pmb W_c(t_0,t_1)]$中的分量，对于$\pmb x_N$有
$$
\pmb W_c(t_0,t_1)\pmb x_N=\pmb 0_x
$$
和
$$
<\pmb x_N,\pmb W_c(t_0,t_1)\pmb x_N>=0
$$
即
$$
\begin{align}
\pmb x_N^T\pmb W_c(t_0,t_1)\pmb x_N&=\int_{t_0}^{t_1}\pmb x_N^T[\pmb \Phi(t_0,\tau)\pmb B(\tau)][\pmb \Phi(t_0,\tau)\pmb B(\tau)]^T\pmb x_N\mathrm d\tau\\
&=\int_{t_0}^{t_1} \|[[\pmb \Phi(t_0,\tau)\pmb B(\tau)]^T\pmb x_N]\|^2\mathrm d\tau=0
\end{align}
$$
所以
$$
[\pmb \Phi(t_0,\tau)\pmb B(\tau)]^T\pmb x_N=\pmb 0_{m\times 1},\ \ \ \ \forall t\in[t_0,t_1]
$$
对于$\pmb x_R$有
$$
\pmb x_R=\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau)\pmb u_R(\tau)\mathrm d\tau
$$
于是，
$$
\pmb x_N=\overline{\pmb x}-\pmb x_R=\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau) [\overline{\pmb u}(\tau)-\pmb u_R(\tau)]\mathrm d\tau
$$
和
$$
\begin{align}
\|\pmb x_N\|^2&=<\pmb x_N,\pmb x_N>=\pmb x_N^T\int_{t_0}^{t_1}\pmb \Phi(t_0,\tau)\pmb B(\tau) [\overline{\pmb u}(\tau)-\pmb u_R(\tau)]\mathrm d\tau\\
&=\int_{t_0}^{t_1}\{[\Phi(t_0,\tau)\pmb B(\tau)]^T\pmb x_N\}^T[\overline{\pmb u}(\tau)-\pmb u_R(\tau)]\mathrm d\tau\\
&=\int_{t_0}^{t_1}\pmb 0_{1\times m}[\overline{\pmb u}(\tau)-\pmb u_R(\tau)]\mathrm d\tau\\
&=0
\end{align}
$$
即
$$
\pmb x_N=\pmb 0
$$
说明任何能控的状态只处于$R[\pmb W_c(t_0,t_1)]$中。由此得到能控子空间的概念

现在分析线性非时变连续系统的情况。

由前证得对于矩阵指数，有
$$
e^{\pmb At}=\sum\limits_{k=0}^{n-1}\alpha_k(t)\pmb A^k=\mathcal L^{-1}[(s\pmb I-\pmb A)^{-1}]
$$
设$\pmb z\neq \pmb 0_x$，但$\forall \pmb z\in N[\pmb W_c(0,t_1)]$，可以证明
$$
\pmb B^Te^{-\pmb A^Tt}\pmb z=\pmb B^T\sum\limits_{k=0}^{n-1}(-1)^k\alpha_k(t)(\pmb A^T)^k\pmb z=\pmb 0_{m\times1},\ \ \ \ \forall t\in[0,\infty)
$$
因为$\alpha_k(t)$，$k=0,1,2,\cdots,n-1$在$[0,\infty)$内彼此线性无关，所以$\pmb B^T\pmb z=\pmb B^T\pmb A^T\pmb z=\cdots=\pmb B^T(\pmb A^{n-1})^T\pmb z=\pmb 0_{m\times 1}$ ，即
$$
\pmb M_c^T\pmb z=\begin{bmatrix}
\pmb B^T\\
(\pmb {AB})^T\\
\vdots\\
(\pmb A^{n-1}\pmb B)^T
\end{bmatrix}\pmb z=\pmb 0_{nm\times 1}, \ \ \ \ \pmb z\in N[\pmb M_c^T]
$$
这说明
$$
N[\pmb W_c(0,t_1)]\subseteq N[\pmb M_c^T]
$$
采用相反的思路也可证得
$$
 N[\pmb M_c^T]\subseteq N[\pmb W_c(0,t_1)]
$$
所以
$$
X_{\overline{c}}=N[\pmb W_c(0,t_1)]=N[\pmb M_c^T]
$$
最后因为
$$
\begin{align}
X&=R[\pmb W_c(0,t_1)]\oplus N[\pmb W_c(0,t_1)]\\
&=R[\pmb M_c]\oplus N[\pmb M_c^T]
\end{align}
$$
又有
$$
X_c=R[\pmb W_c(0,t_1)]=R[\pmb M_c]
$$
证毕

**能控性分解**

考虑$n$维线性系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$，当系统不能控，即
$$
\mathrm {rank}(M_C)=\mathrm{rank}(\begin{bmatrix}\boldsymbol B&\boldsymbol {AB}&\cdots&\boldsymbol {A}^{n-1}\boldsymbol B \end{bmatrix})=n_1<n
$$
时，构造$n\times n$的矩阵
$$
\boldsymbol Q:=\begin{bmatrix}\boldsymbol q_1&\boldsymbol q_2&\cdots&\boldsymbol q_{n_1} &\boldsymbol q_{n_1+1}&\cdots&\boldsymbol q_n \end{bmatrix}
$$
其中，前$n_1$列是能控性矩阵$\boldsymbol M_C$阵中的任一$n_1$个线性无关列，而剩下的列在保持$\boldsymbol Q$非奇异的前提下可任意选取。这样等价变换$\boldsymbol x=\boldsymbol Q\overline{\boldsymbol x}$可将系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$在形式上变换为
$$
\begin{bmatrix}\dot{\boldsymbol x}_c\\ \dot{\boldsymbol {x}}_\overline{c} \end{bmatrix}=\begin{bmatrix}\boldsymbol A_c&\boldsymbol A_{12}\\\boldsymbol 0&\boldsymbol A_{\overline{c}} \end{bmatrix}\begin{bmatrix}\boldsymbol x_c\\\boldsymbol x_{\overline c} \end{bmatrix}+\begin{bmatrix}\boldsymbol B_c\\\boldsymbol 0\end{bmatrix}\boldsymbol u
$$
其中$\boldsymbol A_c$是$n_1\times n_1$维的，$\boldsymbol A_c$是$(n-n_1)\times(n-n_1)$的，且变换后的$n_1$维子方程
$$
\begin{align}
\dot{\boldsymbol x}_c&=\boldsymbol A_c\boldsymbol x_c+\boldsymbol B_c\boldsymbol u\\
\boldsymbol y&=\boldsymbol C_c\boldsymbol x_c+\boldsymbol D\boldsymbol u
\end{align}
$$
是能控的，且与原系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$具有相同的传递矩阵

图示： 

<img src="https://chaphlagical.github.io/assets/images/%E8%83%BD%E6%8E%A7%E6%80%A7%E5%92%8C%E8%83%BD%E8%A7%82%E6%80%A7.assets/1.png" style="zoom:50%;" />

 #### 5.3.2. 不完全能观系统的状态空间结构

**能观子空间的概念**

若线性连续系统不完全能观，则状态空间$X=X_o\oplus X_{\overline{o}}$，且
$$
\begin{matrix}
X_{\overline{o}}=N[W_o(t_0,t_1)],\\
X_{{o}}=R[W_o(t_0,t_1)],
\end{matrix}\ \ \ \ 
t_1>t_0
$$
特别地，对于线性非时变连续系统，有
$$
\begin{matrix}
X_{\overline{o}}=N[W_o(t_0,t_1)]=N[\pmb M_o],\\
X_{{o}}=R[W_o(t_0,t_1)]=R[\pmb M^T_o],
\end{matrix}\ \ \ \ 
t_1>0
$$
$X_\overline{o}$和$X_o$分别表示不能观子空间和能观子空间

*证明：*

设系统不完全能观，$\pmb x(t_0)= \hat{\pmb x}\neq \pmb 0_x$是任意一个不能观的初态，则有$\hat{\pmb x}$产生$\pmb y_{zi}(t)=\pmb 0_y$，$\forall t\in[t_0,t_1]$，即
$$
\pmb y_{zi}(t)=\pmb C(t)\pmb \Phi(t,t_0)\hat{\pmb x}=\pmb 0_y,\ \ \ \ \forall t\in [t_0,t_1]
$$


显然
$$
X_\overline{o}=N[\pmb C(t)\pmb \Phi(t,t_0)],\ \ \ \ \forall t\in[t_0,t_1]
$$
于是
$$
X_{o}=R[(\pmb C(t)\pmb \Phi(t,t_0))^T],\ \ \ \ \forall t\in[t_0,t_1]
$$
$\pmb W_o(t_0,t_1)$与$[\pmb C(t)\pmb \Phi(t,t_0)]^T$之间秩的一致性和$\pmb W_o(t_0,t_1)$的对称性决定线性连续系统不能观结构的正确性

对于线性非时变连续系统，$\pmb y_{zi}(t)=\pmb Ce^{\pmb At}\pmb x_0$，若$\forall \pmb x_0\in\hat {\pmb x}\in X_\overline o$则
$$
\sum\limits_{k=0}^{n-1}\alpha_k(t)\pmb {CA}^k\hat{\pmb x}=\pmb 0_y, \ \ \ \ \forall \hat{\pmb x}\in X_\overline o,t\in [0,\infty)
$$
易证得
$$
\pmb M_o\hat{\pmb x}=\pmb 0_{nr\times 1},\ \ \ \ \forall \hat{\pmb x}\in X_\overline o
$$
即
$$
X_\overline o\subseteq N[\pmb M_o]
$$
反过来可证明
$$
N[\pmb M_o]\subseteq X_{\overline o}
$$
从而有
$$
X_{\overline o}=N[\pmb M_o]
$$
和
$$
X_o=R[\pmb M_o^T]
$$
**能观性分解**

考虑$n$维系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$，当系统不能观，即：
$$
\mathrm{rank}(\boldsymbol M_o)=\mathrm{rank}\begin{bmatrix}\boldsymbol C\\\boldsymbol {CA}\\\vdots\\\boldsymbol {CA}^{n-1} \end{bmatrix}=n_2<n
$$
时，通过构造$n\times n$的矩阵$\boldsymbol P$（其中前$n_2$行是$M_o$的任意$n_2$个线性无关行，剩下的各列可在保证$\boldsymbol P$非奇异的条件下任意选取）
$$
\boldsymbol P=\begin{bmatrix}\boldsymbol p_1\\\vdots\\\boldsymbol p_{n_2}\\\vdots\\\boldsymbol p_n \end{bmatrix}
$$
等价变换$\overline{\boldsymbol x}=\boldsymbol {Px}$即可将系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$在形式上变换为
$$
\begin{bmatrix}\dot{\boldsymbol x}_o\\\dot{\boldsymbol x_\overline{o}} \end{bmatrix}=
\begin{bmatrix}\boldsymbol A_o&\boldsymbol O\\\boldsymbol A_{21}&\boldsymbol A_{\overline{o}} \end{bmatrix}\begin{bmatrix}\boldsymbol x_o\\\boldsymbol x_{\overline{o}}\end{bmatrix}+\begin{bmatrix}\boldsymbol B_o\\\boldsymbol B_{\overline{o}} \end{bmatrix}\boldsymbol u\\
\boldsymbol y=\begin{bmatrix}\boldsymbol C_o&\boldsymbol O\end{bmatrix}\begin{bmatrix}\boldsymbol x_o\\\boldsymbol x_{\overline{o}}\end{bmatrix}+\boldsymbol {Du}
$$
其中，$\boldsymbol A_o$是$n_2\times n_2$矩阵，$A_{\overline{o}}$是$(n-n_2)\times(n-n_2)$的矩阵。变换后的$n_2$维子方程
$$
\begin{align}
\dot{\overline{\boldsymbol x}}_o&=\overline{\boldsymbol A}_o\overline{\boldsymbol x}_o+\overline{\boldsymbol B}_o\boldsymbol u\\
\boldsymbol y&=\overline{\boldsymbol C}_o\overline{\boldsymbol x}_o+\boldsymbol {Du}
\end{align}
$$
是能观的，且与原系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$具有相同的传递矩阵

图示：

<img src="https://chaphlagical.github.io/assets/images/%E8%83%BD%E6%8E%A7%E6%80%A7%E5%92%8C%E8%83%BD%E8%A7%82%E6%80%A7.assets/2.png" style="zoom:50%;" />

#### 5.3.3. 卡尔曼分解(系统结构分解定理)

每一个状态空间方程都可以通过一等价变换，变换为如下的规范形式：
$$
\begin{bmatrix}\dot{\boldsymbol x}_{co} \\\dot{\boldsymbol x}_{c\overline{o}}\\\dot{\boldsymbol x}_{\overline{c}o}\\\dot{\boldsymbol x}_{\overline{c}\overline{o}} \end{bmatrix}=\begin{bmatrix}
\overline{\boldsymbol A}_{co}&\boldsymbol O& \overline{\boldsymbol A}_{13}&\boldsymbol O\\
\overline{\boldsymbol A}_{21}&\overline{\boldsymbol A}_{c\overline{o}}&
\overline{\boldsymbol A}_{23}&\overline{\boldsymbol A}_{24}\\
\boldsymbol O&\boldsymbol O&\overline{\boldsymbol A}_{\overline{c}{o}}&\boldsymbol O\\
\boldsymbol O&\boldsymbol O&\overline{\boldsymbol A}_{43}&\overline{\boldsymbol A}_{\overline{c}\overline{o}}
\end{bmatrix}
\begin{bmatrix}{\boldsymbol x}_{co} \\{\boldsymbol x}_{c\overline{o}}\\{\boldsymbol x}_{\overline{c}o}\\{\boldsymbol x}_{\overline{c}\overline{o}}\end{bmatrix}
+
\begin{bmatrix}\boldsymbol B_{co}\\\boldsymbol B_{c\overline{o}}\\\boldsymbol O\\\boldsymbol O \end{bmatrix}\boldsymbol u\\

\boldsymbol y=\begin{bmatrix}\boldsymbol C_{co}&\boldsymbol O&\boldsymbol C_{\overline{c}o}&\boldsymbol O \end{bmatrix}
$$
其中，

* $\boldsymbol x_{co}$：能控，能观
* $\boldsymbol x_{c\overline o}$：能控，不能观
* $\boldsymbol x_{\overline{c}o}$：不能控，能观
* $\boldsymbol x_{\overline{c}\overline{o}}$：不能控，不能观

其状态方程零状态等价于既能控又能观的状态方程：
$$
\dot{\boldsymbol x}_{co}=\boldsymbol A_{co}\boldsymbol x_{co}+\boldsymbol B_{co}\boldsymbol u\\
\boldsymbol y=\boldsymbol C_{co}\boldsymbol x_{co}+\boldsymbol {Du}
$$
即传递矩阵为：
$$
\hat G(s)=\boldsymbol C_{co}(s\boldsymbol I-\boldsymbol A_{co})^{-1}\boldsymbol B_{co}+\boldsymbol D
$$

### 5.4. 能观性与能控性的比较

#### 5.4.1. 对偶性原理

把连续时间系统的能控子空间和不能控子空间以及能观子空间和不能观子空间的表达式写在一起：
$$
\begin{matrix}
X_C=R[\boldsymbol W_C(t_f)]&X_{\overline{C}}=N[\boldsymbol W_C(t_f)]&\boldsymbol W_C(t_f)=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}dt\\
X_O=R[\boldsymbol W_O(t_f)]&X_{\overline{O}}=N[\boldsymbol W_O(t_f)]&\boldsymbol W_O(t_f)=\int^{t_f}_0e^{\boldsymbol A't}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At}dt
\end{matrix}
$$
考虑两个系统的能控性和能观性：
$$
\begin{matrix}
S_1:\begin{cases}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\\boldsymbol y=\boldsymbol {Cx} \end{cases}&S_2:\begin{cases}\dot{\boldsymbol x}=-\boldsymbol A'\boldsymbol x+\boldsymbol C'\boldsymbol u\\\boldsymbol y=\boldsymbol B'\boldsymbol x \end{cases}
\end{matrix}
$$
对于$S_1$：
$$
W_{C,1}(t_f)=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}dt\\
X_{C,1}=R[W_{C,1}(t_f)]
$$
对于$S_2$：
$$
\begin{align}
W_{O,1}(t_f)&=\int^{t_f}_0e^{(-\boldsymbol A')'t}(\boldsymbol B')'(\boldsymbol B')e^{(-\boldsymbol A')t}dt\\
&=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}dt\\
&=W_{C,1}(t_f)\\
X_{O,2}&=R[W_{O,2}(t_f)]=R[W_{C,1}(t_f)]=X_{C,1}

\end{align}
$$
<img src="https://chaphlagical.github.io/assets/images/%E8%83%BD%E6%8E%A7%E6%80%A7%E5%92%8C%E8%83%BD%E8%A7%82%E6%80%A7.assets/image-20200330174414656.png" style="zoom:50%;" />

对于$S_1$：
$$
W_{O,1}(t_f)=\int^{t_f}_0e^{\boldsymbol A't}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At}dt\\
X_{O,1}=R[\boldsymbol W_{O,1}(t_f)]
$$
对于$S_2$：
$$
\begin{align}
W_{C,2}&=\int^{t_f}_0e^{-(-\boldsymbol A')t}(\boldsymbol C')(\boldsymbol C')'e^{-(-\boldsymbol A')t}dt\\
&=\int^{t_f}_0e^{\boldsymbol A't}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At}dt\\
&=W_{O,1}(t_f)\\
W_{C,2}&=R[\boldsymbol W_{C,2}(t_f)]=R[\boldsymbol W_{O,1}(t_f)]=X_{O,1}
\end{align}
$$
<img src="https://chaphlagical.github.io/assets/images/%E8%83%BD%E6%8E%A7%E6%80%A7%E5%92%8C%E8%83%BD%E8%A7%82%E6%80%A7.assets/image-20200330174855373.png" style="zoom:50%;" />

#### 5.4.2. 小结

|                 |                             能控                             |                             能观                             |
| :-------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|   格拉姆矩阵    | $\boldsymbol W_C(t_f)=\int^{t_f}_0e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A'\tau}d\tau$ | $\boldsymbol W_0(t_f)=\int^{t_f}_0e^{\boldsymbol A't}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At}dt$ |
| 能控/能观性矩阵 | $\boldsymbol M_C=\begin{bmatrix}\boldsymbol B&\boldsymbol A\boldsymbol B&\boldsymbol A^2\boldsymbol B&\cdots&\boldsymbol A^{n-1}\boldsymbol B\end{bmatrix}$ | $\boldsymbol M_O=\begin{bmatrix}\boldsymbol C\\\boldsymbol {CA}\\\vdots\\\boldsymbol {CA}^{n-1}\end{bmatrix}$ |
| 能控/能观性校验 |  $\begin{bmatrix}\lambda\pmb I-\pmb A&\pmb B\end{bmatrix}$   |  $\begin{bmatrix}\lambda\pmb I-\pmb A\\\pmb C\end{bmatrix}$  |
|  对偶(可互换)   | $\begin{cases}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\\boldsymbol y=\boldsymbol {Cx} \end{cases}$ | $\begin{cases}\dot{\boldsymbol x}=-\boldsymbol A'\boldsymbol x+\boldsymbol C'\boldsymbol u\\\boldsymbol y=\boldsymbol B'\boldsymbol x \end{cases}$ |

### 5.5. 线性离散系统的能观性和能控性

### 5.6. 作业复习