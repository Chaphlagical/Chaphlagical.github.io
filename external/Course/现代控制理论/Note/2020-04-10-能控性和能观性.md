---
title: 能控性和能观性
tags: 现代控制理论
article_header:
  type: cover
  image:
    src: /assets/images/control.png
---

<!--more-->

## 一、能控性与能达性

### (一) 能控与能达的概念

**定义：状态的能控与能达**

对某系统的一个特定状态$\overline{\boldsymbol x}$，若存在一个有限的时间段$[t_0,t_f)$，以及定义在该时间段上的控制函数$\boldsymbol u(t)=\overline{\boldsymbol  u}(t)$,$t\in[t_0,t_f)$，能够把系统从初始状态$\boldsymbol  x(t_0)=\overline{\boldsymbol x}$推向状态$\boldsymbol  x(t_f)=\boldsymbol 0$，则称该系统的这一特定状态$\overline{\boldsymbol  x}$是$t_0$时刻可控的；反过来，若存在将系统从$\boldsymbol  x(t_0)=\boldsymbol 0$推向$\boldsymbol  x(t_f)=\overline{\boldsymbol x}$的控制作用，则称状态$\overline{\boldsymbol  x}$是$t_0$时刻能达的。

**定义：状态的能控与能达（线性定常连续时间系统）**

对系统$\dot{\boldsymbol  x}=\boldsymbol  A \boldsymbol x+\boldsymbol  B\boldsymbol  u$的一个特定状态$\overline{\boldsymbol  x}$，若存在一个有限时间$t_f>0$，及控制函数$\boldsymbol  u(t)=\overline{\boldsymbol  u}(t)$，$t\in [t_0,t_f)$，能够把系统$\{\boldsymbol A,\boldsymbol B\}$从初始状态$\boldsymbol  x(0)=\overline{\boldsymbol x}$推向状态$\boldsymbol  x(t_f)=\boldsymbol  0$，则称该系统的这一特定状态$\overline{\boldsymbol x}$是能控的；反过来，如果存在将系统从$\boldsymbol x(0)=\boldsymbol  0$推向$\boldsymbol x(t_f)=\overline{\boldsymbol x}$的控制作用，则称状态$\overline{\boldsymbol x}$为能达的。

**定义：系统的能控与能达**

如果系统状态空间中的每一个状态都是能控的，则称系统是状态完全能控的或简称系统是能控的；同样，若系统的每一个状态都是能控的则称系统是状态完全能达的，或简称系统是能达的。

* 可以证明：对于连续时间系统而言，系统能控与系统能达完全等价

**定义：系统能控（回避能达的概念）**

系统称为能控的是指：对状态空间中任意初态$\boldsymbol x_1$及任意模态$\boldsymbol x_2$，存在一个输入，使得在有限时间内将$\boldsymbol x_1$转移至$\boldsymbol x_2$ 

### (二) 能控的条件

#### 1、象空间和零空间

**定义：矩阵的象空间**

$m\times n$矩阵$\boldsymbol M$的象空间是由
$$
R(\boldsymbol  M)=\{\boldsymbol y\in R^m|\boldsymbol y=\boldsymbol M\boldsymbol x,\boldsymbol x\in R^n\}
$$
定义的$m$维向量空间的子空间

**定义：矩阵的零空间**

$m\times n$矩阵$\boldsymbol M$的零空间是由
$$
N(\boldsymbol M)=\{\boldsymbol x\in R^n|\boldsymbol M\boldsymbol x=\boldsymbol 0\}
$$
定义的$n$维向量空间的子空间

零空间中的每一个元素都称为矩阵$\boldsymbol M$的化零向量

**有关结论：**

1. $N(\boldsymbol M)=R(\boldsymbol M')^{\perp}$
2. $rank(\boldsymbol M)+nullity(\boldsymbol M')=m$
3. $R(\boldsymbol M\boldsymbol M')=R(\boldsymbol  M)$
4. $N(\boldsymbol M'\boldsymbol M)=N(\boldsymbol M)$

#### 2、能控性定理

**定理：能控性定理**

对于线性定常系统$\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B\boldsymbol u$，状态$\overline{\boldsymbol x}$是能控状态的充要条件是存在有限的$t_f>0$，使该状态属于象空间$R[\boldsymbol W_C(t_f)]$，即$\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]$，其中
$$
\boldsymbol W_C(t_f)=\int^{t_f}_0e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A'\tau}d\tau
$$
称为能控格兰姆矩阵。

**充分性证明：** $\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]\Rightarrow \boldsymbol x(t_f)=\boldsymbol 0$

因$\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]$，故有向量$\boldsymbol z$满足$\overline{\boldsymbol x}=\boldsymbol W_C(t_f)\boldsymbol z$，于是，对初态$\boldsymbol x(0)=\overline{\boldsymbol x}$，只要选取输入
$$
\overline{\boldsymbol u}(t)=-\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z,t\in[0,t_f]
$$
则在$t_f$时刻，系统的状态响应是
$$
\begin{align}
\boldsymbol x(t_f)&=e^{\boldsymbol At_f}\boldsymbol x(0)+\int^{t_f}_0e^{\boldsymbol A(t_f-\tau)}\boldsymbol B\overline{\boldsymbol u}(\tau)d\tau\\
&=e^{\boldsymbol At_f}\boldsymbol x(0)+\int^{t_f}_0e^{\boldsymbol A(t_f-\tau)}\boldsymbol B(-\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol z)d\tau\\
&=e^{\boldsymbol At_f}\overline{\boldsymbol x}-e^{\boldsymbol At_f}\left(\int^{t_f}_0e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A'\tau}d\tau \right)\boldsymbol z\\
&=e^{\boldsymbol  At_f}\overline{\boldsymbol x}-e^{\boldsymbol At_f} \boldsymbol W_C(t_f)\boldsymbol z=e^{\boldsymbol At_f}\overline{\boldsymbol x}-e^{\boldsymbol At_f}\overline{\boldsymbol x}=\boldsymbol 0
\end{align}
$$
此即表明，状态$\overline{\boldsymbol x}$是能控的，充分性得证

**必要性证明：** 状态$\overline{\boldsymbol x}$能控$\Rightarrow$$\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]$($\Leftrightarrow\forall\boldsymbol v\in N[\boldsymbol W_C(t_f)],\boldsymbol v'\overline{\boldsymbol x}=0$)

若状态$\overline{\boldsymbol x}$能控，有$\boldsymbol u(\cdot)$使得
$$
\begin{align}
\boldsymbol x(t_f)&=e^{\boldsymbol At_f}\boldsymbol x(0)+\int^{t_f}_0e^{\boldsymbol A(t_f-\tau)}\boldsymbol B\boldsymbol u(\tau)d\tau\\
&=e^{\boldsymbol At_f}\left[\overline{\boldsymbol x}+\int^{t_f}_0e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol u(\tau)d\tau \right]=\boldsymbol 0
\end{align}
$$
因矩阵指数的非奇异性
$$
\int^{t_f}_0e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol u(\tau)d\tau=\boldsymbol 0
$$
对$\forall \tau\in (0,t_f)$

有：
$$
\begin{align}
0&=\boldsymbol v'\boldsymbol W_C(t_f)\boldsymbol v=\int^{t_f}_0\boldsymbol v'e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol vd\tau\\
&=\int^{t_f}_0(\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol v)'(\boldsymbol  B'e^{-\boldsymbol A'\tau}\boldsymbol v)d\tau\\
&=\int^{t_f}_0\|\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol v \|^2d\tau
\end{align}
$$
即：
$$
\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol v=0
$$
因此，
$$
\boldsymbol v'\overline{\boldsymbol x}=-\int^{t_f}_0\boldsymbol v'e^{-\boldsymbol A\tau}\boldsymbol B\boldsymbol u(\tau)d\tau=-\int^{t_f}_0[\boldsymbol B'e^{-\boldsymbol A'\tau}\boldsymbol v]\boldsymbol u(\tau)d\tau=0
$$
即若状态$\overline{\boldsymbol x}$能控，则必然有$\overline{\boldsymbol x}\in R[\boldsymbol W_C(t_f)]$ 

**推论：** 线性定常系统能控的充要条件是其能控格兰姆矩阵非奇异

**定义：能控子空间和不能控子空间**

线性系统的所有能控状态的集合（及普通的向量加法和数乘运算）构成一个子空间，称之为系统的能控子空间；能控子空间的正交补空间称为系统的不能控子空间

系统的能控子空间就是该系统能控格兰姆矩阵的象空间；而系统的不能控子空间是该系统能控格兰姆矩阵的零空间
$$
X_C=R[\boldsymbol W_C(t_f)]\\
X_\overline{C}=R[\boldsymbol W_C(t_f)]
$$

#### 3、能控性判据

**定理：能控性判据**

定义$n$维系统$\{\boldsymbol A,\boldsymbol B\}$的能控性矩阵为：
$$
\boldsymbol M_C=\begin{bmatrix}\boldsymbol B&\boldsymbol A\boldsymbol B&\boldsymbol A^2\boldsymbol B&\cdots&\boldsymbol A^{n-1}\boldsymbol B\end{bmatrix}
$$
则系统的能控子空间是：$X_C=R[\boldsymbol W_C(t_f)]=R(\boldsymbol M_C)$

系统的不能控子空间是：$X_\overline{C}=N[\boldsymbol W_C(t_f)]=N(\boldsymbol M'_C)$

**证明：**

因$\boldsymbol W_C=\boldsymbol W_C' $，且$E(\boldsymbol M_C)^{\perp}=N(\boldsymbol M_C')$，$R(\boldsymbol W_C)^{\perp}=N(\boldsymbol W_C')=N(\boldsymbol W_C)$

故只要证：$N(\boldsymbol W_C)=N(\boldsymbol M_C')\Leftrightarrow N(\boldsymbol W_C)\subset N(\boldsymbol M_C')$且$N(\boldsymbol W_C)\supset N(\boldsymbol M'_C)$

先证$N(\boldsymbol W_C)\subset N(\boldsymbol M_C')$：

设$z\in N(\boldsymbol W_C)$，则$\boldsymbol W_C\boldsymbol z=\boldsymbol 0$

当然：
$$
\begin{align}
0&=\boldsymbol z'\boldsymbol W_C\boldsymbol z=\int^{t_f}_0\boldsymbol z'e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol zdt\\
&=\int^{t_f}_0(\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z)'(\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z)dt\\
&=\int^{t_f}_0\|\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z \|^2dt
\end{align}
$$
于是：$\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z=\boldsymbol 0,\forall t\in(0,t_f)$，等式两端同时对$t$求$k$阶导数并令$t=0$，可得
$$
\boldsymbol B'(\boldsymbol A')^k\boldsymbol z=\boldsymbol 0,k=0,1,2,\cdots,n-1
$$
于是
$$
\boldsymbol M'_C\boldsymbol z=
\begin{bmatrix}\boldsymbol B'\\\boldsymbol B'\boldsymbol A'\\\vdots\\\boldsymbol B'(\boldsymbol A')^{n-1}\end{bmatrix}\boldsymbol z=\begin{bmatrix}\boldsymbol B'\boldsymbol z\\\boldsymbol B'\boldsymbol A'\boldsymbol z\\
\vdots\\\boldsymbol B'(\boldsymbol A')^{n-1}\boldsymbol z\end{bmatrix}=\begin{bmatrix}\boldsymbol 0\\\boldsymbol 0\\\vdots\\\boldsymbol 0\end{bmatrix}=\boldsymbol 0
$$
此即$\boldsymbol z\in N(\boldsymbol M_C')$

所以$N(\boldsymbol W_C)\subset N(\boldsymbol M'_C)$

再证明$N(\boldsymbol W_C)\supset N(\boldsymbol M_c')$

若$\boldsymbol z\in N(\boldsymbol M_C')$，即$\boldsymbol M'_C\boldsymbol z=\boldsymbol 0$ ，则
$$
\boldsymbol B'(\boldsymbol A')^k\boldsymbol z=\boldsymbol 0\ \ \ \ k=0,1,2,\cdots,n-1
$$
于是：
$$
\begin{align}
\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z&=\boldsymbol B'\left(\sum\limits_{k=0}^{n-1}\alpha_k(t)(-\boldsymbol A')^k \right)\boldsymbol z\\
&=\sum\limits_{k=0}^{n-1}(-1)^k\alpha_k(t)\boldsymbol B'(\boldsymbol A')^k\boldsymbol z=\boldsymbol 0,\forall t\in(0,t_f)
\end{align}
$$
所以
$$
\begin{align}
\boldsymbol W_C\boldsymbol z&=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}dt\cdot \boldsymbol z\\
&=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B(\boldsymbol B'e^{-\boldsymbol A't}\boldsymbol z)dt=\boldsymbol 0
\end{align}
$$
此即$\boldsymbol z\in N(\boldsymbol W_C)$

所以$N(\boldsymbol W_C)\supset N(\boldsymbol M_C')$

证毕

**推论：系统能控判据**

线性定常系统能控的充要条件是其能控性矩阵满秩，即：
$$
rank(\boldsymbol M_C)=rank\begin{bmatrix}\boldsymbol B&\boldsymbol A\boldsymbol B&\boldsymbol A^2\boldsymbol B&\cdots&\boldsymbol A^{n-1}\boldsymbol B\end{bmatrix}=n
$$
若$\boldsymbol B$的列秩为$m$，上式可进一步简化为：
$$
rank(\boldsymbol M_C)=rank\begin{bmatrix}\boldsymbol B&\boldsymbol A\boldsymbol B&\boldsymbol A^2\boldsymbol B&\cdots&\boldsymbol A^{n-m}\boldsymbol B\end{bmatrix}=n
$$

#### 4、能控性校验

**定理：能控性校验**

$n$维系统$\{\boldsymbol A,\boldsymbol B\}$能控的充要条件是：对系统矩阵$\boldsymbol A$的每个特征值$\lambda$都有
$$
rank[\lambda\boldsymbol I-\boldsymbol A \vdots \boldsymbol B]=n
$$
*证明：*

即证
$$
rank(\boldsymbol M_C)=rank[\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B]=n
$$
充分性证明：

已知$rank[\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B]=n$

当$\lambda$不是$\boldsymbol A$的特征值，$|\lambda\boldsymbol I-\boldsymbol A|\neq 0\Rightarrow rank([\lambda\boldsymbol I-\boldsymbol A,\boldsymbol B])=n$

当$\lambda$是$\boldsymbol A$的特征值，$|\lambda\boldsymbol I-\boldsymbol A|=0\Rightarrow rank(\lambda\boldsymbol I-\boldsymbol A)<n$

假设$rank([\lambda\boldsymbol I-\boldsymbol A,\boldsymbol B])<0$，则存在非0向量$\boldsymbol v$，使得
$$
\boldsymbol v^T[\lambda\boldsymbol I-\boldsymbol A,\boldsymbol B]=0\Rightarrow \boldsymbol v^T\boldsymbol B=0,\lambda \boldsymbol v^T=\boldsymbol v^T\boldsymbol A\\
\Rightarrow\boldsymbol v^T\boldsymbol {AB}=\lambda\boldsymbol v^T\boldsymbol B=0\Rightarrow\boldsymbol v^T\boldsymbol A^k\boldsymbol B=0,k=0,1,2,\cdots\\
\Rightarrow\boldsymbol v^T[\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B]=0
$$
得到矛盾

必要性证明：

已知$rank([\lambda\boldsymbol I-\boldsymbol A,\boldsymbol B])=n,\forall \lambda$

假设$rank([\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B])<n$

存在非0向量$\boldsymbol v$使得：

$\boldsymbol v^T[\boldsymbol B,\boldsymbol {AB,\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B}]=0\Rightarrow \boldsymbol v^T\boldsymbol B=0,\cdots,\boldsymbol v^T\boldsymbol A^{n-1}\boldsymbol B=0$

$\Rightarrow\boldsymbol v^T\boldsymbol A^l\boldsymbol B=0,l\geq n$ 

$V=\{\boldsymbol v|\boldsymbol v^T\boldsymbol A^l\boldsymbol B=0,\forall l\in N\}$是一个线性空间，$V$非空

$V$有一组基$\{\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\}$，$V=span\{\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\}$

对任意向量$\boldsymbol v\in V$，有如下坐标展开
$$
\boldsymbol v=\sum\limits_{j=1}^sy_j\boldsymbol v_j=\begin{bmatrix}\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\end{bmatrix}\boldsymbol y,\boldsymbol y=\begin{bmatrix}y_1\\\vdots\\y_s\end{bmatrix}
$$
可以验证：$\boldsymbol v\in V$
$$
\boldsymbol A^T\boldsymbol v\in V,(\boldsymbol A^T\boldsymbol v)^T\boldsymbol A^l\boldsymbol B=v^T\boldsymbol A^{l+1}\boldsymbol B=0,\forall l\in N
$$
因此
$$
\begin{cases}
\boldsymbol A^T\boldsymbol v_1=\begin{bmatrix}\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\end{bmatrix}\begin{bmatrix}z_{11}\\z_{21}\\\vdots\\z_{s1} \end{bmatrix}\\
\boldsymbol A^T\boldsymbol v_s=\begin{bmatrix}\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s\end{bmatrix}\begin{bmatrix}z_{1s}\\z_{2s}\\\vdots\\z_{ss} \end{bmatrix}
\end{cases}
\Rightarrow
\begin{matrix}
\boldsymbol A^T[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]=[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol Z\\
Z=\begin{bmatrix}z_{11}&\cdots&z_{1s}\\\vdots&\ddots&\vdots\\z_{s1}&\cdots&z_{ss} \end{bmatrix}
\end{matrix}
$$
$Z$至少有一个特征值$\alpha$和一个特征向量$\boldsymbol u$

$\boldsymbol Z\boldsymbol u=\alpha\boldsymbol u,\boldsymbol u\neq 0$

定义$\overline{\boldsymbol v}=[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol u，\overline{\boldsymbol v}\neq 0$
$$
\begin{align}
\boldsymbol A^T\overline{\boldsymbol v}&=\boldsymbol A^T[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol u\\
&=[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol {Zu}\\
&=[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s](\alpha\boldsymbol u)\\
&=\alpha[\boldsymbol v_1,\boldsymbol v_2,\cdots,\boldsymbol v_s]\boldsymbol u\\
&=\alpha\overline{\boldsymbol v}
\end{align}
$$

$$
\begin{align}
\begin{cases}\overline{\boldsymbol v}\boldsymbol A=\alpha\overline{\boldsymbol v}\\ \overline{\boldsymbol v}\in V\Rightarrow\overline{\boldsymbol v}^T\boldsymbol B=0 \end{cases}
&\Rightarrow \overline{\boldsymbol v}\begin{bmatrix}\alpha\boldsymbol I-\boldsymbol A&\boldsymbol B\end{bmatrix}=0,\overline{\boldsymbol v}\neq 0\\
&\Rightarrow rank([\lambda \boldsymbol I-\boldsymbol A,\boldsymbol B])<n,\lambda=\alpha
\end{align}
$$

因此
$$
rank([\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B])=n\Leftrightarrow rank([\lambda \boldsymbol I-\boldsymbol A,\boldsymbol B])=n,\forall \lambda
$$
**定理：线性变换不改变系统的能控性**

$\overline{\boldsymbol A}=\boldsymbol P\boldsymbol A\boldsymbol P^{-1},\overline{\boldsymbol B}=\boldsymbol P\boldsymbol B$，$\boldsymbol P$：非奇异
$$
\begin{align}
&[\overline{\boldsymbol B},\overline{\boldsymbol A}\overline{\boldsymbol B},\overline{\boldsymbol A}^2\overline{\boldsymbol B},\cdots,\overline{\boldsymbol A}^{n-1}\overline{\boldsymbol B}]=\boldsymbol P[\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B]
\end{align}
$$

$$
rank[\overline{\boldsymbol B},\overline{\boldsymbol A}\overline{\boldsymbol B},\overline{\boldsymbol A}^2\overline{\boldsymbol B},\cdots,\overline{\boldsymbol A}^{n-1}\overline{\boldsymbol B}]=rank[\boldsymbol B,\boldsymbol {AB},\boldsymbol A^2\boldsymbol B,\cdots,\boldsymbol A^{n-1}\boldsymbol B]
$$

#### 5、能控标准型

**定义：能控标准型系统与能控标准型**

单输入系统$\dot{\boldsymbol x}=\boldsymbol A_C\boldsymbol x+\boldsymbol b_c\boldsymbol u$，若矩阵对$(\boldsymbol A_C,\boldsymbol b_C)$具有如下标准形式：
$$
\boldsymbol A_c=\begin{bmatrix}0&1&0&\cdots&0\\
0&0&1&\cdots&0\\
\vdots&\vdots&\vdots&\ddots&\vdots\\
0&0&0&\cdots&1\\
-\alpha_0&-\alpha_1&-\alpha_2&\cdots&-\alpha_{n-1}
\end{bmatrix};\boldsymbol b_c=\begin{bmatrix}0\\0\\\vdots\\0\\1\end{bmatrix}
$$
则系统$\{\boldsymbol A_C,\boldsymbol b_C\}$称作能控标准型系统，矩阵对$(\boldsymbol A_C,\boldsymbol b_C)$称作能控标准型

**定理：能控标准型系统**

单输入系统能控的充要条件是：存在一个线性变换，可将系统变换为能控标准型系统  

<img src="/assets/images/能控性和能观性.assets/image-20200330180342402.png" alt="image-20200330180342402" style="zoom: 50%;" />

#### 6、输出能控性

**定义：系统的输出能控性**

对系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$，若存在一个有限时间$t_f>0$，及控制函数
$$
\boldsymbol u(t)=\overline{\boldsymbol u}(t),t\in[0,t_f]
$$
能够把系统的输出从任一初始输出$\boldsymbol y(0)=\boldsymbol y_1$推向$t_f$时刻的任意指定输出$\boldsymbol y(t_f)=\boldsymbol y_2$，则称该系统是输出能控的

**定理：系统输出能控的条件**

系统输出能控的充要条件为系统的输出能控性矩满秩
$$
\boldsymbol M_{Cy}=\begin{bmatrix}\boldsymbol D&\boldsymbol {CB}&\boldsymbol {CAB}&\cdots&\boldsymbol C \boldsymbol A^{n-1}\boldsymbol B \end{bmatrix}=\begin{bmatrix}\boldsymbol D&\boldsymbol C\boldsymbol M_C\end{bmatrix}
$$

### (三) 能达的条件

**系统的能达集合**
$$
S_r=\left\{ \boldsymbol x|\boldsymbol x=\int^{t_0}_0e^{\boldsymbol A(t_f-\tau)}\boldsymbol Bu(\tau)d\tau,\forall t_f,\forall  u(\tau) \right\}
$$

$$
S_r\subset span[\boldsymbol B,\boldsymbol {AB},\cdots,\boldsymbol A^{n-1}\boldsymbol B]
$$

$$
S_r^\perp\subset \left(span[\boldsymbol B,\boldsymbol {AB},\cdots,\boldsymbol A^{n-1}\boldsymbol B]\right)^\perp
$$

$$
S_r=R^n\Leftrightarrow rank[\boldsymbol B,\boldsymbol{AB,\cdots,\boldsymbol A^{n-1}\boldsymbol B}]=n
$$

## 二、能观性与能构性

### (一) 能观与能构的概念

**定义：状态的不能观测与不能重构**

零输入条件下，若系统在某有限时间段的输出恒为零，则称该时间段的初始状态是不能观测的；而称该时间段的末端状态是不能重构的。

**定义：系统的能观与能构**

如果系统的状态空间中没有不能观测的非零状态，则称系统是状态完全能观测的，简称系统是能观的；同样，如果状态空间中没有不能重构的非零状态，则称系统是状态完全能重构的，简称系统是能构的。

可以证明：对线性定常连续时间系统，系统的能观测性与能重构性的条件是相同的  

**定义：能观子空间和不能观子空间**

线性系统的所有不能观状态的集合（及普通的向量加法和数乘运算）构成一个子空间，称之为系统的不能观子空间；不能观子空间的正交补空间称为系统的能观子空间

**注意：**所有能观状态的集合不能构成一个线性子空间，因为其中没有零元素

### (二) 对偶性原理

#### 1、能观性定理

**定理：能观性定理**

线性定常系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$的状态$\overline{\boldsymbol x} $为不能观测的充要条件是：
$$
\overline{\boldsymbol x}\in N[\boldsymbol W_0(t_f)]
$$
其中对称阵
$$
\boldsymbol W_0(t_f)=\int^{t_f}_0e^{\boldsymbol A't}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At}dt
$$
称为系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$的能观格拉姆矩阵
$$
X_{\overline{0}}=N[\boldsymbol W_0(t_f)],X_0=R[\boldsymbol W_0(t_f)]
$$
能观性定理表明：系统的不能观子空间是该系统能观格兰姆矩阵的零空间，当然系统的能观子空间是该系统能观格兰姆矩阵的象空间  

*证明：*

必要性 $\overline{x}$不能观$\Rightarrow$$\overline{x}\in N[\boldsymbol W_0(t_f)]$

如果状态$\overline{\boldsymbol x}$不能观，则存在某有限的$t_f>0$，使
$$
\boldsymbol y(t)=\boldsymbol C\boldsymbol x(t)=\boldsymbol Ce^{\boldsymbol At}\overline{\boldsymbol x}=0,\forall t\in [0,t_f]
$$
于是
$$
\boldsymbol W_0(t_f)\overline{\boldsymbol x}=\int^{t_f}_0e^{\boldsymbol A't}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At}dt\overline{\boldsymbol x}=\int^{t_f}_0e^{\boldsymbol A;t}\boldsymbol C'\boldsymbol y(t)dt=0
$$
此即表明$\overline{\boldsymbol x}\in N[\boldsymbol W_0(t_f)]$ 

充分性 $\overline{\boldsymbol x}\in N[\boldsymbol W_0(t_f)]\Rightarrow \overline{\boldsymbol x}$不能观

因
$$
\overline{\boldsymbol x}\in N[\boldsymbol W_0(t_f)]
$$
即
$$
\boldsymbol W_0(t_f)\overline{\boldsymbol x}=0
$$
故
$$
0=\overline{\boldsymbol x}'\boldsymbol W_0(t_f)\overline{\boldsymbol x}=\int^{t_f}_0\overline{\boldsymbol x}'e^{\boldsymbol A't_f}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At_f}\overline{\boldsymbol x}dt=\int^{t_f}_0\Big\|\boldsymbol Ce^{\boldsymbol At_f}\overline{\boldsymbol x}\Big\|^2dt
$$
故当$\boldsymbol u(t)\equiv0$，$\boldsymbol x(0)=\overline{\boldsymbol x}$时，系统的输出为
$$
\boldsymbol y(t)=\boldsymbol C\boldsymbol x(t)=\boldsymbol Ce^{\boldsymbol At}\overline{\boldsymbol x}=0,\forall t\in [0,t_f]
$$
这就是状态$\overline{\boldsymbol x}$不能观的定义

**推论：** 线性系统能观的充要条件是其能观格拉姆矩阵非奇异

#### 2、对偶性原理

把连续时间系统的能控子空间和不能控子空间以及能观子空间和不能观子空间的表达式写在一起：
$$
\begin{matrix}
X_C=R[\boldsymbol W_C(t_f)]&X_{\overline{C}}=N[\boldsymbol W_C(t_f)]&\boldsymbol W_C(t_f)=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}dt\\
X_O=R[\boldsymbol W_O(t_f)]&X_{\overline{O}}=N[\boldsymbol W_O(t_f)]&\boldsymbol W_O(t_f)=\int^{t_f}_0e^{\boldsymbol A't}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At}dt
\end{matrix}
$$
考虑两个系统的能控性和能观性：
$$
\begin{matrix}
S_1:\begin{cases}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\\boldsymbol y=\boldsymbol {Cx} \end{cases}&S_2:\begin{cases}\dot{\boldsymbol x}=-\boldsymbol A'\boldsymbol x+\boldsymbol C'\boldsymbol u\\\boldsymbol y=\boldsymbol B'\boldsymbol x \end{cases}
\end{matrix}
$$
对于$S_1$：
$$
W_{C,1}(t_f)=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}dt\\
X_{C,1}=R[W_{C,1}(t_f)]
$$
对于$S_2$：
$$
\begin{align}
W_{O,1}(t_f)&=\int^{t_f}_0e^{(-\boldsymbol A')'t}(\boldsymbol B')'(\boldsymbol B')e^{(-\boldsymbol A')t}dt\\
&=\int^{t_f}_0e^{-\boldsymbol At}\boldsymbol B\boldsymbol B'e^{-\boldsymbol A't}dt\\
&=W_{C,1}(t_f)\\
X_{O,2}&=R[W_{O,2}(t_f)]=R[W_{C,1}(t_f)]=X_{C,1}

\end{align}
$$
<img src="/assets/images/能控性和能观性.assets/image-20200330174414656.png" alt="image-20200330174414656" style="zoom:50%;" />

对于$S_1$：
$$
W_{O,1}(t_f)=\int^{t_f}_0e^{\boldsymbol A't}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At}dt\\
X_{O,1}=R[\boldsymbol W_{O,1}(t_f)]
$$
对于$S_2$：
$$
\begin{align}
W_{C,2}&=\int^{t_f}_0e^{-(-\boldsymbol A')t}(\boldsymbol C')(\boldsymbol C')'e^{-(-\boldsymbol A')t}dt\\
&=\int^{t_f}_0e^{\boldsymbol A't}\boldsymbol C'\boldsymbol Ce^{\boldsymbol At}dt\\
&=W_{O,1}(t_f)\\
W_{C,2}&=R[\boldsymbol W_{C,2}(t_f)]=R[\boldsymbol W_{O,1}(t_f)]=X_{O,1}
\end{align}
$$
<img src="/assets/images/能控性和能观性.assets/image-20200330174855373.png" alt="image-20200330174855373" style="zoom:50%;" />

**对偶性原理：**

系统1：$\{\boldsymbol A,\boldsymbol B,\boldsymbol C\}$，与系统2：$\{\overline{\boldsymbol  A}=-\boldsymbol A',\overline{\boldsymbol B}=\boldsymbol C',\overline{\boldsymbol C}=\boldsymbol B' \}$，即
$$
\begin{matrix}
S_1:\begin{cases}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\\boldsymbol y=\boldsymbol {Cx} \end{cases}&S_2:\begin{cases}\dot{\boldsymbol x}=-\boldsymbol A'\boldsymbol x+\boldsymbol C'\boldsymbol u\\\boldsymbol y=\boldsymbol B'\boldsymbol x \end{cases}
\end{matrix}
$$
是一对偶系统，即：

<img src="/assets/images/能控性和能观性.assets/image-20200330175106979.png" alt="image-20200330175106979" style="zoom:50%;" />

### (三) 能观性的判定

#### 1、能观性判据

如果对于系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$，定义$n$维能观性矩阵为$\boldsymbol M_O$，则系统的不能观状态的子空间是$X_{\overline{O}}$，而系统的能观子空间是$X_O$
$$
\boldsymbol M_O=\begin{bmatrix}\boldsymbol C\\\boldsymbol {CA}\\\vdots\\\boldsymbol {CA}^{n-1}\end{bmatrix},\begin{matrix}X_{\overline{O}}=N(\boldsymbol M_O)\\X_O=R(\boldsymbol M'_O) \end{matrix}
$$
**推论：**系统能观的充要条件是其能观性矩阵满秩

#### 2、能观性校验

$n$维系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$能观的充要条件是：对系统矩阵$\boldsymbol A$的每个特征值$\lambda$都有
$$
rank\begin{bmatrix}\lambda\boldsymbol I-\boldsymbol A\\\boldsymbol C\end{bmatrix}=n
$$

#### 3、能观标准型

**定义：能观标准型系统和能观标准型**

能控标准型系统的对偶系统是能观标准型系统，能观标准型系统的系统矩阵和输出矩阵组成的矩阵对称为能观标准型。对$n$维单输出系统$\{\boldsymbol A_o,\boldsymbol B_o,\boldsymbol c_o,\boldsymbol d_o\}$，若其中矩阵$\boldsymbol A_o$和$\boldsymbol c_o$具有如下型式：
$$
\boldsymbol A_o=\begin{bmatrix}0&0&\cdots&0&-\alpha_0\\
1&0&\cdots&0&-\alpha_1\\0&1&\cdots&0&-\alpha_2\\
\vdots&\vdots&\ddots&\vdots&\vdots\\
0&0&\cdots&1&-\alpha_{n-1}
\end{bmatrix},\boldsymbol c_o=\begin{bmatrix}0&0&\cdots&0&1\end{bmatrix}
$$
则系统$\{\boldsymbol A_o,\boldsymbol B_o,\boldsymbol c_o,\boldsymbol d_o\}$称为能观标准型系统，矩阵对$(\boldsymbol A_o,\boldsymbol c_o)$称作能观标准型

**定理：能观标准型系统**

单输出系统能观的充要条件是，存在一个线性变换，将之变换成能观标准型系统

能观标准型也可分为右友型、左友型、下友型、上友型四种，它们的型式可由相应的能控标准型的对偶系统得到；

化能观系统为能观标准型系统的变换阵也可由同样方式得到  

## 三、线性系统状态空间结构

**状态空间的线性变换：**
$$
\begin{matrix}\dot{\boldsymbol x}=\boldsymbol {Ax}+\boldsymbol {Bu}\\
\boldsymbol y=\boldsymbol {Cx}+\boldsymbol {Du}
\end{matrix}
\xrightarrow[\overline{\boldsymbol x}=\boldsymbol {Px}=\boldsymbol Q^{-1}\boldsymbol x]{\boldsymbol x=\boldsymbol {Q}\overline{\boldsymbol x}} 
\begin{matrix}\dot{\overline{\boldsymbol x}}=\overline {\boldsymbol A}\overline{\boldsymbol x}+\overline{\boldsymbol B}\boldsymbol u\\
\boldsymbol y=\overline{\boldsymbol C}\overline{\boldsymbol x}+\overline{\boldsymbol D}\boldsymbol u
\end{matrix}\\

\begin{matrix}\overline{\boldsymbol A}=\boldsymbol Q^{-1}\boldsymbol {AQ}&\overline{\boldsymbol B}=\boldsymbol Q^{-1}\boldsymbol B\\\overline{\boldsymbol C}=\boldsymbol {CQ}&\overline{\boldsymbol D}=\boldsymbol D \end{matrix}
\ \ \boldsymbol P=\boldsymbol Q^{-1}\ \ \begin{matrix}\overline{\boldsymbol A} =\boldsymbol {PA}\boldsymbol P^{-1}&\overline{\boldsymbol B}=\boldsymbol {PB}\\
\overline{\boldsymbol C}=\boldsymbol C\boldsymbol P^{-1}&\overline{\boldsymbol D}=\boldsymbol D
\end{matrix}
$$

### (一) 能控性分解

考虑$n$维线性系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$，当系统不能控，即
$$
\mathrm {rank}(M_C)=\mathrm{rank}(\begin{bmatrix}\boldsymbol B&\boldsymbol {AB}&\cdots&\boldsymbol {A}^{n-1}\boldsymbol B \end{bmatrix})=n_1<n
$$
时，构造$n\times n$的矩阵
$$
\boldsymbol Q:=\begin{bmatrix}\boldsymbol q_1&\boldsymbol q_2&\cdots&\boldsymbol q_{n_1} &\boldsymbol q_{n_1+1}&\cdots&\boldsymbol q_n \end{bmatrix}
$$
其中，前$n_1$列是能控性矩阵$\boldsymbol M_C$阵中的任一$n_1$个线性无关列，而剩下的列在保持$\boldsymbol Q$非奇异的前提下可任意选取。这样等价变换$\boldsymbol x=\boldsymbol Q\overline{\boldsymbol x}$可将系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$在形式上变换为
$$
\begin{bmatrix}\dot{\boldsymbol x}_c\\ \dot{\boldsymbol {x}}_\overline{c} \end{bmatrix}=\begin{bmatrix}\boldsymbol A_c&\boldsymbol A_{12}\\\boldsymbol 0&\boldsymbol A_{\overline{c}} \end{bmatrix}\begin{bmatrix}\boldsymbol x_c\\\boldsymbol x_{\overline c} \end{bmatrix}+\begin{bmatrix}\boldsymbol B_c\\\boldsymbol 0\end{bmatrix}\boldsymbol u
$$
其中$\boldsymbol A_c$是$n_1\times n_1$维的，$\boldsymbol A_c$是$(n-n_1)\times(n-n_1)$的，且变换后的$n_1$维子方程
$$
\dot{\boldsymbol x}_c=\boldsymbol A_c\boldsymbol x_c+\boldsymbol B_c\boldsymbol u\\
\boldsymbol y=\boldsymbol C_c\boldsymbol x_c+\boldsymbol D\boldsymbol u
$$
是能控的，且与原系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$具有相同的传递矩阵

### (二) 规范分解

#### 1、能观性分解

考虑$n$维系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$，当系统不能观，即：
$$
\mathrm{rank}(\boldsymbol M_o)=\mathrm{rank}\begin{bmatrix}\boldsymbol C\\\boldsymbol {CA}\\\vdots\\\boldsymbol {CA}^{n-1} \end{bmatrix}=n_2<n
$$
时，通过构造$n\times n$的矩阵$\boldsymbol P$（其中前$n_2$行是$O$的任意$n_2$个线性无关行，剩下的各列可在保证$\boldsymbol P$非奇异的条件下任意选取）
$$
\boldsymbol P=\begin{bmatrix}\boldsymbol p_1\\\vdots\\\boldsymbol p_{n_2}\\\vdots\\\boldsymbol p_n \end{bmatrix}
$$
等价变换$\overline{\boldsymbol x}=\boldsymbol {Px}$即可将系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$在形式上变换为
$$
\begin{bmatrix}\dot{\boldsymbol x}_o\\\dot{\boldsymbol x_\overline{o}} \end{bmatrix}=
\begin{bmatrix}\boldsymbol A_o&\boldsymbol O\\\boldsymbol A_{21}&\boldsymbol A_{\overline{o}} \end{bmatrix}\begin{bmatrix}\boldsymbol x_o\\\boldsymbol x_{\overline{o}}\end{bmatrix}+\begin{bmatrix}\boldsymbol B_o\\\boldsymbol B_{\overline{o}} \end{bmatrix}\boldsymbol u\\
\boldsymbol y=\begin{bmatrix}\boldsymbol C_o&\boldsymbol O\end{bmatrix}\begin{bmatrix}\boldsymbol x_o\\\boldsymbol x_{\overline{o}}\end{bmatrix}+\boldsymbol {Du}
$$
其中，$\boldsymbol A_o$是$n_2\times n_2$矩阵，$A_{\overline{o}}$是$(n-n_2)\times(n-n_2)$的矩阵。变换后的$n_2$维子方程
$$
\dot{\overline{\boldsymbol x}}_o=\overline{\boldsymbol A}_o\overline{\boldsymbol x}_o+\overline{\boldsymbol B}_o\boldsymbol u\\
\boldsymbol y=\overline{\boldsymbol C}_o\overline{\boldsymbol x}_o+\boldsymbol {Du}
$$
是能观的，且与原系统$\{\boldsymbol A,\boldsymbol B,\boldsymbol C,\boldsymbol D\}$具有相同的传递矩阵

#### 2、规范分解（卡尔曼分解）

每一个状态空间方程都可以通过一等价变换，变换为如下的规范形式：
$$
\begin{bmatrix}\dot{\boldsymbol x}_{co} \\\dot{\boldsymbol x}_{c\overline{o}}\\\dot{\boldsymbol x}_{\overline{c}o}\\\dot{\boldsymbol x}_{\overline{c}\overline{o}} \end{bmatrix}=\begin{bmatrix}
\overline{\boldsymbol A}_{co}&\boldsymbol O& \overline{\boldsymbol A}_{13}&\boldsymbol O\\
\overline{\boldsymbol A}_{21}&\overline{\boldsymbol A}_{c\overline{o}}&
\overline{\boldsymbol A}_{23}&\overline{\boldsymbol A}_{24}\\
\boldsymbol O&\boldsymbol O&\overline{\boldsymbol A}_{\overline{c}{o}}&\boldsymbol O\\
\boldsymbol O&\boldsymbol O&\overline{\boldsymbol A}_{43}&\overline{\boldsymbol A}_{\overline{c}\overline{o}}
\end{bmatrix}
\begin{bmatrix}{\boldsymbol x}_{co} \\{\boldsymbol x}_{c\overline{o}}\\{\boldsymbol x}_{\overline{c}o}\\{\boldsymbol x}_{\overline{c}\overline{o}}\end{bmatrix}
+
\begin{bmatrix}\boldsymbol B_{co}\\\boldsymbol B_{c\overline{o}}\\\boldsymbol O\\\boldsymbol O \end{bmatrix}\boldsymbol u\\

\boldsymbol y=\begin{bmatrix}\boldsymbol C_{co}&\boldsymbol O&\boldsymbol C_{\overline{c}o}&\boldsymbol O \end{bmatrix}
$$
其中，

* $\boldsymbol x_{co}$：能控，能观
* $\boldsymbol x_{c\overline o}$：能控，不能观
* $\boldsymbol x_{\overline{c}o}$：不能控，能观
* $\boldsymbol x_{\overline{c}\overline{o}}$：不能控，不能观

其状态方程零状态等价于既能控又能观的状态方程：
$$
\dot{\boldsymbol x}_{co}=\boldsymbol A_{co}\boldsymbol x_{co}+\boldsymbol B_{co}\boldsymbol u\\
\boldsymbol y=\boldsymbol C_{co}\boldsymbol x_{co}+\boldsymbol {Du}
$$
即传递矩阵为：
$$
\hat G(s)=\boldsymbol C_{co}(s\boldsymbol I-\boldsymbol A_{co})^{-1}\boldsymbol B_{co}+\boldsymbol D
$$

#### 3、能稳定性与能检测性

若系统的不能控子系统是稳定的，则称该系统是能稳定系统，也叫能镇定系统；同样，若系统的不能观子系统是稳定的，则称该系统是能检测系统  

#### 4、系统的能控能观性与传递矩阵的关系

若系统是不能控或不能观的，则系统的既约传递函数之分母的阶数一定小于系统的维数。即出现了零极点对消  

## 四、线性离散系统的能控性和能观性

### (一) 能控、能达、能观、能构的概念

#### 1、状态的能控与能达

对某系统的一个特定状态$\overline{\boldsymbol x}$，若存在一个有限的时间段$[t_0,t_f)$，以及定义在该时间段上的控制函数$\boldsymbol u(t)=\overline{\boldsymbol u}(t)$，$t\in [t_0,t_f)$，能够把系统从初始状态$\boldsymbol x(t_0)=\overline{\boldsymbol x}$推向状态$\boldsymbol x(t_f)=\boldsymbol 0$，则称该系统的这一特定状态$\overline{\boldsymbol x}$是$t_0$时刻能控的；反过来，若存在将系统从$\boldsymbol x(t_0)=\boldsymbol 0$推向$\boldsymbol x(t_f)=\overline{\boldsymbol x}$的控制作用，则称状态$\overline{\boldsymbol x}$是$t_0$时刻能达的

#### 2、系统的能控与能达

如果系统状态空间中的每一个状态都是能控的，则称系统是状态完全能控的或简称系统是能控的；同样，若系统的每一个状态都是能达的，则称系统是状态完全能达的，或简称系统是能达的

#### 3、能控子空间和不能控子空间

线性系统的所有能控状态集合（及普通的向量加法数乘运算）构成一个子空间，称为系统的能控子空间；能控子空间的正交补空间称为系统的不能控子空间

#### 4、状态的不能观测与不能重构

零输入条件下，若系统再某有限时间段的输出恒为零，则称该时间段的初始状态是不能观测的；而称该时间段的末端状态是不能重构的

#### 5、系统的能观与能构

如果系统的状态空间中没有不能观测的非零状态，则称系统是状态完全能观测的，简称系统是能观的；同样，如果状态空间中没有不能重构的非零状态，则称系统是状态完全能重构的，简称系统是能构的

#### 6、能观子空间和不能观子空间 

线性系统的所有不能观状态的集合（及普通的向量加法和数乘运算）构成一个字空间，称之为系统的不能观子空间；不能观子空间的正交补空间称为系统的能观子空间

### (二) 离散时间系统能控与能达判据

定义$n$维离散时间系统$\boldsymbol x[k+1]=\boldsymbol F\boldsymbol x[k]+\boldsymbol {Hu}[k]$的$j$步能控性矩阵为
$$
\boldsymbol M_{cdj}=\begin{bmatrix}\boldsymbol H&\boldsymbol {FH}&\cdots&\boldsymbol F^{j-1}\boldsymbol H \end{bmatrix}
$$
则该系统$j$步能达的充要条件是矩阵$\boldsymbol M_{cdj}$满秩，而系统$j$步能控的充要条件是
$$
R(\boldsymbol M_{cdj})\supseteq R(\boldsymbol F^n)
$$
当且仅当系统矩阵$\boldsymbol F $满秩时，离散时间系统的能控性与能达性完全等价  

能观与能构的判据可以借助于对偶原理得到，注意：能观与能达对偶，能构与能控对偶

### (三) 离散化系统的能控性

**定理：连续—离散**

若连续时间线性定常状态方程是不能控的，则对任何采样周期，其离散化的状态方程总是不能控的

**定理：离散化能控充分条件**

若连续时间线性定常系统$\{\boldsymbol A,\boldsymbol B\}$是能控的，且系统的特征值集合为$\{\lambda_i,i=1,2,\cdots,n\}$，则在采样周期为$T$时的离散化方程$\{\boldsymbol F,\boldsymbol H\}$能控的充分条件是：

当$\mathrm{Re}[\lambda_i-\lambda_j]=0$时，$|\mathrm{Im}(\lambda_i-\lambda_j)|\neq\frac{2\pi m}{T}\ \ m=1,2,\cdots$

对单输入情况，此条件也是必要的