---
title: 二次型指标的线性最优控制
tags: 现代控制理论
article_header:
  type: cover
  image:
    src: /assets/images/control.png
---

<!--more-->

## 一、最优跟踪问题

**运动方程：**
$$
\begin{align}\dot{\pmb x}(t)&=\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t)\\\pmb y(t)&=\pmb C\pmb x(t)\end{align}
$$
**边界条件：**
$$
\pmb x(t_0)=\pmb x_0
$$
**控制约束：**
$$
控制\pmb u(\cdot)无约束
$$
**性能指标：**
$$
J=\pmb e^T(t_f)\pmb F\pmb e(t_f)+\int_{t_0}^{t_f}[\pmb e^T(t)\pmb Q(t)\pmb e(t)+\pmb u^T(t)\pmb R(t)\pmb u(t)]\mathrm dt
$$
其中，$\pmb e(t)=\pmb y_l(t)-\pmb y(t),\pmb F\geq \pmb 0,\pmb Q(t)\geq \pmb 0,\pmb R(t)\geq \pmb 0$

* 末项值：$J_1=\pmb e^T(t_f)\pmb F\pmb e(t_f)$
	* 末态误差向量尽可能小
* 第一过程量：$J_2=\int_{t_0}^{t_f}\pmb e^T(t)\pmb Q(t)\pmb e(t)\mathrm dt$ 
	* 动态跟踪误差的总度量
* 第二过程量：$J_3=\int_{t_0}^{t_f}\pmb u^T(t)\pmb R(t)\pmb u(t)\mathrm dt$ 
	* 控制能量消耗的总度量

## 二、有限时间状态调节器

### (一) 问题的描述

**运动方程：**
$$
\begin{align}\dot{\pmb x}(t)&=\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t)\\\pmb y(t)&=\pmb C\pmb x(t)\end{align}
$$
**边界条件：**
$$
\pmb x(t_0)=\pmb x_0,末端时刻t_f固定、有限
$$
**控制约束：**
$$
控制\pmb u(\cdot)无约束
$$
**性能指标：**
$$
J=\pmb x^T(t_f)\pmb F\pmb x(t_f)+\int_{t_0}^{t_f}[\pmb x^T(t)\pmb Q(t)\pmb x(t)+\pmb u^T(t)\pmb R(t)\pmb u(t)]\mathrm dt
$$
其中，对称阵$\pmb F\geq \pmb 0,\pmb Q(t)\geq \pmb 0,\pmb R(t)\geq \pmb 0$且具有相应的维数，各元连续且有界

### (二) 最优解

**最优控制：**
$$
\pmb u^*(t)=-\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)\pmb x(t)
$$
其中，$\pmb P\geq \pmb 0$，为黎卡提矩阵微分方程：
$$
\dot{\pmb P}(t)+\pmb P(t)\pmb A(t)+\pmb A^T(t)\pmb P(t)-\pmb P(t)\pmb B(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)+\pmb Q(t)=\pmb 0
$$
**最优轨线：**
$$
\dot{\pmb x}(t)=[\pmb A(t)-\pmb B(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)]\pmb x(t),\pmb x(t_0)=\pmb x_0
$$
**最优性能指标：**
$$
J^*=\pmb x^T(t_0)\pmb P(t_0)\pmb x(t_0)
$$

### (三) 有限时间状态调节器最优解的证明

#### 1、用极小值原理证明最优控制

哈密顿函数：$H=[\pmb x^T\pmb Q\pmb x+\pmb u^T\pmb R\pmb u]+{\pmb \lambda}^T[\pmb{Ax}+\pmb {Bu}]$ 

协态方程：$\dot{{\pmb \lambda}}=-\frac{\partial H}{\partial \pmb x}=-2\pmb{Qx}-\pmb A^T\lambda$ 

横截条件：${\pmb \lambda}(t_f)=\frac{\partial }{\partial \pmb x(t_f)}[\pmb x^T(t_f)\pmb F\pmb x(t_f)]=2\pmb F\pmb x(t_f)$  

极值条件：$\frac{\partial H}{\partial \pmb u}=2\pmb{Ru}+\pmb B^T\lambda$
$$
\frac{\partial^2 H}{\partial \pmb u\partial \pmb u^T}=2\pmb R>\pmb 0\Rightarrow \pmb u^*(t)=-\frac{1}{2}\pmb R^{-1}(t)\pmb B^T(t)\lambda(t)
$$

$$
H=[\pmb x^T(t)\pmb Q(t)\pmb x(t)+\pmb u^T(t)\pmb R(t)\pmb u(t)]+\lambda^T(t)[\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t)]
$$

$$
\begin{matrix}
\dot {\pmb x}=\pmb {Ax}+\pmb {Bu}&\dot{\lambda}=-2\pmb {Qx}-\pmb A^T\lambda&\pmb u^*=-\frac{1}{2}\pmb R^{-1}\pmb B^T\lambda

\end{matrix}
$$

注意到，在最优控制条件下，增广状态与协态向量满足：
$$
\begin{matrix}
\frac{\mathrm d}{\mathrm dt}\begin{bmatrix}\pmb x(t)\\\pmb\lambda(t)\end{bmatrix}
=
\begin{bmatrix}\pmb A&-\frac{1}{2}\pmb{BR}^{-1}\pmb B^T\\-2\pmb Q&-\pmb A^T \end{bmatrix}\begin{bmatrix}\pmb x(t)\\\pmb \lambda(t)\end{bmatrix}\\
\Downarrow\\
\begin{bmatrix}\pmb x(t_f)\\\pmb\lambda(t_f)\end{bmatrix}
=
\pmb \Omega(t_f,t)\begin{bmatrix}\pmb x(t)\\\pmb\lambda(t)\end{bmatrix}&\Leftarrow& \pmb \Omega(t_f,t)=\begin{bmatrix}\pmb \Omega_{11}(t_f,t)&\pmb \Omega_{12}(t_f,t)\\\pmb \Omega_{12}(t_f,t)&\pmb \Omega_{22}(t_f,t) \end{bmatrix}\\
\Downarrow\\
\begin{matrix}
\pmb x(t_f)=\pmb \Omega_{11}(t_f,t)\pmb x(t)+\pmb \Omega_{12}(t_f,t)\pmb \lambda(t)\\
\pmb \lambda(t_f)=\pmb \Omega_{21}(t_f,t)\pmb x(t)+\pmb \Omega_{22}(t_f,t)\pmb \lambda(t)
\end{matrix}
&\Leftarrow&
\pmb \lambda(t_f)=2\pmb {Fx}(t_f)
\end{matrix}
$$

得
$$
\pmb \lambda(t)=[\pmb \Omega_{22}(t_f,t)-2\pmb {F\Omega}_{12}(t_f,t)]^{-1}[2\pmb {F\Omega}_{11}(t_f,t)-\pmb \Omega_{21}(t_f,t)]\pmb x(t)\\
\Downarrow\\
\pmb \lambda(t)=2\pmb P(t)\pmb x(t),\pmb P(t_f)=\pmb F\\
\Downarrow \pmb u^*(t)=-\frac{1}{2}\pmb R^{-1}\pmb B^T\lambda\\
\pmb u^*(t)=-\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)\pmb x(t)
$$
代入状态方程：
$$
\dot{\pmb x}=[\pmb A-\pmb {BR}^{-1}\pmb B^T\pmb P]\pmb x
$$
代入横截方程：
$$
\pmb P(t_f)=\pmb F
$$
代入协态方程：
$$
2\dot{\pmb P}\pmb x+2\pmb P\pmb{\dot x}=-2\pmb {Qx}-\pmb A^T\cdot 2\pmb{Px}\\
\dot{\pmb P}\pmb x+\pmb P(\pmb A-\pmb {BR}^{-1}\pmb B^T\pmb P)\pmb x=-\pmb {Qx}-\pmb{A}^T\pmb{Px}\\
(\dot{\pmb P}+\pmb{PA}-\pmb{PBR}^{-1}\pmb B^T\pmb P+\pmb Q+\pmb A^T\pmb P)\pmb x(t)=\pmb 0
$$
注意到$\pmb x(t)$的独立性，可得$\pmb P(t)$应满足的黎卡提方程：
$$
\dot{\pmb P}(t)+\pmb P(t)\pmb A(t)+\pmb A^T(t)\pmb P(t)-\pmb P(t)\pmb B(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)+\pmb Q(t)=\pmb 0\\
\dot{\pmb P}+\pmb P\pmb A+\pmb A^T\pmb P-\pmb P\pmb B\pmb R^{-1}\pmb B^T\pmb P+\pmb Q=\pmb 0,\pmb P(t_f)=\pmb F
$$
这是一个有末态的非线性矩阵微分方程  

#### 2、由最优控制导出最优轨线

这是将最优控制代入状态方程的直接结果  
$$
\dot{\pmb x}(t)=\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t)\\
\pmb u^*(t)=-\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)\pmb x(t)
$$
注意到初始条件，即  
$$
\dot{\pmb x}(t)=[\pmb A(t)-\pmb B(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)]\pmb x(t),\pmb x(t_0)=\pmb x_0
$$

#### 3、关于最优性能指标的证明

$$
J^*=\pmb x^T(t_0)\pmb P(t_0)\pmb x(t_0)
$$

$$
\dot{\pmb x}=\pmb {Ax}+\pmb {Bu},\ \ \pmb x(t_0)=\pmb x_0,\ \ \pmb u^*=-\pmb R^{-1}\pmb B^T\pmb{Px}\\
\dot{\pmb P}+\pmb {PA}+\pmb A^T\pmb P-\pmb {PBR}^{-1}\pmb B^T\pmb P+\pmb Q=\pmb 0,\ \ \pmb P(t_f)=\pmb F
$$

定义标量函数
$$
V[\pmb x(t)]=\pmb x^T(t)\pmb P(t)\pmb x(t)
$$
对时间求导，并将状态方程、黎卡提方程代入得：
$$
\begin{align}
\frac{\mathrm dV}{\mathrm dt}&=\frac{\mathrm d}{\mathrm dt}[\pmb x^T(t)\pmb P(t)\pmb x(t)]=\dot{\pmb x}^T(t)\pmb P(t)\pmb x(t)+{\pmb x}^T(t)\dot{\pmb P}(t)\pmb x(t)+{\pmb x}^T(t)\pmb P(t)\dot{\pmb x}(t)\\
&=(\pmb {Ax}+\pmb{Bu})^T\pmb {Px}-\pmb x^T(\pmb{PA}+\pmb{A}^T\pmb P-\pmb {PBR}^{-1}\pmb B^T\pmb P+\pmb Q)\pmb x+\pmb x^T\pmb P(\pmb {Ax}+\pmb {Bu})\\
&=2\pmb x^T\pmb{PBu}+\pmb x^T(\pmb {PBR}^{-1}\pmb B^T\pmb P-\pmb Q)\pmb x\\
&=-\pmb x^T\pmb {Qx}-\pmb u^T\pmb {Ru}+(\pmb u+\pmb R^{-1}\pmb B^T\pmb {Px})^T\pmb R(\pmb u+\pmb R^{-1}\pmb B^T\pmb{Px})

\end{align}
$$
在最优轨线上，
$$
\frac{\mathrm dV}{\mathrm dt}=\frac{\mathrm d}{\mathrm dt}(\pmb x^{*T}\pmb {Px}^*)=-\pmb x^{*T}\pmb {Qx}^*-\pmb u^{*T}\pmb{Ru}^*\\
\pmb P(t_f)=\pmb F
$$

$$
J=\pmb x^T(t_f)\pmb {Fx}(t_f)+\int_{t_0}^{t_f}[\pmb x^T(t)\pmb Q(t)\pmb x(t)+\pmb u^T(t)\pmb R(t)\pmb u(t)]\mathrm dt
$$

最优指标：
$$
\begin{align}
J^*&=\pmb x^{*T}(t_f)\pmb {Fx}^*(t_f)+\int_{t_0}^{t_f}[\pmb x^T(t)\pmb Q(t)\pmb x(t)+\pmb u^T(t)\pmb R(t)\pmb u(t)]\mathrm dt\\
&=\pmb x^{*T}(t_f)\pmb {Fx}^*(t_f)-\int_{t_0}^{t_f}\frac{\mathrm d}{\mathrm dt}(\pmb x^{*T}\pmb {Px}^*)\mathrm dt\\
&=\pmb x^{*T}(t_0)\pmb {P}(t_0)\pmb{x}^*(t_0)
\end{align}
$$

## 三、无限时间状态调节器

### (一) 线性定常系统的无限时间状态调节器

**运动方程：**
$$
\dot{\pmb x}(t)=\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t)
$$
**边界条件：**
$$
\pmb x(t_0)=\pmb x_0,末端时刻t_f\rightarrow \infty
$$
**控制约束：**
$$
控制\pmb u(\cdot)无约束
$$
**性能指标：**
$$
J=\int_{t_0}^{t_f}[\pmb x^T(t)\pmb Q\pmb x(t)+\pmb u^T(t)\pmb R\pmb u(t)]\mathrm dt
$$
其中，定常加权阵$\pmb Q\geq \pmb 0,\pmb R\geq \pmb 0$且具有相应的维数
$$
J=\min\limits_{t_f\rightarrow \infty}\frac{1}{2}\int_{t_0}^{t_f}[\pmb x^T(t)\pmb Q\pmb x(t)+\pmb u^T(t)\pmb R\pmb u(t)]\mathrm dt=\lim\limits_{t_f\rightarrow \infty}J_{t_f}
$$

$$
\pmb P(t_f)=0\\
\Downarrow t_f=\infty\\
\dot{\pmb P}(t)+\pmb P(t)\pmb A(t)+\pmb A^T(t)\pmb P(t)-\pmb P(t)\pmb B(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)+\pmb Q(t)=\pmb 0\\
\Downarrow \pmb A(t)=\pmb A,\pmb B(t)=\pmb B,\pmb R(t)=\pmb R,\pmb Q(t)=\pmb Q\\
\lim\limits_{t_f\rightarrow \infty}\pmb P(t)=\pmb P,0\leq t\ll t_f\\
\Downarrow \\
\pmb{PA}+\pmb A^T\pmb P-\pmb{PBR}^{-1}\pmb B^T\pmb P+\pmb Q=\pmb 0
$$

### (二) 最优解

若系统$\{\pmb A,\pmb B\}$能控，则存在唯一的最优控制：
$$
\pmb u^*(t)=-\pmb R^{-1}\pmb B^T\pmb {Px}(t)
$$
且最优性能指标为：
$$
J^*=\pmb x^T_0\pmb{Px}_0
$$
其中，$\pmb P\geq 0$，是黎卡提矩阵代数方程：
$$
\pmb{PA}+\pmb A^T\pmb P-\pmb{PBR}^{-1}\pmb B^T\pmb P+\pmb Q=\pmb 0
$$
的唯一解

### (三) 最优解的存在性问题

**最优控制问题有解的充分条件**

系统能控是线性定常系统无限时间状态调节器问题有解的充分条件

**最优控制存在的充要条件**

性能指标中的被积函数绝对可积；或性能指标中不含系统不能控且不稳定的运动模态

### (四) 黎卡提代数方程解的正定问题

**定理**

设矩阵$\pmb P$是黎卡提矩阵代数方程
$$
\pmb{PA}+\pmb A^T\pmb P-\pmb {PBR}^{-1}\pmb B^T\pmb P+\pmb Q=\pmb0
$$
的解，则$\pmb P$正定的充要条件是：若$\pmb H^T\pmb H=\pmb Q$，则矩阵对$(\pmb A,\pmb H)$能观

### (五) 最优调节器的闭环稳定性问题

状态方程：$\dot{\pmb x}(t)=\pmb {Ax}(t)+\pmb {Bu}(t)$

最优控制：$\pmb u^*(t)=-\pmb R^{-1}\pmb B^T\pmb{Px}(t)$

其中，$\pmb P\geq \pmb 0$，且满足：
$$
\pmb{PA}+\pmb A^T\pmb P-\pmb {PBR}^{-1}\pmb B^T\pmb P+\pmb Q=\pmb0
$$
线性定常无限时间最优调节器是一个常增益状态反馈系统，其闭环方程为  
$$
\dot{\pmb x}(t)=(\pmb A-\pmb{BR}^{-1}\pmb B^T\pmb P)\pmb x(t),\pmb x(0)=\pmb x_0
$$
**定理：**

线性定常无限时间调节器渐近稳定的充分条件是：$(\pmb A,\pmb B)$能控，且若$\pmb H^T\pmb H=\pmb Q$则矩阵对$(\pmb A,\pmb H)$能观

**定理：**

线性定常无限时间最优调节器问题，非零最优控制下的闭环系统总是渐近稳定的  

### (六) 具有给定稳定裕度的状态调节器

#### 1、问题描述

**运动方程：**
$$
\dot{\pmb x}(t)=\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t)
$$
**边界条件：**
$$
\pmb x(t_0)=\pmb x_0,
$$
**控制约束：**
$$
控制\pmb u(\cdot)无约束
$$
**性能指标：**
$$
J=\int_{0}^{\infty}e^{2\alpha t}[\pmb x^T(t)\pmb Q\pmb x(t)+\pmb u^T(t)\pmb R\pmb u(t)]\mathrm dt
$$
其中，$\pmb Q\geq \pmb 0,\pmb R\geq \pmb 0$且具有相应的维数

#### 2、最优解

最优控制：$\pmb u^*(t)=-\pmb R^{-1}\pmb B^T\overline{\pmb P}\pmb x(t)$

最优性能指标：$J^*=\pmb x_0^T\overline{\pmb P}\pmb x_0$

最优闭环系统：$\dot{\pmb x}(t)=(\pmb A-\pmb{BR}^{-1}\pmb B^T\overline{\pmb P})\pmb x(t)$，$\pmb x(0)=\pmb x_0$

闭环系统稳定性：渐进稳定的，且稳定度至少为$\alpha$

**最优控制存在且唯一的充分条件：**

系统$\{\pmb A,\pmb B\}$能控，若$\pmb H^T \pmb H=\pmb Q$，$(\pmb A,\pmb H)$能观，$\overline{\pmb P}>\pmb 0$，是如下黎卡提矩阵代数方程的唯一解
$$
\overline{\pmb P}(\pmb A+\alpha\pmb I)+(\pmb A^T+\alpha\pmb I)\overline{\pmb P}-\overline{\pmb P}\pmb{BR}^{-1}\pmb B^T\overline{\pmb P}+\pmb Q=\pmb 0
$$

#### 3、化归性证明

定义：$\hat{\pmb x}(t)=e^{\alpha t}\pmb x(t)$，$\hat{\pmb u}(t)=e^{\alpha t}\pmb u(t)$

则
$$
\dot{\hat{\pmb x}}=\frac{\mathrm d}{\mathrm dt}[e^{\alpha t}\pmb x]=\alpha e^{\alpha t}\pmb x+e^{\alpha t}[\pmb{Ax}+\pmb{Bu}]=(\alpha\pmb I+\pmb A)\cdot e^{\alpha t}\pmb x+\pmb B\cdot e^{\alpha t}\pmb u
$$
即状态方程及初态变为：
$$
\dot{\hat{\pmb x}}=(\alpha\pmb I+\pmb A)\hat{\pmb x}+\pmb B\hat{\pmb u},\hat{\pmb x}(0)=\pmb x_0
$$
此时，最优性能指标变为：
$$
J=\int_{0}^{\infty}[\hat{\pmb x}^T(t)\pmb Q\hat{\pmb x}(t)+\hat{\pmb u}^T(t)\pmb R\hat{\pmb u}(t)]\mathrm dt
$$

#### 4、关于稳定度的证明

对于变量代换：

$\hat{\pmb x}(t)=e^{\alpha t}\pmb x(t)$，$\hat{\pmb u}(t)=e^{\alpha t}\pmb u(t)$ $\Rightarrow$ ${\pmb x}(t)=e^{-\alpha t}\hat{\pmb x}(t)$，${\pmb u}(t)=e^{-\alpha t}\hat{\pmb u}(t)$ 

将后一个等式代入到关于$\hat{\pmb x}$和$\hat{\pmb u}$的最优解中，可立即得到
$$
{\pmb u}(t)=e^{-\alpha t}\hat{\pmb u}^*(t)=e^{-\alpha t}(-\pmb R^{-1}\pmb B^T\overline{\pmb P}\hat{\pmb x}(t))=-e^{-\alpha t}\pmb R^{-1}\pmb B^T\overline{\pmb P}\cdot e^{\alpha t}\pmb x(t)=-\pmb R^{-1}\pmb B^T\overline{\pmb P}\pmb x(t)
$$
此外，注意到变换后的状态轨线$\hat{\pmb x}^*(t)$是渐进趋于零状态的，即
$$
\lim\limits_{t\rightarrow \infty}\hat{\pmb x}^*(t)=\lim\limits_{t\rightarrow \infty} e^{\alpha t}\pmb x^*(t)=\pmb 0
$$
它表明$\pmb x^*(t)$可以比$e^{-\alpha t}$更快的速度收敛于零，称这样的闭环系统稳定度为$\alpha$ 

## 四、离散系统状态调节器

### (一) 有限时间离散状态调节器

状态方程：$\pmb x[k+1]=\pmb A[k]\pmb x[k]+\pmb B[k]\pmb u[k]$

边界条件：$\pmb x[k_0]=\pmb x_0$，末端时刻$k_N$固定、有限

控制约束：控制$\pmb u[\cdot]$无约束

性能指标：
$$
J=\pmb x^T[k_N]\pmb {Fx}[k_N]+\sum\limits_{k=k_0}^{k_N-1}(\pmb x^T[k]\pmb Q[k]\pmb x[k]+\pmb u^T[k]\pmb R[k]\pmb u[k])
$$
其中$\pmb F\geq \pmb 0$，$\pmb Q[k]\geq \pmb 0$，$\pmb R[k]\geq \pmb 0$且具有相应的维数

### (二) 最优解

最优控制：$\pmb u[k]=-\pmb K[k]\pmb x[k]$

最优性能指标：$J^*=\pmb x_0^T\pmb P[k_0]\pmb x_0$

其中，最优反馈增益序列：
$$
\pmb K[k]=(\pmb B^T[k]\pmb P[k+1]\pmb B[k]+\pmb R[k])^{-1}\pmb B^T[k]\pmb P[k+1]\pmb A[k]\ \ k=k_0,k_0+1,k_0+2,\cdots,k_N-1
$$
而$\pmb P[k]$是下列离散黎卡提差分方程的正半定对称解
$$
\pmb P[k]=(\pmb A[k]-\pmb B[k]\pmb K[k])^T\pmb P[k+1](\pmb A[k]-\pmb B[k]\pmb K[k])+\\
\pmb K^T[k]\pmb R[k]\pmb K[k]+\pmb Q[k],\ \ \ k=k_0,k_0+1,k_0+2,\cdots,k_N-1
$$
边界条件为：$\pmb P[k_N]=\pmb F$

### (三) 最优解的求取方法

$\pmb K[k]$和$\pmb P[k]$均与$\pmb x[\cdot]$无关，均可离线计算，从而可从末态边界条件出发，依次求出$\pmb P[k]$和$\pmb K[k]$：
$$
\pmb P[k_N]=\pmb F
$$

$$
\pmb K[k]=(\pmb B^T[k]\pmb P[k+1]\pmb B[k]+\pmb R[k])^{-1}\pmb B^T[k]\pmb P[k+1]\pmb A[k]\\
\pmb P[k]=(\pmb A[k]-\pmb B[k]\pmb K[k])^T\pmb P[k+1](\pmb A[k]-\pmb B[k]\pmb K[k])+\pmb K^T[k]\pmb R[k]\pmb K[k]+\pmb Q[k]\\
k=k_0,k_0+1,k_0+2,\cdots,k_N-1
$$

更简洁的表达：
$$
\begin{align}
\pmb Z_1(k)&=\pmb Q(k)+\pmb A^T(k)\pmb P(k+1)\pmb A(k)\\
\pmb Z_2(k)&=\pmb B^T(k)\pmb P(k+1)\pmb A(k)\\
\pmb Z_3(k)&=\pmb R(k)+\pmb B^T(k)\pmb P(k+1)\pmb B(k)
\end{align}
$$

$$
\begin{align}
\pmb K(k)&=\pmb Z_3^{-1}(k)\pmb Z_2(k)\\
\pmb P(k)&=\pmb Z_1(k)-\pmb Z_2^T(k)\pmb Z_3^{-1}(k)\pmb Z_2(k)
\end{align}
$$

### (四) 无限时间离散状态调节器

状态方程：$\pmb x[k+1]=\pmb A[k]\pmb x[k]+\pmb B[k]\pmb u[k]$

边界条件：$\pmb x[k_0]=\pmb x_0$ 

控制约束：控制$\pmb u[\cdot]$无约束

性能指标：
$$
J=\sum\limits_{k=0}^{\infty}(\pmb x^T[k]\pmb Q\pmb x[k]+\pmb u^T[k]\pmb R\pmb u[k])
$$
其中$\pmb Q\geq \pmb 0$，$\pmb R\geq \pmb 0$且具有相应的维数

### (五) 无限时间离散状态调节器最优解

最优控制：$\pmb u[k]=-\pmb K\pmb x[k]$

最优性能指标：$J^*=\pmb x_0^T\pmb P\pmb x_0$

其中，最优反馈增益序列：
$$
\pmb K=(\pmb B^T\pmb{PB}+\pmb R)^{-1}\pmb B^T\pmb {PA}
$$
而$\pmb P$是下列离散黎卡提代数方程的正半定对称解
$$
\pmb P=(\pmb A-\pmb{BK})^T\pmb P(\pmb A-\pmb {BK})+\pmb K^T\pmb{RK}+\pmb Q
$$

## 五、线性最优输出调节器

### (一) 有限时间最优输出调节器

**运动方程：**
$$
\begin{align}\dot{\pmb x}(t)&=\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t)\\\pmb y(t)&=\pmb C(t)\pmb x(t)\end{align}
$$
**边界条件：**
$$
\pmb x(t_0)=\pmb x_0,末端时刻t_f固定、有限
$$
**控制约束：**
$$
控制\pmb u(\cdot)无约束
$$
**性能指标：**
$$
J=\pmb y^T(t_f)\pmb F\pmb y(t_f)+\int_{t_0}^{t_f}[\pmb y^T(t)\pmb Q(t)\pmb y(t)+\pmb u^T(t)\pmb R(t)\pmb u(t)]\mathrm dt
$$
其中，$\pmb F\geq \pmb 0,\pmb Q(t)\geq \pmb 0,\pmb R(t)\geq \pmb 0$且具有相应的维数，各元连续且有界

### (二) 有限时间输出调节器的最优解

**最优控制：**
$$
\pmb u^*(t)=-\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)\pmb x(t)
$$
其中，$\pmb P\geq \pmb 0$，为黎卡提矩阵微分方程：
$$
\dot{\pmb P}(t)+\pmb P(t)\pmb A(t)+\pmb A^T(t)\pmb P(t)-\pmb P(t)\pmb B(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)+\pmb C^T(t)\pmb Q(t)\pmb C(t)=\pmb 0
$$
在边界条件$\pmb P(t_f)=\pmb C^T(t_f)\pmb F\pmb C(t_f)$下的解

**最优轨线：**
$$
\dot{\pmb x}(t)=[\pmb A(t)-\pmb B(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)]\pmb x(t),\pmb x(t_0)=\pmb x_0
$$
**最优性能指标：**
$$
J^*=\pmb x^T(t_0)\pmb P(t_0)\pmb x(t_0)
$$

### (三) 最优输出调节器解的化归性证明

事实上，只需要把输出方程代入至性能指标的表达式中，便可立即得到：
$$
\begin{align}
J&=\pmb y^T(t_f)\pmb {Fy}(t_f)+\int_{t_0}^{t_f}[\pmb y^T(t)\pmb Q(t)\pmb y(t)+\pmb u^T(t)\pmb R(t)\pmb u(t)]\mathrm dt\\
&=\pmb x^T(t_f)\pmb C^T(t_f)\pmb {FC}(t_f)\pmb x(t_f)+\int_{t_0}^{t_f}[\pmb x^T\pmb C^T\pmb{QCx}+\pmb u^T\pmb {Ru}]\mathrm dt\\
&=\pmb x^T(t)\overline{\pmb F}\pmb x(t_f)+\int_{t_0}^{t_f}[\pmb x^T\overline{\pmb Q}\pmb x+\pmb u^T\pmb {Ru}]\mathrm dt
\end{align}
$$
其中，$\overline{\pmb F}=\pmb C^T(t_f)\pmb{FC}(t_f)$，$\overline{\pmb Q}(t)=\pmb C^T(t)\pmb Q(t)\pmb C(t)$

由于
$$
\pmb F\geq \pmb 0,\pmb Q(t)\geq \pmb 0,\pmb R(t)>0
$$
不难验证：
$$
\overline{\pmb F}\geq \pmb 0,\overline{\pmb Q}(t)\geq \pmb 0,\pmb R(t)>0
$$
的成立几乎是无条件的(只需$\pmb C$有合适的维数即可)，于是上述问题化归为由有限时间状态调节问题，它的最优解是自然的

### (四) 无限时间定常输出调节器

**运动方程：**
$$
\begin{align}\dot{\pmb x}(t)&=\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t)\\\pmb y(t)&=\pmb C\pmb x(t)\end{align}
$$
**边界条件：**
$$
\pmb x(t_0)=\pmb x_0
$$
**控制约束：**
$$
控制\pmb u(\cdot)无约束
$$
**性能指标：**
$$
J=\int_{t_0}^{t_f}[\pmb y^T\pmb Q\pmb y+\pmb u^T\pmb R\pmb u]\mathrm dt
$$
其中，$\pmb Q(t)\geq \pmb 0,\pmb R(t)\geq \pmb 0$且具有相应的维数

### (五) 无限时间输出调节器的最优解

**最优控制：**
$$
\pmb u^*(t)=-\pmb R^{-1}\pmb B^T\pmb P\pmb x(t)
$$
若$(\pmb A,\pmb B)$能控、$(\pmb A,\pmb H)$能观，其中$\pmb H^T\pmb H=\pmb C^T\pmb{QC}$，则最优控制存在且唯一

**最优轨线：**
$$
\dot{\pmb x}=[\pmb A-\pmb {BR}^{-1}\pmb B^T\pmb P]\pmb x,\pmb x(0)=\pmb x_0
$$
闭环系统在非零最优控制下渐近稳定

**最优性能指标：**
$$
J^*=\pmb x^T_0\pmb P\pmb x_0
$$
其中，$\pmb P>0$，满足黎卡提矩阵代数方程：
$$
\pmb{PA}+\pmb A^T\pmb P-\pmb {PBR}^{-1}\pmb B^T\pmb P+\pmb C^T\pmb {QC}=\pmb 0
$$

## 六、线性最优跟踪问题

### (一) 有限时间最优跟踪控制器

**运动方程：**
$$
\begin{align}\dot{\pmb x}(t)&=\pmb A(t)\pmb x(t)+\pmb B(t)\pmb u(t)\\\pmb y(t)&=\pmb C\pmb x(t)\end{align}
$$
**边界条件：**
$$
\pmb x(t_0)=\pmb x_0,末端时刻t_f固定、有限
$$
**控制约束：**
$$
控制\pmb u(\cdot)无约束
$$
**性能指标：**
$$
J=\pmb e^T(t_f)\pmb S\pmb e(t_f)+\int_{t_0}^{t_f}[\pmb e^T(t)\pmb Q(t)\pmb e(t)+\pmb u^T(t)\pmb R(t)\pmb u(t)]\mathrm dt
$$
其中，$\pmb F\geq \pmb 0,\pmb Q(t)\geq \pmb 0,\pmb R(t)> \pmb 0$且具有相应的维数，各元连续且有界；$\pmb y_r(t)$表示期望输出向量，误差向量$\pmb e(t)$定义为
$$
\pmb e(t)=\pmb y_r(t)-\pmb y(t)=\pmb y_r(t)-\pmb C(t)\pmb x(t)
$$

### (二) 线性最优跟踪问题的解

最优控制：
$$
\pmb u^*(t)=-\pmb R^{-1}(t)\pmb B^T(t)[\pmb P(t)\pmb x(t)-\pmb g(t)]
$$
最优轨线：
$$
\dot{\pmb x}=(\pmb A-\pmb{BR}^{-1}\pmb B^T\pmb P)\pmb x+\pmb{BR}^{-1}\pmb B^T\pmb g,\pmb x(t_0)=\pmb x_0
$$
最优性能指标：
$$
J^*=\pmb x^T(t_0)\pmb P(t_0)\pmb x(t_0)-2\pmb g^T(t_0)\pmb x_0+\pmb \varphi(t_0)
$$
其中，

1. $\pmb P\geq \pmb 0$，是黎卡提矩阵微分方程：
	$$
	\dot{\pmb P}(t)+\pmb P(t)\pmb A(t)+\pmb A^T(t)\pmb P(t)-\pmb P(t)\pmb B(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)+\pmb C^T(t)\pmb Q(t)\pmb C(t)=\pmb 0
	$$
	在边界条件$\pmb P(t_f)=\pmb C^T(t_f)\pmb {SC}(t_f)$下的唯一解

2. $\pmb g(t)$称为伴随向量，满足向量微分方程
	$$
	\dot{\pmb g}(t)+[\pmb A(t)-\pmb B(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)]^T\pmb g(t)+\pmb C^T(t)\pmb Q(t)\pmb y_l(t)=\pmb 0
	$$
	及边界条件$\pmb g(t_f)=\pmb C^T(t_f)\pmb{Sy}_l(t_f)$

3. 标量函数$\pmb \varphi(t)$满足微分方程
	$$
	\dot{\pmb \varphi}(t)=\pmb y_r^T(t)\pmb Q(t)\pmb y_r(t)+2\pmb g^T(t)\pmb R^{-1}(t)\pmb B^T(t)\pmb P(t)\pmb g(t)
	$$
	及边界条件$\pmb \varphi(t_f)=\pmb y_r^T(t_f)\pmb P(t_f)\pmb y_r(t_f)$

### (三) 无限时间最优跟踪控制器

**状态空间方程：**
$$
\dot{\pmb x}=\pmb{Ax}+\pmb{Bu}\\
\pmb y=\pmb {Cx}
$$
**边界条件：**
$$
\pmb x(0)=\pmb x_0
$$
**控制约束：**
$$
控制u(\cdot)无约束
$$
**性能指标：**
$$
J=\int_{0}^{\infty} (\pmb e^T\pmb{Qe}+\pmb u^T\pmb {Ru})\mathrm dt
$$
其中，$\pmb Q\geq \pmb 0$，$\pmb R>\pmb 0$且具有相应的维数，$\pmb y_r(t)$表示期望输出的向量，误差向量$\pmb e(t)$定义为：
$$
\pmb e(t)=\pmb y_r(t)-\pmb y(t)=\pmb y_r(t)-\pmb {Cx}(t)
$$

### (四) 线性最优跟踪问题的解

**最优控制(近似)：**
$$
\pmb u^*=-\pmb R^{-1}\pmb B^T[\pmb {Px}-\pmb g(t)]
$$
**最优轨线：**
$$
\dot{\pmb x}=(\pmb A-\pmb{BR}^{-1}\pmb B^T\pmb P)\pmb x+\pmb {BR}^{-1}\pmb B^T\pmb g(t),\pmb x(0)=\pmb x_0
$$
**最优性能指标：**
$$
J^*=\pmb x_0^T\pmb{Px}_0-2\pmb g^T(0)\pmb x_0
$$
其中，

1. $\pmb P>\pmb 0$满足黎卡提矩阵代数方程：
	$$
	\pmb {PA}+\pmb{A^T}\pmb P-\pmb {PBR}^{-1}\pmb B^T\pmb P+\pmb C^T\pmb {QC}=\pmb 0
	$$

2. 伴随向量$\pmb g(t)=[\pmb A^T-\pmb{PBR}^{-1}\pmb B^T]^{-1}\pmb C^T\pmb Q\pmb y_r(t)$

此外，为保证最优控制近似解存在，要求$(\pmb A,\pmb B)$能控、$(\pmb A,\pmb H)$能观，其中，$\pmb H^T\pmb H=\pmb C^T\pmb{QC}$