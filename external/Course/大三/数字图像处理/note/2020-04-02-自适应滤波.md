---
title: 自适应滤波
tags: 数字图像处理
article_header:
  type: cover
  image:
    src: /assets/images/DIP.jpg
---

<!--more-->

## 一、综述

### (一) 滤波与滤波器

在信号与图像处理领域，滤波器主要有三种应用：

滤波去噪

<img src="/assets/images/自适应滤波.assets/image-20200402091130534.png" alt="image-20200402091130534"  />

平滑内插

![image-20200402091144507](/assets/images/自适应滤波.assets/image-20200402091144507.png)

预测估计

![image-20200402091154670](/assets/images/自适应滤波.assets/image-20200402091154670.png)

### (二) 自适应滤波器

信号或者噪声的特性并不是一成不变的，为了取得更好的滤波效果**，**滤波器的参数应该也随之调整

自适应滤波器包含有一种参数自适应调整的机制，即能够对处理的信号进行监控，据此调整滤波器的参数

自适应滤波器还包含有一种最优机制，即根据实际获取的信号，对滤波器结构和参数进行设计，以取得最优的滤波效果

**需要给定一个优化目标**

* 需要关于信号或噪声的先验信息

**需要建立一种自调整机制**

* 通常是基于递归模型的，当缺少完整的先验信息时，递归模型是一种有效的手段

**自适应滤波通常包含两个阶段：**

1. 滤波过程：根据输入信号产生预定的输出信号
2. 自调整过程**：** 根据外界条件的变化调整滤波器的结构或者参数

### (三) 自适应滤波的应用

#### 1、系统辨识

<img src="/assets/images/自适应滤波.assets/image-20200402091538376.png" alt="image-20200402091538376" style="zoom:50%;" />

#### 2、信道均衡

<img src="/assets/images/自适应滤波.assets/image-20200402091618410.png" alt="image-20200402091618410" style="zoom:50%;" />

<img src="/assets/images/自适应滤波.assets/image-20200402091650494.png" alt="image-20200402091650494" style="zoom:50%;" />

#### 3、预测估计

<img src="/assets/images/自适应滤波.assets/image-20200402091710475.png" alt="image-20200402091710475" style="zoom:50%;" />

<img src="/assets/images/自适应滤波.assets/image-20200402091719294.png" alt="image-20200402091719294" style="zoom:50%;" />

#### 4、消除干扰

<img src="/assets/images/自适应滤波.assets/image-20200402091759782.png" alt="image-20200402091759782" style="zoom:50%;" />

#### 5、消除回声

<img src="/assets/images/自适应滤波.assets/image-20200402091859581.png" alt="image-20200402091859581" style="zoom:50%;" />

<img src="/assets/images/自适应滤波.assets/image-20200402091911539.png" alt="image-20200402091911539" style="zoom:50%;" />

## 二、维纳滤波

<img src="/assets/images/自适应滤波.assets/image-20200402091931175.png" alt="image-20200402091931175" style="zoom:50%;" />

目标：找到最佳的滤波器参数使得均方误差$E\{e^2(n)\}$最小

定义目标函数：
$$
\begin{align}
J(\boldsymbol w)&=E\{e^2(n)\}\\
&=E\{[d(n)-y(n)]^2\}\\
&=E\{d^2(n)-2d(n)y(n)+y^2(n) \}
\end{align}
$$
将滤波器定义代入得：
$$
\begin{align}
J(\boldsymbol w)&=E\{d^2(n)-2d(n)y(n)+y^2(n) \}\\
&=E\{d^2(n)-2E\{d(n)\boldsymbol w^T\boldsymbol x(n) \}+E\{\boldsymbol w^T\boldsymbol x(n)\boldsymbol x^T(n)\boldsymbol w  \} \}
\end{align}
$$
由于$\boldsymbol w$为滤波器参数而不是随机变量，故上式可简化为：
$$
J(\boldsymbol w)=E\{d^2(n) \}-2\boldsymbol w^TE\{d(n)\boldsymbol x(n) \}+\boldsymbol w^TE\{\boldsymbol x(n)\boldsymbol x^T(n)\}\boldsymbol w
$$
定义$\boldsymbol P=E\{d(n)\boldsymbol x(n)\}$为互相关矩阵，$\boldsymbol R=E\{\boldsymbol x(n)\boldsymbol x^T(n)\}$为自相关矩阵，则有：
$$
J(\boldsymbol w)=\sigma^2_d-2\boldsymbol w^T\boldsymbol P+\boldsymbol w^T\boldsymbol R\boldsymbol w
$$
以二元维纳滤波为例，代价函数为：
$$
J(w_0,w_1)=\sigma^2_d-2w_0p(0)-2w_1p(1)+w_0^2r(0)+2w_0w_1r(1)+w_1^2r(0)
$$
对代价函数分别求两个权重系数得梯度
$$
\frac{\partial J}{\partial w_0}=-2p(0)+2w_0r(0)+2w_1r(1)\\
\frac{\partial J}{\partial w_1}=-2p(1)+2w_0r(1)+2w_1r(0)
$$
矩阵表示：
$$
\nabla \boldsymbol J(w_0,w_1)= \begin{bmatrix}\frac{\partial J}{\partial w_0}\\\frac{\partial J}{\partial w_1}\end{bmatrix}=-2\begin{bmatrix}p(0)\\p(1)\end{bmatrix}+2\begin{bmatrix}r(0)&r(1)\\r(1)&r(0)\end{bmatrix}\begin{bmatrix}w_0\\w_1\end{bmatrix}
$$
对于通用的N-1元维纳滤波， 可以采用类似策略来计算梯度
$$
\nabla \boldsymbol J(\boldsymbol w)=-2\boldsymbol P+2\boldsymbol R\boldsymbol w
$$
通过计算上式等于0，可以得到维纳滤波得表达式：
$$
\boldsymbol w_{opt}=\boldsymbol R^{-1}\boldsymbol P
$$
性能分析：

* 利用平稳随机过程的相关特性和频谱特性，对混有噪声的信号进行滤波，奠定了最优滤波理论的基础
* 当输入过程是广义平稳的，且统计特性已知时，能够取得较好的结果
* 但是，输入过程取决于外界环境的信号和干扰，其统计特性常常是未知的、变化的

## 三、最小二乘滤波

最小二乘滤波分为两个步骤：

* Filtering, producing
	1. output signal
	2. estimation error
* Adaptive process, automatic
	* adjustment of filter tap weights

<img src="/assets/images/自适应滤波.assets/image-20200402094933443.png" alt="image-20200402094933443" style="zoom: 50%;" />

基于递归机制得参数自适应

设$w(n)$为第$n$次迭代后得到的滤波器参数，则第$n+1$次迭代的参数估计可表示为：
$$
\boldsymbol w(n+1)=\boldsymbol w(n)+\boldsymbol g(n)
$$
其中，$\boldsymbol g(n)$为方向向量，其作用是最小化目标函数
$$
\boldsymbol J(\boldsymbol w(n+1))=\boldsymbol J(\boldsymbol w(n)+\boldsymbol g(n))
$$
为实现目标函数的最小化，可以对$\boldsymbol J(\boldsymbol w(n+1))$进行泰勒级数展开：
$$
\boldsymbol J(\boldsymbol w+\boldsymbol g)=\boldsymbol J(\boldsymbol w)+\sum\limits_i g_i\frac{\partial \boldsymbol J(\boldsymbol w)}{\partial w_i}+\frac{1}{2}\sum\limits_i\sum\limits_jg_ig_j\frac{\partial^2 \boldsymbol J(\boldsymbol w)}{\partial w_i\partial w_j}+\cdots
$$
以二元滤波器为例，
$$
\frac{\partial \boldsymbol J(\boldsymbol w+\boldsymbol g)}{\partial \boldsymbol g}=\nabla \boldsymbol J+\begin{bmatrix} \frac{\partial ^2\boldsymbol J(\boldsymbol w)}{\partial w_0\partial w_0}&\frac{\partial^2 \boldsymbol J(\boldsymbol w)}{\partial w_0\partial w_1}\\ \frac{\partial^2 \boldsymbol J(\boldsymbol w)}{\partial w_0\partial w_1}&\frac{\partial \boldsymbol J(\boldsymbol w)}{\partial w_1\partial w_1} \end{bmatrix}\begin{bmatrix}g_0\\g_1\end{bmatrix}
$$
为实现$\boldsymbol J(\boldsymbol w+\boldsymbol g)$的最小化，令上式为0，可以得到：
$$
\boldsymbol g=-\boldsymbol H^{-1}\nabla \boldsymbol J
$$
可得到牛顿迭代法的表达式：
$$
\boldsymbol w(n+1)=\boldsymbol w(n)-\boldsymbol H^{-1}\nabla \boldsymbol J
$$
将上式中的Hessian矩阵近似为 $\boldsymbol H=2\boldsymbol I$ **，**则可以得到最速下降法的通用表达式：
$$
\boldsymbol w(n+1)=\boldsymbol w(n)-\frac{\mu}{2}\nabla \boldsymbol J
$$
这里，常数$\mu$用于控制收敛速度

将维**纳滤波器**的表达式代入最速下降滤波中，可得：
$$
\begin{align}
\boldsymbol w(n+1)&=\boldsymbol w(n)+\frac{1}{2}\mu[-\nabla J(n)]\\
&=\boldsymbol w(n)+\mu[\boldsymbol P-\boldsymbol R\boldsymbol w(n)]
\end{align}
$$
其中，$\boldsymbol R$和$\boldsymbol P$为瞬态估计，
$$
\hat{\boldsymbol R}=\boldsymbol u(n)\boldsymbol u^H(n)\\
\hat{\boldsymbol p}(n)=\boldsymbol u(n)d^*(n)
$$
将**瞬态误差**$|e(n)|$代入到最速下降滤波中，
$$
\begin{align}
\boldsymbol w(n+1)&=\boldsymbol w(n)+\mu[\boldsymbol P-\boldsymbol R\boldsymbol w(n)]\\
&=\boldsymbol w(n)+\mu[\boldsymbol u(n)d^*(n)-\boldsymbol u(n)\boldsymbol u^H(n)\boldsymbol w(n)]\\
&=\boldsymbol w(n)+\mu\boldsymbol u(n)[d^*(n)-y^*(n)]\\
&=\boldsymbol w(n)+\mu \boldsymbol u(n)e^*(n)
\end{align}
$$
滤波器输出：$\boldsymbol y(n)=\boldsymbol w^T\boldsymbol u(n)$

**收敛性分析**

<img src="/assets/images/自适应滤波.assets/image-20200402101555078.png" alt="image-20200402101555078" style="zoom: 50%;" />

由上述定义可知，tap-weight-error的变化率为：
$$
\begin{align}
\varepsilon(n+1)&=[\boldsymbol I-\mu\boldsymbol u(n)\boldsymbol u^H(n)]\varepsilon(n)+\mu \boldsymbol u(n)e^*_o(n)\\
&=[\boldsymbol I-\mu\boldsymbol R]e(n)+\mu\boldsymbol u(n)e^*_o(n)
\end{align}
$$
计算tap-weight-error的自相关矩阵$K$
$$
\begin{align}
\boldsymbol K(n)&=E[\varepsilon(n)\varepsilon^H(n)]\\
&=(\boldsymbol I-\mu\boldsymbol R)\boldsymbol K(n-1)(\boldsymbol I-\mu \boldsymbol R)+\mu^2J_\min\boldsymbol R
\end{align}
$$
对于回归式
$$
x_{ii}(n+1)=(1-\mu\lambda_i)^2x_{ii}(n)+\mu^2\lambda_iJ_\min
$$
其中，$\lambda$是$\boldsymbol R$的特征值

其收敛的必要条件是$|1-\mu\lambda_i|<1$

也就是说LMS算法收敛的必要条件是：
$$
0<\mu<\frac{2}{\lambda_\max}
$$
步长的选择

<img src="/assets/images/自适应滤波.assets/image-20200402102155939.png" alt="image-20200402102155939" style="zoom:50%;" />

## 四、二维运动估计

**关键性假设**

* 假设各幅图像的亮度具有一致性
* 运动较小

![image-20200402102357484](/assets/images/自适应滤波.assets/image-20200402102357484.png)

**基础性假设**

点的亮度变化仅由运动引起
$$
I(\boldsymbol x,t)\approx I(\boldsymbol x+\delta \boldsymbol x,t+\delta t)
$$
作泰勒展开
$$
I(\boldsymbol x,t)=I(\boldsymbol x,t)+\nabla I\cdot \delta \boldsymbol x+\delta t \boldsymbol I_t+O^2
$$
得到光流约束方程：
$$
\nabla I\cdot \boldsymbol v+\boldsymbol I_t=0
$$
物理意义:如果一个固定的观察者观察一幅活动的场景，那么所得图象上某点灰度的(一阶)时间变化率是场景亮度变化率与该点运动速度的乘积