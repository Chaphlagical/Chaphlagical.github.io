---
title: 极小值原理
tags: 现代控制理论
article_header:
  type: cover
  image:
    src: /assets/images/control.png
---

<!--more-->

## 一、静态最优化问题及解

### (一) 一元函数的极值

设$J=f(u)\rightarrow [a,b]$上的单值连续可微函数，则

1. $f'(u)\Big|_{u=u^*}=0\&f''(u)\Big|_{u=u^*}>0\Leftrightarrow f(u)在u=u^*处取极小值$
2. $f'(u)\Big|_{u=u^*}=0\&f''(u)\Big|_{u=u^*}<0\Leftrightarrow f(u)在u=u^*处取极大值$

最小(大)值：$[a,b]$上极小(大)值中的最小(大)值
$$
J^*=f(u^*)=\min_{u\in[a,b]}[f(u)]
$$

### (二) 多元函数的极值

设：$J=f(\pmb u),\pmb u=\begin{bmatrix}u_1&u_2&\cdots&u_n\end{bmatrix}^T$，则$J$取极值的必要条件与充分条件分别是

1. 必要条件
	$$
	\frac{\partial f}{\partial \pmb u}\Bigg|_{\pmb u=\pmb u^*}=\pmb 0
	$$

2. 充分条件
	$$
	\frac{\partial f}{\partial \pmb u}\Bigg|_{\pmb u=\pmb u^*}=\pmb 0\ \ \& \ \ \frac{\partial^2 f}{\partial \pmb u\partial \pmb u^T}\Bigg|_{\pmb u=\pmb u^*}>0
	$$
	

### (三) 具有等式约束的条件极值

设连续可微的目标泛函：
$$
J=f(\pmb x,\pmb u)
$$
等式约束条件：
$$
\pmb g(\pmb x,\pmb u)=\pmb 0
$$

#### 1、嵌入法(消元法)

从约束条件等式中解出某些变量，使问题变为无约束的极值问题

#### 2、拉格朗日乘子法(增元法)

将约束条件式乘以乘子$\lambda$，与目标函数试相加，构成一个新的泛函，使问题变为无约束的极值问题

**拉格朗日乘子法的一般形式**

设连续可微的目标泛函：
$$
J=f(\pmb x.\pmb u)
$$
等式约束条件：
$$
\pmb g(\pmb x,\pmb u)=0
$$
构造拉格朗日函数：
$$
H=J+\lambda^T\pmb g(\pmb x,\pmb u)=f(\pmb x,\pmb u)+\lambda^T\pmb g(\pmb x,\pmb u)
$$
式子中$\lambda$为乘子矢量，与$\pmb g$同维列向量

求导：
$$
\begin{cases}
\frac{\partial H}{\partial \pmb x}=\pmb 0\\
\frac{\partial H}{\partial \pmb u}=\pmb 0\\
\frac{\partial H}{\partial \pmb \lambda}=\pmb 0
\end{cases}
$$

## 二、泛函极值与变分法

### (一) 重要概念

#### 1、距离空间与距离

非空$X$称为是距离空间是指：$\forall \pmb x,\pmb y\in X$，存在实值泛函$d(\pmb x,\pmb y)$满足：

1. $d(\pmb x,\pmb y)\geq 0$，$\forall \pmb x,\pmb y\in X$；$d(\pmb x,\pmb y)=0\Leftrightarrow \pmb x=\pmb y$
2. $d(\pmb x,\pmb y)=d(\pmb y,\pmb x)$
3. $d(\pmb x,\pmb y)\leq d(\pmb x,\pmb z)+d(\pmb z,\pmb y)$

式中，$d(\pmb x,\pmb y)$称为是距离空间$X$上的距离，$d(\pmb x,\pmb y)=\|\pmb x-\pmb y\|$

#### 2、泛函的极值（自变量为函数）

若泛函$J$在任何一条与$\pmb y(\pmb x)$接近的曲线上都有：
$$
\Delta \pmb J=\pmb J[\pmb y(\pmb x)]-\pmb J(\pmb y_0(\pmb x))\geq 0\\
\rightarrow \pmb J在\pmb y_0(\pmb x)上达到极小值\\
\Delta \pmb J=\pmb J[\pmb y(\pmb x)]-\pmb J(\pmb y_0(\pmb x))\leq 0\\
\rightarrow \pmb J在\pmb y_0(\pmb x)上达到极大值
$$

**泛函的极小值：连续泛函**
$$
J[y(x)]\geq J[y_0(x)],\forall y(x)\\
\Downarrow\\
J[y_0(x)+\delta y(x)]\geq J[y_0(x)],\forall \delta y(x)\\
\Downarrow\\
J[y_0(x)+a\times \delta y(x)]\geq J[y_0(x)],\forall a\\
\Downarrow\\
\phi(a)=\Delta J_a=J[y_0(x)+a\times \delta y(x)]-J[y_0(x)]\geq 0\\
\Downarrow\\
\frac{\mathrm d}{\mathrm da}\phi(a)\Big|_{a=0}=0
$$

$$
\frac{\mathrm d}{\mathrm da}\phi(a)\Big|_{a=0}=\frac{\mathrm d}{\mathrm da}J[y_0(x)+a\times \delta y(x)]\Big|_{a=0}=\delta J
$$

### (二) 变分法的基本概念

#### 1、变分问题

求泛函的极值问题称为变分问题，其方法为变分法

#### 2、泛函的变分

##### (1) 函数的微分

设函数$y=f(x)$，则其微分：$\mathrm dy=f'(x)\mathrm dx$，求极值必要条件：$\mathrm dy=0$

##### (2) 泛函的变分

设泛函$J[y(x)]$则其增量：
$$
\begin{align}
\Delta J&=J[y(x)+\Delta y(x)]-J[y(x)]\\
&=L[y(x),\Delta y(x)]+R[y(x),\Delta y(x)]
\end{align}
$$
$L[y(x),\Delta y(x)]$为$\Delta y(x)$的线性连续函数，$R[y(x),\Delta y(x)]$为$\Delta y(x)$的高阶无穷小项
$$
\begin{align}
\Delta J(\Delta y_1(x))&=J[y(x)+\Delta y_1(x)]-J[y(x)]\\
&=L[y(x),\Delta y_1(x)]+R[y(x),\Delta y_1(x)]
\end{align}
$$

$$
\begin{align}
\Delta J(\Delta y_2(x))&=J[y(x)+\Delta y_2(x)]-J[y(x)]\\
&=L[y(x),\Delta y_2(x)]+R[y(x),\Delta y_1(x)]
\end{align}
$$

$$
\begin{align}
\Delta J[\alpha_1\Delta y_1(x)+\alpha_2\Delta y_2(x)]=J[y(x)+\alpha_1\Delta y_1(x)+\alpha_2\Delta y_2(x)]-J[y(x)]\\
=L[y(x),\alpha_1\Delta y_1(x)+\alpha_2\Delta y_2(x)]-J[y(x)]+R[y(x),\alpha_1\Delta y_1(x)+\alpha_2\Delta y_2(x)]-J[y(x)]
\end{align}
$$

$$
L[y(x),\alpha_1\Delta y_1(x)+\alpha_2\Delta y_2(x)]-J[y(x)]\\
=\alpha_1L[y(x),\Delta y_1(x)]+\alpha_2L[y(x),\Delta y_2(x)]
$$

泛函的一阶变分为：
$$
\delta J=L[y(x),\delta y(x)]
$$

##### (3) 泛函变分的计算

1. 利用定义式计算
	$$
	\begin{align}
	\Delta J&=J[y(x)+\delta y(x)]-J[y(x)]\\
	&=L[y(x),\delta y(x)]+R[y(x),\delta y(x)]\\
	&=\delta J+R[y(x),\delta y(x)]
	\end{align}
	$$

2. 利用下式计算
	$$
	\delta J=\frac{\partial }{\partial a}J[y(x)+a\delta y(x)]\Big|_{a=0}
	$$

#### 3、泛函的极值

可微泛函$J[y(x)]$在$y_0(x)$上达到极值的必要条件：
$$
\delta J=\delta J(\delta y)=0,\forall \delta y
$$

$$
\Delta J=J[y(x)]-J[y_0(x)]\geq 0 \ \ \ \ 极小值\\
\Delta J=J[y(x)]-J[y_0(x)]\leq 0 \ \ \ \ 极大值
$$

**多元泛函的极值**

设多元泛函为$J[y_1(x),y_2(x),\cdots,y_n(x)]$，则同样取极值的必要条件为：$\delta J=0$

**多元泛函的变分**
$$
\delta J=\frac{\partial}{\partial a}J[y_1+a\delta y_1,y_2+a\delta y_2,\cdots,y_n+a\delta y_n]\Big|_{a=0}=\sum \delta J_{y_i}
$$

### (三) 泛函极值的必要条件——欧拉方程

设泛函$J(x)=\int^{t_f}_{t_0}L[x(t),\dot{x}(t),t]\mathrm dt$在$[t_0,t_f]$上$L[x,\dot x,t]$二次连续可微

求极值轨线$x^*(t)\Rightarrow J=\min$

极值的必要条件：$\delta J=0$

即泛函的一阶变分：
$$
\delta J=\int^{t_f}_{t_0}\Big[\Big(\frac{\partial L}{\partial x}\Big)\delta x+\Big(\frac{\partial L}{\partial \dot x}\Big)\delta \dot x\Big]\mathrm dt=0
$$
其中，
$$
\int^{t_f}_{t_0}\Big(\frac{\partial L}{\partial \dot x}\Big)\delta \dot x\mathrm dt=\Big(\frac{\partial L}{\partial \dot x}\Big)\delta x\Big|^{t_f}_{t_0}-\int^{t_f}_{t_0}\Big(\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x}\Big)\delta x\mathrm dt
$$
故
$$
\delta J=\Big(\frac{\partial L}{\partial \dot x}\Big)\delta x\Big|^{t_f}_{t_0}+\int^{t_f}_{t_0}\Big(\frac{\partial L}{\partial x}-\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x}\Big)\delta x\mathrm dt=0
$$
$x(t)$不受约束，$\delta x$任意，故泛函$J$取极值的必要条件为：

1. 欧拉方程
	$$
	\frac{\partial L}{\partial x}-\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x}=0
	$$

	$$
	\because L=L(x,\dot x,t)\\
	\therefore 
	\begin{align}
	\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x}&=\frac{\partial }{\partial \dot x}\Big(\frac{\partial L}{\partial \dot x}\Big)\frac{\mathrm d\dot x}{\mathrm dt}+\frac{\partial }{\partial x}\Big(\frac{\partial L}{\partial \dot x}\Big)\frac{\mathrm d x}{\mathrm dt}+\frac{\partial }{\partial t}\Big(\frac{\partial L}{\partial \dot x}\Big)\frac{\mathrm dt}{\mathrm dt}\\
	&=\frac{\partial ^2 L}{\partial \dot x^2}\ddot x+\frac{\partial ^2 L}{\partial x\partial \dot x}\dot x+\frac{\partial^2L}{\partial t\partial \dot x}
	\end{align}
	$$

2. 横截条件
	$$
	\Big(\frac{\partial L}{\partial \dot x}\Big)\delta x\Big|^{t_f}_{t_0}=0
	$$
	展开上式得：
	$$
	\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_f}\delta x(t_f)-\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_0}\delta x(t_0)=0
	$$
	 **固定端点**
	$$
	\begin{matrix}\delta x(t_f)=0&\delta x(t_0)=0 \end{matrix}\\
	\Rightarrow \begin{matrix}x(t_0)=x_0&x(t_f)=x_f \end{matrix}
	$$
	**自由端点**

	始端自由：
	$$
	\begin{matrix}\delta x(t_f)=0&\delta x(t_0)\neq 0\end{matrix}\\
	\Rightarrow \begin{matrix}\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_0}=0&x(t_f)=x_f\end{matrix}
	$$
	终端自由：
	$$
	\begin{matrix}\delta x(t_f)\neq0&\delta x(t_0)= 0\end{matrix}\\
	\Rightarrow \begin{matrix}\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_f}=0&x(t_0)=x_0\end{matrix}
	$$
	两端自由：
	$$
	\begin{matrix}\delta x(t_f)\neq0&\delta x(t_0)\neq 0\end{matrix}\\
	\Rightarrow \begin{matrix}\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_0}=0&\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_f}=0\end{matrix}
	$$

### (四) 多元函数的极值条件

设泛函$J(x)=\int^{t_f}_{t_0}L[x(t),\dot x(t),t]\mathrm dt$，在$[t_0,t_f]$上$L[x,\dot x,t]$二次连续可微，且
$$
\begin{matrix}x(t_0)=x_0&x(t_f)=x_f &x\in R^n\end{matrix}
$$
求极值轨线$x^*(t)\Rightarrow J=\min$ 

1. 欧拉方程
	$$
	\frac{\partial L}{\partial x}=\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x}=0\rightarrow 向量形式
	$$
	其中
	$$
	L=[x_1,x_2,\cdots,x_n;\dot x_1,\dot x_2,\cdots,\dot x_n;t]\\
	x=[x_1,x_2,\cdots,x_n]^T
	$$

2. 横截条件
	$$
	\Big(\frac{\partial L}{\partial \dot x}\Big)\delta x\Big|^{t_f}_{t_0}=0
	$$

### (五) 可变端点问题

设泛函$J(x)=\int^{t_f}_{t_0}L[x(t),\dot x(t),t]\mathrm dt$，在$[t_0,t_f]$上$L[x,\dot x,t]$二次连续可微，已知
$$
x(t_0)=x_0 (固定始端)
$$
终端$[t_f,x(t_f)]$可沿着靶线$C(t)$变动，且$C(t)$具有连续的一阶导数

求极值轨线$x^*(t)\Rightarrow J=\min$ 
$$
J(x)=\int^{t_f}_{t_0}L[x(t),\dot x(t),t]\mathrm dt
$$
故泛函$J$取极值的必要条件：
$$
\delta J=\delta J_x+\delta J_{\dot x}+\delta J_{t_f}=0
$$
又有：
$$
\delta J_x+\delta J_{\dot x}=\Big(\frac{\partial L}{\partial \dot x}\Big)\delta x\Big|_{t_0}^{t_f}+\int^{t_f}_{t_0}\Big(\frac{\partial L}{\partial x}-\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x} \Big)\delta x\mathrm dt
$$

$$
\delta J_{t_f}=L(x,\dot x,t)\Big|_{t_f}\cdot \delta t_f
$$

故
$$
\delta J=\Big(\frac{\partial L}{\partial \dot x}\Big)\delta x\Big|_{t_0}^{t_f}+\int^{t_f}_{t_0}\Big(\frac{\partial L}{\partial x}-\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x} \Big)\delta x\mathrm dt+L(x,\dot x,t)\Big|_{t_f}\cdot \delta t_f=0
$$

1. 欧拉方程
	$$
	\frac{\partial L}{\partial x}-\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x}=0
	$$

2. 横截条件

	固定始端：$x(t_0)=x_0$

	终端横截条件：
	$$
	\Big(\frac{\partial L}{\partial \dot x}\Big)\delta x\Big|^{t_f}_{t_0}+L(x,\dot x,t)\Big|_{t_f}\cdot \delta t_f=0
	$$
	展开得：
	$$
	\begin{align}
	&\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_f}\cdot \delta x(t_f)-\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_0}\cdot \delta x(t_0)+L(x,\dot x,t)\Big|_{t_f}\cdot \delta t_f\\
	=&\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_f}\cdot\delta x(t_f)+L(x,\dot x,t)\Big|_{t_f}\cdot\delta t_f=0
	\end{align}
	$$
	其中，

	<img src="/assets/images/极小值原理.assets/image-20200506080236965.png" alt="image-20200506080236965" style="zoom:50%;" />
	$$
	\begin{align}
	\delta x(t_f)&\approx \delta x_f-\dot x(t_f)\delta t_f\\
	&\approx \dot C(t_f)\delta t-\dot x(t_f)\delta t_f
	\end{align}
	$$
	即：
	$$
	\Big\{L+[\dot C(t)-\dot x(t)]\Big(\frac{\partial L}{\partial \dot x}\Big) \Big\}_{t=t_f}=0
	$$
	**分析：**

	* 若靶线$C(t)$为平行于$t$轴的直线，即$\dot C(t)=0$，则上式为：
		$$
		\Big\{L-\dot x(t)\Big(\frac{\partial L}{\partial \dot x}\Big)\Big\}_{t=t_f}=0
		$$

	* 若靶线$C(t)$为垂直于$t$轴的直线，即$\dot C(t)\rightarrow \infty$，则上式为：
		$$
		\frac{L(t_f)}{\dot C(t_f)-\dot x(t_f)}+\Big(\frac{\partial L}{\partial \dot x}\Big)_{t=t_f}=0\rightarrow \Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_f}=0
		$$

3. 若终端固定，始端沿给定曲线$D(t)$变动，则有
	$$
	\Big\{L+[\dot x(t)-\dot D(t)]\Big(\frac{\partial L}{\partial \dot x}\Big) \Big\}_{t=t_0}=0
	$$

	* 若$D(t)$为平行于$t$轴的直线，即$\dot D(t)=0$，则上式为：
		$$
		\Big\{L-\dot x(t)\Big(\frac{\partial L}{\partial \dot x}\Big)\Big\}_{t=t_0}=0
		$$

	* 若$D(t)$为垂直于$t$轴的直线，即$\dot D(t)\rightarrow \infty$，则上式为：
		$$
		\Big(\frac{\partial L}{\partial \dot x}\Big)\Big|_{t_0}=0
		$$

4. 对多变量泛函，有矢量形式：

	欧拉方程：
	$$
	\frac{\partial L}{\partial x}-\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x}=0
	$$
	终端横截条件：
	$$
	\Big\{L+[\dot C(t)-\dot x(t)]^T\Big(\frac{\partial L}{\partial \dot x}\Big) \Big\}_{t=t_f}=0
	$$

### (六) 具有综合型性能泛函的情况

**综合型性能指标**
$$
J=\Phi[x(t_f)]+\int_{t_0}^{t_f}L[x(t),\dot x(t),t]\mathrm dt
$$
固定始端：$x(t_0)=x_0$

自由终端：$t=t_f$一定，$x_f$任意

求极值轨线$x^*(t)\Rightarrow J=\min$ 

泛函$J$取极值的必要条件：
$$
\delta J=0
$$
分部积分得：
$$
\delta J_x+\delta J_{\dot x}=\int^{t_f}_{t_0}\Big[\Big(\frac{\partial L}{\partial x} \Big)^T\delta x+\Big(\frac{\partial L}{\partial \dot x}\Big)^T\delta\dot x \Big]\mathrm dt
$$
其中，
$$
\int_{t_0}^{t_f}\Big(\frac{\partial L}{\partial \dot x} \Big)^T\delta \dot x\mathrm dt=\Big(\frac{\partial L}{\partial \dot x} \Big)^T\delta x\Big|_{t_0}^{t_f}-\int_{t_0}^{t_f}\Big(\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x} \Big)^T\delta x\mathrm dt
$$
故
$$
\delta J_x+\delta J_{\dot x}=
\Big(\frac{\partial L}{\partial \dot x} \Big)^T\delta x\Big|_{t_0}^{t_f}-\int_{t_0}^{t_f}\Big(\frac{\partial L}{\partial x}-\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x} \Big)^T\delta x\mathrm dt
$$

$$
\delta J_{x_f}=\Big\{\frac{\partial \Phi[x(t_f)]}{\partial x(t_f)}\Big\}^T\delta x(t_f)
$$

* 欧拉方程：
	$$
	\frac{\partial L}{\partial x}-\frac{\mathrm d}{\mathrm dt}\frac{\partial L}{\partial \dot x}=0
	$$

* 横截条件：

	固定始端：
	$$
	x(t_0)=x_0
	$$
	自由始端：
	$$
	\Big(\frac{\partial L}{\partial \dot x} \Big)_{t=t_f}=\frac{\partial \Phi[x(t_f)]}{\partial x(t_f)}
	$$

### (七) 有约束条件的泛函极值

#### 1、拉格朗日问题

设系统$\dot x(t)=f(x,u,t)$，其中$x\in R^n$，$u\in R^r$

$f(x,u,t)$为$n$维连续可微的矢量函数

设性能泛函
$$
J=\int_{t_0}^{t_f}L(x,u,t)\mathrm dt
$$
固定始端：$x(t_0)=x_0$

终端状态$x(t_f)$自由

求$u^*\rightarrow J=\min(\max)$

**有约束条件的泛函极值分析思路：**

利用拉格朗日乘子法$\rightarrow$将有约束条件的泛函极值问题转化为无约束条件的泛函极值问题

**有约束条件的泛函极值分析方法：**

1. 写出约束方程：
	$$
	f(x,u,t)-\dot x(t)=0
	$$

2. 构造增广泛函：
	$$
	J'=\int_{t_0}^{t_f}\Big\{L(x,u,t)+\lambda^T[f(x,u,t)-\dot x] \Big\}\mathrm dt
	$$
	式中，$\lambda(t)=\begin{bmatrix}\lambda_1&\lambda_2&\cdots&\lambda_n\end{bmatrix}^T$ 为拉格朗日乘子向量

	令哈密顿函数：
	$$
	H(x,u,\lambda,t)=L(x,u,t)+\lambda^Tf(x,u,t)
	$$
	则转化为无约束条件的泛函极值问题：
	$$
	\begin{align}
	J'&=\int_{t_0}^{t_f}\Big\{H(x,u,\lambda,t)-\lambda^T\dot x \Big\}\mathrm dt\\
	&=\int_{t_0}^{t_f}\overline{H}(x,\dot x,u,\lambda,t)\mathrm dt
	\end{align}
	$$

3. 泛函极值的必要条件：$\delta J'=0$
	$$
	J'=\int_{t_0}^{t_f}\Big\{H(x,u,\lambda,t)-\lambda^T\dot x \Big\}\mathrm dt
	$$

	$$
	\delta J'=\int_{t_0}^{t_f}\Big[\Big(\frac{\partial H}{\partial x}\Big)^T\delta x+\Big(\frac{\partial H}{\partial u} \Big)^T\delta u-\lambda^T\delta \dot x \Big]\mathrm dt=0
	$$

	其中：
	$$
	-\int_{t_0}^{t_f}\lambda^T\delta \dot x\mathrm dt=-\delta x^T\lambda\Big|_{t_0}^{t_f}+\int_{t_0}^{t_f}\dot\lambda\delta x\mathrm dt
	$$
	故
	$$
	\delta J'=-(\delta x)^T\lambda\Big|_{t_0}^{t_f}+\int_{t_0}^{t_f}\Big[\Big(\frac{\partial H}{\partial x}+\dot\lambda \Big)^T\delta x+\Big(\frac{\partial H}{\partial u}\Big)^T\delta u\Big]\mathrm dt=0
	$$

	* 哈密顿正则方程
		$$
		\begin{cases}
		\dot{x}=\frac{\partial H(x,u,\lambda,t)}{\partial \lambda}&状态方程\\
		\dot \lambda=-\frac{\partial H(x,u,\lambda,t)}{\partial x}&伴随方程(协态方程)
		\end{cases}
		$$

	* 控制方程
		$$
		\frac{\partial H(x,u,\lambda,t)}{\partial u}=0
		$$

	* 边界条件
		$$
		-(\delta x)^T\lambda\Big|_{t_0}^{t_f}=-(\delta x)^T\lambda\Big|_{t_f}+(\delta x)^T\lambda\Big|_{t_0}=0
		$$

		* 固定端点：
			$$
			\begin{matrix}
			\delta x(t_f)=0&\delta x(t_0)=0\\
			\rightarrow x(t_0)=x_0&x(t_f)=x_f
			\end{matrix}
			$$

		* 自由端点

			终端自由
			$$
			\begin{matrix}
			\delta x(t_0)=0&\delta x(t_f)\neq0\\
			\rightarrow x(t_0)=x_0&\lambda(t_f)=0
			\end{matrix}
			$$
			两端自由
			$$
			\lambda\Big|_{t_0}^{t_f}=0
			$$

4. 求最优控制的步骤：

	* 构造增广泛函：
		$$
		J'=\int_{t_0}^{t_f}\Big\{H(x,u,\lambda,t)-\lambda^T\dot x \Big\}\mathrm dt
		$$
		哈密顿函数：
		$$
		H(x,u,\lambda,t)=L(x,u,t)+\lambda^Tf(x,u,t)
		$$

	* 控制方程：
		$$
		\frac{\partial H(x,u,\lambda,t)}{\partial u}=0\rightarrow u^*(x,\lambda)
		$$

	* 将$u^*$代入哈密顿正则方程$\rightarrow$$x^*$，$\lambda^*$

	* 利用边界条件定解

#### 2、波尔扎问题

设系统$\dot x(t)=f(x,u,t)$，其中$x\in R^n$，$u\in R^r$

$f(x,u,t)$为$n$维连续可微的矢量函数

设性能泛函
$$
J=\Phi[x(t_f),t_f]+\int_{t_0}^{t_f}L(x,u,t)\mathrm dt
$$
$\Phi$，$L$均为连续可微的函数

$x(t_0)=x_0$固定始端

终端状态$x_f$满足：$N[x(t_f),t_f]=0$

$N\rightarrow q(q\leq N)$维矢量函数，$t_f$待求终端时间

求$u^*\rightarrow J=\min(\max)$ 

1. 构造增广泛函
	$$
	J'=\Phi[x(t_f),t_f]+\mu^TN[x(t_f),t_f]+\\
	
	\\\int_{t_0}^{t_f}\Big\{L(x,u,t)+\lambda^T[f(x,u,t)-\dot x] \Big\}\mathrm dt
	$$
	式中，$\lambda(t)=\begin{bmatrix}\lambda_1&\lambda_2&\cdots&\lambda_n\end{bmatrix}^T$ 为拉格朗日乘子向量

	$\mu=\begin{bmatrix}\mu_1&\mu_2&\cdots&\mu_q\end{bmatrix}^T$为终端乘子矢量

	令哈密顿函数：
	$$
	H(x,u,\lambda,t)=L(x,u,t)+\lambda^Tf(x,u,t)
	$$
	则转化为：
	$$
	J'=\Phi[x(t_f),t_f]+\mu^TN[x(t_f),t_f]+\int_{t_0}^{t_f}\Big\{H(x,\mu,\lambda,t)-\lambda^T\dot x\Big\}\mathrm dt
	$$

2. 泛函极值的必要条件
	$$
	\delta J'=0
	$$

	$$
	\delta J'=\delta J_u'+\delta J_x'+\delta J'_{\dot x}+\delta J'_{t_f}+\delta J'_{x_f}=0
	$$

	$$
	\begin{align}
	\delta J'_x+\delta J'_{\dot x}+\delta J_u'&=\int_{t_0}^{t_f}\Big[\Big(\frac{\partial H}{\partial x}\Big)^T\delta x+\Big(\frac{\partial H}{\partial u} \Big)^T\delta u-\lambda^T\delta \dot x \Big]\mathrm dt\\
	&=-(\delta x)^T\lambda\Big|_{t_0}^{t_f}+\int_{t_0}^{t_f}\Big[\Big(\frac{\partial H}{\partial x}+\dot \lambda\Big)^T\delta x+\Big(\frac{\partial H}{\partial u} \Big)^T\delta u \Big]\mathrm dt\\
	&=-[\delta x(t_f)]^T\lambda(t_f)+\int_{t_0}^{t_f}\Big[\Big(\frac{\partial H}{\partial x}+\dot \lambda\Big)^T\delta x+\Big(\frac{\partial H}{\partial u} \Big)^T\delta u \Big]\mathrm dt
	\end{align}
	$$

	$$
	\begin{align}
	\delta J_{t_f}&=\frac{\partial }{\partial t_f}\Big\{\Phi+\mu^TN+\int_{t_0}^{t_f}\{H(x,u,\lambda,t)-\lambda^T\dot x\}\mathrm dt \Big\}_{t=t_f}\delta t_f\\
	&=\Big[\frac{\partial \Phi}{\partial t_f}+\frac{\partial N^T}{\partial t_f}\mu+(H-\lambda^T\dot x) \Big]\Big|_{t=t_f}\delta t_f\\
	&=\Big[\frac{\partial \Phi}{\partial t_f}+\frac{\partial N^T}{\partial t_f}\mu+H \Big]\Big|_{t=t_f}\delta t_f-\lambda^T(t_f)\dot x(t_f)\delta t_f\\
	&=\Big[\frac{\partial \Phi}{\partial t_f}+\frac{\partial N^T}{\partial t_f}\mu+H \Big]\Big|_{t=t_f}\delta t_f-\lambda^T(t_f)\delta x_f+\lambda^T(t_f)\delta x(t_f)
	\end{align}
	$$

	$$
	\begin{align}
	\delta J_{x_f}&=(\delta x_f)^T\frac{\partial}{\partial x_f}\{\Phi+\mu^TN\}_{t=t_f}\\
	&=\Big[\frac{\partial \Phi}{\partial x_f}+\frac{\partial N^T}{\partial x_f}\mu \Big]^T\Bigg|_{t=t_f}\delta x_f
	\end{align}
	$$

	$$
	哈密顿正则方程\begin{cases}
	\dot x=\frac{\partial H(x,u,\lambda,t)}{\partial \lambda}&状态方程\\
	-\dot \lambda=\frac{\partial H(x,u,\lambda,t)}{\partial x}&伴随方程
	\end{cases}\\
	\frac{\partial H(x,u,\lambda,t)}{\partial u}=0
	$$

	边界条件与横截条件：

	**固定始端**
	$$
	x(t_0)=x_0
	$$
	**终端条件**

	$x_f$固定时不存在
	$$
	\lambda(t_f)=\Big[\frac{\partial \Phi}{\partial x}+\Big(\frac{\partial N^T(x)}{\partial x} \Big)\mu \Big]\Bigg|_{t=t_f}
	$$

	$$
	N[x(t_f)]=0
	$$

	**终端时刻**

	$t_f$固定时不存在
	$$
	H[x(t_f),u(t_f),\lambda(t_f),t_f]+\Big[\frac{\partial \Phi}{\partial t}+\Big(\frac{\partial N^T(x)}{\partial t} \Big)\mu \Big]\Big|_{t=t_f}=0
	$$
	

## 三、连续系统的最小值原理

用变分法求解最优控制问题的局限性

* 要求控制量$u(\cdot)$没有约束
	* 控制量有不等式约束$|u(t)|\leq u_{\max}$
	* 控制量仅为孤立点集
* 要求$\partial H/\partial u$存在且连续
	* 最少燃料问题$J=\int_{t_0}^{t_f}|u(t)|\mathrm dt$

### (一) 问题的描述

运动方程：
$$
\pmb{\dot x}=\pmb f[\pmb x(t),\pmb u(t),t]
$$
边界条件：
$$
\pmb x(t_0)=\pmb x_0\\
\psi(\pmb x_f,t_f)=\pmb0
$$
控制约束：
$$
\pmb u(t)\in \Omega,分段连续
$$
性能指标：
$$
\pmb J=\varphi(\pmb x_f,t_f)+\int_{t_0}^{t_f}L(\pmb x,\pmb u,t)\mathrm dt
$$

$$
\begin{matrix}
末端时刻t_f固定、或自由&求：\\
固定、自由、或受约束&最优控制\pmb u^*(t)\\
向量函数\pmb f(\cdot)在[t_0,t_f]上连续且可微&最优轨线\pmb x^*(t)\\
标量函数\varphi(\cdot)，L(\cdot)在[t_0,t_f]上连续且二次可微&最优指标\pmb J^*
\end{matrix}
$$

### (二) 最优解

#### 1、最优解的表述

最优控制使哈密顿函数取强极小

哈密顿函数
$$
H(\pmb x,\pmb u,\lambda,t)=L(\pmb x,\pmb u,t)+\lambda^T\pmb f(\pmb x,\pmb u,t)
$$
极小值问题的最优解是
$$
H^*=H(\pmb x^*,\pmb u^*,\lambda,t)=\min\limits_{u\in \Omega}H(\pmb x^*,\pmb u,\lambda,t)
$$

#### 2、最优解的求取

##### (1) 正则方程

$$
H(\pmb x,\pmb u,\lambda,t)=L(\pmb x,\pmb u,t)+\lambda^T\pmb f(\pmb x,\pmb u,t)
$$

状态方程
$$
\pmb {\dot x}=\frac{\partial H}{\partial \lambda}=\pmb f[\pmb x(t),\pmb u(t),t]
$$
协态方程
$$
\dot \lambda=-\frac{\partial H}{\partial \pmb x}
$$

##### (2) 边界条件

除初态$\pmb x(t_0)=\pmb x_0$之外，视不同的末端情况有如下的横截条件方程：
$$
\begin{matrix}
A.末端固定&\pmb x(t_f)=\pmb x_f\\
B.末端自由&\lambda(t_f)=\frac{\partial \varphi}{\partial\pmb x_f}&\varphi 为性能指标中的末值项\\
C.末端受约束&\lambda(t_f)=\frac{\partial \varphi}{\partial\pmb x_f}+\frac{\partial \pmb\psi^T}{\partial \pmb x_f}\pmb\gamma(t_f)&\pmb\psi是末端约束\pmb\psi(\pmb x_f,\pmb t_f)=\pmb 0\\
&&\pmb\gamma(t_f)为关于末端约束的拉格朗日乘子
\end{matrix}
$$

##### (3) 极值条件

对于定常系统：$H^*$为常数，特别当末端时刻$t_f$自由时常值为零：$H^*(t)=0$

对于时变系统：

$t_f$固定：
$$
H^*(t)=H^*(t_f)-\int_{t}^{t_f}\frac{\partial H(\tau)}{\partial \tau}\mathrm d\tau
$$
$t_f$自由：
$$
H^*(t_f)=-\frac{\partial \varphi}{\partial t_f}-\frac{\partial \pmb \psi^T}{\partial t_f}\pmb \gamma(t_f)
$$

### (三) 极小值原理的意义

1. 容许控制的条件放宽了
2. 最优控制使得哈密顿函数取得强极小
3. 不要求哈密顿函数对控制函数的可微性
4. 给出了最优控制的必要而非充分条件  

### (四) 极小值原理的应用

#### 1、时间最优控制 (梆梆控制， Bang Bang  )

* 控制矢量的各分量均取控制域的边界值
* 控制量可不断从一个边值变换到另一个边值
* 性能指标简单：$J=t_f$或$J=\int_{t_0}^{t_f}\mathrm dt$

**基本问题：**线性定常系统的时间最优控制
$$
\dot x(t)=Ax(t)+Bu(t)
$$
其中，$x(0)=x_0$，$x(t_f)=0$，$t_f$待求

性能指标：$\min\limits_u J=\int_{t_0}^{t_f}\mathrm dt=t_f$

控制约束：$-1\leq u_i(t)\leq 1$

或$|u_i(t)|\leq 1$，$i=1,2,\cdots,r$

求$u^*\rightarrow J=\min$

取哈密顿函数：
$$
H(x,u,t)=1+\lambda^T(Ax+Bu)=1+x^TA^T\lambda+u^TB^T\lambda
$$
由$\min\limits_{u\in U}H(x^*,\lambda^*,u,t)=H(x^*,\lambda^*,u^*,t)$
$$
\min\limits_{u\in U} H\rightarrow \min u^TB^T\lambda
$$
得$u^*(t)=-SGN(B^T\lambda)$

其中，$sgn\ a=\begin{cases}+1&a>0\\0&a=0\\-1&a<0\end{cases}$

由正则方程组
$$
\dot x=Ax+Bu\\
\dot \lambda (t)=-\frac{\partial H}{\partial x}=-A^T\lambda
$$
得
$$
\lambda(t)=e^{-A^Tt}\lambda(0)=e^{-A^Tt}\lambda_0
$$
故
$$
u^*(t)=-SGN(B^T\lambda)=-SGN(B^Te^{-A^Tt}\lambda_0)
$$

1. 时间控制是Bang-Bang控制，即开关控制

2. 最优控制$u^*$是唯一的

	定理：线性定常系统$\sum (A,B,C)$，若存在时间最优控制$u^*$，则该最优控制$u^*(t),i=1,2,\cdots,r$是唯一的

3. 最优控制得开关次数

	线性定常系统$\sum (A,B,C)$，若存在时间最优控制$u^*$满足$|u_i(t)|\leq 1,(i=1,2,\cdots,r)$且矩阵$A$得特征值均为实数。则每一个$u_i^*(t)$都是Bang-Bang控制，且在两个边界值之间最多切换$n-1$次

#### 2、燃料最优控制

$$
J=\int_{t_0}^{t_f}\Big|\sqrt{\pmb u^T(t)\pmb {Ru}(t)} \Big|\mathrm dt=\int_{t_0}^{t_f}\sum\limits_{j-1}^m\Big|c_ju_j(t)\Big|\mathrm dt
$$

#### 3、时间-燃料最优控制

复合指标

