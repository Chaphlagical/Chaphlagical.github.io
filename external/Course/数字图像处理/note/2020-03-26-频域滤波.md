---
title: 频域滤波
tags: 数字图像处理
article_header:
  type: cover
  image:
    src: /assets/images/DIP.jpg
---

<!--more-->

## 一、绪论

### (一) 图像傅里叶变换

<img src="/assets/images/频域滤波.assets/image-20200326093414091.png" alt="image-20200326093414091" style="zoom:67%;" />

为了便于分析和描述，需要对频谱进行中心化

<img src="/assets/images/频域滤波.assets/image-20200326093454014.png" alt="image-20200326093454014" style="zoom:67%;" />

用$(-1)^{x+y}$乘以输入图像来进行中心变换

<img src="/assets/images/频域滤波.assets/image-20200326093611346.png" alt="image-20200326093611346" style="zoom:50%;" />

### (二) 图像频域处理

<img src="/assets/images/频域滤波.assets/image-20200326093650825.png" alt="image-20200326093650825" style="zoom:50%;" />

思想：通过滤波器函数以某种方式来修改图像变换**，**然后通过取结果的反变换来获得处理后的输出图像

**图像频域处理的基本步骤：**

* 用$(-1)^{x+y}$乘以输入图像来进行中心变换
	$$
	f(x,y)(-1)^{x+y}
	$$

* 计算图像的DFT，即$F(u,v)$

* 计算$H(u,v)F(u,v)$

* 对上述进行反DFT变换

* 提取上步的实部

* 用$(-1)^{x+y}$乘以上步中的结果，$H(u,v)$称为滤波器

**空域滤波器$h(x,y)\Leftrightarrow H(u,v)$**

* 零延拓
* 中心化
* 离散傅里叶变换

### (三) 图像频域处理

$H(u)$定义在复数域上，因此

* 其幅值部分与图像各频率的幅值相乘，改变其频域内容
* 其相位部分使图像的相位平移
* 幅值调制（比较常见）
* 相位调制（比较少见）

**频域滤波方法分类：**

* 低通滤波：保留低频成分
* 高通滤波：保留高频成分
* 高频提升滤波：提升高频成分
* 带通滤波：保留中频成分
* 带阻滤波：阻断中频成分

**低通滤波**

* 保留低频成分—通常用于平滑、去噪等任务中

<img src="/assets/images/频域滤波.assets/image-20200326094603147.png" alt="image-20200326094603147" style="zoom: 67%;" />

**高频滤波**

* 保留高频成分—通常用于边缘提取等任务中

<img src="/assets/images/频域滤波.assets/image-20200326094705818.png" alt="image-20200326094705818" style="zoom: 67%;" />

**带通滤波**

* 保留中频成分—通常用于纹理提取等任务中

<img src="/assets/images/频域滤波.assets/image-20200326094808170.png" alt="image-20200326094808170" style="zoom:67%;" />

## 二、低通滤波

### (一) 理想低通滤波

$$
H(u,v)=
\begin{cases}
1&D(u,v)\leq D_0\\
0&D(u,v)>D_0
\end{cases}
$$

<img src="/assets/images/频域滤波.assets/image-20200326095035452.png" alt="image-20200326095035452" style="zoom: 80%;" />

**频域图像分析**

* 特性研究需要具有相同截止频率加以比较，方法是用图像功率
* 定义：

$$
P_T=\sum\limits^{M-1}_{n=0}\sum\limits_{v=0}^{N-1}p(u,v)\\
p(u,v)=|F(u,v)|=R^2(u,v)+I^2(u,v)
$$

* 如果变换被中心化，原点在图像的矩形中心，则半径为r圆包含的功率为：

$$
a=100[\sum\limits_u\sum\limits_vp(u,v)/P_T(u,v)]
$$

<img src="/assets/images/频域滤波.assets/image-20200326095453012.png" alt="image-20200326095453012" style="zoom:67%;" />

**理想低通滤波**

<img src="/assets/images/频域滤波.assets/image-20200326095532766.png" alt="image-20200326095532766" style="zoom: 50%;" />

**振铃效应**

<img src="/assets/images/频域滤波.assets/image-20200326095553260.png" alt="image-20200326095553260" style="zoom:50%;" />

<img src="/assets/images/频域滤波.assets/image-20200326100010192.png" alt="image-20200326100010192" style="zoom:50%;" />

### (二) 其他低通滤波器

#### 1、巴特沃斯低通滤波器

$$
H(u)=\frac{1}{1+(u^2/u_c^2)^n}
$$

<img src="/assets/images/频域滤波.assets/image-20200326100235465.png" alt="image-20200326100235465" style="zoom: 80%;" />

* $u_c $：截止频率，控制频率的截断位置；
* $n$: 滤波器阶次，控制截断性能；
* $n$越大，平滑性能越好，但会产生振铃；
* $n$越小，平滑性能越弱，但振铃效应不明显

![image-20200326100533091](/assets/images/频域滤波.assets/image-20200326100533091.png)

![image-20200326100541198](/assets/images/频域滤波.assets/image-20200326100541198.png)

**巴特沃斯低通滤波器VS理想低通滤波器**

![image-20200326100706097](/assets/images/频域滤波.assets/image-20200326100706097.png)

#### 2、高斯低通滤波器

$$
H(u)=e^{-\frac{1}{2}u^2/u_c^2}
$$

<img src="/assets/images/频域滤波.assets/image-20200326100756248.png" alt="image-20200326100756248" style="zoom:67%;" />

* $u_c$：高斯滤波函数的方差($u_c$的意义与空域高斯滤波相同)

![image-20200326100910583](/assets/images/频域滤波.assets/image-20200326100910583.png)

![image-20200326100939256](/assets/images/频域滤波.assets/image-20200326100939256.png)

## 三、高通滤波和带通滤波

### (一) 高通滤波

#### 1、高通滤波的作用

* 去模糊
* 逆卷积
* 锐化
* 边缘提取

消除模糊但放大噪声

#### 2、高通滤波器

##### (1) 理想高通滤波器

$$
H(u)=\begin{cases}1&\mathrm{if\ u>u_c}\\ 0&\mathrm{otherwise} \end{cases}
$$

<img src="/assets/images/频域滤波.assets/image-20200326101410264.png" alt="image-20200326101410264" style="zoom:67%;" />



<img src="/assets/images/频域滤波.assets/image-20200326101418434.png" alt="image-20200326101418434" style="zoom:67%;" />



![image-20200326101448599](/assets/images/频域滤波.assets/image-20200326101448599.png)

##### (2) 高斯高通滤波器

$$
H(u)=1-e^{-\frac{1}{2}u^2/u_c^2}
$$

![image-20200326101720636](/assets/images/频域滤波.assets/image-20200326101720636.png)

![image-20200326101758882](/assets/images/频域滤波.assets/image-20200326101758882.png)

##### (3) 巴特沃斯高通滤波

$$
H(u)=\frac{1}{1+(u_c^2/u^2)^n}
$$

<img src="/assets/images/频域滤波.assets/image-20200326101918801.png" alt="image-20200326101918801" style="zoom:80%;" />

* $u_c$：截止频率，控制频率的截断位置
* $n$：滤波器阶次，控制截断性能

![image-20200326102019526](/assets/images/频域滤波.assets/image-20200326102019526.png)

**高通滤波的空域表示**

![image-20200326112734924](/assets/images/频域滤波.assets/image-20200326112734924.png)

**理想高通滤波vs高斯高通滤波**

![image-20200326113013647](/assets/images/频域滤波.assets/image-20200326113013647.png)

**巴特沃斯高通滤波vs高斯高通滤波**

![image-20200326113720991](/assets/images/频域滤波.assets/image-20200326113720991.png)

##### (4) LOG

<img src="/assets/images/频域滤波.assets/image-20200326114049662.png" alt="image-20200326114049662" style="zoom:67%;" />

![image-20200326114101947](/assets/images/频域滤波.assets/image-20200326114101947.png)

##### (5) 高频提升滤波

![image-20200326114132107](/assets/images/频域滤波.assets/image-20200326114132107.png)

![image-20200326114151854](/assets/images/频域滤波.assets/image-20200326114151854.png)

![image-20200326114205350](/assets/images/频域滤波.assets/image-20200326114205350.png)

**应用**

![image-20200326114228405](/assets/images/频域滤波.assets/image-20200326114228405.png)

![image-20200326114243835](/assets/images/频域滤波.assets/image-20200326114243835.png)

### (二) 带通滤波器

![image-20200326114344473](/assets/images/频域滤波.assets/image-20200326114344473.png)

### (三) 同态滤波

**目的**

* 提升图像中的高频部分
* 衰减低频部分但是保留细节

![image-20200326114437262](/assets/images/频域滤波.assets/image-20200326114437262.png)

**基本步骤** 

* 取对数

$$
\ln(f(x,y))=\ln(i(x,y))+\ln(r(x,y))
$$

* 作傅里叶变换

$$
F(\ln(f(x,y)))=F(\ln(i(x,y)))+F(\ln(r(x,y)))
$$

$$
Z(u,v)=Illum(u,v)+Refl(u,v)
$$

* 应用$H(u,v)$

$$
Z(u,v)H(u,v)=Illum(u,v)H(u,v)+Refl(u,v)H(u,v)
$$

* 作反变换

$$
F^{-1}(Z(u,v)H(u,v))=F^{-1}(Illum(u,v)H(u,v))+F^{-1}(Refl(u,v)H(u,v))
$$

$$
s(x,y)=i'(x,y)+r'(x,y)
$$

* 取指数

$$
e^{s(x,y)}=e^{i'(x,y)}e^{r'(x,y)}
$$

$$
g(x,y)=i_0(x,y)r_0(x,y)
$$

![image-20200326115509461](/assets/images/频域滤波.assets/image-20200326115509461.png)

**应用**

![image-20200326115524937](/assets/images/频域滤波.assets/image-20200326115524937.png)