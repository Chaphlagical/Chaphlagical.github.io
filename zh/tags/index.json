[{"content":"1. 插值 1.1. 插值问题的描述 1.1.1. 问题的一般形式   寻找定义域$\\Omega\\subseteq \\mathbb R^d $，值域$\\mathbb R$上的函数$f:\\Omega\\rightarrow\\mathbb R$\n  基函数集合：$B={b_1,\\cdots,b_n}$，$b_i:\\Omega\\rightarrow\\mathbb R$\n  将$f$表示为基函数的线性组合\n  $$\nf_\\lambda(x)=\\sum\\limits_{k=0}^n\\lambda_ib_i(x)\n$$\n​\t其中，$f$由$\\lambda=\\begin{pmatrix}\\lambda_1 \\\\ \\vdots\\\\ \\lambda_n\\end{pmatrix}$唯一确定\n 函数值${(x_1,y_1), \\cdots,(x_n,y_n)}$，$(x_i,y_i)\\in \\mathbb R^d\\times\\mathbb R$ 目标找到$\\lambda$使得$f_\\lambda(x_i)=y_i$对所有$i$成立  1.1.2. 插值问题应用举例 最简单的光滑曲线曲面建模问题：\n 给定曲线或曲面上的一组点 选择一组可张成合适函数空间的基函数  光滑基函数 任意线性组合也为光滑函数   找到一个线性组合能够使得曲线或曲面能插值给定点  1.2. 插值问题的求解 构造线性方程组：\n 在数据点$x_i$上计算基函数：  $$\n\\forall i\\in{1,\\cdots,n}:\\sum\\limits_{i=1}^n\\lambda_ib_i(x_i)=y_i\n$$\n 写成矩阵形式：  $$\n\\begin{pmatrix}\nb_1(x_1)\u0026amp;\\cdots\u0026amp;b_n(x_1)\\\\\n\\vdots\u0026amp;\\ddots\u0026amp;\\vdots\\\\\nb_1(x_n)\u0026amp;\\cdots\u0026amp;b_n(x_n)\n\\end{pmatrix}\n\\begin{pmatrix}\n\\lambda_1\\\\ \\vdots\\\\ \\lambda_n\n\\end{pmatrix}=\n\\begin{pmatrix}\ny_1\\\\ \\vdots\\\\ y_n\n\\end{pmatrix}\n$$\n1.2.1. 多项式插值示例   使用多项式基$B={1,x,x^2,x^3,\\cdots,x^{n-1}}$\n  求解线性方程组\n  $$\n\\begin{pmatrix}\n1\u0026amp;x_1\u0026amp;\\cdots\u0026amp;x_1^{n-1}\\\\\n1\u0026amp;x_2\u0026amp;\\cdots\u0026amp;x_2^{n-1}\\\\\n\\vdots\u0026amp;\\vdots\u0026amp;\\ddots\u0026amp;\\vdots\\\\\n1\u0026amp;x_n\u0026amp;\\cdots\u0026amp;x_n^{n-1}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\lambda_1\\\\ \\lambda_2\\\\ \\vdots\\\\ \\lambda_n\n\\end{pmatrix}=\n\\begin{pmatrix}\ny_1\\\\ y_2\\\\ \\vdots\\\\ y_n\n\\end{pmatrix}\n$$\n1.2.2. 多项式插值存在的问题  系统矩阵稠密 依赖于基函数选取，矩阵可能病态，导致难以求解（求逆）  病态问题\n  输入数据的细微变化导致输出（解）的剧烈变化\n  将线性方程看成直线（超平面）\n 当系统病态时，直线编程近似平行 求解（即直线求交）变得困难、不精确    举例：\n  考虑二元方程组\n$x_1+0.5x_2=1.5$ 和 $0.667x_1+0.333x_2=1$\n解为$(1,1)$\n  对第二个方程右边项扰动0.001\n$x_1+0.5x_2=1.5$ 和 $0.667x_1+0.333x_2=0.999$\n解为$(0,3)$\n  对矩阵系数进行扰动\n$x_1+0.5x_2=1.5$ 和 $0.667x_1+0.334x_2=0.999$\n解为$(2,-1)$\n    1.2.3. 矩阵条件数 $$\n\\kappa_2(A)=\\dfrac{\\max\\limits_{x\\neq 0}\\dfrac{|Ax|}{|x|}}{\\min\\limits_{x\\neq 0}\\dfrac{|Ax|}{|x|}}\n$$\n 等于最大特征值和最小特征值之间的比例 条件数大意味着基元之间有太多相关性  考虑多项式插值\n 多项式插值问题是病态的  对于等距分布的数据点$x_i$，范德蒙矩阵的条件数随着数据点数$n$呈指数级增长（多项式最高次数为$n-1$）    原因：\n  幂（单项式）函数基\n 幂函数之间差别随次数增加而减小 不同幂函数之间唯一差别为增长速度    1.2.4. 函数互相抵消   对于单项式函数基，从左到右，首先由常函数1主宰，接着$x$增长最快，接着$x^2$增长最快，接着$x^3$增长最快\u0026hellip;\n  好的基函数一般需要系数交替以达到函数的互相抵消\n  解决方法：\n 使用正交多项式基 正交基获得方法：Gram-Schmidt正交化  1.3. 拉格朗日插值方法 拉格朗日插值方法避免求解线性方程组\n1.3.1. 拉格朗日插值的一般形式   构造插值问题的通用解\n  给定$n+1$个点${(x_0,y_0),\\cdots,(x_n,y_n) }$，寻找一组次数为$n$的多项式基函数$l_i$使得\n$$\nl_i(x_j)=\\begin{cases}\n1,\u0026amp;若i=j\\\n0,\u0026amp;若i\\neq j\n\\end{cases}\n$$\n    插值问题的解为\n$$\nP(x)=y_0l_0(x)+y_1l_1(x)+\\cdots+y_nl_n(x)=\\sum\\limits_{i=0}^ny_il_i(x)\n$$\n  1.3.2. 拉格朗日多项式的计算   $n$阶多项式，且有以下$n$个根\n$$\nx_0,x_1,x_2,\\cdots,x_{i-1},x_{i+1}\\cdots,x_n\n$$\n  可表示为\n$$\n\\begin{align}\nl_i(x)\u0026amp;=C_i(x-x_0)(x-x_1)\\cdots(x-x_{i-1})(x-x_{i+1})\\cdots(x-x_n)\\\\\n\u0026amp;=C_i\\prod_{j\\neq i}(x-x_j)\n\\end{align}\n$$\n  由$l_i(x_i)=1$，可得\n$$\n1=C_i\\prod_{j\\neq i}(x_i-x_j)\\Rightarrow C_i=\\dfrac{1}{\\prod_{j\\neq i}(x_i-x_j)}\n$$\n  最终的多项式基函数为\n$$\nl_i(x)=\\dfrac{\\prod_{j\\neq i}(x-x_j)}{\\prod_{j\\neq i}(x_i-x_j)}\n$$\n多项式$l_i(x)$称为拉格朗日多项式\n  1.3.3. 拉格朗日插值 vs 单项式基插值 事实上，给定同一组输入点，利用拉格朗日多项式和利用范德蒙矩阵（单项式基）进行插值所得到的解完全相同\n 假设解不同。记两个解的差别多项式为$R_n$，$R_n$阶数至多为$n$ 那么$R_n(x_i)=0$，$i=0,1,\\cdots,n$，$x_i$为不同插值点。因此$R_n$是有$n+1$个根的$n$阶多项式，因此$R_n=0$  1.3.4. 多项式插值分析  多项式插值不稳定 控制点的微小变化可导致完全不同的结果 振荡现象：多项式随着插值点数（可以是细微的）增加而摆动  解决方法：\n 使用更好的基函数做插值，例如：分片多项式  2. 逼近 2.1. 动机 2.1.1. 使用逼近的原因  数据点含噪声（采样） 更紧凑的表达 计算简单  2.1.2. 常用的逼近函数  多项式 有理函数（多项式商） 三角函数  2.2. 多项式逼近 2.2.1. 万能逼近定理 又叫Weierstrass定理：\n令$f$为闭区间$[a,b]$上任意连续函数，则对任意给定$\\varepsilon$，存在$n$和多项式$P_n$使得\n$$\n|f(x)-P_n(x)|\u0026lt;\\varepsilon,\\forall x\\in[a,b]\n$$\nWeierstrass只证明了存在性，而未给出多项式\n2.2.2. Bernstein多项式逼近 Bernstein多项式构造定理\n对$[0,1]$区间上任意连续函数$f(x)$和任意正整数$n$，以下不等式对所有$x\\in[0,1]$成立\n$$\n|f(x)-B_n(f,x)|\u0026lt;\\dfrac{9}{4}m_{f,n}\n$$\n $m_{f,n}=\\mathop {\\mathrm {lower\\ upper\\ bound}}\\limits_{y_1,y_2\\in[0,1]且|y_1-y_2|\u0026lt;\\frac{1}{\\sqrt{n}}}|f(y_1)-f(y_2)|$ $B_n(f,x)=\\sum_{j=0}^nf(x_j)b_{n,j}(x)$，其中$x_j$为$[0,1]$上等距采样点 $b_{n,j}=\\begin{pmatrix}n\\\\ j\\end{pmatrix}x^j(1-x)^{n-j}$为Bernstein多项式  Bernstein多项式逼近特点\n 逼近结果优秀，但需要高阶 计算昂贵 容易带来误差  2.3. 最小二乘逼近 2.3.1. 逼近问题  给定一组线性无关的连续函数集合$B={b_1,\\cdots,b_n}$和一组结点${(x_1,y_1),\\cdots,(x_m,y_m)}$，其中$m\u0026gt;n$ 在$B$张成空间中寻找对结点逼近最好的函数$f\\in\\mathrm{span}(B)$  2.3.2. 最佳逼近的定义 最小二乘逼近\n$$\n\\mathop{\\mathrm{argmin}}\\limits_{f\\in\\mathrm{span(B)}}\n\\sum\\limits_{j=1}^m(f(x_j)-y_j)^2\n$$\n$$\n\\begin{align}\n\\sum\\limits_{j=1}^m(f(x_j)-y_j)^2\u0026amp;=\\sum\\limits_{j=1}^m\\Big(\\sum\\limits_{i=1}^n\\lambda_ib_i(x_j)-y_j\\Big)^2\\\\\n\u0026amp;=(M\\pmb\\lambda-\\pmb y)^T(M\\pmb \\lambda-\\pmb y)\\\\\n\u0026amp;=\\pmb y^T\\pmb y-2\\pmb y^TM\\pmb \\lambda+\\pmb \\lambda^TM^TM\\pmb \\lambda\n\\end{align}\n$$\n其中，$\\pmb \\lambda=(\\lambda_1,\\lambda_2,\\cdots,\\lambda_n)^T$，$\\pmb y=(y_1,y_2,\\cdots,y_m)^T$，$M=\\begin{pmatrix}b_1(x_1)\u0026amp;\\cdots\u0026amp;b_n(x_1)\\\\ \\vdots\u0026amp;\\ddots\u0026amp;\\vdots\\\\ b_1(x_m)\u0026amp;\\cdots\u0026amp;b_n(x_m) \\end{pmatrix}$\n2.3.3. 最小二乘解   关于$\\pmb\\lambda$的二次多项式\n$$\n\\pmb\\lambda^TM^TM\\pmb\\lambda-2\\pmb y^TM\\pmb \\lambda+\\pmb y^T\\pmb y\n$$\n  最小解满足\n$$\nM^TM\\pmb\\lambda=M^T\\pmb y\n$$\n  ","description":"插值与逼近","id":1,"section":"note","tags":["CAGD"],"title":"CAGD(1) | 插值与逼近","uri":"https://chaphlagical.github.io/zh/note/cagd/cagd1/"},{"content":"1. 曲线的表示 1.1. 隐式表示 曲线隐式表示为$f(x,y)=0$，该方法有诸多局限性：\n 对于同一个$x$横坐标值对应多个纵坐标值 存在一些位置，导数$\\dfrac{\\mathrm dy}{\\mathrm dx}$没有定义 关于轴变换非不变  1.2. 参数表示 曲线参数表示为$c(t)=(x(t),y(t))$\n 求值方便 参数$t$可作为时间进行插值 曲线可以理解为运动粒子的运动轨迹跟踪  2. 曲线建模举例 2.1. 用幂函数基进行建模 以抛物线$\\pmb f(t)=\\pmb at^2+\\pmb bt+\\pmb c$为例\n 幂函数基的系数缺少直觉上的几何意义  2.2. 一种改进的画法 其中，\n $\\pmb b_0^1=(1-t)\\pmb b_0+t\\pmb b_1$ $\\pmb b_1^1=(1-t)\\pmb b_1+t\\pmb b_2$  $$\n\\begin{align}\n\\pmb b_0^2\n\u0026amp;=(1-t)\\pmb b_0^1+t\\pmb b_1^1\\\\\n\u0026amp;=(1-t)[(1-t)\\pmb b_0+t\\pmb b_1]+t[(1-t)\\pmb b_1+t\\pmb b_2]\\\\\n\u0026amp;=(1-t)^2\\pmb b_0+2t(1-t)\\pmb b_1+t^2\\pmb b_2\n\\end{align}\n$$\n以之前的例子\n$$\n\\pmb f(t)=\\begin{pmatrix}1\\\\1\\end{pmatrix}t^2+\\begin{pmatrix}-2\\\\0\\end{pmatrix}t+\\begin{pmatrix}1\\\\0\\end{pmatrix}\n$$\n转为上述形式：\n$$\n\\pmb f(t)=\\begin{pmatrix}1\\\\0\\end{pmatrix}(1-t)^2+\\begin{pmatrix}0\\\\0\\end{pmatrix}2t(1-t)+\\begin{pmatrix}0\\\\1\\end{pmatrix}t^2\n$$\n在图上表示为\n 各系数均有相应的几何意义 更多直觉上的曲线操作  对于四个控制点，同样有：\n$$\n\\begin{matrix}\n\\pmb p_0^0(t)=\\pmb p_0,\u0026amp;\\pmb p_1^0(t)=\\pmb p_1,\u0026amp;\\pmb p_2^0(t)=\\pmb p_2,\u0026amp;\\pmb p_3^0(t)=\\pmb p_3\n\\end{matrix}\n$$\n第一次迭代：\n$$\n\\begin{align}\n\\pmb p_0^1\u0026amp;=(1-t)\\pmb p_0+t\\pmb p_1\\\\\n\\pmb p_1^1\u0026amp;=(1-t)\\pmb p_1+t\\pmb p_2\\\\\n\\pmb p_2^1\u0026amp;=(1-t)\\pmb p_2+t\\pmb p_3\n\\end{align}\n$$\n第二次迭代：\n$$\n\\begin{align}\n\\pmb p_0^2=(1-t)^2\\pmb p_0+2t(1-t)\\pmb p_1+t^2\\pmb p_2\\\\\n\\pmb p_1^2=(1-t)^2\\pmb p_1+2t(1-t)\\pmb p_2+t^2\\pmb p_3\\\n\\end{align}\n$$\n最终得到的曲线方程：\n$$\n\\pmb c(t)=(1-t)^3\\pmb p_0+3t(1-t)^2\\pmb p_1+3t^2(1-t)\\pmb p_2+t^3\\pmb p_3\n$$\n3. De Casteljau算法 3.1. 动机  对给定$t$计算$\\pmb x(t)$  按比例$t:(1-t)$平分控制多边形 用线连接新点（相邻线段） 用相同比例进行插值 迭代，直到只剩下一个点    3.2. 算法描述   输入点：$\\pmb b_0,\\pmb b_1,\\cdots,\\pmb b_n\\in\\mathbb R^3$\n  输出曲线：$\\pmb x(t),t\\in [0,1]$\n  对给定$t$进行点$\\pmb x(t)$的几何构造\n$$\n\\begin{align}\n\\pmb b_i^0(t)\u0026amp;=\\pmb b_i,\\ \\ \\ \\ i=0,\\cdots,n\\\\\n\\pmb b_i^r(t)\u0026amp;=(1-t)\\pmb b_i^{r-1}(t)+t\\pmb b_{i+1}^{r-1}(t)\\\\\nr=\u0026amp;1,\\cdots,n\\ \\ \\ \\ i=0,\\cdots,n-r\n\\end{align}\n$$\n  最后，$\\pmb b_0^n(t)$为所找的曲线点$\\pmb x(t)$在参数值$t$的取值\n  所有系数可写为下三角矩阵：\n$$\n\\begin{matrix}\n\\pmb b_0=\\pmb b_0^0\\\\\n\\pmb b_1=\\pmb b_1^0\u0026amp;\\pmb b_0^1\\\\\n\\pmb b_2=\\pmb b_2^0\u0026amp;\\pmb b_1^1\u0026amp;\\pmb b_0^2\\\\\n\\pmb b_3=\\pmb b_3^0\u0026amp;\\pmb b_2^1\u0026amp;\\pmb b_1^2\u0026amp;\\pmb b_0^3\\\\\n\\vdots\u0026amp;\\vdots\u0026amp;\\vdots\u0026amp;\\ddots\u0026amp;\\ddots\\\\\n\\pmb b_{n-1}=\\pmb b_{n-1}^0\u0026amp;\\pmb b_{n-2}^1\u0026amp;\\cdots\u0026amp;\\cdots\u0026amp;\\cdots\u0026amp;\\pmb b_0^{n-1}\\\\\n\\pmb b_n=\\pmb b_n^0\u0026amp;\\pmb b_{n-1}^1\u0026amp;\\cdots\u0026amp;\\cdots\u0026amp;\\cdots\u0026amp;\\pmb b_1^{n-1}\u0026amp;\\pmb b_0^n=\\pmb x(t)\n\\end{matrix}\n$$\n伪代码：\n3.3. De Casteljau算法性质   包含点$\\pmb b_0,\\cdots,\\pmb b_n$的多边形称为Bezier多边形\n  点$\\pmb b_i$称为Bezier点（控制点）\n  由Bezier点$\\pmb b_0,\\cdots,\\pmb b_n$和De Casteljau算法所定义的曲线称为Bezier曲线\n  De Casteljau算法是数值稳定的，因为只使用了凸组合\n  De Casteljau算法复杂度\n 时间复杂度$O(n^2)$ 空间复杂度$O(n)$ 其中$n$为Bezier点的数量    Bezier曲线的性质\n  给定Bezier点$\\pmb b_0,\\cdots,\\pmb b_n$和Bezier曲线$\\pmb x(t)$\n  Bezier曲线是$n$阶多项式曲线\n  端点$\\pmb x(0)=\\pmb b_0,\\pmb x(1)=\\pmb b_n$插值，其余的Bezier点仅仅是大致的近似值\n  凸包性质：\n Bezier曲线完全在其Bezier多边形的凸包内部    变化减少\n 没有直线与Bezier曲线的交点比Bezier多边形多    Bezier点的影响：全局但伪局部\n 全局：移动Bezier点会改变整个曲线的形状 伪局部：点$\\pmb b_i$对$x(t)$在$t=\\dfrac{i}{n}$有最大的影响    仿射不变性\n Bezier曲线和Bezier多边形在仿射变换下不变    仿射参数变换不变性\n  对称性\n 以下两条Bezier曲线重合，它们仅在相反的方向上移动：  $$\n\\begin{matrix}\n\\pmb x(t)=[\\pmb b_0,\\cdots,\\pmb b_n]\u0026amp;\n\\pmb x'(t)=[\\pmb b_n,\\cdots,\\pmb b_0]\n\\end{matrix}\n$$\n  线性精确\n 当$\\pmb b_0,\\cdots,\\pmb b_n$共线时，Bezier曲线为线段    重心组合下的不变性\n    4. Bezier曲线 Bezier曲线表示为基函数组合：\n$$\n\\pmb x(t)=\\sum\\limits_{i=0}^n\\pmb B_i^n(t)\\cdot b_i\n$$\n4.1. 期望特性  对基底的要求：  良好性质的曲线  光滑的基函数   局部控制（或者至少半局部）  紧致的基函数   仿射不变性  对控制点或曲线进行仿射变换$\\pmb x=A\\pmb x+b$应该有相同的效果 例如：旋转、平移 否则交互式编辑曲线将非常困难   凸包性质  曲线处于其控制点的凸包内 至少能够避免奇怪的震荡   优点  计算优势（递归相交测试） 更多可预测的行为      4.2. 仿射不变性  仿射变换：$\\pmb x\\rightarrow A\\pmb x+\\pmb b$  4.2.1. 线性不变性 Bezier曲线的线性不变性是显然的，Bezier曲线表示为基函数的线性组合：\n$$\n\\pmb f(t)=\\sum\\limits_{i=1}^nb_i(t)\\pmb p_i=\\sum\\limits_{i=1}^nb_i(t)\\begin{pmatrix}\np_i^{(x)}\\\\p_i^{(y)}\\\\p_i^{(z)}\n\\end{pmatrix}\n$$\n因此\n$$\nA(\\pmb f(t))=A\\Big(\\sum\\limits_{i=1}^nb_i(t)\\pmb p_i \\Big)=\\sum\\limits_{i=1}^nb_i(t)(A\\pmb p_i)\n$$\n4.2.2. 平移不变性 $$\n\\sum\\limits_{i=1}^nb_i(t)(\\pmb p_i+\\pmb b)=\\sum\\limits_{i=1}^nb_i(t)\\pmb p_i+\\sum\\limits_{i=1}^nb_i(t)\\pmb b=\\pmb f(t)+\\Big(\\sum\\limits_{i=1}^nb_i(t)\\Big)\\pmb b\n$$\n 为了满足平移不变性，基函数的和应恒为1 这也称为\u0026quot;partition of unity property\u0026quot;，单位划分性质 $\\pmb b_i$是控制点$\\pmb p_i$的“仿射组合” 该性质对建模非常重要  4.3. 凸包性质   凸组合\n  点集${\\pmb p_1,\\cdots,\\pmb p_n}$的一个凸组合为如下形式\n$$\n\\sum\\limits_{i=1}^n\\lambda_i\\pmb p_i\\ \\mathrm{with}\\sum\\limits_{i=1}^n\\lambda_i=1\\ \\mathrm{and}\\ \\forall i=1,\\cdots,n:0\\leq\\lambda_i\\leq 1\n$$\n  所有允许的凸组合的集合形成点集的凸包\n 凸包是包含所有点集${\\pmb p_1,\\cdots,\\pmb p_n}$以及集合中两个元素之间的每条完整连线的最小集合      相应地\n  如果我们有性质：\n$$\n\\forall t\\in\\Omega:\\sum\\limits_{i=1}^nb_i(t)=1\\ \\mathbb {and}\\ \\forall t\\in\\Omega,\\forall i:b_i(t)\\geq 0\n$$\n所构造地曲线/曲面将满足：\n 仿射不变性（平移，线性映射） 限制在控制点的凸包中    推论：曲线将有linear precision（线性精确）\n 当所有控制点共线时，曲线为直线段 具有平面控制点的曲面也将是平面      凸包性质在实践中十分有用\n 避免不良震荡  被限制在凸包内，不像多项式插值   线性精确性质比较直观（用户友好） 可用于快速范围检查  相交测试可以先对凸包进行，然后再对物体进行 递归相交算法与细分规则结合使用      4.4. Bezier曲线的多项式描述   给定$(n+1)$个控制点$\\pmb b_0,\\cdots,\\pmb b_n$\n  目标：Bezier曲线$\\pmb x(t)$，其中$t\\in[0,1]$\n  定义$n+1$个基函数，通过其线性组合来描述一个Bezier曲线\n$$\nB_0^n(t),\\cdots,B_n^n(t)\\ \\mathbb{over}\\ [0,1]\n$$\n$$\n\\pmb x(t)=\\sum\\limits_{i=0}^nB_i^n(t)\\cdot\\pmb b_i\n$$\n  4.4.1. Bernstein基函数 Bernstein基函数：$B={B_0^{(n)},B_1^{(n)},\\cdots,B_n^{(n)} }$\n  $n$次Bernstein基函数\n$$\nB_i^{(n)}(t)=\\begin{pmatrix}n\\\\ i\\end{pmatrix}\nt^i(1-t)^{n-i}\n$$\n其中，二项式系数\n$$\n\\begin{pmatrix}n\\\\i\\end{pmatrix}=\n\\begin{cases}\n\\dfrac{n!}{(n-i)!!}\u0026amp;\\mathrm {for}\\ 0\\leq i\\leq n\\\\\n0\u0026amp;\\mathrm{otherwise}\n\\end{cases}\n$$\n杨氏三角：\n前三组Bernstein基函数\n  4.4.2. Bernstein基函数的性质 $$\nB={B_0^{(n)},B_1^{(n)},\\cdots,B_n^{(n)}},\\ \\ \\\nB_i^{(n)}=\\begin{pmatrix}n\\\\i\\end{pmatrix}t^i(1-t)^{n-i}\n$$\n光滑性\n基函数为$n$次多项式——显然光滑\n局部控制\n每个基函数$B_i^{(n)}$在$t=\\dfrac{i}{n}$处取最大值——对该处有最大影响\n凸包性质和仿射不变性\n组合数的性质：\n$$\n\\sum\\limits_{i=0}^nB_i^{(n)}(t)=(t+(1-t))^n=1\n$$\n递归计算特性\n$$\n\\begin{align}\nB_i^n(t):=(1-t)B_i^{(n-1)}(t)+tB_{i-1}^{(n-1)}(1-t)\\\\ \\mathrm{with}\\ B_0^0(t)=1,B_i^n(t)=0\\ \\ \\mathrm {for}\\ i\\not\\in{0,\\cdots,n}\n\\end{align}\n$$\n对称性\n$$\nB_i^n(t)=B_{n-i}^n(1-t)\n$$\n非负性\n$$\nB_i^{(n)}(t)\\geq 0\\ \\mathrm{for}\\ t\\in[0,\\cdots,1]\n$$\n$$\nB_i^{(n)}(t)\u0026gt;0\\ \\mathrm{for}\\ 0\u0026lt;t\u0026lt;1\n$$\n$$\n\\begin{align}\nB_0^{(n)}(0)=1,\\ \\ \\ \\ B_1^{(n)}(0)=\\cdots=B_n^{(n)}(0)=0\\\\\nB_0^{(n)}(1)=\\cdots=B_{n-1}^{(n)}=0,\\ \\ \\ \\ B_n^{(n)}(1)=1\n\\end{align}\n$$\n导数\n$$\n\\begin{align}\n\\dfrac{\\mathrm d}{\\mathrm dt}B_i^{(n)}(t)\u0026amp;=\\begin{pmatrix}n\\\\ i\\end{pmatrix}(it^{i-1}(1-t)^{n-i}-(n-i)t^i(1-t)^{n-i-1})\\\\\\ \u0026amp;=\\dfrac{n!}{(n-i)!i!}it^{i-1}(1-t)^{n-i}-\\dfrac{n!}{(n-i)!i!}(n-i)t^i(1-t)^{n-i-1}\\\\\u0026amp;=n\\Bigg[\\begin{pmatrix}n-1\\\\ i-1\\end{pmatrix}t^{i-1}(1-t)^{n-i}-\\begin{pmatrix}n-1\\\\ i\\end{pmatrix}t^i(1-t)^{n-i-1} \\Bigg]\\\\ \u0026amp;=n\\Big[B^{(n-1)}_{i-1}(t)-B_i^{(n-1)}(t)\\Big]\n\\end{align}\n$$\n$$\n\\begin{align}\n\\dfrac{\\mathrm d^2}{\\mathrm dt^2}B_i^{(n)}(t)\u0026amp;=\\dfrac{\\mathrm d}{\\mathrm dt}\\Big[B_{i-1}^{(n-1)}(t)-B_i^{(n-1)}(t) \\Big]\\\\ \u0026amp;=n\\Big[(n-1)\\Big(B_{i-2}^{(n-2)}(t)-B_{i-1}^{(n-2)}(t) \\Big)-(n-1)\\Big(B_{i-1}^{(n-2)}(t)-B_i^{(n-2)}(t) \\Big) \\Big]\\\\ \u0026amp;=n(n-1)\\Big[B_{i-2}^{(n-2)}(t)-2B_{i-2}^{(n-2)}(t)+B_i^{(n-2)}(t) \\Big]\n\\end{align}\n$$\n4.5. Bezier曲线的性质 4.5.1. 前面提到过的性质：   仿射不变性\n  凸包性质\n  控制点影响性\n  4.5.2. 导数性质 对于$t\\in[0,1]$，有\n$$\n\\pmb f(t)=\\sum\\limits_{i=0}^{n-1}\\begin{pmatrix}n\\\\i\\end{pmatrix}t^i(1-t)^{n-i}\\pmb p_i\\\n\\Rightarrow \\pmb f(0)=\\pmb p_0\\ \\ \\ \\ \\pmb f(1)=\\pmb p_1\n$$\n一阶导数\n$$\n\\begin{align}\n\\dfrac{\\mathrm d}{\\mathrm dt}\\pmb f(t)\u0026amp;=n\\sum\\limits_{i=0}^{n-1}\\Big[B_{i-1}^{(n-1)}(t)-B_i^{(n-1)}(t) \\Big]\\pmb p_i\\\\\n\u0026amp;=n\\Big(\\Big[-B_0^{(n-1)}(t) \\Big]\\pmb p_0+\\Big[B_0^{n-1}(t)-B_1^{(n-1)}(t) \\Big]\\pmb p_1+\\cdots\\Big)\n\\end{align}\n$$\n$$\n\\begin{matrix}\n\\dfrac{\\mathrm d}{\\mathrm dt}\\pmb f(0)=n(\\pmb p_1-\\pmb p_0)\u0026amp;\\dfrac{\\mathrm d}{\\mathrm dt}\\pmb f(1)=n(\\pmb p_n-\\pmb p_{n-1})\n\\end{matrix}\n$$\n以此类推，对于边界点${0,1}$，有\n$$\n\\begin{align}\n\\pmb f(0)\u0026amp;=\\pmb p_0\\\\\n\\pmb f(1)\u0026amp;=\\pmb p_1\\\\\n\\pmb f'(0)\u0026amp;=n[\\pmb p_1-\\pmb p_0]\\\\\n\\pmb f'(1)\u0026amp;=n[\\pmb p_n-\\pmb p_{n-1}]\\\\\n\\pmb f''(0)\u0026amp;=n(n-1)[\\pmb p_2-2\\pmb p_1+\\pmb p_0]\\\\\n\\pmb f''(1)\u0026amp;=n(n-1)[\\pmb p_n-2\\pmb p_{n-1}+\\pmb p_{n-2}]\n\\end{align}\n$$\n对于一阶导数，还有：\n$$\n\\begin{align}\n\\pmb f'(t)\u0026amp;=\\sum_{i=0}^n\\dfrac{\\mathrm d}{\\mathrm dt}B_i^{(n)}(t)\\pmb p_i\\\\\n\u0026amp;=n\\sum_{i=0}^n\\Big(B_{i-1}^{(n-1)}(t)-B_i^{(n-1)}(t) \\Big)\\pmb p_i\\\\\n\u0026amp;=n\\sum_{i=0}^nB_{i-1}^{(n-1)}(t)\\pmb p_i-n\\sum_{i=0}^nB_i^{(n-1)}(t)\\pmb p_i\\\\\n\u0026amp;=n\\sum_{i=-1}^{n-1}B_i^{(n-1)}(t)\\pmb p_{i+1}-n\\sum\\limits_{i=0}^nB_i^{(n-1)}(t)\\pmb p_i\\\\\n\u0026amp;=n\\sum_{i=0}^{n-1}B_i^{(n-1)}(t)\\pmb p_{i+1}-n\\sum\\limits_{i=0}^{n-1}B_i^{(n-1)}(t)\\pmb p_i\\\\\n\u0026amp;=n\\sum\\limits_{i=0}^{n-1}B_i^{(n-1)}(t)(\\pmb p_{i+1}-\\pmb p_i)\n\\end{align}\n$$\n高阶导数：\n$$\n\\pmb f^{[r]}(t)=\\dfrac{n!}{(n-r)!}\\sum\\limits_{i=0}^{n-r}B_i^{(n-r)}(t)\\cdot\\Delta^r\\pmb p_i\n$$\n4.6. Bezier曲线升阶（Degree Evaluation）   给定：$\\pmb b_0,\\cdots,\\pmb b_n\\rightarrow \\pmb x(t)$\n  目标：$\\overline{\\pmb b}_0,\\cdots,\\overline{\\pmb b_n},\\overline{\\pmb b}_{n+1} \\rightarrow \\overline{\\pmb x}(t)$ with $\\pmb x=\\overline{\\pmb x}$\n  解决方法：\n  $$\n\\begin{align}\n\\overline{\\pmb b}_0\u0026amp;=\\pmb b_0\\\\\n\\overline{\\pmb b}_{n+1}\u0026amp;=\\pmb b_n\\\\\n\\overline{\\pmb b}_j\u0026amp;=\\dfrac{j}{n+1}\\pmb b_{j-1}+\\Big(1-\\dfrac{j}{n+1}\\Big)\\pmb b_j\\ \\mathrm{for}\\ j=1,\\cdots,n\n\\end{align}\n$$\n  证明：\n考虑\n$$\n\\begin{align}\n(1-t)B_i^n(t)\u0026amp;=(1-t)\\begin{pmatrix}n\\\\i\\end{pmatrix}\n(1-t)^{n-i}t^i\\\\\n\u0026amp;=\\begin{pmatrix}n\\\\i\\end{pmatrix}(1-t)^{n+1-i}t^i\\\\\n\u0026amp;=\\dfrac{n+1-i}{n+1}\\begin{pmatrix}n+1\\\\i\\end{pmatrix}(1-t)^{n+1-i}t^i\\\\\n\u0026amp;=\\dfrac{n+1-i}{n+1}B_i^{n+1}(t)\n\\end{align}\n$$\n类似地，\n$$\ntB_i^n(t)=\\dfrac{i+1}{n+1}B_i^{n+1}(t)\n$$\n从而有：\n$$\n\\begin{align}\n\\pmb f(t)\u0026amp;=[(1-t)+t]\\pmb f(t)\\\\\n\u0026amp;=[(1-t)+t]\\sum\\limits_{i=0}^nB_i^n(t)\\pmb P_i\\\\\n\u0026amp;=\\sum\\limits_{i=0}^n\\Big[(1-t)B_i^n(t)+tB_i^n(t)\\Big]\\pmb P_i\\\\\n\u0026amp;=\\sum\\limits_{i=0}^n\\Bigg[\\dfrac{n+1-i}{n+1}B_i^{n+1}(t)+\\dfrac{i+1}{n+1}B_{i+1}^{n+1}(t) \\Bigg]\\pmb P_i\\\\\n\u0026amp;=\\sum\\limits_{i=0}^n\\dfrac{n+1-i}{n+1}B_i^{n+1}(t)\\pmb P_i+\\sum\\limits_{i=0}^n\\dfrac{i+1}{n+1}B_{i+1}^{n+1}(t) \\pmb P_i\\\\\n\u0026amp;=\\sum\\limits_{i=0}^n\\dfrac{n+1-i}{n+1}B_i^{n+1}(t)\\pmb P_i+\\sum\\limits_{i=1}^n\\dfrac{i}{n+1}B_{i}^{n+1}(t) \\pmb P_{i-1}\\\\\n\u0026amp;=\\sum\\limits_{i=0}^{n+1}\\dfrac{n+1-i}{n+1}B_i^{n+1}(t)\\pmb P_i+\\sum\\limits_{i=0}^n\\dfrac{i}{n+1}B_{i}^{n+1}(t) \\pmb P_{i-1}\\\\\n\u0026amp;=\\sum\\limits_{i=0}^{n+1}B_i^{n+1}(t)\\Bigg[\\dfrac{n+1-i}{n+1}\\pmb P_i+\\dfrac{i}{n+1}\\pmb P_{i-1} \\Bigg]\n\\end{align}\n$$\n  4.7. 细分   给定\n$$\n\\pmb b_0,\\cdots,\\pmb b_n\\rightarrow \\pmb x(t),t\\in[0,1]\n$$\n  目标\n$$\n\\begin{align}\n\\pmb b_0^{(1)},\\cdots,\\pmb b_n^{(1)}\\rightarrow \\pmb x^{(1)}(t)\\\\\n\\pmb b_0^{(2)},\\cdots,\\pmb b_n^{(2)}\\rightarrow \\pmb x^{(2)}(t)\\\\\n\\mathrm{with}\\quad \\pmb x=\\pmb x^{(1)}\\cup\\pmb x^{(2)}\n\\end{align}\n$$\n  解决方法\n$$\n\\pmb b_i^{(1)}=\\pmb b_0^i,\\pmb b_i^{(2)}=\\pmb b_0^{n-i}\\ \\mathrm{for}\\ i=0,\\cdots,n\n$$\n  4.8. 曲线范围 4.9. 矩阵实现 三次Bezier曲线\n$$\n\\pmb P(t)=\\pmb V_0B_{0,3}+\\pmb V_1B_{1,3}+\\pmb V_2B_{2,3}+\\pmb V_3B_{3,3}\n$$\n$$\n\\begin{align}\nB_{0,3}\u0026amp;=\\dfrac{3!}{0!3!}t^0(1-t)^3=(1-t)^3\\\\\nB_{1,3}\u0026amp;=\\dfrac{3!}{1!2!}t^1(1-t)^2=3t(1-t)^2\\\\\nB_{2,3}\u0026amp;=\\dfrac{3!}{2!1!}t^2(1-t)^1=3t^2(1-t)\\\\\nB_{3,3}\u0026amp;=\\dfrac{3!}{3!0!}t^3(1-t)^0=t^3\n\\end{align}\n$$\n矩阵形式表示：\n$$\n\\pmb P(t)=\\begin{bmatrix}t^3\u0026amp;t^2\u0026amp;t\u0026amp;1\\end{bmatrix}\n\\begin{pmatrix}\n-1\u0026amp;3\u0026amp;-3\u0026amp;1\\\\3\u0026amp;-6\u0026amp;3\u0026amp;0\\\\-3\u0026amp;0\u0026amp;3\u0026amp;0\\\\1\u0026amp;4\u0026amp;1\u0026amp;0\n\\end{pmatrix}\n\\begin{bmatrix}\nV_{i-1}\\\\V_i\\\\V_{i+1}\\\\V_{i+2}\n\\end{bmatrix}\n$$\n导数的矩阵表示：\n$$\n\\pmb P'(t)=\\begin{bmatrix}3t^2\u0026amp;2t\u0026amp;1\u0026amp;0\\end{bmatrix}\n\\begin{pmatrix}\n-1\u0026amp;3\u0026amp;-3\u0026amp;1\\\\3\u0026amp;-6\u0026amp;3\u0026amp;0\\\\-3\u0026amp;0\u0026amp;3\u0026amp;0\\\\1\u0026amp;4\u0026amp;1\u0026amp;0\n\\end{pmatrix}\n\\begin{bmatrix}\nV_{i-1}\\\\V_i\\\\V_{i+1}\\\\V_{i+2}\n\\end{bmatrix}\n$$\n","description":"Bezier曲线","id":2,"section":"note","tags":["CAGD"],"title":"CAGD(2) | Bezier曲线","uri":"https://chaphlagical.github.io/zh/note/cagd/cagd2/"},{"content":"1. 参数曲线 1.1. 直观简介  参数曲线$c$可以视为移动粒子的运动轨迹 参数$t$可视为时间参数  1.2. 数学描述 1.2.1. 定义 $\\mathbb R^n$中的曲线类$C^k(k\\geq 1)$的参数化是光滑映射$c:I=[a,b]\\subset \\mathbb R\\rightarrow\\mathbb R^n$，其中$c$属于类$C^k$\n1.2.2. 迹线（trace） 图像集合$c(I)$称为曲线的迹线\n 不同的参数化可能有相同的迹线  1.2.3. 自相交（self-intersection） 迹线中的一个点对应多个参数值$t$，则称曲线的自相交\n1.2.4. 速度向量 曲线$c$在时刻$t$的导数$c'(t)$称为曲线的速度向量\n $c'(t)$给定移动的方向 $|c'(t)|$给定速度大小  1.3. 正则参数曲线（Regular parametric curves）  正则参数化  对于所有的$t$，有$c'(t)\\neq 0$ 正则曲线上的点称为平凡（ordinary）点 非正则曲线上的点称为奇异（singular）点    1.4. 参数的变换 给定一个光滑的正则参数化，参数所允许的更改为任意光滑（可微）函数\n$$\nf:I_1\\rightarrow I\\ \\mathrm{such}\\ \\mathrm{that}\nf'\\neq 0\\ \\mathrm{on}\\ I_1\n$$\n当$f'\u0026gt;0$将保持方向\n 我们可以将正则曲线视为正则参数化的集合，其中任意两个参数都是彼此之间的重新参数化（等价类） 我们对参数变换下的不变量感兴趣  1.5. 几何观察 切线向量（Tangent vector）\n 正则曲线$c(t)$在点$\\pmb p_0=\\pmb c(t_0)$处的正弦线定义为满足$\\pmb p-\\pmb p_0\\parallel\\pmb c_0'$的点$\\pmb p$，其中$\\pmb c'_0=\\pmb c'(t_0)$ 归一化向量$\\pmb t=\\dfrac{\\pmb c'}{\\vert c'\\vert}$称为切线向量  法平面（Normal plane）\n法平面描述为满足$\\pmb p-\\pmb p_0\\perp\\pmb c_0'$的点$\\pmb p$，即\n$$\n(\\pmb p-\\pmb p_0)\\cdot\\pmb c_0'=0\n$$\n密切平面（Osculating plane）\n  假设曲线$\\pmb c(t)$不是一条直线，任意三个不共线的点$\\pmb p_1,\\pmb p_2,\\pmb p_3$，能够决定一个平面\n  如果$\\pmb p_1,\\pmb p_2,\\pmb p_3$趋于于曲线$\\pmb c$上的同一个点$\\pmb p_0$，那么其构成的平面称为曲线$\\pmb c$在点$\\pmb p_0$处的密切平面$T$\n  若曲线在点$\\pmb p_0$处的一阶导数$\\pmb c_0'$和二阶导数$\\pmb c''_0$线性独立，则密切平面给定为：\n$$\n(\\pmb c_0'\\times\\pmb c_0'')\\cdot(\\pmb p-\\pmb p_0)=0\n$$\n  观察$\\pmb p(t+\\Delta t)$与以$\\pmb a$为法向量且穿过点$\\pmb p(t)$的平面的距离，有\n$$\n\\pmb a\\cdot(\\pmb p(t_0+\\Delta t)-\\pmb p(t_0))=\\pmb a\\cdot \\Big(\\dot{\\pmb p}(t_0)\\Delta t+\\dfrac{\\ddot{\\pmb p}(t_0)}{2!}\\Delta t^2+\\cdots \\Big)\n$$\n当距离取最小值时，有\n$$\n\\pmb a\\cdot\\dot{\\pmb P}(t_0)=0,\\ \\ \\\n\\pmb a\\cdot\\ddot{\\pmb P}(t_0)=0\n$$\n此时取得密切平面，密切平面是曲线在$\\pmb p(t_0)$处的最优拟合平面\n从切平面（Rectifying plane）\n同时垂直于密切平面和法平面的平面称为从切平面$R$，从切平面上的点$\\pmb p$满足\n$$\n(\\pmb c_0'\\times(\\pmb c_0'\\times\\pmb c_0''))\\cdot(\\pmb p-\\pmb p_0)=0\n$$\n法向量\n法平面内的任何向量均为曲线的法向量，特别地\n  点$\\pmb p_0$处同时位于密切平面内的法向量$\\pmb n$（密切平面与法平面交线）称为主法向量（principal normal ）\n$$\n(\\pmb c_0'\\times\\pmb c_0'')\\times\\pmb c_0'\n$$\n  点$\\pmb p_0$处同时位于从切平面的法向量$\\pmb b$称为副法向量（binormal）\n$$\n\\pmb c_0'\\times\\pmb c_0''\n$$\n  Frenet标架\n通过以下三个正交向量构造曲线上的局部坐标架\n  切线向量\n$$\n\\pmb t=\\dfrac{\\pmb c'}{|\\pmb c_0'|}\n$$\n  副法向量\n$$\n\\pmb b=\\dfrac{\\pmb c_0'\\times\\pmb c_0''}{|\\pmb c_0'\\times\\pmb c_0''|}\n$$\n  主法向量\n$$\n\\pmb n=\\pmb b\\times\\pmb t\n$$\n  对应的关联平面：\n  法平面\n$$\n(\\pmb p-\\pmb p_0)\\cdot\\pmb t=0\n$$\n  密切平面\n$$\n(\\pmb p-\\pmb p_0)\\cdot\\pmb b=0\n$$\n  从切平面\n$$\n(\\pmb p-\\pmb p_0)\\cdot\\pmb n=0\n$$\n  曲率\n  曲率的基本概念\n 测量曲线的弯曲程度 直线没有弯曲 → 曲率为0 圆有固定的弯曲程度 → 曲率为常数    曲率的计算\n$$\n\\kappa(t)=\\dfrac{|\\pmb c'(t)\\times\\pmb c''(t)|}{|\\pmb c'(t)|^3}\n$$\n特别地，对于平面曲线$\\pmb c(t)=(x(t),y(t))$\n$$\n\\kappa(t)=\\dfrac{|x\u0026rsquo;y''-x'\u0026lsquo;y\u0026rsquo;|}{(x'^2+y'^2)^{\\frac{3}{2}}}\n$$\n曲率半径:$r(t)=\\dfrac{1}{\\kappa(t)}$\n  挠率\n  定义\n  挠率$\\tau$衡量副法向量的变化\n  （曲线从其在密切平面上的投影的偏移量可以视为曲线离平面曲线有多远），由下式给出\n$$\n\\tau(t)=\\dfrac{(\\pmb c'\\times\\pmb c'')\\cdot\\pmb c'''}{|\\pmb c'\\times\\pmb c''|^2}\n$$\n    曲线的长度\n  曲线的弧长\n  正则曲线$C$的弧长定义为：\n$$\n\\mathrm{length}_c=\\int_a^b|\\dot{\\pmb c}|\\mathrm dt\n$$\n  独立于参数的选取\n    2. 弧长曲线曲线 2.1. 弧长参数化   考虑$\\pmb c(t)$从0到$t$跨度的部分，该段弧长$s$为一个关于$t$的函数\n$$\ns(t)=\\int_0^t|\\pmb c'(u)|\\mathrm du\n$$\n  由于$\\dfrac{\\mathrm ds}{\\mathrm dt}=\\vert\\vert \\pmb c'(u)\\vert\\vert\u0026gt;0$，$s$可以作为新的参数化方式\n  易得：\n$$\n\\pmb c'(s)=\\dfrac{\\mathrm d\\pmb c}{\\mathrm ds}=\\dfrac{\\mathrm d\\pmb c/\\mathrm dt}{\\mathrm ds/\\mathrm dt}\\Rightarrow |\\pmb c'(s)|=1\n$$\n  $\\pmb c(s)$称为弧长（单位速度）参数化曲线，参数$s$称为弧长或自然参数\n  2.2. 用弧长进行参数化  弧长（或单位速度）参数化  任意正则曲线都存在弧长参数化 不意味着弧长参数化能够被计算    2.3. 弧长参数化的几何结果   由于$\\vert\\vert\\pmb c'(u)\\vert\\vert=1$，有$\\pmb c'\\cdot\\pmb c'=1$，取导数得到$\\pmb c'\\cdot\\pmb c''=0$\n  $\\pmb c''$与$\\pmb c'$互相垂直（均位于密切平面）\n  因此$\\pmb c''$的方向向量可作为主法向量（$\\pmb c''\\neq \\pmb 0$）\n$$\n\\pmb n=\\dfrac{\\pmb c''}{|\\pmb c''|}\n$$\n  2.4. 曲率   弧长参数曲线$\\pmb c(u)$的曲率为\n$$\n\\kappa=|\\pmb c''(u)|\n$$\n  3. Frenet曲线 3.1. 基本概念  Frenet曲线  Frenet曲线是$\\mathbb R^n$内的弧长参数曲线$\\pmb c$，满足$\\pmb c'(s),\\pmb c''(s),\\cdots,\\pmb c^{n-1}(s)$线性独立   Frenet标架  每条Frenet曲线都有一个独一无二的Frenet标架$\\pmb e_1(s),\\pmb e_2(s),\\cdots,\\pmb e_n(s)$，满足  $\\pmb e_1(s),\\pmb e_2(s),\\cdots,\\pmb e_n(s)$正交且正向   对${\\pmb c',\\pmb c'',\\cdots,\\pmb c^n}$应用Gram-Schmidt正交化    3.2. Gram-Schmidt处理  输入：线性独立向量集合${\\pmb v_1,\\pmb v_2,\\cdots,\\pmb v_n}$ 输出：正交向量集合${\\pmb b_1,\\pmb b_2,\\cdots,\\pmb b_n}$  设$\\pmb b_1=\\dfrac{\\pmb v_1}{\\vert\\vert\\pmb v_1\\vert\\vert}$ 循环：For $k=2,\\cdots,n$  $\\tilde{\\pmb b_k}=\\pmb v_k-\\sum_{i=1}^{k-1}\\langle \\pmb v_k,\\pmb b_i\\rangle \\pmb b_i$ $\\pmb b_k=\\dfrac{\\tilde {\\pmb b_k}}{\\vert\\vert\\tilde {\\pmb b_k}\\vert\\vert}$      3.3. 平面曲线 现在用Frenet标架下弧长参数化表示平面曲线\n法向量：\n$$\n\\pmb e_2(s)=R^{90^\\circ}\\pmb e_1(s)\n$$\n标架方程：\n$$\n\\begin{pmatrix}\n\\pmb e_1(s)\\\\\\pmb e_2(s)\n\\end{pmatrix}'=\n\\begin{pmatrix}\n0\u0026amp;\\kappa(s)\\\\\n-\\kappa(s)\u0026amp;0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\pmb e_1(s)\\\\\\pmb e_2(s)\n\\end{pmatrix}\n$$\n有向曲率：\n$$\n\\kappa(s)=\\langle\\pmb e_1'(s),\\pmb e_2(s)\\rangle=\\dfrac{\\langle\\ddot {\\pmb c}(t),R^{90^\\circ}\\dot{\\pmb c}(t) \\rangle}{|\\dot{\\pmb c}(t)|^3}\n$$\n密切圆：\n 半径：$1/\\kappa$ 圆心：$\\pmb c(s)+\\dfrac{1}{\\kappa}\\pmb e_2(s)$  平面曲线的基本定理\n 令$\\kappa:(a,b)\\rightarrow\\mathbb R$是一个光滑函数。对于某些$s_0\\in(a,b)$，假设我们有给定点$\\pmb p_0$和两个正交向量$\\pmb t_0$和$\\pmb n_0$，则存在唯一一个Frenet曲线$\\pmb c:(a,b)\\rightarrow\\mathbb R^2$，有：  $\\pmb c(s_0)=\\pmb p_0$ $\\pmb e_1(s_0)=\\pmb t_0$ $\\pmb e_2(s_0)=\\pmb n_0$ 曲线$\\pmb c$的曲率$c$等于给定函数$\\pmb \\kappa$   换句话说，对于任意光滑函数，存在唯一一条直线以该函数作为其曲率  3.4. 性质   刚性运动\n 刚性运动：$\\pmb x\\rightarrow A\\pmb x+\\pmb b$，其中$A$为正交矩阵（保距离的仿射映射）  当$\\det \\pmb A=+1$时保方向（非镜面） 镜面$\\det\\pmb A=-1$      平面曲线在刚性运动下的不变性\n 曲率在刚性运动下不变  绝对值不变 如果是保方向刚性运动，则有向值不变      平面曲线的刚度\n  具有相同有向曲率函数的两条Frenet曲线的区别仅因保方向刚性运动而不同\n  弧长导数\n  弧长参数化\n 找到参数曲线的一个弧长参数化往往是很困难的 Frenet标架及其导数依旧是可以计算的，这里定义了弧长导数    弧长导数\n 对于参数曲线$\\pmb c:[a,b]\\rightarrow\\mathbb R^n$，定义任意可微函数$f:[a,b]\\rightarrow\\mathbb R$的弧长导数为\n$$\n\\pmb f'(t)=\\dfrac{1}{|\\dot{\\pmb c}(t)|}\\dot{\\pmb f}(t)\n$$      3.5. 空间曲线 $\\mathbb R^3$中的Frenet标架\n  切线向量\n$$\n\\pmb e_1(s)=\\pmb c'(s)\n$$\n  法向量\n$$\n\\pmb e_2(s)=\\dfrac{1}{|\\pmb c''(t)|}\\pmb c''(t)\n$$\n  副法向量\n$$\n\\pmb e_3(s)=\\pmb e_1(s)\\times\\pmb e_2(s)\n$$\n  Frenet-Serret方程：\n  $$\n\\begin{pmatrix}\n\\pmb e_1(s)\\\\\\pmb e_2(s)\\\\\\pmb e_3(s)\n\\end{pmatrix}=\n\\begin{pmatrix}\n0\u0026amp;\\kappa(s)\u0026amp;0\\\\-\\kappa(s)\u0026amp;0\u0026amp;\\tau(s)\\\\0\u0026amp;-\\tau(s)\u0026amp;0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\pmb e_1(s)\\\\\\pmb e_2(s)\\\\\\pmb e_3(s)\n\\end{pmatrix}\n$$\n  有向曲率：$\\kappa(s)=\\langle \\pmb e_1'(s),\\pmb e_2(s)\\rangle$\n  挠率：$\\tau(s)=\\langle\\pmb e_2'(s),\\pmb e_3(s)\\rangle$，测量曲线如何弯曲超出$\\pmb e_1$和$\\pmb e_2$的平面\n  $\\mathbb R^n$中曲线的Frenet方程表示为：\n  $$\n\\begin{pmatrix}\n\\pmb e_1(s)\\\\\\pmb e_2(s)\\\\\\vdots\\\\\\pmb e_n(s)\n\\end{pmatrix}=\n\\begin{pmatrix}\n0\u0026amp;\\kappa_1(s)\u0026amp;0\u0026amp;\\cdots\u0026amp;0\u0026amp;0\\\\\n-\\kappa_1(s)\u0026amp;0\u0026amp;\\kappa_2(s)\u0026amp;\\cdots\u0026amp;0\u0026amp;0\\\\\n0\u0026amp;-\\kappa_2(s)\u0026amp;0\u0026amp;\\cdots\u0026amp;0\u0026amp;0\\\\\n\\vdots\u0026amp;\\vdots\u0026amp;\\vdots\u0026amp;\\ddots\u0026amp;\\vdots\u0026amp;\\vdots\\\\\n0\u0026amp;0\u0026amp;0\u0026amp;\\cdots\u0026amp;0\u0026amp;\\kappa_{n-1}(s)\\\\\n0\u0026amp;0\u0026amp;0\u0026amp;\\cdots\u0026amp;-\\kappa_{n-1}(s)\u0026amp;0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\pmb e_1(s)\\\\\\pmb e_2(s)\\\\\\vdots\\\\\\pmb e_n(s)\n\\end{pmatrix}\n$$\n 函数$\\kappa_i(s)$称为$i$次Frenent曲率  小结   对于正则曲线\n 切线向量：$\\pmb t=\\dfrac{\\pmb c'}{\\vert\\vert\\pmb c'\\vert\\vert}$，法平面：$(\\pmb p-\\pmb p_0)\\cdot\\pmb t=0$ 副法向量：$\\pmb b=\\dfrac{\\pmb c'\\times\\pmb c''}{\\vert\\vert\\pmb c'\\times\\pmb c''\\vert\\vert}$，密切平面：$(\\pmb p-\\pmb p_0)\\cdot\\pmb b=0$ 主法向量：$\\pmb n=\\pmb b\\times\\pmb t$，从切平面：$(\\pmb p-\\pmb p_0)\\cdot\\pmb n=0$ 曲率：$\\kappa(t)=\\dfrac{\\pmb c'\\times\\pmb c''}{\\vert\\vert\\pmb c'\\vert\\vert^3}$ 挠率：$\\tau(t)=\\dfrac{(\\pmb c'\\times\\pmb c'')\\cdot\\pmb c'''}{\\vert\\vert\\pmb c'\\times\\pmb c''\\vert\\vert^2}$    弧长参数（单位速度）曲线$\\pmb c(s)$\n 切线向量：$\\pmb t=\\pmb c'$ 副法向量：$\\pmb b=\\pmb t\\times\\pmb n$ 主法向量：$\\pmb n=\\dfrac{\\pmb t'}{\\vert\\vert\\pmb t'\\vert\\vert}=\\dfrac{\\pmb c''}{\\vert\\vert\\pmb c''\\vert\\vert}$ 曲率：$\\kappa(t)=\\vert\\vert\\pmb t'\\vert\\vert=\\vert\\vert\\pmb c''\\vert\\vert$ 有向曲率：$\\kappa(s)=\\pmb t'=\\pmb c''$ 挠率：$\\tau(t)=-\\pmb b'\\cdot\\pmb n$    特殊情况：平面曲线\n  对于正则平面曲线$\\pmb c(t)=(x(t),y(t))$，其曲率定义为\n$$\n\\kappa(t)=\\dfrac{|x\u0026rsquo;y''-x'\u0026lsquo;y\u0026rsquo;|}{(x'^2+y'^2)^{\\frac{3}{2}}}\n$$\n  有向曲率\n$$\n\\kappa(t)=\\dfrac{x\u0026rsquo;y''-x'\u0026lsquo;y\u0026rsquo;}{(x'^2+y'^2)^{\\frac{3}{2}}}\n$$\n    ","description":"曲线微分几何","id":3,"section":"note","tags":["CAGD"],"title":"CAGD(3) |  曲线微分几何","uri":"https://chaphlagical.github.io/zh/note/cagd/cagd3/"},{"content":"1. 参数与几何连续性 1.1. 参数连续性   连接曲线——连续性\n  给定两条曲线\n$$\n\\begin{align}\n\u0026amp;\\pmb x_1(t)\\ \\mathrm{over}\\ [t_0,t_1]\\\n\u0026amp;\\pmb x_2(t)\\ \\mathrm{over}\\ [t_1,t_2]\n\\end{align}\n$$\n  若$\\pmb x_1$和$\\pmb x_2$在$t_1$处的0阶到$r$阶导数向量均重合，则$\\pmb x_1$与$\\pmb x_2$在$t_1$处$C^r$连续\n    常见的参数连续性：\n $C^0$：位置变化连续（position varies continuously） $C^1$：一阶导数在交界处连续（First derivative is continuous across junction）  速度向量相同   $C^2$：二阶导数在交界处连续（Second derivative is continuous across junction）  加速度向量相同      1.2. 几何连续性   曲线的几何连续性\n  给定两条曲线\n$$\n\\begin{align}\n\u0026amp;\\pmb x_1(t)\\ \\mathrm{over}\\ [t_0,t_1]\\\n\u0026amp;\\pmb x_2(t)\\ \\mathrm{over}\\ [t_1,t_2]\n\\end{align}\n$$\n  若$\\pmb x_1$和$\\pmb x_2$能够以某种方式重新参数化使得在$t_1$处$C^r$连续，则$\\pmb x_1$和$\\pmb x_2$在$t_1$处$G^r$连续\n    常见的几何连续性\n $G^0=C^0$：位置变化连续性（连接性）（position varies continuously） $G^1$：切线方向变化连续性（相同切线）（ tangent direction varies continuously ）  正则化切线变化连续 等价于曲线能够重新参数化到$C^1$ 等价于单位速度参数化为$C^1$   $G^2$：曲率变化连续性（相同切线与曲率）（curvature varies continuously）  等价于曲线能够重新参数化到$C^2$ 等价于单位速度参数化为$C^2$      1.3. 参数连续性 vs 几何连续性    参数连续性$C^r$ 几何连续性$G^r$     $C^0,C^1,\\cdots$连续 曲线本身是否光滑   在该曲线上运动的粒子是否有光滑的轨迹？（位置、速度、加速度） 独立于参数化方式   取决于参数化方式 与建模更相关（曲线设计）   应用：动画（物体移动、摄像头轨迹）     2. Bezier样条参数化 2.1. Bezier样条曲线的局部和全局参数  给定  $\\pmb b_0,\\cdots,\\pmb b_n$ $\\pmb y(u)$：间隔$[0,1]$之间的Bezier曲线 $\\pmb x(t)$：间隔$[t_i,t_{i+1}]$之间的Bezier曲线   设置$u(t)=\\dfrac{t-t_i}{t_{i+1}-t_i}$ 结果：$\\pmb x(t)=\\pmb y(u(t))$  局部参数$u$从0变化到1，全局参数$t$从$t_i$变化到$t_{i+1}$\n2.2. Bezier样条曲线的导数 $$\n\\begin{align}\n\\dot{\\pmb x}(t)\u0026amp;=\\dot{\\pmb y}(u(t))\\cdot\\dot u(t)=\\dfrac{\\dot{\\pmb y}(u(t))}{t_{i+1}-t_i}\\\\\n\\ddot{\\pmb x}(t)\u0026amp;=\\ddot{\\pmb y}(u(t))\\cdot(\\dot u(t))^2+\\dot{\\pmb y}(u(t))\\cdot\\ddot u(t)=\\dfrac{\\ddot{\\pmb y}(u(t))}{(t_{i+1}-t_i)^2}\\\\\n\\cdots\\\\\n\\pmb x^{[n]}(t)\u0026amp;=\\dfrac{\\pmb y^{[n]}(u(t))}{(t_{i+1}-t_i)^n}\n\\end{align}\n$$\n2.3. Bezier曲线 $$\n\\pmb f(t)=\\sum_{i=0}^nB_i^n(t)\\pmb p_i\n$$\n  ${0,1}$之间的函数值\n$$\n\\begin{align}\n\\pmb f(0)\u0026amp;=\\pmb p_0\\\n\\pmb f(1)\u0026amp;=\\pmb p_1\\\n\\end{align}\n$$\n  ${0,1}$之间的一阶导数向量\n$$\n\\begin{align}\n\\pmb f'(0)\u0026amp;=n[\\pmb p_1-\\pmb p_0]\\\n\\pmb f'(1)\u0026amp;=n[\\pmb p_n-\\pmb p_{n-1}]\\\n\\end{align}\n$$\n  ${0,1}$之间的二阶导数向量\n$$\n\\begin{align}\n\\pmb f''(0)\u0026amp;=n(n-1)[\\pmb p_2-2\\pmb p_1+\\pmb p_0]\\\\\n\\pmb f''(1)\u0026amp;=n(n-1)[\\pmb p_n-2\\pmb p_{n-1}+\\pmb p_{n-2}]\\\n\\end{align}\n$$\n  2.4. Bezier样条曲线的特殊情况 $$\n\\begin{align}\n\\dot{\\pmb x}(t_i)\u0026amp;=\\dfrac{n(\\pmb b_1-\\pmb b_0)}{t_{i+1}-t_i}\\\\\n\\dot{\\pmb x}(t_{i+1})\u0026amp;=\\dfrac{n(\\pmb b_n-\\pmb b_{n-1})}{t_{i+1}-t_i}\\\\\n\\ddot{\\pmb x}(t_i)\u0026amp;=\\dfrac{n(n-1)(\\pmb b_2-2\\pmb b_1+\\pmb b_0)}{(t_{i+1}-t_i)^2}\\\\\n\\ddot{\\pmb x}(t_{i+1})\u0026amp;=\\dfrac{n(n-1)(\\pmb b_n-2\\pmb b_{n-1}+\\pmb b_{n-2})}{(t_{i+1}-t_i)^2}\\\\\n\\end{align}\n$$\n2.5. Bezier样条的一般情况   连接Beizer曲线\n  给定两条$n$阶Bezier曲线：\n$$\n\\begin{align}\n\\pmb k_{j-1}\u0026amp;=\\pmb b_0^-,\\pmb b_1^-,\\cdots,\\pmb b_n^-=\\pmb k_j\\\\\n\\pmb k_j\u0026amp;=\\pmb b_0^+,\\pmb b_1^+,\\cdots,\\pmb b_n^+=\\pmb k_{j+1}\n\\end{align}\n$$\n  要求：$\\pmb k_j$处$C^1$连续\n  $\\pmb b_{n-1}^-,\\pmb k_j,\\pmb b_1^+$不共线且\n$$\n\\dfrac{\\pmb b_n^\u0026ndash;\\pmb b_{n-1}^-}{t_j-t_{j-1}}=\\dfrac{\\pmb b_1^+-\\pmb b_0^+}{t_{j+1}-t_j}\n$$\n    4. Bezier样条阶数 4.1. 可选的方案  $d=0$，分段常数（piecewise constant）：不光滑 $d=1$，分段线性（piecewise linear）：不够光滑 $d=2$，分段二次（piecewise quadratic）：二阶导数为常数，不够灵活 $d=3$，分段三次（piecewise cubic）：计算机图形学应用中常用的阶数  4.2. 三次样条 4.2.1. 三次分段多项式   我们可以在不固定整个曲线的二阶导数的情况下获得$C^2$连续性（？）\n  $C^2$连续性在直觉上很重要\n  运动：连续的位移、速度和加速度\n非连续的加速度是可察觉的（物体、摄像机运动）\n  可以看到二阶阴影不连续（反射性的物体）\n    在所有点集内插得到的$C^2$曲线中（满足相同的始末状态），分段三次曲线拥有最小的积分加速度（即所能获得的最光滑的曲线）\n  4.2.3. 应用  三次Bezier曲线被广泛使用 更高阶的Bezier曲线较少使用（某些CAD/CAM应用） 典型的：\u0026ldquo;points\u0026amp;handles\u0026quot;接口 四种模式  不连续（两条曲线） $C^0$连续（两个点重合） $G^1$连续（切向连续）  处理点指向同一方向，但长度不同   $C^1$连续  处理点有对称向量     $C^2$的限制更大：通过$k_i$进行控制  5. Bezier样条的连续性 5.1. Bezier样条连续性规则 连接多条曲线段，需要确定使曲线有$C^{-1},C^0，C^1，C^2$连续性的控制点约束\n$C^0$连续性\n 每个样条线段内插第一个和最后一个控制点 相邻线段的点必须重合以获得$C^0$连续性  $C^1$连续性\n 切向量与向量差$\\pmb p_1-\\pmb p_0,\\pmb p_n-\\pmb p_{n-1}$成正比 这些向量应相同以满足$C^1$连续性  $C^2$连续性\n $\\mathrm d^2/\\mathrm dt^2$向量与$\\pmb p_2-2\\pmb p_1+\\pmb p_0$和$\\pmb p_n-2\\pmb p_{n-1}+\\pmb p_{n-2}$成正比 切线必须相同 下示阴影三角形必须相似  $G^1$连续性\n能够被参数化为$C^1$，只需按切线向量长度的比率增加第二个曲线段的速度\n6. Bezier样条曲线 6.1. 在某点处$C^2$连续 要求：在$\\pmb k_j$处$C^2$连续\n  $C^1$意味着\n$$\n\\dfrac{\\pmb b_n^\u0026ndash;\\pmb b_{n-1}^-}{t_j-t_{j-1}}=\\dfrac{\\pmb b_1^+-\\pmb b_0^+}{t_{j+1}-t_j}\n$$\n  $C^2$意味着\n$$\n\\dfrac{\\pmb b_n^\u0026ndash;2\\pmb b_{n-1}^-+\\pmb b_{n-2}^-}{(t_j-t_{j-1})^2}=\\dfrac{\\pmb b_2^+-2\\pmb b_1^++\\pmb b_0^+}{(t_{j+1}-t_j)^2}\n$$\n  令\n$$\n\\pmb d^-=\\pmb b_{n-1}^-+\\dfrac{\\Delta_j}{\\Delta_{j-1}}(\\pmb b_{n-1}^\u0026ndash;\\pmb b_{n-2}^-)\n$$\n和\n$$\n\\pmb d^+=\\pmb b_1^+-\\dfrac{\\Delta_{j-1}}{\\Delta_j}(\\pmb b_2^+-\\pmb b_1^+)\n$$\n则有：\n$C^2$连续性$\\Leftrightarrow C^1$连续性+$\\pmb d^-=\\pmb d^+$\n  6.2. 曲线的$G^2$连续性 一般情况下的$G^2$连续性（对所有类型的曲线）\n  给定\n $\\pmb x_1(t)$和$\\pmb x_2(t)$满足 $\\pmb x_1(t_i)=\\pmb x_2(t_i)=\\pmb x(t_i)$ $\\dot{\\pmb x}_1(t_i)=\\dot{\\pmb x}_2(t_i)=\\dot{\\pmb x}(t_i)$    满足在$t=t_i$处$G^2$连续的条件是：\n$$\n\\ddot{\\pmb x}_2(t_i)-\\ddot{\\pmb x}_1(t_i)\\parallel \\dot{\\pmb x}(t_i)\n$$\n  6.3. 某点的$G^2$连续性   要求：曲线在点$\\pmb k_j$处$G^2$连续\n  $G^1$连续\n  $\\pmb b_{n-2}^-,\\pmb b_{n-1}^-,\\pmb k_j,\\pmb b_1^+,\\pmb b_2^+$五个向量共面\n  且面积\n$$\n\\dfrac{\\mathrm{area}(\\pmb b_{n-2}^-,\\pmb b_{n-1}^-,\\pmb k_j)}{\\mathrm {area}(\\pmb k_j,\\pmb b_1^+,\\pmb b_2^+)}=\\dfrac{a^3}{b^3}\n$$\n  7. $C^2$三次Bezier样条曲线 7.1. 三次Bezier样条曲线   给定\n$$\n\\begin{align}\n\\pmb k_0,\\cdots,\\pmb k_n\u0026amp;\\in\\mathbb R^3\\\\\nt_0,\\cdots,t_n\u0026amp;\\in\\mathbb R\\\\\nt_i\u0026lt;t_{i+1}\\ \\mathrm{for}\\ \u0026amp;i=0,\\cdots,n_1\n\\end{align}\n$$\n  目标：插值$C^2$连续分段三次Bezier样条曲线的Bezier点$\\pmb b_0,\\cdots,\\pmb b_{3n}$\n  例子：\n $3n+1$未知点 $\\pmb b_{3i}=\\pmb k_i$，$i=0,\\cdots,n$，共$n+1$个方程 点$\\pmb k_i$处$C^1$连续，$i=1,\\cdots,n-1$，共$n-1$个方程 点$\\pmb k_i$处$C^2$连续，$i=1,\\cdots,n-1$，共$n-1$个方程 两个结束条件方程    7.2. 结束条件 7.2.1. Bessel end condition   $\\pmb k_0$处的切向量等价于插值${\\pmb k_0,\\pmb k_1,\\pmb k_2}$的抛物线在$\\pmb k_0$处的切向量\n  抛物线插值${\\pmb k_0,\\pmb k_1,\\pmb k_2}$\n$$\n\\pmb p(t)=\n\\dfrac{(t_2-t)(t_1-t)}{(t_2-t_0)(t_1-t_0)}\\pmb k_0+\n\\dfrac{(t_2-t)(t-t_0)}{(t_2-t_1)(t_1-t_0)}\\pmb k_1+\n\\dfrac{(t_0-t)(t_1-t)}{(t_2-t_1)(t_2-t_0)}\\pmb k_2\n$$\n  插值抛物线导数\n$$\n\\dot{\\pmb p}(t_0)=\n-\\dfrac{(t_2-t_0)+(t_1-t_0)}{(t_2-t_0)(t_1-t_0)}\\pmb k_0+\n\\dfrac{(t_2-t_0)}{(t_2-t_1)(t_1-t_0)}\\pmb k_1-\n\\dfrac{(t_1-t_0)}{(t_2-t_1)(t_2-t_0)}\\pmb k_2\n$$\n  $\\pmb b_1$的位置\n$$\n\\pmb b_1=\\pmb b_0+\\dfrac{t_1-t_0}{3}\\dot{\\pmb p}(t_0)\n$$\n  7.2.2. Natural end condition $$\n\\begin{align}\n\\ddot {\\pmb x}(t_0)\u0026amp;=0\\Leftrightarrow \\pmb b_1=\\dfrac{\\pmb b_2+\\pmb b_0}{2}\\\\\n\\ddot{\\pmb x}(t_n)\u0026amp;=0\\Leftrightarrow \\pmb b_{3n-1}=\\dfrac{\\pmb b_{3n-2}+\\pmb b_{3n}}{2}\n\\end{align}\n$$\n7.3. 参数化 7.3.1. 问题描述  给定：控制点$\\pmb k_0,\\cdots,\\pmb k_n$以及结序列$t_0\u0026lt;\\cdots\u0026lt;t_n$ 目标：插值曲线 问题：通常情况下，结序列未给定，但会影响曲线的走势  7.3.2. Equidistant (uniform) parameterization  $t_{i+1}-t_i=\\mathrm{const}$ 例如：$t_i=t$ 不考虑数据点的几何形状  7.3.3. Chordal parameterization  $t_{i+1}-t_i=\\Vert \\pmb k_{i+1}-\\pmb k_i\\Vert$ 参数间隔与相邻控制点的距离成正比  7.3.4. Centripetal parameterization  $t_{i+1}-t_i=\\sqrt{\\Vert\\pmb k_{i+1}-\\pmb k_i\\Vert}$  7.3.5. Foley parameterization  涉及控制多边形的角度 $t_{i+1}-t_i=\\Vert\\pmb k_{i+1}-\\pmb k_i\\Vert\\cdot\\Big(1+\\dfrac{3}{2}\\dfrac{\\hat\\alpha_i\\Vert\\pmb k_i-\\pmb k_{i-1}\\Vert}{\\Vert\\pmb k_i-\\pmb k_{i-1}\\Vert+\\Vert\\pmb k_{i+1}-\\pmb k_i\\Vert}+\\dfrac{3}{2}\\dfrac{\\hat\\alpha_{i+1}\\Vert \\pmb k_{i+1}-\\pmb k_i\\Vert}{\\Vert\\pmb k_{i+1}-\\pmb k_i\\Vert+\\Vert\\pmb k_{i+2}-\\pmb k_{i+1}\\Vert} \\Big)$ 其中，$\\hat\\alpha_i=\\min\\Big(\\pi-\\alpha_i,\\dfrac{\\pi}{2}\\Big)$ 且$\\alpha_i=\\mathrm{angle}(\\pmb k_{i-1},\\pmb k_i,\\pmb k_{i+1})$  7.3.6. Affine invariant parameterization  基于仿射不变距离测度的参数化  7.4. 闭合曲线 7.4.1. 问题描述   给定：\n控制点：$\\pmb k_0,\\cdots,\\pmb k_{n-1},\\pmb k_n=\\pmb k_0$\n结序列：$t_0\u0026lt;\\cdots\u0026lt;t_n$\n  分段三次曲线的结束条件：\n$$\n\\begin{align}\n\\dot{\\pmb x}(t_0)\u0026amp;=\\dot{\\pmb x}(t_n)\\\n\\ddot{\\pmb x}(t_0)\u0026amp;=\\ddot{\\pmb x}(t_n)\n\\end{align}\n$$\n  7.4.2. 闭合三次Bezier样条曲线   $C^2$连续且曲线闭合\n  闭合曲线的优势：无需选择结束条件\n  例子：\n$n=3$\n  ","description":"Bezier样条","id":4,"section":"note","tags":["CAGD"],"title":"CAGD(4) | Bezier样条","uri":"https://chaphlagical.github.io/zh/note/cagd/cagd4/"},{"content":"1. B样条基函数 1.1. De Boor递推 1.1.1. 单位情况 $k$阶（$k-1$度）单位B样条基函数表示为：\n$$\nN_i^1(t)=\\begin{cases}\n1,\u0026amp;i\\leq t\u0026lt;i+1\\\\0,\u0026amp;\\mathrm{otherwise}\n\\end{cases}\n$$\n$$\n\\begin{align}\nN_i^k(t)\u0026amp;=\\dfrac{t-i}{(i+k-1)-i}N_i^{k-1}(t)+\\dfrac{(i+k)-t}{(i+k)-(i+1)}N_{i+1}^{k-1}(t)\\\\\n\u0026amp;=\\dfrac{t-i}{k-1}N_i^{k-1}(t)+\\dfrac{i+k-t}{k-1}N_{i+1}^{k-1}(t)\n\\end{align}\n$$\n1.1.2. 一般情况   给定：结序列$t_0\u0026lt;t_1\u0026lt;\\cdots\u0026lt;t_n\u0026lt;\\cdots\u0026lt;t_{n+k}$\n（$(t_0,t_1,\\cdots,t_{n+k})$称为结向量）\n  归一化的$k$阶（$k-1$度）单位B样条基函数$N_{i,k}$定义为：\n$$\n\\begin{align}\nN_i^1(t)\u0026amp;=\\begin{cases}\n1,\u0026amp;t_i\\leq t\u0026lt;t_{i+1}\\\\0,\u0026amp;\\mathrm{otherwise}\n\\end{cases}\\\\\nN_{i,k}(t)\u0026amp;=\\dfrac{t-t_i}{t_{i+k-1}-t_i}N_{i,k-1}(t)+\\dfrac{t_{i+k}-t}{t_{i+k}-t_{i+1}}N_{i+1,k-1}(t)\n\\end{align}\n$$\n其中，$k\u0026gt;1$且$i=0,\\cdots,n$\n  1.2. 核心思想  设计基函数$\\pmb b(t)$ 性质：  $\\pmb b(t)$为$C^2$连续 $\\pmb b(t)$是三次分段多项式 $\\pmb b(t)$具有局部控制性质 叠加位移的$\\pmb b(t+i)$组成一个整体的划分 对所有的$t$，有$\\pmb b(t)\\geq 0$   简而言之  基函数中具有所有所需的性质 基函数的线性组合也将有这些性质    1.3. 基函数性质   对$t_i\u0026lt;t\u0026lt;t_{i+k}$，有$N_{i,k}(t)\u0026gt;0$\n  对$t_0\u0026lt;t\u0026lt;t_i$或$t_{i+k}\u0026lt;t\u0026lt;t_{n+k}$，有$N_{i,k}(t)=0$\n  对$t_{k-1}\\leq t\\leq t_{n+1}$，有$\\sum_{i=1}^nN_{i,k}(t)=1$\n  对于$t_i\\leq t_j\\leq t_{i+k}$，基函数$N_{i,k}(t)$在结点$t_j$处有$C^{k-2}$连续性\n  区间$[t_i,t_{i+k}]$称为$N_{i,k}$的支撑（support）\n  2. B样条曲线 2.1. B样条曲线简介   给定$n+1$个控制点$\\pmb d_0,\\cdots,\\pmb d_n\\in \\mathbb R^3$，结向量$T=(t_0,\\cdots,t_n,\\cdots,t_{n+k})$\n  $k$阶B样条曲线$\\pmb x(t)$定义为：\n$$\n\\pmb x(t)=\\sum\\limits_{i=0}^nN_{i,k}(t)\\cdot\\pmb d_i\n$$\n  点$\\pmb d_i$称为de Boor points\n  2.1.1. 重复结向量   B样条曲线允许：$T=(t_0,\\cdots,t_n,\\cdots,t_{n+k})$，$t_0\\leq t_1\\leq \\cdots\\leq t_{n+k}$\n  只要不超过$k$个结重合，B样条函数$N_{i,k}(i=0,\\cdots,n)$的递归定义依然有效\n  多结重合的效果：\n 设：$t_0=t_1=\\cdots=t_{k-1}$ 且$t_{n+1}=t_{n+2}=\\cdots=t_{n+k}$  则将插值$\\pmb d_0$和$\\pmb d_n$\n  2.2. B样条的性质 2.2.1. B样条函数 vs Bernstein多项式 结向量$T=(t_0,t_1,\\cdots,t_{2k-1})=(\\underbrace{0,\\cdots,0}_k,\\underbrace{1,\\cdots,1}_k)$下的$k$阶B样条函数$N_{i,k}(i=0,\\cdots,k-1)$为$k-1$次Bernstein多项式$B_i^{k-1}$\n2.2.2. 基本性质   给定\n $T=(\\underbrace{t_0,\\cdots,t_0}_{k\\ \\mathrm{times}},t_k,\\cdots,t_n,\\underbrace{t_{n+1},\\cdots,t_{n+1}}_{k\\ \\mathrm{times}})$ de Boor多边形$\\pmb d_0,\\cdots,\\pmb d_n$    相应的B样条曲线$\\pmb x(t)$有以下性质：\n  $\\pmb x(t_0)=\\pmb d_0$，$\\pmb x(t_{n+1})=\\pmb d_n$（边界点插值）\n  $\\dot{\\pmb x}(t_0)=\\dfrac{k-1}{t_k-t_0}(\\pmb d_1-\\pmb d_0)$（$\\pmb d_0$处的切线方向与$\\pmb d_n$处相似）\n  $\\pmb x(t)$由$n-k+2$个$k-1$次多项式曲线段构成\n  多重内部结$\\Rightarrow$减小了$\\pmb x(t)$的连续阶数\n$l$重内部结$(1\\leq l\u0026lt;k)$意味着$C^{k-l-1}$阶连续\n  de Boor点的局部影响：移动$\\pmb d_i$只会改变曲线的$[t_i,t_{i+k}]$区间部分\n  插入新的de Boor点不会改变曲线段的多项式阶数\n    2.2.3. B样条曲线的局部性 2.2.4. B样条曲线的升阶   使用B样条函数\n  使用de Boor算法\n与Bezier曲线的de Casteljau算法类似，在Boor多边形上进行一系列的线性插值\n  2.3. de Boor算法   给定：\nde Boor点：$\\pmb d_0,\\cdots,\\pmb d_n$\n结向量：$(t_0,\\cdots,t_{k-1}=t_0,t_k,t_{k+1},\\cdots,t_n,t_{n+1},\\cdots,t_{n+k}=t_{n+1})$\n  目标：$k$结B样条曲线的曲线点$\\pmb x(t)$\n  算法流程：\n  中间系数$\\pmb d_i^j(t)$可以表示为一个下三角矩阵——de Boor图\n$$\n\\begin{matrix}\n\\pmb d_{r-k+1}=\\pmb d^0_{r-k+1}\\\\\n\\pmb d_{r-k+2}=\\pmb d^0_{r-k+2}\u0026amp;\\pmb d_{r-k+2}^1\\\\\n\\vdots\\\\\n\\pmb d_{r-1}=\\pmb d_{r-1}^0\u0026amp;\\pmb d_{r-1}^1\u0026amp;\\cdots\u0026amp;\\pmb d_{r-1}^{k-2}\\\\\n\\pmb d_r=\\pmb d_r^0\u0026amp;\\pmb d_r^1\u0026amp;\\cdots\u0026amp;\\pmb d_r^{k-2}\u0026amp;\\pmb d_r^{k-1}=\\pmb x(t)\n\\end{matrix}\n$$\n  2.4. B样条曲线插值   给定：$n+1$个控制点$\\pmb k_0,\\cdots,\\pmb k_n$，结序列$s_0,\\cdots,s_n$\n  目标：分段三次插值B样条曲线$\\pmb x$\n  方法：分段三次$\\Rightarrow k=4$\n $\\pmb x(t)$由$n$段组成$\\Rightarrow n+3$个de Boor点    实例：$n=3$\n  若选择结向量\n$$\n\\begin{align}\nT\u0026amp;=(t_0,t_1,t_2,t_3,t_4,\\cdots,t_{n+2},t_{n+3},t_{n+4},t_{n+5},t_{n+6})\\\\\n\u0026amp;=(s_0,s_0,s_0,s_0,s_1,\\cdots,s_{n-1},s_n,s_n,s_n,s_n)\n\\end{align}\n$$\n  插值条件：\n$$\n\\begin{align}\n\\pmb x(s_0)\u0026amp;=\\pmb k_0=\\pmb d_0\\\\\n\\pmb x(s_i)\u0026amp;=\\pmb k_i=N_{i,4}(s_i)\\pmb d_i+N_{i+1,4}(s_i)\\pmb d_{i+1}+N_{i+2,4}(s_i)\\pmb d_{i+2}\\\\\n\u0026amp;\\mathrm{for}\\ i=1,\\cdots,n-1\\\\\n\\pmb x(s_n)\u0026amp;=\\pmb k_n=\\pmb d_{n+2}\n\\end{align}\n$$\n  共计：$n+1$个条件解$n+3$个未知的de Boor点\n$\\Rightarrow$ 2个终值条件\n  natural end condition\n$$\n\\begin{align}\n\\ddot{\\pmb x}(s_0)\u0026amp;=0\\Leftrightarrow \\dfrac{\\pmb d_2-\\pmb d_1}{s_2-s_0}=\\dfrac{\\pmb d_1-\\pmb d_0}{s_1-s_0}\\\\\n\\ddot{\\pmb x}(s_n)\u0026amp;=0\\Leftrightarrow \\dfrac{\\pmb d_{n+2}-\\pmb d_{n+1}}{s_n-s_{n-1}}=\\dfrac{\\pmb d_{n+1}-\\pmb d_n}{s_n-s_{n-2}}\n\\end{align}\n$$\n  结果可以表示为求解对角系统方程：\n$$\n\\begin{pmatrix}\n1\\\\\n\\alpha_0\u0026amp;\\beta_0\u0026amp;\\gamma_0\\\\\n\u0026amp;\\alpha_1\u0026amp;\\beta_1\u0026amp;\\gamma_1\\\\\n\u0026amp;\u0026amp;\u0026amp;\\ddots\\\\\n\u0026amp;\u0026amp;\u0026amp;\u0026amp;\\alpha_{n-1}\u0026amp;\\beta_{n-1}\u0026amp;\\gamma_{n-1}\\\\\n\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\\alpha_n\u0026amp;\\beta_n\u0026amp;\\gamma_n\\\\\n\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;1\n\\end{pmatrix}\n\\begin{pmatrix}\n\\pmb d_0\\\\pmb d_1\\\\\\pmb d_2\\\\\\vdots\\\\\\pmb d_n\\\\\n\\pmb d_{n+1}\\\\\\pmb d_{n+2}\n\\end{pmatrix}=\n\\begin{pmatrix}\n\\pmb k_0\\\\\\pmb 0\\\\\\pmb k_1\\\\\\vdots\\\\\\pmb k_{n-1}\\\\\n\\pmb 0\\\\\\pmb k_{n}\n\\end{pmatrix}\n$$\n其中，\n  $$\n\\begin{align}\n\\alpha_0\u0026amp;=s_2-s_0\\\\\n\\beta_0\u0026amp;=-(s_2-s_0)-(s_1-s_0)\\\\\n\\gamma_0\u0026amp;=s_1-s_0\\\\\n\\alpha_n\u0026amp;=s_n-s_{n-1}\\\\\n\\beta_n\u0026amp;=-(s_n-s_{n-1})-(s_n-s_{n-2})\\\\\n\\gamma_n\u0026amp;=s_n-s_{n-2}\\\\\n\\alpha_i\u0026amp;=N_{i,4}(s_i)\\\\\n\\beta_i\u0026amp;=N_{i+1,4}(s_i)\\\\\n\\gamma_i\u0026amp;=N_{i+2,4}(s_i)\\\\\n\\mathrm{for}\u0026amp;\\ i=1,\\cdots,n-1\n\\end{align}\n$$\n  解法\n 托马斯算法——解决对角系统方程 复杂度$O(n)$ 仅适用于对角占优矩阵  对于对角系统方程\n$$\n\\begin{pmatrix}\nb_1\u0026amp;c_1\u0026amp;\u0026amp;\u0026amp;0\\\\\na_2\u0026amp;b_2\u0026amp;c_2\\\\\n\u0026amp;a_3\u0026amp;b_3\u0026amp;\\cdot\u0026amp;\\\\\n\u0026amp;\u0026amp;\\cdot\u0026amp;\\cdot\u0026amp;c_{n-1}\\\\\n0\u0026amp;\u0026amp;\u0026amp;a_n\u0026amp;b_n\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1\\\\x_2\\\\\\vdots\\\\x_n\n\\end{pmatrix}=\n\\begin{pmatrix}\nd_1\\\\d_2\\\\\\vdots\\\\d_n\n\\end{pmatrix}\n$$\n求解流程：\n  前向消除阶段\n  后向替代阶段\n    2.5. Bezier曲线转B样条曲线   给定\n控制点：$\\pmb k_0,\\cdots,\\pmb k_n$\n结序列：$t_0,\\cdots,t_n$\n2个终值条件\n$\\pmb b_0,\\cdots,\\pmb b_{3n}$：用于$C^2$连续插值三次Bezier样条曲线的Bezier点\n  目标：一些B样条形式的曲线\n  结向量\n$$\nT=(t_0,t_0,t_0,t_0,t_1,\\cdots,t_{n-1},t_n,t_n,t_n,t_n)\n$$\n  $\\pmb d_0,\\cdots,\\pmb d_{n+2}$由下列式子决定：\n$$\n\\begin{align}\n\\pmb d_0\u0026amp;=\\pmb b_0\\\\\n\\pmb d_1\u0026amp;=\\pmb b_1\\\\\n\\pmb d_i\u0026amp;=\\pmb b_{3i-4}+\\frac{\\Delta_{i-1}}{\\Delta_{i-2}}(\\pmb b_{3i-4}-\\pmb b_{3i-5})\\ \\mathrm{for}\\ i=2,\\cdots,n\\\\\n\\pmb d_{n+1}\u0026amp;=\\pmb b_{3n-1}\\\\\n\\pmb d_{n+2}\u0026amp;=\\pmb b_{3n}\n\\end{align}\n$$\n其中，$\\Delta_i=t_{i+1}-t_i\\quad \\mathrm{for}\\quad i=0,\\cdots,n-1$\n  逆问题同样可解\n  3. Bezier和B样条曲线小结  由$n+1$个控制点$\\pmb b_0,\\cdots,b_n$决定的Bezier曲线  $n$次多项式曲线 由控制点唯一确定 边界点作插值，其他点作逼近 控制点的伪局部影响   由控制点$\\pmb k_0,\\cdots,\\pmb k_n$插值的三次Bezier样条曲线  由$n$个分段三次曲线段组成 控制点处有$C^2$连续性 由参数化（如结序列）和两个终值条件唯一确定 插值所有控制点 控制点的伪局部影响   由控制点$\\pmb d_0,\\cdots,\\pmb d_n$和结向量$T=(t_0,t_0,t_0,t_0,t_1,\\cdots,t_{n-1},t_n,t_n,t_n,t_n)$得到的分段三次B样条曲线  由在结点处具有$C^2$连续状态的$n-2$条分段三次曲线段组成 由$\\pmb d_i$和$T$唯一确定 边界点插值，其余点逼近 de Boor点局部影响   通过控制点$\\pmb k_0,\\cdots,k_n$插值三次B样条  对每个$x,y,z$分量，可以使用2个终值条件和求解一个对角线矩阵系统方程来实现类似3.的效果 与2. 的曲线相同    ","description":"B样条","id":5,"section":"note","tags":["CAGD"],"title":"CAGD(5) | B样条","uri":"https://chaphlagical.github.io/zh/note/cagd/cagd5/"},{"content":"我将在这里分享有趣的知识与技术\n","description":"My Blog","id":6,"section":"","tags":null,"title":"关于","uri":"https://chaphlagical.github.io/zh/about/"},{"content":"Your markdown here.\n$$\n\\begin{pmatrix}\na\u0026amp;b\\\\ c\u0026amp;d\n\\end{pmatrix}\n$$\n","description":"This is my awesome post!","id":7,"section":"posts","tags":null,"title":"My First Post","uri":"https://chaphlagical.github.io/zh/posts/test/"}]