---
title: 弹性体仿真
tags: 计算机图形学
article_header:
  type: cover
  image:
    src: /assets/images/cg.jpg
---

<!--more-->

## 材料力学

### 材料的力学特性

* 任何材料都会在外力作用下将发生形变！
* 杨氏模量(Young Modules)：描述固体材料抵抗形变能力的物理量
	* 拉伸模量（tensile modulus），弹性模量（elastic modulus）
	* Stress：应力$σ$，Strain：应变$ε$
	* 单位：帕斯卡

<img src="/assets/images/弹性体仿真.assets/image-20200415140735391.png" alt="image-20200415140735391" style="zoom:50%;" />

### 弹性形变与塑性形变

* 弹性形变：如果外力撤去后，相应的形变消失
* 塑性形变：如果外力撤去后，仍有残余形变
	* 范性形变：外力撤去后，不再发生形变

<img src="/assets/images/弹性体仿真.assets/image-20200415140810693.png" alt="image-20200415140810693" style="zoom:67%;" />

### Stress 

<img src="/assets/images/弹性体仿真.assets/image-20200415140904590.png" alt="image-20200415140904590" style="zoom: 67%;" />
$$
\boldsymbol T^n(\boldsymbol x,n)=\lim\limits_{\Delta A\rightarrow 0}\frac{\Delta \boldsymbol F}{\Delta A}
$$

### Stress Tensor

<img src="/assets/images/弹性体仿真.assets/image-20200415141021046.png" alt="image-20200415141021046" style="zoom:67%;" />
$$
\boldsymbol T^n(\boldsymbol x,\boldsymbol n=\boldsymbol e_1)=\sigma_x\boldsymbol e_1+\tau_{xy}\boldsymbol e_2+\tau_{xz}\boldsymbol e_3\\

\boldsymbol T^n(\boldsymbol x,\boldsymbol n=\boldsymbol e_2)=\tau_{yx}\boldsymbol e_1+\sigma_y\boldsymbol e_2+\tau_{yz}\boldsymbol e_3\\

\boldsymbol T^n(\boldsymbol x,\boldsymbol n=\boldsymbol e_3)=\tau_{zx}\boldsymbol e_1+\tau_{zy}\boldsymbol e_2+\sigma_z\boldsymbol e_3\\
$$

$$
\boldsymbol \sigma=[\boldsymbol \sigma]=\begin{bmatrix}
\sigma_x&\tau_{xy}&\tau_{xz}\\
\tau_{yx}&\sigma_y&\tau_{yz}\\
\tau_{zx}&\tau_{zy}&\sigma_z
\end{bmatrix}
$$

<img src="/assets/images/弹性体仿真.assets/image-20200415141426892.png" alt="image-20200415141426892" style="zoom: 67%;" />
$$
\begin{align}
\boldsymbol T^n=\sigma\boldsymbol n&=(\sigma_xn_x+\tau_{yx}n_y+\tau_{zx}n_z)\boldsymbol e_1\\
&+(\tau_{xy}n_x+\sigma_yn_y+\tau_{zy}n_z)\boldsymbol e_2\\
&+(\tau_{xz}n_x+\tau_{yz}n_y+\sigma_zn_z)\boldsymbol e_3
\end{align}
$$

### Equilibrium Equations

<img src="/assets/images/弹性体仿真.assets/image-20200415141742711.png" alt="image-20200415141742711" style="zoom: 67%;" />
$$
\rho\frac{dv_x}{dt}=\sum F_x=\frac{\partial \sigma_x}{\partial x}+\frac{\partial \tau_{yx}}{\partial y}+G_x\\
\rho\frac{dv_y}{dt}=\sum F_y=\frac{\partial \tau_{xy}}{\partial x}+\frac{\partial \sigma_{y}}{\partial y}+G_y
$$

$$
\rho\frac{d\boldsymbol v}{dt}=\nabla\cdot \sigma+g
$$

### Constitutive Equation

<img src="/assets/images/弹性体仿真.assets/image-20200415142002604.png" alt="image-20200415142002604" style="zoom:50%;" />

### Elastic Material

<img src="/assets/images/弹性体仿真.assets/image-20200415142046059.png" alt="image-20200415142046059" style="zoom:50%;" />

### Diverse Dimensions

<img src="/assets/images/弹性体仿真.assets/image-20200415142112222.png" alt="image-20200415142112222" style="zoom:50%;" />

## 有限元方法

### 空间离散

<img src="/assets/images/弹性体仿真.assets/image-20200415142154087.png" alt="image-20200415142154087" style="zoom:50%;" />

### 形变的度量

* 即时构型与参考构型

<img src="/assets/images/弹性体仿真.assets/image-20200415142351472.png" alt="image-20200415142351472" style="zoom:50%;" />

* 位移矢量
	$$
	\boldsymbol u(\boldsymbol r)=\boldsymbol r'(\boldsymbol r)-\boldsymbol r
	$$

	$$
	\boldsymbol u(x,y,z)=\begin{bmatrix}u_x(x,y,z)\\u_y(x,y,z)\\u_z(x,y,z)\end{bmatrix}=\begin{bmatrix}x'(x,y,z)-x\\y'(x,y,z)-y\\z'(x,y,z)-z\end{bmatrix}
	$$

* 变形的分类：

	* 线变形：线元的伸长和缩短
	* 角变形：成角度的线元之间夹角的改变

* 通过分析物体任意两点距离的变化分析形变：

	<img src="/assets/images/弹性体仿真.assets/image-20200415142721049.png" alt="image-20200415142721049" style="zoom:50%;" />

	* 设$\{\boldsymbol e_1,\boldsymbol e_2,\boldsymbol e_3\}$为参考构型中选取的坐标架
		$$
		\begin{align}
		(d\boldsymbol r')^2+(d\boldsymbol r)^2&=(d[x_i+u_i(x_j)]\boldsymbol e_i)^2+(dx_i\boldsymbol e_i)^2\\
		&=\Big(\Big[dx_i+\frac{\partial u_i}{\partial x_j}dx_j\Big]\boldsymbol e_i\Big)^2-(dx_i\boldsymbol e_i)^2\\
		&=\Big(\Big[\delta_{ij}+\frac{\partial u_i}{\partial x_j}+\frac{\partial u_j}{\partial x_i}+\frac{\partial u_k}{\partial x_i}\cdot\frac{\partial u_k}{\partial x_j} \Big]-\delta_{ij}\Big)dx_idx_j\\
		&=\Big(\frac{\partial u_i}{\partial x_j}+\frac{\partial u_j}{\partial x_i}+\frac{\partial u_k}{\partial x_i}\cdot\frac{\partial u_k}{\partial x_j}\Big)dx_idx_j
		\end{align}
		$$
		

* Green-Lagrange 应变张量
	$$
	(dr')^2-(dr)^2=2\epsilon_{ij}(r)dx_idx_j\\
	\epsilon=\frac{1}{2}(\nabla_x u+(\nabla_xu)^T+(\nabla_xu)^T\nabla_xu)
	$$

* 形变梯度$\boldsymbol F=\frac{\partial \boldsymbol x'}{\partial \boldsymbol x}$，则$\nabla_x\boldsymbol u=\boldsymbol F-\boldsymbol I$
	$$
	\epsilon=\frac{1}{2}(\boldsymbol F^T\boldsymbol F-\boldsymbol I)
	$$

* Cauchy应变张量：舍弃Green-Lagrange应变张量中二次项：
	$$
	\epsilon=\frac{1}{2}(\nabla_x\boldsymbol u+(\nabla_x\boldsymbol u)^T)\\
	\epsilon=\frac{1}{2}(\boldsymbol F^T+\boldsymbol F)-\boldsymbol I
	$$

* CO-rotated: $\epsilon=\frac{1}{2}(\boldsymbol S^T+\boldsymbol S)-\boldsymbol I$，其中$\boldsymbol F=\boldsymbol R\boldsymbol S$极分解

### 弹性物体仿真

#### 线性弹性模型

* 应力（广义胡克模型）
	$$
	\boldsymbol \sigma=\boldsymbol C\boldsymbol \epsilon
	$$
	其中$\boldsymbol C$弹性张量，$\boldsymbol \sigma$应力，$\epsilon$应变

* 各向同性材料
	$$
	\boldsymbol \sigma=\lambda \mathrm{tr}(\epsilon)\boldsymbol I+2\mu\boldsymbol \epsilon
	$$
	$\mu$和$\lambda$为拉梅常数，与材料有关

* 对杨氏模量为$E$，泊松比为$\nu$的材料
	$$
	\mu=\frac{E}{2(1+\nu)}\\
	\lambda=\frac{E\nu}{(1-2\nu)(1+\nu)}
	$$
	
* 势能
	$$
	\eta=\frac{1}{2}\sigma_{ij}\epsilon_{ij}=\frac{1}{2}\boldsymbol \sigma\cdot\boldsymbol \epsilon=\frac{1}{2}\sum\limits_{i,j}\sigma_{ij}\epsilon_{ij}
	$$

* 力的计算
	$$
	f_i=-\frac{\partial \eta}{\partial x_i}
	$$

#### 超弹性材料

* 形变函数：$\boldsymbol \phi:\boldsymbol X\rightarrow\boldsymbol x$

* $\boldsymbol X=(X_1,X_2,X_3)^T,\boldsymbol x=(\phi_1(\boldsymbol X),\phi_2(\boldsymbol X),\phi_3(\boldsymbol X))^T$ 

* 形变梯度张量：
	$$
	F:=\frac{\partial (\phi_1,\phi_2,\phi_3)}{\partial(X_1,X_2,X_3)}=\Big(\frac{\partial \phi_i}{\partial X_j}\Big)_{ij}
	$$

* 超弹性材料能量：
	$$
	E=\int\sigma_{ij}\varepsilon_{ij}dX\\
	E[\boldsymbol \phi]=\int\psi[\boldsymbol \phi;\boldsymbol X]d\boldsymbol X
	$$

	$$
	\begin{align}
	\boldsymbol \phi(\boldsymbol X)&\approx \boldsymbol \phi(\boldsymbol X_*)+\frac{\partial \boldsymbol \phi}{\partial X}(\boldsymbol X_*)(\boldsymbol X-\boldsymbol X_*)\\
	&=\boldsymbol x_*+\boldsymbol F(\boldsymbol X_*)(\boldsymbol X-\boldsymbol X_*)\\
	&=\boldsymbol F_*\boldsymbol X+\boldsymbol t
	\end{align}
	$$

* 能量密度
	$$
	\psi[\boldsymbol \phi;\boldsymbol X]=\psi(\boldsymbol F(\boldsymbol X))
	$$

	* $\psi(\boldsymbol F)=\frac{k}{2}\|\boldsymbol F\|_F^2$
		* 物体会被压缩成一个点
	* $\psi(\boldsymbol F)=\frac{k}{2}\|\boldsymbol F-\boldsymbol I\|^2_F$
		* 物体倾向于平行移动

* Neo-Hooken模型
	$$
	\psi(\boldsymbol F)=\frac{\mu}{2}(I_1-3)-\mu\log(J)+\frac{\lambda}{2}\log^2(J)
	$$

	* 其中$I_1=tr(\boldsymbol F^T\boldsymbol F)$，$J=\det(\boldsymbol F)$，$\mu$和$\lambda$为拉梅常数

### 离散计算

* 将模型离散为四面体单元$ \{T_i \}$，设形变函数为分片线性函数，且在每个四面体单元上是线性的

* 由形变梯度定义：$\boldsymbol x=\boldsymbol \phi(\boldsymbol X)=\boldsymbol {FX}+\boldsymbol b$, for $\boldsymbol X\in T_i$

* 在一个四面体单元（顶点$X_1$, $X_2$, $X_3$, $X_4$）中：

	由$\boldsymbol x_i=\boldsymbol \phi(\boldsymbol X_i)$
	$$
	\begin{cases}
	x_1=FX_1+b\\
	x_2=FX_2+b\\
	x_3=FX_3+b\\
	x_4=FX_4+b\\
	\end{cases}
	\Rightarrow
	\begin{cases}
	x_1-x_4=F(X_1-X_4)\\
	x_2-x_4=F(X_2-X_4)\\
	x_3-x_4=F(X_3-X_4)\\
	\end{cases}
	$$

	$$
	d=\begin{bmatrix}
	x_1-x_4&x_2-x_4&x_3-x_4\\
	y_1-y_4&y_2-y_4&y_3-y_4\\
	z_1-z_4&z_2-z_4&z_3-z_4\\
	\end{bmatrix}
	$$

	$$
	D=\begin{bmatrix}
	X_1-X_4&X_2-X_4&X_3-X_4\\
	Y_1-Y_4&Y_2-Y_4&Y_3-Y_4\\
	Z_1-Z_4&Z_2-Z_4&Z_3-Z_4\\
	\end{bmatrix}
	$$

	

	则$F=dD^{-1}$

* 总能量：$E(x)=\sum V_i\psi(\boldsymbol F_i)$ 其中$V_i$为四面体体积

	力的计算：$\boldsymbol f_i=-\frac{\partial E(\boldsymbol x)}{\partial \boldsymbol x_i}$