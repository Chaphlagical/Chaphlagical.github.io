---
title: 系统得状态空间模型
tags: 现代控制理论
article_header:
  type: cover
  image:
    src: /assets/images/control.png
---

<!--more-->

## 一、状态及状态空间

### (一) 基本概念

#### 1、输入与输出

把作用于系统的所有（外界）激励统称为系统的输入；而把可以量测的、能表征系统行为的响应统称为系统的输出  

#### 2、状态与状态变量

动态系统的状态可定义为一组信息的集合。在已知未来外部输入的情况下，这些信息对于确定系统未来的行为是充分的  

或：

系统在$t_0$时刻的状态$x(t_0)$是其在$t_0$时刻的一组信息，它与$t\geq t_0$的输入$u(t)$一起，可以唯一确定所有的$t\geq t_0$的输出$y(t)$。用于确定动态系统状态的一组变量称作状态变量  

从物理直观上看，定义中“状态变量组为最小”的含义是指，减少其中
的一个变量就会破坏它们对系统行为表征的完全性，而增加一个变量将不增
加行为表征的信息量，即是完全表征系统行为所不需要的。

从数学的角度看，定义中“状态变量组为最小”的含义是指，它们是系
统所有内部变量中线性无关的一个极大变量组，也即以外的系统内部变量都
必和它们线性相关  

#### 3、状态向量

$n $个状态变量依次用$ x_1(t)，x_2(t), \cdots , x_n(t) $表 示，再把这些状态变量看作是向量$ x(t) $的分量，则x(t) 就称为状态向量，记作
$$
\boldsymbol{x}(t)=\begin{bmatrix}x_1(t)\\x_2(t)\\ \vdots \\x_n(t) \end{bmatrix}
$$

#### 4、状态空间

以状态变量用$x_1(t)，x_2(t), \cdots , x_n(t)$为坐标轴所为基张成的$n$维空间，称为状态空间。在特定的时刻$t$，状态向量$x(t)$在状态空间中是一点  

#### 5、状态轨线

随着时间的推移，$x(t)$在状态空间中描绘出一条轨迹，称为
状态轨线  

### (二) 状态空间描述

#### 1、状态方程

$$
\begin{matrix}
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u,t)&\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B\boldsymbol u
\end{matrix}
$$

#### 2、输出方程

$$
\begin{matrix}
\boldsymbol y=\boldsymbol g(\boldsymbol x,\boldsymbol u,t)&\boldsymbol y=\boldsymbol C\boldsymbol x+\boldsymbol D\boldsymbol u
\end{matrix}
$$

#### 3、状态空间方程

**一般形式：**
$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u,t)\\
\boldsymbol y=\boldsymbol g(\boldsymbol x,\boldsymbol u,t)
\end{cases}
$$
**线性定常系统**
$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B\boldsymbol u\\
\boldsymbol y=\boldsymbol C\boldsymbol x+\boldsymbol D\boldsymbol u
\end{cases}
$$

### (三) 线性系统（连续时间系统）

在系统的状态空间方程中，若状态方程和输出方程均为线性方程，即$\dot{x}$和$ y $均为$x$，$u$的线性函数，则称系统为线性系统  

#### 1、线性系统状态空间方程的系数矩阵

$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A(t)\boldsymbol x+\boldsymbol B(t) \boldsymbol u\\
\boldsymbol y=\boldsymbol C(t) \boldsymbol x+\boldsymbol D(t) \boldsymbol u
\end{cases}\\
\dim \boldsymbol x=n\\
\dim \boldsymbol u=p\\
\dim \boldsymbol y=q
$$

* $\boldsymbol A=(a_{ij})_{n\times n}$——系统矩阵（状态矩阵）
* $\boldsymbol B=(b_{ij})_{n\times p}$——控制矩阵（输入矩阵）
* $\boldsymbol C=(c_{ij})_{q\times n}$——观测矩阵（输出矩阵）
* $\boldsymbol D=(d_{ij})_{q\times p}$——输入-输出矩阵

#### 2、叠加原理

满足叠加原理是线性系统的一个基本特征，可作为线性系统的定义  

系统被称作为线性系统是指对每一个及任意两个状态-输入－输出组：
$$
\left.\begin{align}
&\boldsymbol x_i(t_0)\\
&\boldsymbol u_i(t),\ t\geq t_0
\end{align}\right\}
\rightarrow 
y_i(t),\ t\geq t_0\ \ \ \ i=1,2
$$
一定有（$\alpha$为任意实常数）

* 可加性

$$
\left.\begin{align}
&\boldsymbol x_1(t_0)+\boldsymbol x_2(t_0)\\
&\boldsymbol u_1(t)+\boldsymbol u_2(t),\ t\geq t_0
\end{align}\right\}
\rightarrow 
y_1(t)+y_2(t),\ t\geq t_0
$$

* 均匀性

$$
\left.\begin{align}
&\alpha \boldsymbol x_i(t_0)\\
&\alpha\boldsymbol u_i(t),\ t\geq t_0
\end{align}\right\}
\rightarrow 
\alpha y_i(t),\ t\geq t_0\ \ \ \ i=1,2
$$

* 叠加性=可加性+均匀性

$$
\left.\begin{align}
\alpha_1&\boldsymbol x_1(t_0)+\alpha_2\boldsymbol x_2(t_0)\\
&\alpha_1\boldsymbol u_1(t)+\alpha_2\boldsymbol u_2(t),\ t\geq t_0
\end{align}\right\}
\rightarrow 
\alpha_1y_1(t)+\alpha_2y_2(t),\ t\geq t_0
$$

根据可加性，线性系统的响应可分解为零输入响应和零状态响应之和  

<img src="/asserts/images/系统的状态空间模型.assets/image-20200302105202695.png" alt="image-20200302105202695" style="zoom:67%;" />

#### 3、系统结构图

![image-20200302105253116](/asserts/images/系统的状态空间模型.assets/image-20200302105253116.png)
$$
\boldsymbol G(s)=\boldsymbol C(s\boldsymbol I-\boldsymbol A)^{-1}\boldsymbol B+\boldsymbol D
$$

#### 4、线性系统的输入—输出描述  

**脉冲输入响应**

<img src="/asserts/images/系统的状态空间模型.assets/image-20200302105544659.png" alt="image-20200302105544659" style="zoom: 67%;" />

* 齐次性

	<img src="/asserts/images/系统的状态空间模型.assets/image-20200302105603952.png" alt="image-20200302105603952" style="zoom:67%;" />

* 可加性

	<img src="/asserts/images/系统的状态空间模型.assets/image-20200302105703592.png" alt="image-20200302105703592" style="zoom:67%;" />

* 极限

	<img src="/asserts/images/系统的状态空间模型.assets/image-20200302105717060.png" alt="image-20200302105717060" style="zoom:67%;" />

$$
y(t)=\int^{+\infin}_{-\infin}g(t,\tau)u(\tau)d\tau
$$

其中$g(t,\tau)$是一个二元函数，值为τ时刻作用于系统的理想脉冲（输入）所引起系统在 t 时刻的响应（输出），称之为系统的脉冲响应  

若系统是因果的，则输出不可能在施加输入之前表现出来，于是有：
$$
因果的\Leftrightarrow g(t,\tau)=0\ \ \ \ \forall t<\tau
$$
系统在$t_0$时刻是松弛的，是指其$t_0$前的输入为0。于是$t_0$ 时刻松弛的因果系统  
$$
y(t)=\int_{t_0}^tg(t,\tau)d\tau\\
\boldsymbol y(t)=\int^t_{t_0}\boldsymbol G(t,\tau)\boldsymbol u(\tau)d\tau
$$

### (四) 线性定常系统

#### 1、时间位移特性

系统被称作定常的（非时变的、时不变的）是指  

<img src="/asserts/images/系统的状态空间模型.assets/image-20200302110235602.png" alt="image-20200302110235602" style="zoom: 67%;" />

因有时间位移特性。定常系统的初始时刻通常选为零。

如果系统不是定常的，则称之为时变的  

#### 2、连续时间系统的传递函数矩阵  

对单输入-单输出的线性定常系统，传递函数定义为：零初始条件下输出信号的拉氏变换与输入信号的拉氏变换之比。

对多输入-多输出的线性定常系统，也可给出类似的定义  

<img src="/asserts/images/系统的状态空间模型.assets/image-20200302110356031.png" alt="image-20200302110356031" style="zoom:67%;" />

### (五) 离散时间系统

同连续时间系统一样，系统的激励u和响应y分别称为系统的输入和输出，x为系统的状态变量；系统状态方程是一阶差分向量方程，输出方程是一阶代数方程；状态方程与输出方程合称为系统的状态空间方程，若系统还是定常的，则可写作：
$$
\boldsymbol x[k+1]=\boldsymbol F\boldsymbol x[k]+\boldsymbol H \boldsymbol u[k]\\
\boldsymbol y[k]=\boldsymbol C\boldsymbol x[k]+\boldsymbol D \boldsymbol u[k]\\
\boldsymbol G(z)=\boldsymbol C(z\boldsymbol I-\boldsymbol F)^{-1}\boldsymbol H+\boldsymbol D
$$

### (六) 分布系统与非线性系统

#### 1、集总系统与分布系统

系统被称为集总的是指系统状态变量的数目是有限的，或者说它的状态是有限维向量。而系统被称作分布系统是指它有无限多个状态变量。

传输线、柔性梁都是著名的分布系统  

#### 2、非线性系统

不满足叠加原理的系统就是非线性系统，集总的非线性系统的状态空
间方程一般只能写作  
$$
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u,t)\\
\boldsymbol y=\boldsymbol g(\boldsymbol x, \boldsymbol u,t)
$$
若状态方程及输出方程中不显含时间$t$则又可称之为自治系统，如
$$
\dot{\boldsymbol x}=\boldsymbol f(\boldsymbol x,\boldsymbol u)\\
\boldsymbol y=\boldsymbol g(\boldsymbol x, \boldsymbol u)
$$
非线性系统也有定常的、时变的，集总的、分布的，连续的、离散的  

## 二、状态空间方程的建立

### (一) 从系统的机理出发

<img src="/asserts/images/系统的状态空间模型.assets/image-20200302102450031.png" alt="image-20200302102450031" style="zoom: 67%;" />

<img src="/asserts/images/系统的状态空间模型.assets/image-20200302102518710.png" alt="image-20200302102518710" style="zoom:67%;" />

### (二) 自经典模型转换

#### 1、由传递函数求状态空间方程

举例：
$$
y^{(4)}(t)+\alpha_1\dddot{y}(t)+\alpha_2\ddot{y}(t)+\alpha_3\dot{y}(t)+\alpha_4 y(t)\\
=b_0u^{(4)}(t)+b_1\dddot{u}(t)+b_2\ddot{u}(t)+b_3\dot{u}(t)+b_4 u(t)
$$
传递函数为
$$
\begin{align}
\hat{g}(s)&=\frac{\hat{y}(s)}{\hat{u}(s)}
=\frac{b_0 s^4+b_1s^3+b_2s^2+b_3s+b_4}{s^4+\alpha_1s^3+\alpha_2s^2+\alpha_3s+\alpha_4}\\
&=\frac{\beta_1 s^3+\beta_2s^2+\beta_3s+\beta_4}{s^4+\alpha_1s^3+\alpha_2s^2+\alpha_3s+\alpha_4}+\lambda
\end{align}
$$
引入新变量$v(t)$，其拉氏变换定义为
$$
\hat{v(s)}=\frac{1}{s^4+\alpha_1s^3+\alpha_2s^2+\alpha_3s+\alpha_4}\hat{u}(s)
$$
于是有
$$
\hat{y}(s)=(\beta_1 s^3+\beta_2s^2+\beta_3s+\beta_4)\hat{v}(s)+\lambda \hat{u}(s)
$$
定义状态变量为
$$
\boldsymbol x(t):=
\begin{bmatrix}
x_1(t) \\ x_2(t) \\ x_3(t) \\ x_4(t)
\end{bmatrix}
:=
\begin{bmatrix}
v(t) \\ \dot{v}(t) \\ \ddot{v}(t) \\ \dddot{v}(t)
\end{bmatrix}
$$
拉氏变换
$$
\hat{\boldsymbol x}(s):=
\begin{bmatrix}
\hat{x}_1(s) \\ \hat{x}_2(s) \\ \hat{x}_3(s) \\ \hat{x}_4(s)
\end{bmatrix}
:=
\begin{bmatrix}
\hat{v}(s) \\ s\hat{v}(s) \\ s^2\hat{v}(s) \\ s^3\hat{v}(s)
\end{bmatrix}
=
\begin{bmatrix}
1 \\ s \\ s^2 \\ s^3
\end{bmatrix}
\hat{v}(s)
$$
显然
$$
\dot{x}_1=x_2,\ \ \dot{x}_2=x_3,\ \ \dot{x}_3=x_4
$$
又
$$
\hat{u}(s)=(s^4+\alpha_1s^3+\alpha_2s^2+\alpha_3s+\alpha_4)\hat{v(s)}\\
\hat{y}(s)=(\beta_1 s^3+\beta_2s^2+\beta_3s+\beta_4)\hat{v}(s)+\lambda \hat{u}(s)
$$
故
$$
\dot{\boldsymbol x}_4(t)=\begin{bmatrix}-\alpha_4&-\alpha_3&-\alpha_2&-\alpha_1\end{bmatrix}\boldsymbol x(t)+1\cdot u(t)\\
y(t)=\begin{bmatrix}\beta_4&-\beta_3&-\beta_2&-\beta_1\end{bmatrix}\boldsymbol x(t)+\lambda\cdot u(t)
$$
因此，
$$
\begin{align}
\dot{\boldsymbol x}&=\boldsymbol A \boldsymbol x+\boldsymbol b u=
\begin{bmatrix}
0&1&0&0\\
0&0&1&0\\
0&0&0&1\\
-\alpha_4&-\alpha_3&-\alpha_2&-\alpha_1
\end{bmatrix}
\boldsymbol x(t)+
\begin{bmatrix}
0 \\ 0 \\ 0 \\ 1
\end{bmatrix}
u\\

y&=\boldsymbol c \boldsymbol x+ d u=
\begin{bmatrix}
\beta_4& \beta_3& \beta_2& \beta_1
\end{bmatrix}
\boldsymbol x(t)+\lambda u
\end{align}
$$
若定义状态变量：
$$
\boldsymbol x(t):=
\begin{bmatrix}
x_1(t) \\ x_2(t) \\ x_3(t) \\ x_4(t)
\end{bmatrix}
:=
\begin{bmatrix}
\dddot{v}(t) \\ \ddot{v}(t) \\ \dot{v}(t) \\ v(t) \\ 
\end{bmatrix}
$$
则可得状态空间方程
$$
\begin{align}
\dot{\boldsymbol x}&=\boldsymbol A \boldsymbol x+\boldsymbol b u=
\begin{bmatrix}
-\alpha_1&-\alpha_2&-\alpha_3&-\alpha_4\\
1&0&0&0\\
0&1&0&0\\
0&0&1&0\\

\end{bmatrix}
\boldsymbol x(t)+
\begin{bmatrix}
1 \\ 0 \\ 0 \\ 0
\end{bmatrix}
u\\

y&=\boldsymbol c \boldsymbol x+ d u=
\begin{bmatrix}
\beta_1& \beta_2& \beta_3& \beta_4
\end{bmatrix}
\boldsymbol x(t)+\lambda u
\end{align}
$$

#### 2、由动态结构图求状态空间方程

<img src="/asserts/images/系统的状态空间模型.assets/image-20200302114713775.png" alt="image-20200302114713775" style="zoom:67%;" />

<img src="/asserts/images/系统的状态空间模型.assets/image-20200302114738975.png" alt="image-20200302114738975" style="zoom:67%;" />

<img src="/asserts/images/系统的状态空间模型.assets/image-20200302114814877.png" alt="image-20200302114814877" style="zoom:67%;" />

### (三) 系统互连状态方程

* 互连线性系统子系统

$$
S_1:\begin{cases}
\dot{x}_1=A_1x_1+B_1u_1\\
y_1=C_1x_1+D_1u_1
\end{cases}\\
S_2:\begin{cases}
\dot{x}_2=A_2x_2+B_2u_2\\
y_2=C_2x_2+D_2u_2
\end{cases}
$$

* 总系统状态
	$$
	x=\begin{bmatrix}x_1\\ x_2\end{bmatrix}
	$$

#### 1、串联

<img src="/asserts/images/系统的状态空间模型.assets/image-20200309101406894.png" alt="image-20200309101406894"  />
$$
\begin{cases}
u_1=u\\
u_2=y_1=C_1x_1+D_1u\\
y=y_2
\end{cases}
$$

$$
\begin{align}
\dot{x}&=\begin{bmatrix}
A_1&0\\ B_2C_1&A_2
\end{bmatrix}x+\begin{bmatrix}B_1\\ B_2D_1\end{bmatrix}u\\
y&=\begin{bmatrix}D_1C_1& C_2\end{bmatrix}x+D_2D_1 u
\end{align}
$$

#### 2、分流

<img src="/asserts/images/系统的状态空间模型.assets/image-20200309125930193.png" alt="image-20200309125930193"  />
$$
\begin{cases}
u_1=u\\
u_2=u\\
y=\begin{bmatrix}y_1\\ y_2\end{bmatrix}
\end{cases}
$$

$$
\begin{align}
\dot{x}&=\begin{bmatrix}
A_1&0\\ 0&A_2
\end{bmatrix}x+\begin{bmatrix}B_1\\ B_2\end{bmatrix}u\\
y&=\begin{bmatrix}C_1&0\\ 0&C_2\end{bmatrix}x+\begin{bmatrix}D_1\\ D_2\end{bmatrix} u
\end{align}
$$

#### 3、并联

![image-20200309130031220](/asserts/images/系统的状态空间模型.assets/image-20200309130031220.png)
$$
\begin{cases}
u_1=u\\
u_2=u\\
y=y_1+y_2
\end{cases}
$$

$$
\begin{align}
\dot{x}&=\begin{bmatrix}
A_1&0\\ 0&A_2
\end{bmatrix}x+\begin{bmatrix}B_1\\ B_2\end{bmatrix}u\\
y&=\begin{bmatrix}C_1&C_2\end{bmatrix}x+(D_1+D_2) u
\end{align}
$$

#### 4、反馈

![image-20200309130219788](/asserts/images/系统的状态空间模型.assets/image-20200309130219788.png)
$$
\begin{cases}
u_1=u-y_2=u-C_2x_2-D_2u_2\\
u_2=y_1=C_1x_1+D_1u_1\\
y=y_1
\end{cases}
$$
化为
$$
\begin{cases}
u_1=\Delta u-\Delta D_2C_1x_1-\Delta C_2x_2\\
u_2=D_1\Delta u+(C_1-D_1\Delta D_2C_1)x_1-D_1\Delta C_2x_2
\end{cases}\\
\Delta=(I+D_2D_1)^{-1}
$$
得：
$$
\begin{cases}
\dot{x}=\begin{bmatrix}A_1-B_1\Delta D_2C_1&-B_1\Delta C_2\\
B_2(C_1-D_1\Delta D_2C_1)&A_2-B_2D_1\Delta C_2
\end{bmatrix}x+\begin{bmatrix}B_1\Delta\\ B_2D_1\Delta\end{bmatrix}u\\
y=\begin{bmatrix}C_1-D_1\Delta D_2C_1&D_1\Delta C_2\end{bmatrix}x+(D_1\Delta )u
\end{cases}
$$

## 三、状态空间的线性变换

### (一) 坐标变换对状态空间方程的影响

$$
\begin{align}
\begin{matrix}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+\boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x + \boldsymbol D \boldsymbol u
\end{matrix}
\xrightarrow[\overline{\boldsymbol x}=\boldsymbol P \boldsymbol x=\boldsymbol Q^{-1} \boldsymbol x]{\boldsymbol x= \boldsymbol Q \overline{\boldsymbol x}}
\begin{matrix}
\dot{\overline{\boldsymbol x}}=\overline{\boldsymbol A} \overline{\boldsymbol x}+\overline{\boldsymbol B} \overline{\boldsymbol u}\\
\boldsymbol y=\overline{\boldsymbol C} \overline{\boldsymbol x} + \overline{\boldsymbol D} \overline{\boldsymbol u}
\end{matrix}


\end{align}
$$

$$
\boldsymbol Q \dot{\overline{\boldsymbol x}}=\boldsymbol A \boldsymbol Q \overline{\boldsymbol x}+\boldsymbol B \boldsymbol u\\
\dot{\overline{\boldsymbol x}}=\boldsymbol Q^{-1} \boldsymbol A \boldsymbol Q \overline{\boldsymbol x}+\boldsymbol Q^{-1}\boldsymbol B \boldsymbol u
$$

$$
\begin{matrix}
\overline{\boldsymbol A}=\boldsymbol Q^{-1}\boldsymbol A \boldsymbol Q & \overline{\boldsymbol B}=\boldsymbol Q^{-1}\boldsymbol B\\
\overline{\boldsymbol C}=\boldsymbol C \boldsymbol Q & \overline{\boldsymbol D}=\boldsymbol D

\end{matrix}
$$

令$\boldsymbol P=\boldsymbol Q^{-1}$得
$$
\begin{matrix}
\overline{\boldsymbol A}=\boldsymbol P\boldsymbol A \boldsymbol P^{-1} & \overline{\boldsymbol B}=\boldsymbol P\boldsymbol B\\
\overline{\boldsymbol C}=\boldsymbol C \boldsymbol P^{-1} & \overline{\boldsymbol D}=\boldsymbol D

\end{matrix}
$$

### (二) 矩阵的规范化

#### 1、特征方程、特征值及特征向量

$$
\boldsymbol A \boldsymbol q=\lambda \boldsymbol q
$$

称 $\lambda $为$n$阶方阵$\boldsymbol A$的特征值，而称$\boldsymbol q$为$\boldsymbol A$对应于特征值$\lambda$的特征向量

特征多项式：
$$
|\lambda \boldsymbol I-\boldsymbol A|=0
$$

#### 2、方阵的对角规范化

##### (1) 单重特征值、单个特征向量

特征方程：
$$
|s\boldsymbol I-\boldsymbol A|=(s-\lambda_1)(s-\lambda_2)\cdots(s-\lambda_n)
$$
具有$n$个相异特征值：$\lambda_i\neq \lambda_j$

特征向量：
$$
\lambda_i\rightarrow \boldsymbol A \boldsymbol q_i=\lambda_i\boldsymbol q_i
$$
$n$个线性无关的特征向量：$\{\boldsymbol q_1,\boldsymbol q_2,\cdots,\boldsymbol q_n\}$

证明线性无关：假设不是线性无关，存在不全为0的$c_i(i=1,\cdots,n)$
$$
\begin{align}
c_1\boldsymbol q_1+c_2\boldsymbol q_2+\cdots +c_n\boldsymbol q_n&=0\\
\lambda_1c_1\boldsymbol q_1+\lambda_2c_2\boldsymbol q_2+\cdots+\lambda_n c_n \boldsymbol q_n&=0\\
\vdots\\
\lambda_1^{n-1}c_1\boldsymbol q_1+\lambda_2^{n-1} c_2\boldsymbol q_2+\cdots+\lambda_n^{n-1} c_n \boldsymbol q_n&=0
\end{align}
$$
写成矩阵形式：
$$
\begin{bmatrix}c_1\boldsymbol q_1&c_2\boldsymbol q_2&\cdots&c_n\boldsymbol q_n\end{bmatrix}
\begin{bmatrix}
1&\lambda_1&\cdots&\lambda_1^{n-1}\\
1&\lambda_2&\cdots&\lambda_2^{n-1}\\
\vdots&\vdots&\ddots&\vdots\\
1&\lambda_n&\cdots&\lambda_n^{n-1}
\end{bmatrix}=0
$$
因此，$\begin{bmatrix}c_1\boldsymbol q_1&c_2\boldsymbol q_2&\cdots&c_n\boldsymbol q_n\end{bmatrix}=0$，即$c_1=c_2=\cdots=c_n=0$

与假设矛盾，因此线性无关

此时，
$$
\boldsymbol A
\begin{bmatrix}
\boldsymbol q_1& \boldsymbol q_2& \cdots& \boldsymbol q_n
\end{bmatrix}
=
\begin{bmatrix}
\boldsymbol q_1& \boldsymbol q_2& \cdots& \boldsymbol q_n
\end{bmatrix}
\begin{bmatrix}
\lambda_1& & & \boldsymbol O\\
& \lambda_2& &\\
& &\ddots &\\
\boldsymbol O & & & \lambda_n
\end{bmatrix}
$$
显然，$\boldsymbol A$的这$n$个特征向量$\boldsymbol q_i(i=1,2,\cdots,n)$互不相关，则矩阵$\boldsymbol Q= \begin{bmatrix}\boldsymbol q_1& \boldsymbol q_2& \cdots&\boldsymbol q_n\end{bmatrix}$可逆，于是
$$
\boldsymbol Q^{-1}\boldsymbol  A \boldsymbol  Q=\boldsymbol  \Lambda
$$
此即表明，若系统矩阵A的所有特征向量互不相关，则可通过状态变换（重新定义等价的状态状态变量），使系统在新的状态空间内，其系统矩阵呈对角型  

* 同一方阵对应于不同特征值的特征向量一定互不相关；
* 状态变换不改变系统矩阵的特征值；
* 方阵A非奇异的充要条件是它没有零特征值  

##### (2) 多个特征值、多个特征向量

特征方程：
$$
|s\boldsymbol I-\boldsymbol A|=(s-\lambda_1)^{m_1}(s-\lambda_2)^{m_2}\cdots(s-\lambda_l)^{m_l}
$$
$m_i$：$\lambda_i$的代数重数

特征向量：
$$
\lambda_i\rightarrow \boldsymbol A \boldsymbol q_{i,j}=\lambda_i \boldsymbol q_{i,j} \ \ \ \ (j=1,\cdots,m)
$$
$m_i$个线性无关的特征向量：$\{\boldsymbol q_{i,1},\boldsymbol q_{i,2},\cdots,\boldsymbol q_{i,m_i} \}$

所有$n=m_1+m_2+\cdots+m_l$个特征向量线性无关，组成变换矩阵
$$
\boldsymbol Q=
\begin{bmatrix}
\boldsymbol q_{1,1}&
\cdots &
\boldsymbol q_{1,m_1}&
\cdots &
\boldsymbol q_{l,1} &
\cdots &
\boldsymbol q_{l,m_l}
\end{bmatrix}
$$

$$
\boldsymbol Q^{-1}\boldsymbol A \boldsymbol Q=\boldsymbol \Lambda=
\begin{bmatrix}
\lambda_1 \\
&\ddots\\
& & \lambda_1 \\
& & & \ddots \\
& & & & \lambda_p\\
& & & & & \ddots\\
& & & & & & \lambda_p
\end{bmatrix}
$$

##### (3) 多重特征值、单个特征向量

特征方程：
$$
|s\boldsymbol I-\boldsymbol A|=(s-\lambda_1)^{m_1}(s-\lambda_2)^{m_2}\cdots(s-\lambda_l)^{m_l}
$$
$m_i$：$\lambda_i$的代数重数

仅可求到一个线性无关特征向量：$\lambda_i\rightarrow \boldsymbol A \boldsymbol q_i=\lambda_i\boldsymbol q_i$ 

$l$个线性无关的特征向量不足以构成变换矩阵$\boldsymbol Q$

从每个特征向量出发，求取$m_i-1$个增广特征向量
$$
(\lambda_i,\boldsymbol q_i=\boldsymbol q_i^{(1)})\rightarrow \boldsymbol q_i^{(2)},\cdots, \boldsymbol q_i^{(m_i)}
$$
其中，
$$
(\boldsymbol A-\lambda_i\boldsymbol I)\boldsymbol q_i^{(1)}=0\\
(\boldsymbol A-\lambda_i\boldsymbol I)^2\boldsymbol q_i^{(2)}=0\\
\cdots\\
(\boldsymbol A-\lambda_i\boldsymbol I)^{m_i}\boldsymbol q_i^{(m_i)}=0\\
(\boldsymbol A-\lambda_i\boldsymbol I)^k\boldsymbol q_i^{(k+m)}\neq0\ \ (m\geq 1)
$$
求解次序：
$$
\boldsymbol q_i^{(m_i)}\rightarrow \boldsymbol q_i^{(m_i-1)}\rightarrow\cdots\rightarrow\boldsymbol q_i^{(1)}
$$
两个齐次方程的解空间：
$$
S_{m_i}=\{v|(\boldsymbol A-\lambda_i\boldsymbol I)^{m_i}v=0 \}\\
S_{m_i-1}=\{v|(\boldsymbol A-\lambda_i\boldsymbol I)^{m_i-1}v=0 \}
$$
空间包含关系：
$$
S_{m_i}\supset S_{m_i-1}
$$
最高阶增广特征向量：
$$
0\neq \boldsymbol q_i^{(m_i)}\in S_{m_i}\setminus S_{m_i-1}
$$
其余增广特征向量：
$$
\boldsymbol q_i^{(m_i-1)}=(\boldsymbol A -\lambda_i \boldsymbol I)\boldsymbol q_i^{(m_i)}\\
\boldsymbol q_i^{(m_i-2)}=(\boldsymbol A-\lambda_i \boldsymbol I)\boldsymbol q_i^{(m_i-1)}\\
\cdots
$$
$\{\boldsymbol q_i^{(m_i)},\boldsymbol q_i^{(m_i-1)},\cdots,\boldsymbol q_i^{(1)}\}$线性无关
$$
\begin{align}
m_i阶增广特征向量:&\begin{matrix}(\boldsymbol A-\lambda_i \boldsymbol I)^m\boldsymbol q_i^{(m_i)}=0\\ (\boldsymbol A-\lambda_i \boldsymbol I)^{(m-1)}\boldsymbol q_i^{(m_i)}\neq 0 \end{matrix}\\
m_i-1阶增广特征向量:&\begin{matrix}(\boldsymbol A-\lambda_i\boldsymbol I)^{m-1}((\boldsymbol A-\lambda_i\boldsymbol I)\boldsymbol q_i^{m_i})=0\\
(\boldsymbol A-\lambda_i\boldsymbol I)^{m-2}((\boldsymbol A-\lambda_i\boldsymbol I)\boldsymbol q_i^{m_i})\neq0
\end{matrix}\\
m_i-2阶增广特征向量:&\begin{matrix}(\boldsymbol A-\lambda_i\boldsymbol I)^{m-2}((\boldsymbol A-\lambda_i\boldsymbol I)^2\boldsymbol q_i^{m_i})=0\\
(\boldsymbol A-\lambda_i\boldsymbol I)^{m-3}((\boldsymbol A-\lambda_i\boldsymbol I)^2\boldsymbol q_i^{m_i})\neq0
\end{matrix}
\end{align}
$$
$\boldsymbol q_i^{(m_i)}\rightarrow (\boldsymbol A-\lambda_i\boldsymbol I)\boldsymbol q_i^{(m_i)}\rightarrow\cdots\rightarrow(\boldsymbol A-\lambda_i\boldsymbol I)^{m_i-1}\boldsymbol q_i^{(m_i)}$线性无关

证明线性无关：假设不是线性无关，存在不全为0的$c_i(i=1,2,\cdots,m_i)$ 
$$
\begin{align}
c_{m_i}\boldsymbol q_i^{(m_i)}+c_{m_i-1}(\boldsymbol A-\lambda \boldsymbol I)\boldsymbol q^{(2)}+\cdots+c_1(\boldsymbol A-\lambda_i \boldsymbol I)^{m_i-1}\boldsymbol q_i^{(m_i)}&=0\\
(\boldsymbol A-\lambda\boldsymbol I)^{m_i-1}(c_{m_i}\boldsymbol q_i^{(m_i)}+c_{m_i-1}(\boldsymbol A-\lambda \boldsymbol I)\boldsymbol q^{(2)}+\cdots+c_1(\boldsymbol A-\lambda_i \boldsymbol I)^{m_i-1}\boldsymbol q_i^{(m_i)})&=0
\end{align}
$$
得
$$
c_{m_i}(\boldsymbol A-\lambda\boldsymbol I)^{m_i-1}\boldsymbol q_i^{(m_i)}=0
$$
即$c_{m_i}=0$，同理可得$c_1=c_2=\cdots=c_{m_i-1}$与假设矛盾，故线性无关

变换矩阵：
$$
\boldsymbol Q=\begin{bmatrix}\boldsymbol q_1^{(1)}&\cdots&\boldsymbol q_1^{m_1}&\cdots&\boldsymbol q_l^{(1)}&\cdots&\boldsymbol q_l^{(m_l)} \end{bmatrix}
$$

$$
\boldsymbol Q^{-1}\boldsymbol A\boldsymbol Q=\boldsymbol J=\begin{bmatrix}\boldsymbol J_1\\&\ddots\\&&\boldsymbol J_l\end{bmatrix}
$$

其中，
$$
\boldsymbol J_i=\begin{bmatrix}\lambda_i&1\\ &\lambda_i&1\\&&\lambda_i&\ddots\\&&&\ddots&\ddots\\&&&&\lambda_i\end{bmatrix}_{m_i\times m_i}
$$

$$
\boldsymbol Q\boldsymbol J=\boldsymbol A \boldsymbol Q\leftarrow \boldsymbol q_i^{(j-1)}+\lambda_i \boldsymbol q_i^{(j)}=\boldsymbol A \boldsymbol q_i^{(j)}
$$

##### (4) 多重特征值、多个特征向量

特征方程：
$$
|s\boldsymbol I-\boldsymbol A|=(s-\lambda_1)^{m_1}(s-\lambda_2)^{m_2}\cdots(s-\lambda_l)^{m_l}
$$
$m_i$：$\lambda_i$的代数重数

可求到$n_i$个线性无关特征向量：$\lambda_i\rightarrow \boldsymbol A \boldsymbol q_i=\lambda_i\boldsymbol q_i$ 
$$
n_i=rank((\boldsymbol A-\lambda_i\boldsymbol I)^0)-rank(\boldsymbol A-\lambda \boldsymbol I)
$$
有$n_i$组增广特征向量串：$m_{i,1}+m_{i,2}+\cdots+m_{i,n_i}=m_i$
$$
\boldsymbol q_{i,1}^{(m_{i,1})}\rightarrow\boldsymbol q_{i,1}^{(m_{i,1}-1)}\rightarrow\cdots\rightarrow\boldsymbol q_{i,1}^{(1)}\Rightarrow m_{i,1}阶约当块\boldsymbol J_{i,1}\\

\boldsymbol q_{i,2}^{(m_{i,2})}\rightarrow\boldsymbol q_{i,2}^{(m_{i,2}-1)}\rightarrow\cdots\rightarrow\boldsymbol q_{i,2}^{(1)}\Rightarrow m_{i,2}阶约当块\boldsymbol J_{i,2}\\

\vdots\\

\boldsymbol q_{i,n_i}^{(m_{i,n_i})}\rightarrow\boldsymbol q_{i,n_i}^{(m_{i,n_i}-1)}\rightarrow\cdots\rightarrow\boldsymbol q_{i,n_i}^{(1)}\Rightarrow m_{i,n_i}阶约当块\boldsymbol J_{i,n_i}\\
$$

$$
\boldsymbol Q_i=\begin{bmatrix}\boldsymbol q_{i,1}^{(1)}&\cdots&\boldsymbol q_{i,1}^{(m_{i,1})}&\cdots&\boldsymbol q_{i,n_i}^{(1)}&\cdots& \boldsymbol q_{1,n_i}^{(m_{i,n_i})} \end{bmatrix}
$$

变换矩阵
$$
\boldsymbol Q=\begin{bmatrix}\boldsymbol Q_!&\boldsymbol Q_2 &\cdots&\boldsymbol Q_l\end{bmatrix}
$$
约当矩阵：
$$
\boldsymbol J=\begin{bmatrix}\boldsymbol J_1\\&\ddots\\&&\boldsymbol J_l\end{bmatrix}
$$
其中，
$$
\boldsymbol J_i=\begin{bmatrix}\boldsymbol J_{i,1}\\&\ddots\\&&\boldsymbol J_{i,n_i} \end{bmatrix}
$$
则
$$
\boldsymbol Q^{-1}\boldsymbol A\boldsymbol Q=\boldsymbol J=\begin{bmatrix}\boldsymbol J_1\\& \ddots\\&&\boldsymbol J_l\end{bmatrix}
$$
现在求解$m_{i,j}(j=1,\cdots,n_i)$

令$c_k=rank((\boldsymbol A-\lambda_i\boldsymbol I)^k)-rank((\boldsymbol A-\lambda_i\boldsymbol I)^{k+1})$
$$
|\{j|m_{i,j}>k \}|=c_k
$$
$|\{\cdots\}|$表示集合元素个数

$g_i$：$\lambda_i$的几何重数
$$
g_i=\max_j m_{i,j}=\min_k\{k|c_k=0\}
$$
首先定出$g_i$
$$
c_0\geq 1\rightarrow c_1\geq 1\rightarrow\cdots\rightarrow c_{g_i-1}\geq 1\rightarrow c_{g_i}=0
$$
则有
$$
\begin{matrix}|\{j|m_{i,j}>k\}|=c_k\\k=0,1,\cdots,g_i \end{matrix}\Rightarrow m_{i,j}
$$

##### 3、方阵的模式规范化

实方阵的特征多项式为实系数多项式

实方阵可能有非实的复特征值

实方阵的非实复特征值以共轭形式成对出现，相应的特征向量也是共轭的。即若$σ$和$ω$均为实数，$u$和$ v$ 均为实向量，则  
$$
(\sigma+j\omega)(\boldsymbol u+j \boldsymbol v)=\boldsymbol A(\boldsymbol u+j\boldsymbol v)\Rightarrow(\sigma-j\omega)(\boldsymbol u-j \boldsymbol v)=\boldsymbol A(\boldsymbol u-j\boldsymbol v)
$$
模式标准化的方法：

将对角化变换矩阵$\boldsymbol Q$中的共轭非实复特征值$\lambda=\sigma+j\omega$和$\overline{\lambda}=\sigma-j\omega$对应的共轭非实复特征向量$\boldsymbol q=\boldsymbol u+j \boldsymbol v$和$\overline{\boldsymbol q}=\boldsymbol u-j\boldsymbol v$分别用实向量$\boldsymbol u$和$\boldsymbol v$取代

模式标准化的结果：

变换后的目标矩阵中，对角化的二阶矩阵块（含有非实复特征值$\lambda=\sigma+j\omega$和$\overline{\lambda}=\sigma-j\omega$）变为相应的实的非对角的二阶矩阵块，即
$$
\begin{bmatrix}
\sigma+j\omega &0\\
0&\sigma-j\omega
\end{bmatrix}
\Rightarrow
\begin{bmatrix}
\sigma&\omega\\
-\omega&\sigma
\end{bmatrix}
$$