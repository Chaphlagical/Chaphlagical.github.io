---
title: 卡尔曼滤波的理论推导
tags: SLAM
article_header:
  type: cover
  image:
    src: /assets/images/SLAM.jpeg
---

本文介绍卡尔曼滤波的理论推导

## 一、简介

卡尔曼滤波一种利用线性系统状态方程，通过系统输入输出观测数据，对系统状态进行最优估计的算法。它所解决的基本问题是：假设在$t_k$时刻得到一个测量值，并且将它提供的信息用于对随机系统在$t_k$时刻的状态$x$的估计值进行更新。

## 二、线性设备与测量模型

|   模型   |                           连续时间                           |                           离散时间                           | 公式编号 |
| :------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :------: |
|   设备   |                  $\dot{x}(t)=F(t)x(t)+w(t)$                  |               $x_k=\Phi_{k-1}x_{k-1}+w_{k-1}$                | **(1)**  |
|  测量值  |                     $z(t)=H(t)x(t)+v(t)$                     |                       $z_k=H_kx_k+v_k$                       | **(2)**  |
| 设备噪声 | $E\langle w(t)\rangle=0$<br>$E\langle w(t)w(s)^T\rangle=\delta(t-s)Q(t)$ | $E\langle w_k\rangle=0$<br>$E\langle w_kw_i^T\rangle=\Delta(k-i)Q_k$ | **(3)**  |
| 观测噪声 | $E\langle v(t)\rangle=0$<br>$E\langle v(t)v^T(s)\rangle=\delta(t-s)R(t)$ | $E\langle v_k\rangle=0$<br>$E\langle v_k v_i^T\rangle=\Delta(k-i)R_k$ | **(4)**  |

参数解释：

$x $：状态变量 

$z $：测量量

$w $：设备噪声

$v $：测量噪声

$H$：测量灵敏度矩阵

$F、\Phi$：动态系数矩阵

$Q$：设备噪声的协方差矩阵

$R$：测量噪声的协方差矩阵

## 三、离散时间卡尔曼估计子公式

| 公式意义         | 公式                                                         |
| ---------------- | ------------------------------------------------------------ |
| 系统动态模型     | $x_k=\Phi_{k-1}x_{k-1}+w_{k-1}$<br>$w_k\sim N(0,Q_k)$        |
| 测量模型         | $z_k=H_kx_k+v_k$<br>$v_k\sim N(0,R_k)$                       |
| 初始条件         | $E\langle x_0\rangle=\hat{x}_0$<br>$E\langle\widetilde{x}_0\widetilde{x}_0\rangle=P_0$ |
| 独立性假设       | $E\langle w_k v_j^T\rangle=0$，全部的$k$和$j$                |
| 状态估计外推     | $\hat{x}_{k(-)}=\Phi_{k-1}\hat{x}_{(k-1)(+)}$                |
| 误差协方差外推   | $ P_{k(-)}=\Phi_{k-1} P_{(k-1)(+)}\Phi_{k-1}^T+Q_{k-1} $     |
| 状态估计观测更新 | $\hat{x}_{k(+)}=\hat{x}_{k(-)}+\overline{K}_k[z_k-H_k\hat{x}_{k(-)}]$ |
| 误差协方差更新   | $P_{k(+)}=[I-\overline{K}_kH_k]P_{k(-)}$                     |
| 卡尔曼增益矩阵   | $\overline{K}_k=P_{k(-)}H_k^T[H_kP_{k(-)}H_k^T+R_k]^{-1}$    |

## 四、卡尔曼滤波公式推导

### (一) 随机过程和线性系统方法

从线性系统和测量模型出发，推导随机系统在$t_k$时刻的状态最佳估计值。

设$\hat{x}_{k(+)}=K_k^1\hat{x_{k(-)}}+\overline{K}_k z_k$ **(5)**，现求解$\overline{K}_k$和$K_k^1$的值。

由正交原理（使MS误差$e=E\langle[x-\alpha_1z]^2\rangle$最小化的常数$\alpha_1$就是使$x-\alpha_1z$与$z$正交的$\alpha_1$值，即$E\langle [x-\alpha_1z]z\rangle=0$）得

$E\langle[x_k-\hat{x}_{k(+)}]z_i^T=0, \ \ i=1,2,\ ...\ ,k-1 $

$E\langle x_k-\hat{x}_{k(+)}z_k^T\rangle=0$

带入**(1)**和**(5)**式得：

$E\langle [\Phi_{k-1}x_{k-1}+w_{k-1}-K_k^1\hat{x_{k(-)}}-\overline{K}_kz_k]z^T_i\rangle=0,\ \ i=1,2,\ ...\ ,k-1$

再带入**(2)**式得：

$E\langle[\Phi_{k-1}x_{k-1}-K_k^1\hat{x_{k(-)}}-\overline{K}_kH_kx_k-\overline{K}_kv_k]z_i^T\rangle=0,\ \ i=1,2,\ ...\ ,k-1$ 





