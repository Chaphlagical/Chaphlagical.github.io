---
title: 动态规划模型
tags: 优化方法
article_header:
  type: cover
  image:
    src: /assets/images/optimize.jpg
---

<!--more-->

## 一、动态规划一般解法

动态规划模型的求解过程从求解最后一个阶段的最优策略开始，在阶段$i$在状态$s_i$下对所有可能的决策$x_i$，通过递推公式
$$
f^*_i(s_i)=\mathop{max}\limits_{x_i}\ or\ \mathop{min}\limits_{x_i}\{f_i(s_i,x_i,f^*_{i+1}(s_{i+1}))\}
$$
确定每一种状态$s_i$下的最优决策$x_i$，然后继续进行递推

## 二、确定型动态规划问题

### (一) 背包模型

考虑有$n$件物体可供选择，总重量不超过$b$公斤，令$x_i$为背包中的物品$i$的数量，定义$c_i$和$a_i$分别为单位物品$i$的收益和重量，背包问题由以下整数型线性规划模型描述：
$$
max\ \ z=c_1x_1+c_2x_2+……+c_nx_n
$$
$$
s.t.\ \ a_1x_1+a_2x_2+……+a_nx_n\leq b
$$
$$
x_1,x_2,……,x_n\geq 0 且为整数
$$
其中：

* 物品$i$表示阶段$i$,$i=n,n-1,\ ……\ ,2,1$

* 阶段$i$要做的决策是装入物品$i$的数量，用$x_i$来表示，定义$\lfloor\frac{b}{a_i}\rfloor$为小于等于 $\frac{b}{a_i}$ 的最大整数，则决策变量$x_i$的允许决策集合为$x_i\in\{0,1,\ ...\ , \ \}$

* 阶段$i$的状态用$s_i$表示，表示可用于放置物品$i,i+1,\ ...\ ,n$的总重量额度，$x_i$为阶段$i$中放入物品$i$的数量，因此阶段$i+1$的状态变量可以表示为$s_{i+1}=s_i-a_ix_i$，该方程也为状态转移方程。

* 在阶段$i$的状态$s_i$下，若当前的决策为$x_i$，则当前阶段的决策对总收益的贡献为$v_i(s_i,x_i)=c_ix_i$原问题的总收益为$v=\sum\limits^n_{i=1} v_i(s_i,x_i)$。定义$f_i(s_i,x_i)$为在阶段$i,i+1,... ,n$中，第$i$阶段状态$s_i$的情况下，采取决策$x_i$以及在后续阶段$i+1,...,n$采取最优策略时的收益。定义$f^*_i(s_i)\mathop{=}\limits^\Delta f_i(s_i,x_i^*)$为在第$i$阶段的状态$s_i$情况下，在阶段$i,i+1,...,n$采取最优策略时的最大收益。这里阶段$i$中子问题的目标函数可以描述为
  $$
  f_i(s_i,x_i)=c_ix_i+f^*_{i+1}(s_{i+1})
  $$
  阶段$i$要求的解的子问题可以建模为：
  $$
  f_i^*(s_i)=\mathop{max}\limits_{x_i\in\{0,1,...,\lfloor\frac{b}{a_i}\rfloor\}\\a_ix_i\leq s_i}\{f_i(s_i,x_i)\}
  $$

  可得递推方程：
  $$
  f_i^*(s_i)=\mathop{max}\limits_{x_i\in\{0,1,...,\lfloor\frac{b}{a_i}\rfloor\}\\a_ix_i\leq s_i}\{c_ix_i+f^*_{i+1}(s_i-a_ix_i)\},\ i=n,n-1,...,2,1
  $$

  $$
  f^*_{n+1}(s_i-a_ix_i)=0
  $$


### (二) 劳动力模型

  假设工程工期长度为$n$个星期，并且第$i$周至少需要$b_i$个劳动力，令$x_i$为第$i$周雇佣的实际工人数，第$i$周可能有两笔费用：维持多余劳动力的费用$h_1(x_i)$和招聘劳动力的费用$h_2(x_{i-1},x_i)$

* 用第$i$周表示第$i$阶段，$i=1,2,...,n$

* 阶段$i$的决策变量为$x_i$，它是第$i$周的实际工人数

* 阶段$i$的状态由阶段$i-1$的实际劳动力数$x_{i-1}$表示，即$s_i=x_{i-1}$

* 状态转移方程$s_{i+1}=x_i$

* 在阶段$i$的状态$s_i$下，如果当前的决策为$x_i$，则当前阶段的费用$v_i(s_i,x_i)=h_1(x_i)+h_2(s_i,x_i)$，整个工程的总费用为$v=\sum\limits^n_{i=1}v_i(s_i,x_i)$，定义$f_i(s_i,x_i)$为第$i=i,i+1,...,n$周期间，在第$i-1$周工人数为$s_i$，第$i$周工人数，第$i+1,...,n$周采用最优劳动力规模情况下的费用。定义$f^*_i(s_i)\mathop{=}\limits^\Delta f_i(s_i,x_i^*)$为第$i=i,i+1,...,n$周期间，在第$i-1$周工人数为$s_i$，第$i$周工人数，第$i+1,...,n$周采用最优劳动力规模情况下的最小费用。则阶段$i$中的子问题的目标函数为：
  $$
  f_i(s_i,x_i)=h_1(x_i)+h_2(s_i,x_i)+f^*_{i+1}(s_{i+1})
  $$
  递归方程为：
  $$
  f^*_i(s_i)=\mathop{min}\limits_{x_i\geq b_i}\{h_1(x_i)+h_2(s_i,x_i)+f^*_{i+1}(s_{i+1})\}, \ i=n,n-1,...,2,1
  $$

  $$
  f^*_{n+1}(s_{n+1})=0
  $$

### (三) 设备更新模型

在每年年初，我们需要决定是继续使用它还是用一台新的设备更新它。令函数$r(t)$、$c(t)$和$s(t)$分别表示某一台运行了$t$年的设备的年收入、年运行费和当前的折扣现值，购买一台新的设备价格为$b$

* 用年度$i$表示阶段$i=1,2,...,n$

* 阶段$i$的决策$x_i\in\{K,R\}$，$K$表示继续使用，$R$表示进行更新

* 阶段$i$的状态变量表示为设备已经使用的年数$i$，状态变量$s_i=t\in\{0,1,2,...\}$

* 状态转移方程为：$s_{i+1}=\begin{cases}s_i+1&若x_i=K;\\1&若x_i=R\end{cases}$

* 在阶段$i$的状态$s_i$下，当前阶段的净收益为：$v_i(s_i,x_i)=\begin{cases}r(s_i)-c(s_i)&若x_i=K\\s(s_i)-b+r(0)-c(0)& 若x_i=R\end{cases}$

* 定义$f_i(s_i,x_i)$为第$i,i+1,...,n$年期间，已知设备在第$i$年年初运行年数为$s_i$，第$i$年的决策为$x_i$,以及第$i+1,...,n$年间采取最优更新策略下的净收益，阶段$i$中要求解的子问题的目标函数为：
  $$
  f_i(s_i,x_i)=\begin{cases}r(s_i)-c(s_i)+f^*_{i+1}(s_i+1)&若x_i=K\\s(s_i)-b+r(0)-c(0)+f^*_{i+1}(1) &若x_i=R\end{cases}
  $$
  递归方程为：
  $$
  f_i(s_i,x_i)=\mathop{max}\limits_{x_i\in \{K,R\}}\begin{cases}r(s_i)-c(s_i)+f^*_{i+1}(s_i+1)\\s(s_i)-b+r(0)-c(0)+f^*_{i+1}(1) \end{cases},i=n,n-1,...,1
  $$

  $$
  f^*_{n+1}(s_{n+1})=0
  $$

### (四) 投资模型

假设计划在未来$n$年的每年年初进行投资，每年投资额分别为$b_1,b_2,...,b_n$元，可以在两家银行之间选择投资，银行甲的年利率为$r_1$，银行乙的年利率为$r_2$，两家银行都对新的投资按投资额支付红利，银行甲和银行乙在第$i$的红利百分比分别为$q_{1i}$和$q_{2i}$，银行在投资年度年底支付红利，每年年初可以决定在任何一家银行进行本年度的投资，一旦存入资金，必须在银行存放到第$n$年年底，即每年年初只有红利和新的资金可以用于投资

* 阶段用年度$i$表示，$i=1,2,...,n$

* 阶段$i$的决策变量$x_i$代表在银行甲的投资额，决策变量$y_i$代表在银行乙的投资额

* 阶段$i$的状态$s_i$是第$i$年年初可用于投资的资金，故有$x_i+y_i=s_i$

* 第$i$年年初投入的资金额$s_i$包括新投入的资金$b_i$和第$i-1$年进行投资所得的红利，故状态转移方程为：
  $$
  s_1=b_1
  $$

  $$
  s_{i+1}=b_{i+1}+x_iq_{1i}+(s_i-x_i)q_{2i}
  $$

* 已知$x_i$和$s_i-x_i$分别为第$i$年年初在银行甲和银行乙投入的资金数，定义$v_i(s_i,x_i)$为第$i$年年初的投资在第$n$年年底时的累积资金额，令$\alpha_k=1+r_k,\ k=1,2$则有
  $$
  v_i(s_i,x_i)=x_i\alpha_1^{n+1-i}+(s_i-x_i)\alpha_2^{n+1-i}\ ,i=1,2,...,n-1
  $$

  $$
  v_n(s_n,x_n)=x_n\alpha_1+(s_n-x_n)\alpha_2+x_nq_{1n}+(s_n-x_n)q_{2n}
  $$

  递归方程为：
  $$
  f^*_i(s_i)=\mathop{max}\limits_{0\leq x_i\leq s_i}\{v_i(s_i,x_i)+f^*_{i+1}(s_{i+1}) \}, \ i=n,n-1,..,2,1
  $$

  $$
  f^*_{n+1}(s_{n+1})=0
  $$

  