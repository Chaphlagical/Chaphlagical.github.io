---
title: 状态空间方程的解
tags: 现代控制理论
article_header:
  type: cover
  image:
    src: /assets/images/control.png
---

<!--more-->

## 一、矩阵指数

### (一) 状态转移矩阵

**定义**：若时变线性系统的齐次状态方程
$$
\dot{\boldsymbol x}(t)=\boldsymbol A(t)\boldsymbol x(t),\ \ \boldsymbol x(t_0)=\boldsymbol x_0
$$
的解可写作
$$
\boldsymbol x(t,t_0)=\Phi(t,t_0)\boldsymbol x_0
$$
则称矩阵$\Phi(t,t_0)$为该系统的状态转移矩阵

对于线性定常系统，因总可以将初始时间平移到$t_0=0$，故其状态转移矩阵是时间$t$的单变量函数，在不致产生误解时，通常直接简写为$\Phi(t)$

线性定常系统：$\Phi(t,t_0)=\Phi(t-t_0,0)$ 

对于微分方程
$$
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x\ \ \boldsymbol x(0)=\boldsymbol x_0
$$
通过拉氏变换可解得
$$
\begin{align}
\boldsymbol x(t)&=L^{-1}[(s\boldsymbol I-\boldsymbol A)^{-1}]\boldsymbol x_0\\
\boldsymbol x(t)&=\Phi(t)\boldsymbol x_0
\end{align}
$$
在得到线性定常系统的零输入响应（齐次状态方程的解、自由运动的解）的同时，也得到该系统状态转移矩阵的拉氏反变换表示形式：
$$
\Phi(t)=L^{-1}[(s\boldsymbol I-\boldsymbol A)^{-1}]
$$
对于标量系统，
$$
\begin{align}
\Phi(t)&=L^{-1}[\frac{1}{s-a}]=e^{at}
=\sum\limits^\infty_{k=0}\frac{1}{k!}(at)^k
\end{align}
$$

### (二) 矩阵指数的定义和求解

#### 1、定义

**定义(矩阵指数)**：对方阵$\boldsymbol S$，其矩阵指数定义为
$$
e^{\boldsymbol S}=\sum\limits^\infty_{k=0}\frac{1}{k!}\boldsymbol S^k=\boldsymbol I+\boldsymbol S+\frac{1}{2!}\boldsymbol S^2+\frac{1}{3!}\boldsymbol S^3+\cdots
$$
对于线性定常系统，矩阵指数(状态转移矩阵)定义为：
$$
e^{\boldsymbol A t}=\sum\limits^\infty_{k=0}\boldsymbol A^kt^k=\boldsymbol I+\boldsymbol At+\frac{1}{2!}\boldsymbol A^2t^2+\frac{1}{3!}\boldsymbol A^3t^3+\cdots
$$

#### 2、状态转移矩阵的性质

* 性质1：$\Phi(t)=e^{\boldsymbol A t}=L^{-1}[(s\boldsymbol I-\boldsymbol A)^-1]$ 
* 性质2：$\Phi(0)=e^{\boldsymbol A 0}=\boldsymbol I$
* 性质3：$\Phi(t)=\boldsymbol A \Phi(t)=\Phi(t)\boldsymbol A$，$\frac{\mathrm{d}}{\mathrm{d}t}(e^{\boldsymbol A t})=\boldsymbol A e^{\boldsymbol A t}=e^{\boldsymbol A t}\boldsymbol A$

* 性质4：$\Phi(t)\Phi(\tau)=\Phi(t+\tau)$，$e^{\boldsymbol A t}e^{\boldsymbol A \tau}=e^{\boldsymbol A(t+\tau)}$

	* 推论1：状态转移矩阵是可逆阵，且总有
		$$
		[\Phi(t)]^{-1}=\Phi(-t),\ \ [e^{\boldsymbol A t}]^{-1}=e^{-\boldsymbol A t}
		$$

	* 推论2：对一切整数$k$，总有
		$$
		[\Phi(t)]^k=\Phi(kt),\ \ [e^{\boldsymbol A t}]^k=e^{\boldsymbol Akt}
		$$

* 性质5：$\boldsymbol A \boldsymbol B=\boldsymbol B \boldsymbol A\Leftrightarrow e^{\boldsymbol At}e^{\boldsymbol Bt}=e^{(\boldsymbol A+\boldsymbol B)t}$ 

	* 若对标量$\sigma$和方阵$\boldsymbol B$，有$\boldsymbol A=\sigma\boldsymbol I+\boldsymbol B$ 则：
		$$
		e^{\boldsymbol At}=e^{\sigma t}e^{\boldsymbol Bt}
		$$

* 性质6：对任一非奇异矩阵$\boldsymbol P$有
	$$
	e^{\boldsymbol P^{-1}\boldsymbol A \boldsymbol P t}=\boldsymbol P^{-1}e^{\boldsymbol A t}\boldsymbol P
	$$

### (三) 矩阵指数的求取

#### 1、直接计算法

* 若矩阵$\boldsymbol A$呈对角线形，即：$\boldsymbol A=\mathrm{diag}(a_1,a_2,\cdots,a_m)$则
	$$
	e^{\boldsymbol A t}=\mathrm{diag}(e^{a_1t},e^{a_2t},\cdots,e^{a_mt})
	$$

* 若矩阵$\boldsymbol A$呈对角块形，即：$\boldsymbol A=\mathrm{Diag}(\boldsymbol A_1,\boldsymbol A_2,\cdots,\boldsymbol A_m)$则
	$$
	e^{\boldsymbol At}=\mathrm{Diag}(e^{\boldsymbol A_1t},e^{\boldsymbol A_2t},\cdots,e^{\boldsymbol A_mt})
	$$

#### 2、拉氏变换法

$$
e^{\boldsymbol At}=L^{-1}[(s\boldsymbol I-\boldsymbol A)^{-1}]
$$

#### 3、标准型法

$$
e^{\boldsymbol At}=\boldsymbol Qe^{\boldsymbol Q^-1 \boldsymbol A \boldsymbol Q}\boldsymbol Q^{-1}=\boldsymbol Q e^{\boldsymbol At}\boldsymbol Q^{-1}
$$

当矩阵$\boldsymbol A $有$ n $个互不相关的特征向量时，可以通过相似变换将$\boldsymbol A $变换为对角线形  

#### 4、待定系数法

$$
e^{\boldsymbol At}=\sum\limits^{n-1}_{m=0}\alpha_m(t)\boldsymbol A^m
$$

**凯利-哈密顿定理**：方阵满足自身的特征方程

对于$n\times n$矩阵$\boldsymbol A$，设其特征多项式为
$$
f(\lambda)=|\lambda\boldsymbol I-\boldsymbol A|=\lambda^n+a_{n-1}\lambda^{n-1}+\cdots+a_1\lambda+a_0
$$
则凯利-哈密顿定理保证如下的矩阵方程成立：
$$
f(\boldsymbol A)=a_0\boldsymbol I+a_1 \boldsymbol A+a_2 \boldsymbol A^2+\cdots+a_{n-1}\boldsymbol A^{n-1}+\boldsymbol A^n=\boldsymbol 0
$$
**推论：**若$\boldsymbol A\in R^{n\times n}$，则对任意自然数$k$总有$\boldsymbol A^k=\sum\limits^{n-1}_{m=0}\beta_{k,m}\boldsymbol A^m$

更进一步：
$$
e^{\boldsymbol A t}=\sum\limits^\infty_{k=0}\frac{1}{k!}\boldsymbol A^kt^k=\sum\limits^\infty_{k=0}\frac{t^k}{k!}\sum\limits^{n-1}_{m=0}\beta_m \boldsymbol A^m=\sum\limits^{n-1}_{m=0}\alpha_m(t)\boldsymbol A^m
$$
**结论：**已知某函数$f(\lambda)$和一方阵$\boldsymbol A$，若多项式$g(\lambda)$在$\boldsymbol A$的谱上与$f(\lambda)$相等，则矩阵函数$f(\boldsymbol A)=g(\boldsymbol A)$

若方阵$\boldsymbol A$有$n$个互不相同的特征值$\lambda_i(i=1,2,\cdots,n)$，则函数$f(\lambda)$与$g(\lambda)$在矩阵$\boldsymbol A$的谱上相等可理解为如下$n$个等式：
$$
f(\lambda_i)=g(\lambda_i),\ \ (i=1,2,\cdots,n)
$$
若方阵$\boldsymbol A$有$m$个互不相同的特征值，其第$k$个特征值为$l_k$重，则函数$f(\lambda)$与多项式函数$g(\lambda)$在矩阵$\boldsymbol A$的谱上相等可理解为：
$$
\frac{\mathrm{d}^{(i)}}{\mathrm{d}\lambda^i}f(\lambda)\Bigg|_{\lambda=\lambda_k}=\frac{\mathrm{d}^{(i)}}{d\lambda^i}g(\lambda)\Bigg|_{\lambda=\lambda_k}(i=0,1,2,\cdots,l_k-1;k=1,2,\cdots,m)
$$
矩阵函数、标量函数的相互构造：
$$
f(\boldsymbol A)=e^{\boldsymbol At}=\sum\limits^\infty_{k=0}\frac{\boldsymbol A^kt^k}{k!}\Leftrightarrow f(\lambda)=\sum\limits^\infty_{k=0}\frac{\lambda^kt^k}{k!}=e^{\lambda t}
$$
构造另一个低阶多项式标量函数：
$$
g(\lambda)=\sum\limits^{n-1}_{k=0}\alpha_k\lambda_k\neq f(\lambda)
$$
特征多项式：$\Delta (\lambda)=|\lambda \boldsymbol I-\boldsymbol A|=\lambda^n+a_1\lambda^{n-1}+a_2\lambda^{n-2}+\cdots+a_n$
$$
\Delta(\boldsymbol A)=0
$$
特征多项式除高阶多项式：
$$
\begin{align}
f(\lambda)&=\Delta(\lambda)\times h(\lambda)+g(\lambda)\\
f(\boldsymbol A)&=\Delta(\boldsymbol A)\times h(\boldsymbol A)+g(\boldsymbol A)\\
&=0\times h(\boldsymbol A)+g(\boldsymbol A)\\
&=g(\boldsymbol A)
\end{align}
$$
对于$\{\alpha_{n-1},\alpha_{n-2},\cdots,\alpha_0 \}$的求解：
$$
\begin{align}
g(\lambda_1)&=f(\lambda_1)\\
\frac{\mathrm{d}}{\mathrm{d}\lambda}g(\lambda_1)&=\frac{\mathrm{d}}{\mathrm{d\lambda}}f(\lambda_1)\\
\vdots\\
\frac{\mathrm{d^{n_1-1}}}{\mathrm{d}\lambda^{n_1-1}}g(\lambda_1)&=\frac{\mathrm{d^{n_1-1}}}{\mathrm{d}\lambda^{n_1-1}}f(\lambda_1)\\
\vdots\\
g(\lambda_l)&=f(\lambda_l)\\
\frac{\mathrm{d}}{\mathrm{d}\lambda}g(\lambda_l)&=\frac{\mathrm{d}}{\mathrm{d\lambda}}f(\lambda_l)\\
\vdots\\
\frac{\mathrm{d^{n_l-1}}}{\mathrm{d}\lambda^{n_l-1}}g(\lambda_l)&=\frac{\mathrm{d^{n_l-1}}}{\mathrm{d}\lambda^{n_l-1}}f(\lambda_l)\\
\end{align}
$$
$n$个未知数：
$$
g(\lambda)=\sum\limits^{n-1}_{k=0}\alpha_k \lambda^k\neq f(\lambda)
$$
$n$个方程：
$$
n_1+n_2+\cdots+n_l=n\\
f(\boldsymbol A)=f(\boldsymbol B)=\sum\limits^{n-1}_{k=0}\alpha_k \boldsymbol A^k
$$

### (四) 模态与模态分解

考察齐次状态空间方程的解，以互不相同的特征值为例：
$$
\begin{align}
\boldsymbol x(t)&=e^{\boldsymbol At}\boldsymbol x_0=e^{(\boldsymbol Q \boldsymbol \Lambda \boldsymbol Q^{-1})t}\boldsymbol x_0=\boldsymbol Q e^{\boldsymbol \Lambda t}\boldsymbol Q^{-1}\boldsymbol x_0\\
&=\begin{bmatrix}\boldsymbol q_1&\boldsymbol q_2&\cdots&\boldsymbol q_n\end{bmatrix}
\begin{bmatrix}e^{\lambda_1 t}\\&e^{\lambda_2 t}\\&&\ddots\\&&& e^{\lambda_n t} \end{bmatrix}\begin{bmatrix}\boldsymbol p_1\\ \boldsymbol p_2\\ \vdots\\ \boldsymbol p_n\end{bmatrix}\boldsymbol x_0\\
&=\begin{bmatrix}e^{\lambda_1 t}\boldsymbol q_1&e^{\lambda_2 t}\boldsymbol q_2\cdots e^{\lambda_nt}\boldsymbol q_n \end{bmatrix}\begin{bmatrix}\boldsymbol p_1\boldsymbol x_0\\ \boldsymbol p_2\boldsymbol x_0\\ \vdots\\ \boldsymbol p_n \boldsymbol x_0 \end{bmatrix}\\
&=(\boldsymbol p_1 \boldsymbol x_0)e^{\lambda_1 t}\boldsymbol q_1+(\boldsymbol p_2 \boldsymbol x_0)e^{\lambda_2 t}\boldsymbol q_2+\cdots+(\boldsymbol p_n \boldsymbol x_0)e^{\lambda_n t}\boldsymbol q_n
\end{align}
$$
其中，$\boldsymbol p$为行向量，$\boldsymbol q$、$\boldsymbol x$为列向量，$\boldsymbol p\boldsymbol x$为标量

由于$e^{\lambda_i t}$体现了系统的固有属性，一般将$e^{\lambda_i t},(i=1,2,\cdots,n)$称作系统的模态，或者称作振荡振型，简称振型。 也称将系统矩阵约当化的状态变换阵$Q$为该系统的模态矩阵，称该状态变换过程及结果为模态分解  

## 二、状态空间方程的解

### (一) 线性定常非齐次状态方程的解

$$
\begin{matrix}\dot{\boldsymbol x}=\boldsymbol A\boldsymbol x+\boldsymbol B \boldsymbol u&\boldsymbol x(0)=\boldsymbol x_0 \end{matrix}
$$

同时左乘$e^{-\boldsymbol A t}$并移项
$$
e^{-\boldsymbol A t}\dot{\boldsymbol x}-e^{-\boldsymbol A t}\boldsymbol A \boldsymbol x(t)=e^{-\boldsymbol A t}\boldsymbol B \boldsymbol u(t)
$$
此即
$$
\frac{\mathrm{d}}{\mathrm{d}t}(e^{-\boldsymbol A t}\boldsymbol x(t))=e^{-\boldsymbol A t}\boldsymbol B \boldsymbol u(t)
$$
对此式从0至$t$积分
$$
e^{-\boldsymbol At}\boldsymbol x(t)-e^0 \boldsymbol x(0)=\int^t_0 e^{-\boldsymbol A \tau}\boldsymbol B \boldsymbol u(\tau)d\tau
$$
移项，等式两边同左乘$e^{\boldsymbol A t}$
$$
\boldsymbol x(t)=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A(t-\tau)}\boldsymbol B \boldsymbol u(\tau)d\tau
$$
变量代换得
$$
\boldsymbol x(t)=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau
$$
当初始时刻非零时，从$t_0$积分到$t$，得
$$
\boldsymbol x(t)=e^{\boldsymbol A (t-t_0)}\boldsymbol x(t_0) +\int^t_{t_0} e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau
$$

### (二) 状态空间方程的解

$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+ \boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x+\boldsymbol D \boldsymbol u
\end{cases}\\
\boldsymbol x(0)=\boldsymbol x_0
$$

$$
\begin{align}
\boldsymbol x(t)&=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A(t-\tau)}\boldsymbol B\boldsymbol u(\tau)d\tau\\
&=e^{\boldsymbol A t}\boldsymbol x_0+\int^t_0 e^{\boldsymbol A\tau}\boldsymbol B \boldsymbol u(t-\tau)d\tau\\
\boldsymbol y(t)&=\boldsymbol C e^{\boldsymbol At}\boldsymbol x_0+\boldsymbol C\int^t_0 e^{\boldsymbol A(t-\tau)}\boldsymbol B\boldsymbol u(\tau)d\tau+\boldsymbol D \boldsymbol u\\
&=\boldsymbol C e^{\boldsymbol A t}\boldsymbol x_0+\boldsymbol C\int ^t_0 e^{\boldsymbol A\tau}\boldsymbol B\boldsymbol u(t-\tau)d\tau+\boldsymbol D\boldsymbol u
\end{align}
$$

### (三) 状态空间方程的离散化

$$
\begin{cases}
\dot{\boldsymbol x}=\boldsymbol A \boldsymbol x+ \boldsymbol B \boldsymbol u\\
\boldsymbol y=\boldsymbol C \boldsymbol x+\boldsymbol D \boldsymbol u
\end{cases}\Leftrightarrow
\begin{cases}
\boldsymbol x[k+1]=\boldsymbol F\boldsymbol x[k]+\boldsymbol H \boldsymbol u[k]\\
\boldsymbol y[k]=\boldsymbol C \boldsymbol x[k]+\boldsymbol D \boldsymbol u[k]
\end{cases}
$$

$$
\boldsymbol F=e^{\boldsymbol AT}\\
\boldsymbol H=(\int^T_0e^{\boldsymbol A \tau}d\tau)\boldsymbol B
$$



## 三、预解矩阵及频域求解

**Souriau-Frame-Faddeev算法**
$$
\begin{align}
(s\boldsymbol I-\boldsymbol A)^{-1}&=\frac{\mathrm{adj}(s\boldsymbol I-\boldsymbol A)}{\mathrm{det}(s\boldsymbol I-\boldsymbol A)}\\
&=\frac{\sum\limits^{n-1}_{k=0}\boldsymbol Q_k\boldsymbol S^k}{s^n+a_{n-1}s^{n-1}+\cdots+a_1s+a_0}
\end{align}
$$
其中，
$$
\begin{align}
\boldsymbol A\boldsymbol Q_0+a_0\boldsymbol I&=\boldsymbol0\\
\boldsymbol A\boldsymbol Q_k+a_k\boldsymbol I&=\boldsymbol Q_{k-1}(k=n-1,\cdots,1)
\end{align}
$$
**推论：**
$$
(s\boldsymbol I-\boldsymbol A)^{-1}=\sum\limits^{n-1}_{k=0}a_k(s)\boldsymbol A^k
$$
其中，
$$
a_k(s)=\frac{1}{\Delta (s)}(s^{n-k-1}+a_{n-1}s^{n-k-2}+\cdots+a_{k+2}s+a_{k+1}),k=0,1,2,\cdots,n-1\\
\Delta (s)=\det(s \boldsymbol I-\boldsymbol A)
$$
