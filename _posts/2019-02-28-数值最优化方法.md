---
bg: "2019-02-28.jpg"
layout: post
title:  "数值最优化方法"
crawlertitle: "数值最优化方法"
summary: "数值最优化方法"
date:   2019-02-28 08:02:53 +0700
categories: posts
tags: ['优化方法']
author: Chaf
---

本文简单梳理数值最优化方法的基本要点


* TOC
{:toc}
# 第一章 无约束最优化方法的基本结构

## 一、最优性条件

### （一）无约束最优化问题

无约束最优化问题是求一个函数的极值，即求$min f(x)$，其中$x\in \mathbb{R},f(x)\in \mathbb{R}$称为目标函数，问题的解成为最优解，记为$x^{\star}$，该点的函数值$f(x^{\star})$称为最优值。

### （二）最优解类型

#### 		1、全局最优解

若对任意$x\in\mathbb{R}$,$f(x)\geq f(x^{\star})$则称$x^{\star}$为无约束最优化问题的全局最优解；若对任意$x \in\mathbb{R^n}$且$x\neq x^\star$，有$f(x)>f(x^{\star})$ ，则称$x^{\star}$为问题的严格全局最优解.

#### 		2、局部最优解

对$x^{\star} \in \mathbb{R^n}$，若存在$\varepsilon>0$，使得对任意$x\in\mathbb{R^n}$，当$\parallel x-x^\star\parallel<\varepsilon $时，有$f(x)\geq f(x^\star)$，则称$x^\star$为无约束最优化问题的局部最优解；若对$x^{\star} \in \mathbb{R^n}$，若存在$\varepsilon>0$，使得对任意$x\in\mathbb{R^n}$，当$\parallel  x-x^\star\parallel<\varepsilon $且$x\neq  x^\star$时，有$f(x)> f(x^\star)$，则称$x^\star$为无约束最优化问题的严格局部最优解.

### （三）最优性条件

#### 		1、一阶必要条件

设$f(x)\in C^1$，$x^ \star$为$f(x)$的一个局部极小点，则$g(x^\star)=0$.

#### 		2、二阶必要条件

设$f(x) \in C^2$，$x^ \star$ 是$x^ \star$是$f(x)$的一个局部极小点，则$G(x^ \star)$半正定.

#### 		3、二阶充分条件

设$f(x)\in C^2$，在点$x^ \star$有$g(x^ \star)=0$，则当$G(x^ \star)$正定时，$x^ \star$是$f(x)$的严格局部极小值点.

#### 		4、方向导数与最优性条件的方向导数表述

##### （1）方向导数定义

一阶方向导数定义为$\frac{\partial f(x)}{\partial d}=lim_{a \rightarrow0^+}\frac{f(x+ad)-f(x)}{\alpha \parallel d \parallel}$.

##### （2） 一、二阶导数的计算

* 若$f(x) \in C^1,则它在点$$x$处沿方向$d \neq 0$的一阶方向导数可表示为$\frac{\partial f(x)}{\partial d}=\frac{1}{\parallel d \parallel}g(x)^Td$
*  若$f(x) \in C^2,则它在点$$x$处沿方向$d \neq 0$的二阶方向导数可表示为$\frac{\partial ^2 f(x)}{\partial d^2}=\frac{1}{\parallel d \parallel ^2}d^TG(x)d$.

##### （3）最优性条件表述

* 一阶必要条件：设$f(x)\in C^1$，$x^ \star$为$f(x)$的一个局部极小点，则$f(x)$在点$x^ \star$处沿任意方向的一阶方向导数为零.
* 二阶充分条件：设$f(x)\in C^2$，$f(x)$在点$x^ \star$处沿任意方向的一阶方向导数为零，则当$f(x)$在点$x^ \star$处沿任意方向的二阶导数为正时，$x^ \star$为$f(x)$的严格局部极小点，

## 二、方法的特性

### （一）等高线

等高线是函数在其上恒取常数值的曲线，即$f(x)=c(x \in \mathbb{R^2})$.c取不同的值，可以在平面上得到相应的一族曲线.

### （二）稳定点及其种类

满足$g(x)=0$的点称为稳定点.

极大极小点均为稳定点.

既非极小点又非极大点的稳定点为鞍点.

### （三）方法的基本结构

**步1** 给定初始点$x_0 \in \mathbb{R^n}，k:=0$；

**步2** 若在$x_k$点终止准则满足，则输出有关信息，停止迭代；

**步3** 确定$f(x)$在$x_k$点的下降方向$d_k$；

**步4** 确定步长$\alpha_k$，使$f(x_k+\alpha_kd_k)$较之$f(x_k)$有某种意义下的下降；

**步5** 令$x_{k+1}:=x_k+\alpha_kd_k，k:=k+1$，转**步2**

### （四）终止准则

常见的终止准则：

* $\parallel g(x_k) \parallel \leq \varepsilon$ 
* $\parallel x_k-x_{k+1} \parallel \leq \varepsilon$
* $f_k-f_{k+1} \leq \varepsilon$ 

### （五）收敛性与收敛速度

#### 		1、线性收敛

$\mathop{lim}\limits_{k \rightarrow \infty} \frac{\parallel x_{k+1}-x^ \star \parallel}{\parallel x_k-x^ \star \parallel}=a$ 

#### 		2、超线性收敛

$\mathop{lim}\limits_{k \rightarrow \infty} \frac{\parallel x_{k+1}-x^ \star \parallel}{\parallel x_k-x^ \star \parallel}=0$

#### 		3、二阶收敛

$\mathop{lim}\limits_{k \rightarrow \infty} \frac{\parallel x_{k+1}-x^ \star \parallel}{\parallel x_k-x^ \star \parallel^2}=a$ 

### （六）二次终止性

对于一个算法，如果它对任意正定二次函数，从任意起始点出发，可以经过有限次迭代求得极小点，则称算法具有二次终止性.

## 三、线搜索准则

### （一）问题描述

* 满足什么准则，步长可以接受？
* 有了合适的准则之后，满足该准则的步长怎么求？

### （二）精确线搜索准则

$\alpha_k=\mathop{min}\limits_{\alpha} f(x_k+\alpha d_k)$

迭代公式：$x_{k+1}=x_k+\alpha_k d_k$

同时有结论：$g^T_{k+1}d_k=0$

### （三）非精确线搜索准则

非精确搜索即寻找合适的$\alpha_k$使得$f(x_k+\alpha_k d_k)<f(x_k)$

一般可取，

#### 		1、Armijo 准则

$f(x_k+\alpha d_k) \leq f(x_k)+\rho g^T_kd_k\alpha，\rho \in(0,1)$

#### 		2、Goldstein 准则

$f(x_k+\alpha d_k) \leq f(x_k)+\rho g^T_kd_k\alpha，$

$f(x_k+\alpha d_k) \geq  f(x_k)+(1-\rho) g^T_kd_k\alpha，\rho \in(0,\frac{1}{2})$

#### 		3、Wolfe准则

$f(x_k+\alpha d_k) \leq f(x_k)+\rho g^T_kd_k\alpha$

$g(x_k+\alpha d_k)^Td_k \geq \sigma g^T_kd_k，1>\sigma>\rho>0$

#### 		4、强Wolfe准则

$f(x_k+\alpha d_k) \leq f(x_k)+\rho g^T_kd_k\alpha，$

$\mid g(x_k+\alpha d_k)^Td_k \mid \leq -\sigma g_k^Td_k，1>\sigma>\rho>0$

### （四）非精确线性搜索的可行性

#### 1、非精确线搜索步长$\alpha_k$的存在性

设$f(x_k+\alpha d_k)$在$\alpha>0$时有下界，且$g^T_kd_k<0$，则必存在$\alpha_k$，在点$x_k+\alpha_kd_k$处满足Wolfe准则或Goldstein准则.

#### 2、非精确线搜索方法的收敛性

设在水平集$\{x \mid f(x) \leq f(x_0)\}$上，$f(x)$有下界，$g(x)$一致收敛，则非精确线搜索算法中的方向$d_k$与$-g_k$之间的夹角$\theta_k$一致有界，即对某一$\mu>0$，有 $0 \leq\theta_k \leq \frac{\pi}{2}-\mu，\forall k$.若Wolfe准则对任给k都成立，则或者存在N，使$g_N=0$，或者$g_k \rightarrow 0，k \rightarrow \infty.$

## 四、线搜索求步长

### （一）0.618方法

#### 			1、基本思想

首先确定一个初始区间，使其包含$\varphi(\alpha)=f(\alpha_k+\alpha d_k)，\alpha>0$的极小点；然后在这个区间上求出近似满足精确线搜索准则的点.该方法建立在单峰函数的基础上.
称$\varphi(\alpha)$是区间$[a,b]$上的单峰函数，若存在$\alpha ^ \star \in [a,b]$，使得$f(x)$在$[a,\alpha ^ \star]$上单调下降，在$[\alpha ^ \star,b]$上单调上升. 

#### 			2、进退法求初始搜索空间

**步1** 给定$\alpha_0 \in [0,\infty)，\gamma_0>0，t>1，i:=0$.

**步2** 计算$\alpha_{i+1}=\alpha_i+\gamma_i$.若$\alpha_{i+1} \leq 0$，则令$\alpha_{i+1}:=0$，转**步4**；若$\varphi(\alpha_{i+1}) \geq \varphi(\alpha_i)$，则转**步4**.

**步3** 令$\gamma_{i+1}=t\gamma_i，\alpha:=\alpha_i，\alpha_i:=\alpha_{i+1}，i:=i+1$，转**步2**.

**步4** 若$i=0$，令$\gamma_i:=-\gamma_i，\alpha:=\alpha_{i+1}$，转**步2**；否则

$a=min${$\alpha ，\alpha_{i+1} $} 

$b=max ${$\alpha ，\alpha_{i+1}$} 

#### 			3、0.618方法求一维函数$\varphi(\alpha)$的近似极小点

 **步1** 给定$a_0>0，b_0>0，i:=0，\varepsilon >0，\tau:=0.618.$

**步2** 若$b_i-a_i<\varepsilon，则\alpha^ \star:=\frac{b_i+a_i}{2}$，输出$\alpha^ \star$，停止线搜索.

**步3** 计算

$\alpha^l_i:=a_i+(1-\tau)(b_i-a_i)$，

$\alpha^r_i:=a_i+\tau(b_i-a_i)$ 

**步4** 若$\varphi (\alpha^l_i)<\varphi(\alpha^r_i)$，则$a_{i+1}:=a_i，b_{i+1}:=\alpha^r_i$；否则$a_{i+1}:=\alpha^l_i，b_{i+1}:=b_i，i:=i+1$，转**步2**

### （二）多项式插值法

#### 		1、两点二次插值求步长

设在$0，\alpha_0(\alpha_0>0)$两点已知：

$\varphi (0)=f(x_k)，\varphi^{'}(0)=g^T_kd_k，\varphi(\alpha_0)=f(x_k+\alpha_0d_k)$

假定在点$\alpha_0$处准则$f(x_k+\alpha d_k) \leq f(x_k)+\rho g^T_kd_k\alpha，\rho \in(0,\frac{1}{2})$不满足

构造二次插值多项式$p(\alpha)=a\alpha^2+b\alpha+c$

满足插值条件：$p(0)=\varphi(0)，p^{'}(0)=\varphi^{'}(\alpha_0)$

则：$p(\alpha)=\frac{\varphi(\alpha_0)-\varphi(0)-\varphi^{'}(0)\alpha_0}{\alpha^2_0}\alpha^2+\varphi^{'}(0)\alpha+\varphi(0)$

$p(\alpha)$的稳定点为$\alpha_1=\frac{-\varphi^{'}(0)\alpha^2_0}{2[\varphi(\alpha_0)-\varphi(0)-\varphi^{'}(0)\alpha_0]}$

#### 		2、三点三次插值求步长

在进行完一步二次插值之后，在$0，\alpha_0>0，\alpha_1>0$三点可知四个插值数据：

$\varphi(0)，\varphi^{'} (0)，\varphi(\alpha_0)，\varphi(\alpha_1)$

从而进行三次插值

设三次插值函数为：$p(\alpha)=a\alpha^3+b\alpha^2+c\alpha+d$

由插值条件可得$d=\varphi(0)，c=\varphi^{'}(0)$以及

$a\alpha^3_0+b\alpha^2_0+\varphi^{'}(0)\alpha_0+\varphi(0)=\varphi(\alpha_0)$

$a\alpha^3_1+b\alpha^2_1+\varphi^{'}(0)\alpha_1+\varphi(0)=\varphi(\alpha_1)$

解方程组得

$\begin{equation}
\begin{bmatrix}
a\\\\b
\end{bmatrix}
=\frac{1}{\alpha_0^2\alpha_1^2(\alpha_1-\alpha_0)}
\begin{bmatrix}
\alpha^2_0 & -\alpha^2_1 \\\\ -\alpha_0^3 & \alpha^3_1
\end{bmatrix}
\begin{bmatrix}
\varphi(\alpha_1)-\varphi(0)-\varphi^{'}(0)\alpha_1\\\\ \varphi(\alpha_0)-\varphi(0)-\varphi^{'}(0)\alpha_0
\end{bmatrix}
\end{equation}$

由$p^{'}(\alpha)=0$可求得$p(\alpha)$的极小点$\alpha_2$，下一步迭代的插值数据可选为$\varphi(0)，\varphi^{'}(0)，\varphi(\alpha_1)，\varphi(\alpha_2)$

## 五、信赖域方法

### （一）基本思想

利用Taylor展开式，在点$x_k$的邻域内，使用$f(x_k+d)$的一阶近似函数或二阶近似函数代替$f(x_k+d)$去求得$d_k$，记近似函数为$q_k(d)$，求该函数的极小点作为迭代方向$d_k$，即求$\mathop{min}\limits_{d}q_k(d)$得$d_k$.

### （二）信赖域子问题

假定在第k步迭代已得$x_k$以及信赖域的半径$\Delta_k$，则

$min q_k(d)，$

$s.t. \parallel d\parallel \leq\Delta_k，\Delta_k>0$

称为信赖域子问题.

### （三）信赖域算法

解无约束最优化问题信赖域方法的基本结构：

**步1** 给出$x_0 \in \mathbb{R^n}，\Delta_0>0,\varepsilon>0，k:=0.$

**步2** 若终止准则满足，则输出$x_k$，迭代停止.

**步3** 求解信赖域子问题得到$d_k$.

**步4** 由$\gamma_k=\frac{\Delta f_k}{\Delta q_k}$计算$\gamma_k$：

若$\gamma_k>0.75$，且$\parallel d_k \parallel=\Delta_k$，则$\Delta_{k+1}:=2\Delta_k$；

若$\gamma_k<0.25$，则$\Delta_{k+1}:=\Delta_k/4$；

否则，$\Delta_{k+1}:=\Delta_k$ .

**步5** 若$\gamma_k \leq 0$，则$x_{k+1}:=x_k$；否则$x_{k+1}:=x_k+d_k，k:=k+1$，转**步2**.

# 第二章 负梯度方法和Newton型方法

## 一、最速下降法

### （一）最速下降方法

假定在第k步迭代已得迭代点$x_k$，我们欲求$x_k$处使$f(x)$下降最快的方法。这个方向应满足下降条件$g_k^Td<0$。虽然满足下降方向有无穷个，但使$\mid g_k^Td \mid$达到最大值且满足$\parallel d \parallel=1$的$d$只有一个，由Cauchy-Schwarz不等式有：

$\mid g_k^T \mid \leq \parallel g_k \parallel  \parallel d  \parallel$

可知当且仅当$d=d_k=-g_k/\parallel g_k \parallel$时下降最快



### （二）最速下降方法的收敛速度

#### 1、G度量意义

#### 2、Kantorovich不等式

#### 3、正定二次函数最速下降方法的收敛速度

#### 4、条件数

##### （1）定义

##### （2）问题的良态与病态

## 二、Newton方法

### （一）基本Newton方法

#### 1、基本Newton方法步骤

#### 2、基本Newton方法的收敛性

#### 3、优点

#### 4、缺点

### （二）阻尼Newton方法

#### 1、基本概念

#### 2、阻尼Newton方法对严格凸函数的全局收敛性

#### 3、优点

### （三）混合方法

#### 1、混合方法步骤

#### 2、优点

#### 3、缺点

### （四）LM方法

## 三、拟Newton方法

### （一）背景

### （二）拟Newton条件

#### 1、拟Newton条件

#### 2、拟Newton方法的结构

### （三）拟Newton方法修正公式

#### 1、对称秩1公式

#### 2、DFP公式

#### 3、BFGS公式

#### 4、Broyden族公式

## 四、拟Newton方法的基本性质

### （一）变度量意义下的最速下降方法

### （二）对称秩1方法的性质

#### 对称秩1方法的二次终止性

### （三）BFGS方法和DFP方法的性质

#### 1、矩阵$H_k$的存在性与正定性

#### 2、矩阵$H_{k+1}$的正定性

#### 3、Broyden族公式$H^{\varphi}_{k+1}$ 的正定性

## 五、DFP公式的意义

### （一）PSB公式

#### 1、引理一

#### 2、引理二

#### 3、定理

### （二）从PSB公式到DFP公式

## 六、BB方法