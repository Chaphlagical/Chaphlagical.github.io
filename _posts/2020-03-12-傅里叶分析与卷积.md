---
title: 傅里叶分析与卷积
tags: 数字图像处理
article_header:
  type: cover
  image:
    src: /assets/images/DIP.jpg
---

<!--more-->

## 一、傅里叶变换

### (一) 复数的几何意义

#### 1、复数可以用于描述二维复平面上的点集

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312095924095.png" alt="image-20200312095924095" style="zoom:67%;" />

#### 2、复数的幅值和相位

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312095944905.png" alt="image-20200312095944905" style="zoom:67%;" />

#### 3、复数乘法

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312100206816.png" alt="image-20200312100206816" style="zoom:67%;" />

**复数乘法的等效表达：**
$$
(a_1e^{b_1})(a_2e^{b_2})=a_1a_2e^{(b_1+b_2)}
$$

### (二) 欧拉公式和调和函数

#### 1、欧拉公式的定义

$$
e^{i\theta}=\cos\theta+i\sin\theta
$$

**任意一个复数$z$可以写作：**
$$
z=|z|e^{i\phi(z)}
$$

#### 2、欧拉公式的几何意义

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312100505398.png" alt="image-20200312100505398" style="zoom:67%;" />

#### 3、调和函数

$$
f(t)=e^{j2\pi ut}
$$

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312100556147.png" alt="image-20200312100556147" style="zoom:67%;" />

* 模为1
* 将正弦函数和余弦函数同时表示；
* 若这个函数是信号的描述，则u为信号频率；
* 这一函数被称作广义调和函数。

若将调和函数输入一个线性时不变系统，则有：
$$
f(t)=e^{j2\pi ut}\\
f(t)\rightarrow H(u)f(t)
$$
其中，$H(u)$为系统传递函数，满足：
$$
H(u)=|H(u)|e^{j\phi(H(u))}
$$
则有：
$$
\begin{align}
H(u)e^{j2\pi ut}&=|H(u)|e^{i\phi(u)}e^{i2\pi ut}\\
&=|H(u)|e^{i(2\pi ut+\phi(u))}
\end{align}
$$

### (三) 傅里叶变换

#### 1、复杂信号描述为一组正弦信号的叠加

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312101207996.png" alt="image-20200312101207996" style="zoom:67%;" />

#### 2、傅里叶变换的基本原理

假设有一组单位正交基$\{\overline e_k\}$

则属于由单位正交基所构成空间内的向量可以描述为：
$$
\overline{v}=\sum\limits_ka_k\overline{e}_k
$$
其中，权重系数为
$$
a_k=\overline{v}\cdot \overline{e}_k
$$
注意：

* 每个向量可以被转换为一组权重系数
* 向量与权重系数之间的转换是可逆变换

**函数的线性计算**

向量的内积：
$$
\overline{u}\cdot\overline{v}=\sum\limits_j \overline{u}[j]\cdot\overline{v}[j]
$$
函数的内积：
$$
f\cdot g=\int^\infin_{-\infin}f(x)\cdot g(x)dx
$$
向量正交投影变换：
$$
\begin{align}
a_k&=\overline{v}\cdot \overline{e}_k\\
&=\sum\limits_j\overline{v}[j]\cdot e_k[j]
\end{align}
$$
函数正交投影变换：
$$
\begin{align}
a_k&=f\cdot e_k\\
&=\int^\infin_{-\infin}f(t)e_k(t)dt
\end{align}
$$
向量正交投影逆变换：
$$
\overline{v}=\sum\limits_ka_k\cdot \overline{e}_k
$$
函数正交投影逆变换：
$$
f(t)=\sum\limits_ka_k\cdot e_k(t)
$$
**调和函数可以作为输入函数的一组正交基**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312102820220.png" alt="image-20200312102820220" style="zoom:67%;" />

**傅里叶级数**

对于一个有限集合$\{u_k\}$：

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312102911965.png" alt="image-20200312102911965" style="zoom:67%;" />

**傅里叶变换**

（投影与统计）

将$u_k$替换成频率$u$，有

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103003136.png" alt="image-20200312103003136" style="zoom:67%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103031695.png" alt="image-20200312103031695" style="zoom:67%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103049759.png" alt="image-20200312103049759" style="zoom:67%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103059672.png" alt="image-20200312103059672" style="zoom:67%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103113210.png" alt="image-20200312103113210" style="zoom:67%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103131315.png" alt="image-20200312103131315" style="zoom:67%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103146324.png" alt="image-20200312103146324" style="zoom:67%;" />

### (四) 离散傅里叶变换

离散傅里叶变换**，**将时域信号的采样变换为在离散时间傅里叶变换频域的采样**。**即使对有限长的离散信号作DFT，也应当将其看作经过周期延拓成为周期信号再作变换。
$$
\begin{align}
F(u)&=\frac{1}{M}\sum\limits^{M-1}_{x=0}f(x)e^{-i2\pi ux/M}\\
f(x)&=\sum^{M-1}_{u=0}F(u)e^{i2\pi ux/M}
\end{align}
$$
**归一化离散傅里叶变换**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103614024.png" alt="image-20200312103614024" style="zoom:67%;" />

## 二、傅里叶变换性质与信号卷积

#### 1、典型信号的傅里叶变换

**余弦信号**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103801554.png" alt="image-20200312103801554" style="zoom: 50%;" />

**正弦信号**

 <img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103842192.png" alt="image-20200312103842192" style="zoom: 50%;" />

**阶跃信号**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103906498.png" alt="image-20200312103906498" style="zoom: 50%;" />

**冲激信号**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103923968.png" alt="image-20200312103923968" style="zoom: 50%;" />

**门信号**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103941164.png" alt="image-20200312103941164" style="zoom: 50%;" />

**高斯信号**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312103959726.png" alt="image-20200312103959726" style="zoom: 50%;" />

**差分信号**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312104018070.png" alt="image-20200312104018070" style="zoom: 50%;" />

**其他**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312104050811.png" alt="image-20200312104050811" style="zoom: 50%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312104058744.png" alt="image-20200312104058744" style="zoom: 50%;" />

#### 2、傅里叶变换的性质

**线性特性**

若$f_1(t)\leftrightarrow F_1(\Omega)\ \ \ \ f_2(t)\leftrightarrow F_2(\Omega)$ 

则$af_1(t)+bf_1(t)\leftrightarrow aF_1(\Omega)+bF_2(\Omega)$

**时移特性**

若$f(t)\leftrightarrow F(\Omega)$

则$f_1(t)=f(t-t_0)\leftrightarrow F_1(\Omega)=F(\Omega)e^{-j\Omega t_0}$

**尺度变换特性**

若$f(t)\leftrightarrow F(\Omega)$

则$f(at)\leftrightarrow \frac{1}{|a|}F(\frac{\Omega}{a}),a\neq 0$

**帕斯瓦尔定理**
$$
\int^\infin_{-\infin}|f(t)|^2dt=\int^\infin_{-\infin}|F(u)|^2du
$$
**卷积定理**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312105455365.png" alt="image-20200312105455365" style="zoom:50%;" />

#### 3、信号的卷积

**线性系统与响应**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312111329190.png" alt="image-20200312111329190" style="zoom:50%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312111341653.png" alt="image-20200312111341653" style="zoom:50%;" />

#### 4、图像生成机制

定义亮度为控件变量的函数，$f(x,y)$是点$(x,y)$的亮度

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312111444183.png" alt="image-20200312111444183" style="zoom:50%;" />

成像系统会使输入图像退化（质量失真），得到图像为
$$
g(x,y)=D(f(x,y))
$$
$D$为退化函数，一般包括某些随机噪声过程，若退化操作$D$是线性时不变的，则$g$可以写成
$$
g(x,y)=\iint^{+\infin}_{-\infin}f(\alpha,\beta)h(x-\alpha,y-\beta)d\alpha d\beta+n(x,y)
$$
以一维条件下为例（可以推广到二位情况），点$x$处的函数$f$为：
$$
f(x)=\int^\infin_{-\infin}f(x')\delta(x-x')dx'
$$
其中，$\delta(r)$表示增量函数
$$
g(x)=D(f(x))=D(\int^\infin_{-\infin}f(x')\delta(x-x')dx')
$$
若$D$为线性运算，可以变换$D$与积分符号次序
$$
g(x)=D(f(x))=\int^\infin_{-\infin}f(x')D(\delta(x-x'))dx'
$$
引入新的函数$h(x,x')=D(\delta(x-x'))$，假设$D$只与$x-x'$有关，则有
$$
g(x)=\int^\infin_{-\infin}f(x')h(x-x')dx'
$$

#### 5、卷积与相关

**卷积定理**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312112136245.png" alt="image-20200312112136245" style="zoom:50%;" />

**卷积**
$$
f(t)*g(t)=\int^{\infin}_{-\infin}f(\tau)g(t-\tau)d\tau\leftrightarrow F(s)\ G(s)
$$
**相关**
$$
f(t)*g(-t)=\int^\infin_{-\infin}g(\tau)g(t+\tau)d\tau\leftrightarrow F(s)\ G^*(s)
$$
相关的作用是判断两个信号的相似程度，不仅是波形上的，也包括起始位置

**自相关**

自相关是指与信号自身进行相关计算
$$
f(t)*f(-t)
$$
其作用是判断信号是否周期性信号

实际应用中用来表示局部范围内有效信号和噪声的权重比

## 三、图像傅里叶变换

### (一) 二维连续傅里叶变换

可以分解为水平和垂直方向上的一维连续傅里叶变换
$$
\begin{align}
b(u,v)&=e^{i2\pi ux}e^{i2\pi vy}\\
&=e^{i2\pi(ux+vy)}
\end{align}
$$
<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312112744192.png" alt="image-20200312112744192" style="zoom:50%;" />


$$
v=\omega \sin\theta,u=\omega \cos\theta,\omega=\sqrt{v^2+u^2},\theta=\tan^{-1}(\frac{v}{u})
$$
<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312112930716.png" alt="image-20200312112930716" style="zoom:50%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312112954178.png" alt="image-20200312112954178" style="zoom:50%;" />

### (二) 二维离散(图像)傅里叶变换

对于一副$M*N$的图像，可以描述为：
$$
\begin{align}
f_{u,v}[x,y]&=e^{i2\pi ux/M}e^{i2\pi vy/N}\\
&=e^{i2\pi(ux/M+vy/N)}
\end{align}
$$
其傅里叶变换及其逆变换为：
$$
\begin{align}
F[u,v]=\frac{1}{MN}\sum\limits^{M-1}_{x=0}\sum\limits^{N-1}_{y=0}f[x,y]e^{-i2\pi(ux/M+vy/N)}\\
f[x,y]=\sum\limits^{M-1}_{x=0}\sum\limits^{N-1}_{y=0}F[u,v]e^{i2\pi(ux/M+vy/N)}
\end{align}
$$

#### 例子

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312113616106.png" alt="image-20200312113616106" style="zoom:50%;" />

**门信号**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312113637695.png" alt="image-20200312113637695" style="zoom:50%;" />

**图像**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312113649775.png" alt="image-20200312113649775" style="zoom:50%;" />

**图像(实部和虚部)**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312113702673.png" alt="image-20200312113702673" style="zoom:50%;" />

**图像(功率和相位)**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312113756597.png" alt="image-20200312113756597" style="zoom:50%;" />

#### 中心化

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312113829651.png" alt="image-20200312113829651" style="zoom:50%;" />

为了便于分析和描述，需要对频谱进行中心化

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312113847456.png" alt="image-20200312113847456" style="zoom:50%;" />

用$(-1)^{x+y}$乘以输入图像来进行中心变换

### (三) 图像与傅里叶频谱之间的关系

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312113943335.png" alt="image-20200312113943335" style="zoom:50%;" />

**脉冲(点)的频谱**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312114001769.png" alt="image-20200312114001769" style="zoom:50%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312114112405.png" alt="image-20200312114112405" style="zoom:50%;" />

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312114125265.png" alt="image-20200312114125265" style="zoom:50%;" />

**边缘的频谱**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312114143946.png" alt="image-20200312114143946" style="zoom:50%;" />

**线的频谱**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312114200352.png" alt="image-20200312114200352" style="zoom:50%;" />

**相位谱的作用**

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312114227921.png" alt="image-20200312114227921" style="zoom:50%;" />

仅使用功率谱的重建结果：

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312114250423.png" alt="image-20200312114250423" style="zoom:50%;" />

仅使用相位谱重建的结果

<img src="/assets/images/傅里叶分析与卷积.assets/image-20200312114315359.png" alt="image-20200312114315359" style="zoom:50%;" />