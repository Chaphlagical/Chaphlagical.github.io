---
title: 采样与网格剖分
tags: 计算机图形学
article_header:
  type: cover
  image:
    src: /assets/images/cg.jpg
---

<!--more-->

## 采样

### 从连续到离散

* 对象的表达
	* 在数学上，连续表达与计算
	* 在计算机中，离散表达与计算

* 数值方法：数值微分、数值积分、数值优化
	* 数值分析：离散计算对精确计算的近似程度
	* Fourier分析/变换：离散Fourier分析/变换
	* 卷积（滤波）

* 在计算机科学（计算机图形学）中，采样无处不在
	* 计算机只能表达离散的数值
	* 例子：int型的数据（量化）

**图像：区域的采样**

<img src="/assets/images/采样与网格剖分.assets/image-20200414000120477.png" alt="image-20200414000120477" style="zoom:50%;" />

**视频：时间的采样**

<img src="/assets/images/采样与网格剖分.assets/image-20200414000136279.png" alt="image-20200414000136279" style="zoom:50%;" />

**曲线的采样**

<img src="/assets/images/采样与网格剖分.assets/image-20200414000148975.png" alt="image-20200414000148975" style="zoom:50%;" />

**曲面的采样**

<img src="/assets/images/采样与网格剖分.assets/image-20200414000202097.png" alt="image-20200414000202097" style="zoom:50%;" />

### 采样与重建

<img src="/assets/images/采样与网格剖分.assets/image-20200414000223322.png" alt="image-20200414000223322" style="zoom:50%;" />

### Sampling Theorem

**Nyquist–Shannon sampling theorem**

If a function $x(t)$ contains no frequencies higher than $B$ hertz, it is completely determined by giving its ordinates at a series of points spaced $1/(2B) $ seconds apart

**采样与信号频率**

<img src="/assets/images/采样与网格剖分.assets/image-20200414000340163.png" alt="image-20200414000340163" style="zoom:50%;" />

**欠采样产生频率的走样**

* 高频函数拟合低频信号：过拟合
* 低频函数拟合高频信号：欠拟合

<img src="/assets/images/采样与网格剖分.assets/image-20200414000415427.png" alt="image-20200414000415427" style="zoom:50%;" />

### Stippling

<img src="/assets/images/采样与网格剖分.assets/image-20200414000502783.png" alt="image-20200414000502783" style="zoom:50%;" />

<img src="/assets/images/采样与网格剖分.assets/image-20200414000521488.png" alt="image-20200414000521488" style="zoom:50%;" />

### Half-tone(dithering)

<img src="/assets/images/采样与网格剖分.assets/image-20200414000754283.png" alt="image-20200414000754283" style="zoom:50%;" />

<img src="/assets/images/采样与网格剖分.assets/image-20200414000802053.png" alt="image-20200414000802053" style="zoom:50%;" />

### 1D曲线的采样：分段线性逼近表达

<img src="/assets/images/采样与网格剖分.assets/image-20200414000830189.png" alt="image-20200414000830189" style="zoom:50%;" />

### 2D曲面的采样：分片线性逼近表达

<img src="/assets/images/采样与网格剖分.assets/image-20200414000855406.png" alt="image-20200414000855406" style="zoom:50%;" />

### 平面规则区域的采样

将一个区域分解为若干个小区域

<img src="/assets/images/采样与网格剖分.assets/image-20200414000939127.png" alt="image-20200414000939127" style="zoom:50%;" />

### 平面区域的不规则采样

<img src="/assets/images/采样与网格剖分.assets/image-20200414001001641.png" alt="image-20200414001001641" style="zoom:50%;" />

将一个区域分解为若干个小区域

<img src="/assets/images/采样与网格剖分.assets/image-20200414001022814.png" alt="image-20200414001022814" style="zoom:50%;" />

### Triangulation

复杂函数的分片线性逼近 (piece-wise linear approximation)

<img src="/assets/images/采样与网格剖分.assets/image-20200414001135433.png" alt="image-20200414001135433" style="zoom:50%;" />

### Blue Noise Sampling

* (Left) A uniformly distributed yet randomly located point set
* (Right) The typical power spectrum, radially averaged power spectrum and anisotropy of blue noise distributions.

<img src="/assets/images/采样与网格剖分.assets/image-20200414001213856.png" alt="image-20200414001213856" style="zoom: 67%;" />

## 三角网格

### Mesh Quality

* What do we mean a “good” mesh/simplex (triangle)? 
	* Minimal angle
	* Mean ratio
	* Aspect/radius ratio
	* …

### 2D Delaunay Triangulation

<img src="/assets/images/采样与网格剖分.assets/image-20200414001349046.png" alt="image-20200414001349046" style="zoom:50%;" />

<img src="/assets/images/采样与网格剖分.assets/image-20200414001406227.png" alt="image-20200414001406227" style="zoom:50%;" />



#### Properties of DT

1. Empty sphere property: no points inside the circum-sphere of any simplex

	* Delaunay edge

		<img src="/assets/images/采样与网格剖分.assets/image-20200414001531480.png" alt="image-20200414001531480" style="zoom:50%;" />

2. DT maximizes the smallest angle

	<img src="/assets/images/采样与网格剖分.assets/image-20200414001606217.png" alt="image-20200414001606217" style="zoom:50%;" />

3. Convex hull: union of all triangles

	<img src="/assets/images/采样与网格剖分.assets/image-20200414001630991.png" alt="image-20200414001630991" style="zoom:50%;" />

4. DT maximizes the arithmetic mean of the radius of inscribed circles of the triangles. 

	DT minimizes roughness (the Dirichlet energy of any piecewise-linear scalar function)

	DT minimizes the maximum containing radius (the radius of the smallest sphere containing the simplex)

5. The DT in d-dimensional spaces is the projection of the points of convex hull onto a (d+1)-dimensional paraboloid.

	<img src="/assets/images/采样与网格剖分.assets/image-20200414001732314.png" alt="image-20200414001732314" style="zoom:50%;" />

<img src="/assets/images/采样与网格剖分.assets/image-20200414001746435.png" alt="image-20200414001746435" style="zoom:50%;" />

6. DT minimizes the spectrum of the geometric Laplacian (spectral characterization)

### Edge Swapping/Flipping 

* Start with any triangulation

	1. find any two adjacent triangles that form a convex quadrilateral that does not satisfy empty sphere condition

	2. swap the diagonal of the quadrilateral to be a Deluany triangulation of that four points

	3. repeat step 1,2 until stuck.

### Algorithms for Voronoi Diagrams

* Compute the intersection of n-1 half-planes for each site, and “merge” the cells into the diagram
* Divide-and-conquer (1975, Shamos & Hoey)
* Plane sweep (1987, Fortune)
* Randomized incremental construction (1992, Guibas, Knuth& Sharir)

## Mesh Generation

Given a fixed point set, Delaunay triangulation will try to make the triangulation more shape regular and thus is considered as a “good” unstructured mesh.

### DT is not necessary a good mesh

<img src="/assets/images/采样与网格剖分.assets/image-20200414134338717.png" alt="image-20200414134338717" style="zoom:50%;" />

DT only optimize the connectivity when points are fixed. The distribution of points is more important for a good mesh.

### Centroidal Voronoi Tessellation

Definition: The VT is a centroidal Voronoi tessellation (CVT) , if each seed coincides with the centroid of its Voronoi cell

<img src="/assets/images/采样与网格剖分.assets/image-20200414134613220.png" alt="image-20200414134613220" style="zoom:50%;" />

<img src="/assets/images/采样与网格剖分.assets/image-20200414134640542.png" alt="image-20200414134640542" style="zoom:50%;" />

* CVT energy function

$$
F(X)=\sum\limits_{i=1}^N\int_{V_i}\rho(\boldsymbol x)\|\boldsymbol x-\boldsymbol x_i\|^2d\boldsymbol x
$$

* CVT is a critical point of $F(X)$, an optimal CVT is a global minimizer of  $F(X)$

### Lloyd Algorithm

* Construct the VT associated with the points
* Compute the centroids of the Voronoi regions
* Move the points to the centroids
* Iterate until convergent

<img src="/assets/images/采样与网格剖分.assets/image-20200414134732280.png" alt="image-20200414134732280" style="zoom:50%;" />

### CVT Energy Function

* Geometric interpretation

	* –The CVT energy with $\rho(\boldsymbol x)$ identical to 1, is the volume difference between the circumscribed polytope and the paraboloid.

	<img src="/assets/images/采样与网格剖分.assets/image-20200414135408379.png" alt="image-20200414135408379" style="zoom:50%;" />

### The Gradient of CVT Energy

$$
\frac{\partial F}{\partial \boldsymbol x_i}=2m_i(\boldsymbol x_i-\boldsymbol c_i)
$$

where
$$
m_i=\int_{\boldsymbol x\in \Omega_i}\rho(\boldsymbol x)d\sigma
$$
Lloyd’s method is a gradient descent method, thus has linear convergence

### Smoothness of $F(\boldsymbol X)$

Can BFGS method be applied to computing CVT? Or does CVT energy $F(\boldsymbol X)$ have required C2  smoothness?

Results:

* It has been noted that $F(\boldsymbol X)$ is non-smooth [Iri et al. 1984], but without proof
* It has been proved that $F(\boldsymbol X)$ is C1 [Cortes et al. 2005]
* $F(\boldsymbol X)$ is C2 in a convex domain in 2D and 3D [Liu et al. 2009]

### $C^2$ Continuity of $F(\boldsymbol X)$ — Illustration

<img src="/assets/images/采样与网格剖分.assets/image-20200414140217740.png" alt="image-20200414140217740" style="zoom:50%;" />

### CVT on Surface

<img src="/assets/images/采样与网格剖分.assets/image-20200414140236719.png" alt="image-20200414140236719" style="zoom:50%;" />

### CVT for Remeshing

<img src="/assets/images/采样与网格剖分.assets/image-20200414140254284.png" alt="image-20200414140254284" style="zoom:50%;" />

### Optimal Delaunay Triangulation

* ODT energy function
	$$
	\begin{align}
	E(X)&=\|f-f_{I,\Tau}\|_{L^1(\Omega)}\\
	&=\sum\limits_{\tau\in \Tau}\int_{\tau}f_I(\boldsymbol x)d\boldsymbol x-\int_\Omega f(\boldsymbol x)d\boldsymbol x
	\end{align}
	$$
	<img src="/assets/images/采样与网格剖分.assets/image-20200414140543170.png" alt="image-20200414140543170" style="zoom:50%;" />

### CVT & ODT Energy

* CVT energy
	$$
	F(X)=\sum\limits_{i=1}^N\int_{V_i}\|\boldsymbol x-\boldsymbol x_i\|^2d\boldsymbol x
	$$

* ODT energy
	$$
	E(X)=\sum\limits_{\tau\in \Tau}\int_\tau f_I(\boldsymbol x)d\boldsymbol x-\int_\Omega f(\boldsymbol x)d\boldsymbol x
	$$
	<img src="/assets/images/采样与网格剖分.assets/image-20200414140730699.png" alt="image-20200414140730699" style="zoom:50%;" />

### Compare ODT and CVT

<img src="/assets/images/采样与网格剖分.assets/image-20200414140754969.png" alt="image-20200414140754969" style="zoom:50%;" />

### Triangle Library

[http://www.cs.cmu.edu/~quake/triangle.html](http://www.cs.cmu.edu/~quake/triangle.html)

<img src="/assets/images/采样与网格剖分.assets/image-20200414141122075.png" alt="image-20200414141122075" style="zoom:50%;" />

## 高维对象的采样与网格剖分

### 二维流形曲面的采样与网格化

![image-20200414140841948](/assets/images/采样与网格剖分.assets/image-20200414140841948.png)

### 二维流形曲面的四边形网格化

![image-20200414140901169](/assets/images/采样与网格剖分.assets/image-20200414140901169.png)

### 空间体的采样与剖分

* Interior of 3D shapes
	* FEM
	* Simulation
	* …
* Two typical types
	* Tetrahedral meshes
	* Hexahedral meshes

<img src="/assets/images/采样与网格剖分.assets/image-20200414140947363.png" alt="image-20200414140947363" style="zoom:50%;" />

### 空间体的四面体网络

<img src="/assets/images/采样与网格剖分.assets/image-20200414141010065.png" alt="image-20200414141010065" style="zoom:50%;" />

### TETGEN (Tetrahedron Generation)

[https://people.sc.fsu.edu/~jburkardt/examples/tetgen/tetgen.html](https://people.sc.fsu.edu/~jburkardt/examples/tetgen/tetgen.html)