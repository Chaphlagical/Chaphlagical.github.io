---
title: 离散微分几何
tags: 计算机图形学
article_header:
  type: cover
  image:
    src: /assets/images/cg.jpg
---

<!--more-->

## Curves

### Differential Geometry of a Curve

<img src="/assets/images/离散微分几何.assets/image-20200414225335307.png" alt="image-20200414225335307" style="zoom:50%;" />

* Point p on the curve at $u_0$
	$$
	p=C(u_0)
	$$

* Tangent T to the curve at $u_0$
	$$
	C_u=\frac{\partial C(u)}{\partial u}\\T=\frac{C_u}{\|C_u\|}
	$$

* Normal N and Binormal B to the curve at $u_0 $
	$$
	\begin{align}
	C_{uu}&=\frac{\partial^2 C(u)}{\partial u^2}\\
	B&=\frac{C_u\times C_{uu}}{\|C_u\times C_{uu}\|}\\
	N&=\frac{C_{uu}-(T\cdot C_{uu})T}{\|C_{uu}-(T\cdot C_{uu})T\|}\\
	&=B\times T\\
	&=\frac{(C_u\times C_{uu})\times C_u}{\|C_u\times C_{uu}\|\|C_u\|}
	\end{align}
	$$

* Curvature $κ$ at $u_0$ and the radius $ρ$ osculating circle 

* Curvature at $u_0$ is the component of $-N_T$ along $T$ 

<img src="/assets/images/离散微分几何.assets/image-20200414230035392.png" alt="image-20200414230035392" style="zoom:50%;" />

### Tangent vector to curve

$$
T=C'(t)=\frac{dC(t)}{dt}=[x'(t),y'(t)]
$$

### Unit length tangent vector

$$
\vec{T}=\vec{C}(t)=\frac{[x'(t),y'(t)]}{\sqrt{x'(t)^2+y'(t)^2}}
$$

### Curvature

$$
k(t)=\frac{x'(t)y''(t)-y'(t)x''(t)}{(x'(t)^2+y'(t)^2)^{3/2}}
$$

<img src="/assets/images/离散微分几何.assets/image-20200414230604436.png" alt="image-20200414230604436" style="zoom:50%;" />

## Surfaces

<img src="/assets/images/离散微分几何.assets/image-20200414230636782.png" alt="image-20200414230636782" style="zoom:50%;" />

* Point $p$ on the surface at $(u_0,v_0) $

* Tangent $S_u$ in the $u$ direction 
	$$
	S_u=\frac{\partial S(u,v)}{\partial u}
	$$

* Tangent $S_v$ in the $v$ direction 
	$$
	S_v=\frac{\partial S(u,v)}{\partial v}
	$$
	
* Plane of tangents $T$
	$$
	T=uS_u+vS_v
	$$

<img src="/assets/images/离散微分几何.assets/image-20200414230917542.png" alt="image-20200414230917542" style="zoom:50%;" />

### Surface Curvature

<img src="/assets/images/离散微分几何.assets/image-20200414230950106.png" alt="image-20200414230950106" style="zoom:50%;" />![image-20200414230956117](/assets/images/离散微分几何.assets/image-20200414230956117.png)

![image-20200414230956117](/assets/images/离散微分几何.assets/image-20200414230956117.png)

<img src="/assets/images/离散微分几何.assets/image-20200414231035607.png" alt="image-20200414231035607" style="zoom:50%;" />

## Discrete Differential Geometry on Meshes

### mesh are only $C^0$

* Meshes are piecewise linear surfaces
	* Infinitely continuous on triangles
	* $C^0$ at edges and vertices

### Apply the traditional differential geometry on discrete mesh surfaces

* Normal estimation
* Curvature estimation
* Principal curvature directions

### Estimation of Differential Measures

* Approximate the (unknown) underlying surface

	* Continuous approximation

	* Discrete approximation

### Continuous Approximation

* Approximate surface by quadric

* At each mesh vertex (use surrounding triangles)

	* Compute normal at vertex
		* Typically average face normals
	* Compute tangent plane & local coordinate system
		* (node=(0, 0, 0))
	* For each neighbor vertex compute location in local system
		* relative to node and tangent plane

* Find quadric function approximating vertices
	$$
	F(x,y,z)=ax^2+bxy+cy^2-z=0
	$$

* To find coefficients use least squares fit
	$$
	\min \sum\limits_i (ax_i^2+bx_iy_i+cy_i^2-z_i)
	$$

	$$
	\begin{bmatrix}x_1^2&x_1y_1&y_1^2\\
	\cdots&\cdots&\cdots\\
	x_n^2&x_ny_n&y_n^2
	\end{bmatrix}\begin{bmatrix}a\\b\\c\end{bmatrix}=\begin{bmatrix}z_1\\\vdots\\z_n\end{bmatrix}\\
	A=\begin{bmatrix}x_1^2&x_1y_1&y_1^2\\
	\cdots&\cdots&\cdots\\
	x_n^2&x_ny_n&y_n^2
	\end{bmatrix},
	X=\begin{bmatrix}a\\b\\c\end{bmatrix},
	b=\begin{bmatrix}z_1\\\vdots\\z_n\end{bmatrix}\\
	$$

	Approximation can be found by: $\hat X=(A^TA)^{-1}A^Tb$

* Given surface $F$ its principal curvatures $k_{\min}$ and $k_{max}$ are real roots of:
	$$
	k^2-(a+c)k+ac-b^2=0
	$$

* Mean curvature:
	$$
	H=(k_{\min}+k_{\max})/2
	$$

* Gaussian curvature:
	$$
	K=k_\min k_\max
	$$
	

### Discrete Approximation

#### Normal Estimation

* Normal estimation on vertices
	* Defined for each face
	* Average face normals
* Weighted: face areas, angles at vertex

#### Mean Curvature

<img src="/assets/images/离散微分几何.assets/image-20200414233046265.png" alt="image-20200414233046265" style="zoom:50%;" />

* Integral of curvature on circular arc

	* $\beta$— central angle
		$$
		\int k=\frac{1}{R}arclength=\frac{1}{R}\frac{\beta}{2\pi}2\pi R=\beta
		$$

* On cylindrical parts $H=k_\max/2 (k_\min=0)$

* On planar faces $H=0$

* For entire vertex region
	$$
	\int H=\sum\limits_i \beta_i/2 \|e_i\|/2=\frac{1}{4}\sum\limits_i \beta_i\|e_i\|
	$$
	
* Mean curvature at vertex ($A_i$ triangle area)
	$$
	H=\frac{3}{4\sum A_i}\sum\limits_i \beta_i\|e_i\|
	$$
	
* Use Gauss-Bonnet Theorem
	$$
	\int_T K=2\pi-\sum\limits_i \alpha_i-\int_{\partial T}k_{\partial T}=2\pi-\sum\limits_i\alpha_i
	$$

* Curvature at vertex
	$$
	K=\frac{3(2\pi-\sum\limits_i\alpha_i)}{\sum\limits_i A}
	$$

### Application

* Feature detection
* Shape recognition
* Mesh segmentation
* Any feature-aware applications
	* Preserving salient features in processing