---
title: 高阶PDE插值/拟合
tags: 计算机图形学
article_header:
  type: cover
  image:
    src: /assets/images/cg.jpg
---

<!--more-->

## Background

* Partial Differential Equations (PDE)

$$
E(f,f_x,f_y,f_{xx},f_{xy},f_{yy})=0
$$

* The PDE's which occur in physics are mostly second order and linear:
	$$
	A\cdot f_{xx}+2B\cdot f_{xy}+D\cdot f_x+E\cdot f_y+F\cdot f+G=0
	$$

	* $A\cdot C<B^2$: Hyberbolic

		* wave equation:
			$$
			\Delta f=\frac{1}{\upsilon^2} \frac{\partial^2f}{\partial t^2}
			$$

	* $A\cdot C=B^2$: Parobolic

		* heat equation:
			$$
			\frac{\partial f}{\partial t}=k\cdot \Delta f
			$$

	* $A\cdot C>B^2$: Elliptic

		* Laplace equation:
			$$
			\Delta f=0
			$$

		* Poisson equation:
			$$
			\Delta f=-\rho
			$$
			

## Poisson Equation

$$
\Delta f=-\rho\\
\Delta \equiv \frac{\partial^2}{\partial x^2}+\frac{\partial^2}{\partial y^2}\\
\rho=\rho(x,y)
$$

## Boundary conditions

* Dirichlet boundary conditions:
	$$
	f|_{\partial \Omega}
	$$

* Neumann boundary conditions:
	$$
	\frac{\partial f}{\partial \boldsymbol{s}}|_{\partial\Omega}
	$$

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229092107196.png" alt="image-20200229092107196" style="zoom:67%;" />

## Existence of solution

The solution of an Poisson Equation is uniquely determined in $\Omega$, if *Dirichlet* boundary conditions or *Neumann* boundary conditions are specified on $\partial \Omega$

## Discrete Poisson Equation

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229092239536.png" alt="image-20200229092239536" style="zoom:67%;" />
$$
\Delta f=-\rho
$$

$$
\frac{f_{i+1,j}+f_{i-1,j}-2f_{i,j}}{h^2}+\frac{f_{i,j+1}+f_{i,j-1}-2f_{i,j}}{h^2}=\rho_{i,j}
$$

## Matrix Nature of Poisson Equation

* Sparse linear system

$$
\begin{bmatrix}
-4&1\\
1&-4&1\\
&1&-4&1\\
&&1&-4&1\\
&&&1&-4&1\\
&&&&1&-4&1\\
&&&&&1&-4&1\\
&&&&&&1&-4&1\\
&&&&&&&1&-4&1
\end{bmatrix}
\begin{bmatrix}
f_{11}\\f_{21}\\f_{31}\\f_{12}\\f_{22}\\f_{32}\\f_{13}\\f_{23}\\f_{33}
\end{bmatrix}
=
\begin{bmatrix}
b_{11}\\b_{21}\\b_{31}\\b_{12}\\b_{22}\\b_{32}\\b_{13}\\b_{23}\\b_{33}
\end{bmatrix}
$$

## Poisson Equation Solver

* Direct method
* Iterative methods
	* Jacobi, Gauss-Seidel, SOR
* Multigrid method

## Variational interpretation

$$
f^*=\arg\min_f\iint_{\Omega}\|\nabla f-\boldsymbol v\|^2\ \ s.t.\ f^*|_{\partial \Omega}=f|_{\partial \Omega}
$$

Using Euler Equation:
$$
F_f-\frac{\partial}{\partial x}F_{f_x}-\frac{\partial}{\partial y}F_{f_y}=0
$$
We have:
$$
\Delta f=\mathrm{div}(\boldsymbol v)\ \ s.t.\ f^*|_{\partial \Omega}=f|_{\partial \Omega}
$$
$\boldsymbol v$ is a guidance field, needs not to be a gradient field

## Physical Origins of Poisson Equation

* Electrostatic potential
	$$
	\Delta \Phi=-\frac{\rho(\boldsymbol x)}{\varepsilon_0}
	$$

* Gravitational potential
	$$
	\Delta \Phi=-4\pi G\rho(\boldsymbol x)
	$$

### Electrostatic potential

$$
\boldsymbol F=\frac{q_1q_2\boldsymbol r}{4\pi\varepsilon_0 r^3}
$$

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229094102665.png" alt="image-20200229094102665" style="zoom:50%;" />

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229094153936.png" alt="image-20200229094153936" style="zoom: 50%;" />

**Relationships: **

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229094243481.png" alt="image-20200229094243481" style="zoom:50%;" />

###  Gravitational potential

$$
\boldsymbol F=\frac{mMG\boldsymbol r}{r^3}
$$

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229094646662.png" alt="image-20200229094646662" style="zoom: 50%;" />

**Relationship:**

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229094722829.png" alt="image-20200229094722829" style="zoom:50%;" />

### Analogy for Image 

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229094751116.png" alt="image-20200229094751116" style="zoom:50%;" />

**Relationship:**

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229094809868.png" alt="image-20200229094809868" style="zoom:50%;" />

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229094840423.png" alt="image-20200229094840423" style="zoom:50%;" />

## Poisson Image Editing

### Seamless Cloning

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095016380.png" alt="image-20200229095016380" style="zoom:50%;" />

### Cloning by solving Poisson Equation

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095050292.png" alt="image-20200229095050292" style="zoom:50%;" />

### Application

#### compose

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095148671.png" alt="image-20200229095148671" style="zoom:50%;" />

#### change features

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095208749.png" alt="image-20200229095208749" style="zoom:50%;" />

#### change texture

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095228480.png" alt="image-20200229095228480" style="zoom:50%;" />

#### conceal

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095249553.png" alt="image-20200229095249553" style="zoom:50%;" />

#### mix lights

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095305946.png" alt="image-20200229095305946" style="zoom:50%;" />

#### change colors

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095353242.png" alt="image-20200229095353242" style="zoom:50%;" />

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095343089.png" alt="image-20200229095343089" style="zoom:50%;" />

#### seamless Tiling

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095419312.png" alt="image-20200229095419312" style="zoom:50%;" />

#### Image Stitching

<img src="/assets/images/高阶PDE插值拟合.assets/image-20200229095449289.png" alt="image-20200229095449289" style="zoom:50%;" />

## Demo

[Demo](https://chaphlagical.github.io/external/CG_Demo/Poisson.html)