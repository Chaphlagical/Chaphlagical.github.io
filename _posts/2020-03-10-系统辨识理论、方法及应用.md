---
title: 系统辨识理论、方法及应用
tags: 系统辨识
article_header:
  type: cover
  image:
    src: /assets/images/SI.jpg
---

<!--more-->

## 一、系统辨识的基本原理

### (一) 系统辨识的三大要素

* 输入、输出数据$(u,y,y_g)$
* 模型类$(G_g)$
* 等价准则$(J(y,y_g))$

数据是辨识的基础，准则是辨识的优化目标，模型类是寻找模型的范围

### (二) 等价准则

在SI中，有一个很重要的概念，就是等价准则，它是用来衡量模型接近实际过程的标准。而通常被辨识对
象和模型的等价性是通过引入评价函数来定义的，这个评价函数称为等价准则函数  

对于相同的输入$u$，若实际系统的输出为$y$，模型$G_g$的输出为$y_g$，而被辨识对象和模型输出这两个输出量之
间的偏离值（误差）$e=y-y_g$，采用的准则函数如下：

* 连续信号下，准则函数为
	$$
	J(y,y_g)=\int^t_{t-T}[y(t)-y_g(t)]^2dt=\int^t_{t-T}e^2(t)dt
	$$

* 离散信号下，准则函数为
	$$
	J(y,y_g)=\sum\limits^N_{k}|y-y_g|^2=\|e\|^2
	$$

在给定的模型类中，当$G_g$使准则函数最小时，定义$G_g$与对象等价。因此，辨识就是求使准则函数最小的模
型$G_g$的优化问题  

准则函数通常表示成误差$e$的函数，写作$J(y,y_g)=f(e)$，而在具体表达中，平方误差准$f(e)=e^2$则用得最多，而根据误差的定义形式，又可分为输出误差、输入误差和广义误差形式  

#### 误差的形式

##### (1) 从输出端定义

系统输出量的希望值与实际值之差，但在实际中此差值信号常常无法测量，一般只有数学意义，输出误差定义为：
$$
e=y-y_g
$$
输出误差通常是参数的非线性函数，这种参数辨识是一种复杂的非线性最优化问题，当误差和参数的关系
是一次函数时，称模型是关于参数线性的

参数线性模型按照最小均方误差准则，采用最小二乘（LS，Least Square），可实现对参数辨识

辨识技术为非参数模型转化为参数模型提供了手段  

##### (2) 从输入端定义

系统的输入信号与主反馈信号之差。此信号在实际中可测量，所以具有一定的物理意义  ，输入误差定义为：
$$
e(t)=u(t)-u'(t)=u(t)-(G^{-1}_g y)(t)
$$
其中，$G_g^{-1}$为模型$G_g$的逆系统，其关系如图

<img src="/assets/images/系统辨识理论、方法及应用.assets/image-20200229161221554.png" alt="image-20200229161221554" style="zoom:50%;" />

##### (3) 广义误差

将输入、输出误差组合而成，定义为
$$
e(t)=(G_2^{-1}y)(t)-(G_1u)(t)
$$
其中，$G_1$和$G_2^{-1}$称为广义模型

<img src="/assets/images/系统辨识理论、方法及应用.assets/image-20200229161403063.png" alt="image-20200229161403063" style="zoom:50%;" />

## 二、系统描述的数学模型

### (一) 数学模型的分类

* 按施加信息的特征，分为连续型和离散型
* 按系统分析定义，分为时间域和频率域；
* 动态系统按描述模型方式，划分为参数型和非参数型
	* 参数型用模型的系数来描述系统，如微分方程和传递函数中的$a_i$、$b_i$系数，状态空间方程中的系数矩阵$A$，$B$
	* 非参数指模型用响应曲线来描述，如时域中的脉冲响应模型、频域中的频率响应模型  

### (二) 参数模型类

#### 1、连续系统的参数模型

一个线性连续动态系统可以分别用时域的微分方程和频域的传递函数来表示。连续时间、线性、定常
系统，其动态特性可以用$n$阶微分方程来表示：
$$
a_n\frac{\mathrm d^n c(t)}{\mathrm dt^n}+a_{n-1}\frac{\mathrm d^{n-1} c(t)}{\mathrm dt^{n-1}}+\cdots+a_1\frac{\mathrm d c(t)}{\mathrm dt}+a_0c(t)\\=b_m\frac{\mathrm d^m r(t)}{\mathrm dt^m}+b_{m-1}\frac{\mathrm d^{m-1} r(t)}{\mathrm dt^{m-1}}+\cdots+b_1\frac{\mathrm d r(t)}{\mathrm dt}+b_0r(t)
$$
微分系数$a_i(i=1,2,\cdots,n)$和$b_j(j=1,2,\cdots,m)$与系统阶次$n$和$m$，决定了系统的动态特性，是系统需要辨识的参数，对方程进行拉氏变换，假定初始条件为零，写成复数域形式：
$$
a_ns^nC(s)+a_{n-1}s^{n-1}C(s)+\cdots+a_1sC(s)+a_0C(s)\\
=b_ms^mR(s)+b_{m-1}s^{m-1}R(s)+\cdots+b_1sR(s)+b_0R(s)
$$
定义传递函数为输出的拉式变换与输入的拉式变换之比：
$$
G(s)=\frac{C(s)}{R(s)}=\frac{b_ms^m+b_{m-1}s^{m-1}+\cdots+b_1s+b_0}{a_ns^n+a_{n-1}s^{n-1}+\cdots+a_1s+a_0}
$$
对于MIMO系统，考察$m$输入和$r$输出系统：

<img src="/assets/images/系统辨识理论、方法及应用.assets/image-20200229162634858.png" alt="image-20200229162634858" style="zoom:50%;" />

记$U(s)=[U_1(s),U_2(s),\cdots,U_m(s)]^T$，$Y(s)=[Y_1(s),Y_2(s),\cdots,Y_r(s)]^T$，则传递函数为
$$
G(s)=\frac{Y(s)}{U(s)}
$$
展开形式为
$$
\begin{bmatrix}
Y_1(s) \\ Y_2(s) \\ \vdots \\ Y_r(s)
\end{bmatrix}
=
\begin{bmatrix}
G_{11}(s) & G_{12}(s) & \cdots & G_{1m}(s)\\
G_{21}(s) & G_{22}(s) & \cdots & G_{2m}(s)\\
\vdots&\vdots&& \vdots\\
G_{r1}(s) & G_{r2}(s) & \cdots & G_{rm}(s)\\
\end{bmatrix}
\begin{bmatrix}
U_1(s)\\ U_2(s)\\ \vdots \\ U_m(s)
\end{bmatrix}
$$
MIMO系统可用状态空间描述，表示为
$$
\begin{cases}
\dot{\boldsymbol X}(t)=\boldsymbol A(t)\boldsymbol X(t)+\boldsymbol B(t)\boldsymbol U(t)\\
\boldsymbol Y(t)=\boldsymbol C(t)\boldsymbol X(t)+\boldsymbol D(t)\boldsymbol U(t)
\end{cases}
$$
$\boldsymbol X(t)$为$n$维状态向量；$\boldsymbol U(t)$为$m$维输入向量；$\boldsymbol Y(t)$为$r$维输出向量； $\boldsymbol A(t)$为$n×n$阶系数矩阵；

$\boldsymbol B(t)$为$n×m$阶控制矩阵； $\boldsymbol C( t)$为$r×n$阶输出矩阵；$\boldsymbol D(t) $为$r×m$阶前馈矩阵  

#### 2、离散系统的参数模型

若系统描述为一个或者多个变量仅在离散的瞬间改变它们的值，称之为离散时间系统。与连续系统对
应，一个线性离散的动态系统可以用时域的差分方程和频域的$Z$变换传递函数来表示。
在单变量及不考虑系统干扰的情况下，其离散输入量$u(k)$及输出量$y(k)$之间的关系表示为如下差分方程形式：
$$
y(k)+a_1y(k-1)+\cdots+a_{n_a}y(k-n_a)\\
=b_0u(k)+b_1u(k-1)+\cdots+a_{n_b}u(k-n_b)\\
n_a\geq n_b
$$
引入后移算子$q^{-1}$，并定义
$$
q^{-1}y(k)=y(k-1)
$$
用多项式表示
$$
\begin{cases}
A(q^{-1})=1+a_1q^{-1}+a_2q^{-2}+\cdots+a_{n_a}q^{-n_a}\\
B(q^{-1})=b_0+b_1q^{-1}+b_2q^{-2}+\cdots+b_{n_b}q^{-n_b}
\end{cases}
$$
原差分方程表示为
$$
A(q^{-1})y(k)=B(q^{-1})u(k)
$$
对原差分方程做$Z$变换，设初始条件为零，则有
$$
(1+a_1z^{-1}+a_2z^{-2}+\cdots+a_{n_a}z^{-n_a})Y(z) \\
=(b_0+b_1z^{-1}+b_2z^{-2}+\cdots+b_{n_b}z^{-n_b})U(z),\ \ n_a\geq n_b
$$
定义传递函数：
$$
H(z)=\frac{Y(z)}{U(z)}=\frac{b_0+b_1z^{-1}+b_2z^{-2}+\cdots+b_{n_b}z^{-n_b}}{1+a_1z^{-1}+a_2z^{-2}+\cdots+a_{n_a}z^{-n_a}}
$$

### (三) 非参数模型类

非参数模型是指从系统的实验过程，直接或间接获得的响应，它不能表示为对象的有限参数模型。例
如：所记录到的一个系统的阶跃响应、脉冲响应、频率响应都属于非参数模型，采用相关分析、频谱分析
所得到的结果也属于非参数模型。对于这类模型，不需要选择其模型结构，也不必要估计模型参数，因
此，适用于描述任意复杂的系统  

#### 1、连续系统的非参数模型

##### (1) 测试信号

* 脉冲信号：表示为一个持续时间极短的信号  
	$$
	r(t)=A\delta(t)
	$$

* 阶跃信号：表示为参考输入量的一个瞬间突变过程  
	$$
	r(t)=A
	$$

* 斜坡信号：表示信号由零值开始随时间t作线性增长
	$$
	r(t)=At
	$$

* 等加速度信号：是一种抛物线函数，表示函数值随时间以等加速度增长            
	$$
	r(t)=\frac{1}{2}At^2
	$$
	
* 正弦信号：模拟海浪运动模型，船舶的消摆运动  
	$$
	r(t)=A\sin(\omega t)
	$$

##### (2) 一阶系统

对于一阶系统$G(s)=\frac{1}{1+Ts}$

* 单位脉冲响应
	$$
	c(t)=g(t)=\frac{1}{T}e^{-\frac{1}{T}t}
	$$

* 单位阶跃响应
	$$
	c(t)=1-e^{-\frac{1}{T}t}
	$$

* 单位斜坡响应
	$$
	c(t)=t-T(1-e^{-\frac{1}{T}t})
	$$

#### 2、离散系统的非参数模型

对于离散系统，受到一个单位脉冲（Delta）函数激励后的系统响应。这种形式表示为加权序列$h(KT)$（即脉冲响应的离散化）  

差分方程: 加权序列$h(k)$和输入脉冲值$u(i)  $
$$
y(k)=\sum\limits^k_{j=0}h(k-j)u(j)
$$
进行$Z$变换得到脉冲传递函数为
$$
H(z)=Z[h(k)]=\sum\limits^\infity_{k=0}h(KT)z^{-k}
$$
展开得到
$$
\begin{align}
H(z)&=\frac{b_0+b_1z^{-1}+\cdots+b_{n_b}z^{-n_b}}{1+a_1z^{-1}+\cdots+a_{n_a}z^{-n_a}}\\
&=h_0+h_1z^{-1}+h_2z^{-2}+\cdots
\end{align}
$$

## 三、随机信号的描述与分析

为了达到辨识的目的，待测系统必须产生一个满足辨识条件的动态过程。可以利用系统本身存在或人为干预进行动态激励。

通常采用外加激励信号使系统产生扰动而形成动态激励，而所施加信号按性质可分为脉冲信号、阶跃信号、斜坡信号及白噪声信号（工业测试用伪随机信号）。

一般认为具有可调频带且能量均匀分布在频带上的准白噪声信号-伪随机信号是较理想的辨识扰动信号，其已广泛应用为经典辨识方法和现代辨识方法中的扰动信号  

**扰动信号的分类**

<img src="/assets/images/系统辨识理论、方法及应用.assets/image-20200229181242259.png" alt="image-20200229181242259" style="zoom:50%;" />



## 四、随机过程的概念

### (一) 随机过程的定义

通常，把依赖于参数$t\in T$的随机变量族$\{x(t),t\in T\}$称为随机过程，参数集$T$通常是指时间常数  

一个随机过程$\{x(t),t\in T\}$，实际上是两个变量的二元函数，其中一个变量为样本空间$\Omega$中的$\omega$ （基本事件），另一个是参数集$T$中的$t  $ 

* 当$t$固定为$t_i$时，$x(t_i,\omega)$为随机变量
* 当$\omega$固定为$\omega_i$时，$x(t,\omega_i)$为时间$t$的函数（非随机）
* 由于固定$\omega$，表示某一次实验，故称$x(t,\omega_i)$为随机过程的一个样本函数

### (二) 随机过程的数字特征

**随机过程的分布函数**

若给定随机过程$\{x(t),t\in T \}$ ，对于每一个$t\in T$，则$x(t)$为随机变量，其分布函数定义为：
$$
F(x,t)=P\{x(t)<x \},t\in T
$$
相应的密度函数$f(x,t)=\frac{\partial F(x,t)}{\partial x}$，称$ F(x,t)$为随机过程$\{x(t),t\in T \}$ 的一维分布

一维分布不足以描述随机过程，它不能回答随机过程$\{x(t),t\in T \}$ 在不同t时的相关性问题。当参数t取$t_1，t_2$时，就有两个随机变量$x(t_1)$和$x(t_2)$，需考虑它们的联合分布：
$$
F(x_1,x_2,t_1,t_2)=P\{x(t_1)<x_1,x(t_2)<x_2 \},\ \ t_1,t_2\in T
$$
**均值**

若给定随机过程$\{x(t),t\in T \}$ ，固定$t\in T$，则$x(t)$是一随机变量，均值一般与$t$有关，记为
$$
\mu_x(t)\mathop=\limits^\Delta E[x(t)]=\int_{-\infity}^{\infity}x(t)p_1(x,t)dx
$$
其中，$\mu_x(t)$为随机过程$\{x(t),t\in T \}$ 的均值函数，$p_1(x,t)$一维密度函数

对于随机序列有
$$
m\mathop=\limits^\Delta E[x(k)]=\sum\limits^\infity_{k=-\infity}x(k)p[x(k),k]
$$
称$m$为随机序列$\{x(t),t\in T \}$ 的均值函数

**均方值**

均方值是为随机信号提供有关强度，它是时间历程平方值的简单平均值，又称为随机变量的二阶原点矩，记为
$$
\varphi^2_x(t)\mathop=\limits^\Delta E[x^2(t)]=\int^\infity_{-\infity} x^2(t)p_1(x,t)dx
$$
对于随机序列有
$$
\varphi_x^2(k)\mathop=\limits E[x^2(k)]=\sum\limits^\infity_{k=-\infity}x^2(k)p[x(k),k]
$$
$\varphi_x^2(t)$、$\varphi_x^2(k)$分别称为随机过程和随机序列的均方值函数

**方差**

方差在表达方式上等于均方值减去均值的平方，它表示随机过程在该时刻对于均值的平均偏离程度，又称之为随机变量的二阶中心矩。记为  
$$
\sigma_x^2(t)\mathop=\limits^\Delta E\{[x^2(t)]\}-\mu_x^2(t)=\int^\infity_{-\infity} [x^2(t)]p_1(x,t)dx-\mu_x^2(t)
$$
对于一随机序列，则参数t对应于一个个的时刻$k$，其方差表示为  
$$
\sigma_x^2(k)\mathop=\limits^\Delta E\{[x^2(k)]\}-m^2=\sum\limits^\infity_{-\infity}[x(k)]^2p_1[x(k),k]-m^2
$$
$\sigma^2_x(t)$和$\sigma_x^2(k)$分别称作随机过程和随机序列的方差函数  

**自相关函数**

随机过程的相关函数是描述两个信号数值间的依存关系的。考察两个信号$x(t)$和$y(t)$，他们都是时间的函数，若其中一个信号的数值总是以某种方式依存于另一个信号的数值，则称这两个信号是相关的。

自相关函数是描述信号$x(t_1) $的某一时刻值与另一时刻值$ x(t_2)$间的依存程度，这样就有两个随机变量了，若设它们的二维密度函数为$p_2(x_1,x_2,t_1,t_2)$，则自相关函数记为  
$$
R_x(t_1,t_2)=E\{x(t_1)x(t_2)\}=\int^\infity_{-\infity}\int^\infity_{-\infity}x_1x_2p_2(x_1,x_2,t_1,t_2)dx_1dx_2
$$
**协方差函数**

随机过程$\{x(t),t\in T\}$对任意两个时刻$t_1$，$t_2$的协方差函数记为：
$$
\begin{align}
C_x(t_1,t_2)&=E\{[x(t_1)-\mu_x(t_1)][x(t_2)-\mu_x(t_2)] \}\\
&=\int^\infity_{-\infity}\int^\infity_{-\infity} [x(t_1)-\mu_x(t_1)][x(t_2)-\mu_x(t_2)]p_2(x_1,x_2,t_1,t_2)dx_1dx_2
\end{align}
$$
其中$\mu_x(t)=E\{x(t)\}$。描述过程在任意两个不同时刻$t_1、t_2$所对应的两个随机变量$x(t_1)$和$x(t_2)$的相关性。

当$t_1=t_2=t$时，$C_x(t,t)\mathop=\limits^\Delta E\{[x(t)-\mu_x(t)]^2 \}=\sigma_x^2$

协方差就转化为方差  

**互相关函数**

若有两个随机变量$x(t)$和$y(t)$需同时考虑时，有
$$
R_{xy}(t_1,t_2)=E[x(t_1)y(t_2)],\ \ \ \ t_1,t_2\in T
$$
**互协方差函数**

定义为变量$x(t_1)$和$y(t_2)$的相关矩，记作
$$
\begin{align}
C_{xy}(t_1,t_2)&=Cov[x(t_1)y(t_2)]\\
&=E\{[x(t_1)-\mu_x(t_1)][y(t_2)-\mu_y(t_2)] \}\\
&=R_{xy}(t_1,t_2)-\mu_x(t_1)\mu_y(t_2)

\end{align}
$$

### (三) 平稳随机过程与各态历经性

如果一个随机过程$\{x(t),t\in T\}$的统计性质不随时间而改变，则称之为平稳随机过程  

若对于任意$n$和任意选定$t_1<t_2<\cdots<t_n,t_k\in T,k=1,2,\cdots,n$及$\tau$为任意值，且$x_1,x_2,\cdots,x_n\in R$，有
$$
f_n(x_1,x_2,\cdots,x_n;t_1,t_2,\cdots,t_n)=f_n(x_1,x_2,\cdots,x_n;t_1+\tau,t_2+\tau,\cdots,t_n+\tau)
$$
则称$\{x(t),t\in T\}$为平稳随机过程

该定义说明，当取样点在时间轴上作任意平移时，随机过程的所有有限维分布函数是不变的，具体到它的一维分布,则与时间$t$无关，而二维分布只与时间间隔$τ$有关，即有  
$$
f_1(x_1,t_1)=f_1(x_1)
$$
和
$$
f_2(x_1,x_2;t_1,t_2)=f_2(x_1,x_2;\tau)
$$
**均值**
$$
\mu_x(t_1)=E[x(t_1)]=\int_{-\infity}^{\infity}x_1f_1(x_1,t_1)dx_1=\int_{-\infity}^\infity x_1f_1(x_1)dx_1=a\\
\mu_x(t_2)=E[x(t_2)]=\int_{-\infity}^{\infity}x_1f_1(x_1,t_2)dx_1=\int_{-\infity}^\infity x_1f_1(x_1)dx_1=a
$$
这说明，平稳随机过程的各样本函数围绕着一水平线起伏  

**方差**
$$
\begin{align}
\sigma_x^2(t_1)&=E\{[x(t_1)]^2\}-\mu_x^2(t_1)\\
&=\int^\infity_{-\infity}[x(t_1)]^2f_1(x_1,t_1)dx_1-\mu_x^2(t_1)\\
&=\int^\infity_{-\infity}[x(t_1)]^2f_1(x_1)dx_1-\mu_x^2(t_1)\\

\sigma_x^2(t_1)&=E\{[x(t_2)]^2\}-\mu_x^2(t_2)\\
&=\int^\infity_{-\infity}[x(t_2)]^2f_1(x_1,t_2)dx_1-\mu_x^2(t_2)\\
&=\int^\infity_{-\infity}[x(t_2)]^2f_1(x_1)dx_1-\mu_x^2(t_2)
\end{align}
$$
平稳随机过程的方差$σ^2(t)=σ^2=常数$，表示它的起伏偏离数学期望的程度也是常数  

**自相关函数**
$$
R_x(t_1,t_2)=E\{x(t_1)x(t_1+\tau)\}=\int^\infity_{-\infity} \int^\infity_{-\infity} x_1x_2f_2(x_1,x_2;\tau)dx_1dx_2=R_x(\tau)
$$
表明仅是时间间隔$τ=t_2-t_1$的函数，而不再是$t_1$和$t_2$的二维函数  

以上表明，随机过程$\{x(t) ,t∈T｝$具有“平稳”的数字特征：它的均值与时间无关（均值不变）；它的自相关函数只与时间间隔τ有关，即  
$$
R_x(t_1,t_2)=R_x(t_3,t_4)=\cdots=R_x(\tau=t_2-t_1)=R_x(\tau)
$$
**宽平稳随机过程**

当均值不随时间改变，即$\mu_x(t_1)=\mu_x(t_2)=\cdots=\mu_x$，

自相关函数$R_x(t_1,t_2)=R_x(t_3,t_4)=\cdots=R_x(\tau=t_2-t_1)=R_x(\tau)$ ，则称这个平稳随机过程称为宽（广义）平稳随机过程  

**相关函数**

设$R_x(\tau)$为平稳随机过程$\{x(t),t\in T\}$的相关函数，则
$$
R_x(\tau)\mathop=\limits^\Delta E\{x(t)x(t+\tau) \}
$$
**时间均值函数**
$$
\mu_x(t)\mathop=\limits^\Delta E\{x(t)\}=\lim_{T\rightarrow\infity} \frac{1}{2T}\int^T_{-T}x(t)dt
$$
**时间相关函数**
$$
R_x(\tau)\mathop=\limits^\Delta E\{x(t)x(t+\tau) \}=\lim_{T\rightarrow\infity} \frac{1}{2T}\int^T_{-T}x(t)x(t+\tau)d\tau
$$
利用各种“时间平均值”去获得统计性质，即随机过程$x(t)$的均值 等于$x(t)$的时间平均值，随机过程$x(t)$的相关函数 等于$x(t)$的时间平均相关函数。称为各态历经性，或称遍历性。具有各态历经性的随机过程，称为各态历经随机
过程；不具备各态历经性的随机过程，则称为非各态历经的  

**自相关函数的性质**

* 当$\tau=0$时，$R_x(\tau)=\lim\limits_{T\rightarrow\infity}\frac{1}{2T}\int^T_{-T}x(t)x(t+\tau)dt=\overline{x}^2(t)=\sigma^2>0$，其中，$\sigma^2$为信号的均方值，说明自相关函数的初值大于零  
* 当$\tau$相当大时，平均值为零的信号的自相关函数$R_x(τ)$趋于零，即 $\lim\limits_{t\rightarrow\infity}R_x(\tau)=0$ 
* $R_x(\tau)$在$\tau$为任何值时都不会大于它的初值，$R_x(\tau)\geq R_x(0)$ 
* $R_x(\tau)$为$\tau$上的偶函数
* 若信号$x(t)$中含有周期性成分，$R_x(\tau)$中也必含有周期性成分

**谱密度函数**

设$R_x(\tau)$为平稳随机过程$\{x(t),t\in T\}$的相关函数，则
$$
R_x(\tau)=\frac{1}{2\pi}\int^\infity_{-\infity}S_x(\omega)e^{j\tau\omega}d\omega
$$
其中，$S_x(\omega)$称为平稳随机过程$x(t)$的谱密度函数，它的物理意义表示$x(t)$的平均功率关于频率的分布  

在应用相关函数确定谱密度函数时，一个重要条件是$R_x(\tau)$绝对可积，即
$$
\int^\infity_{-\infity}|R_x(\tau)|d\tau<\infity
$$
这时必存在功率谱密度
$$
\begin{align}
S_x(\omega)&=\int^\infity_{-\infity}R_x(\tau)e^{-j\tau \omega}d\tau\\
&=\int^\infity_{-\infity}R_x(\tau)(\cos\omega \tau-j\sin\omega\tau)d\tau\\
&=\int^\infity_{-\infity}R_x(\tau)\cos\omega \tau d\tau\\
&=2\int^\infity_{-\infity}R_x(\tau)\cos\omega\tau d\tau\ \ \ \ -\infity<\omega<\infity
\end{align}
$$
谱密度函数就是相关函数的傅立叶变换式，相关函数就是谱密度函数的反傅立叶变换式  
$$
\begin{align}
R_x(\tau)&=\frac{1}{2\pi}\int^\infity_{-\infity}S_x(j\omega)e^{j\omega}d\omega\\
&=\frac{1}{2\pi}\int^\infity_{-\infity}S_x(j\omega)(\cos\omega\tau+j\sin\omega\tau)d\omega\\
&=\frac{1}{2\pi}\int^\infity_{-\infity}S_x(j\omega)\cos\omega\tau d\omega
\end{align}
$$
为了达到辨识的目的，待测系统必须产生一个满足辨识条件的动态过程。可以利用系统本身存在或人为干预进行动态激励  

通常采用外加激励信号使系统产生扰动而形成动态激励，而所施加信号按性质可分为脉冲信号、阶跃信号、周期信号及白噪声信号（工业测试用伪随机信号）

对扰动信号的要求是输入信号必须能充分激励系统所有的模态。换句话说，从频谱分析角度看，输入信号的频谱应具有较宽的带宽，可以覆盖系统的频谱。从测试角度看，应当有尽量小的振幅，以减轻扰动信号对待测系统工作信号的影响    

## 五、白噪声与伪随机码

### (一) 基本概念

#### 1、白噪声

严格地说，白噪声是一种均值为零，谱密度为非零常数的平稳随机过程。

不很严格地说，可把它视作以极高频率出现的许多微小脉冲的组合  

白噪声的频率特征是功率谱密度函数为常数，即  
$$
S_x(\omega)=S_0
$$
可以理解为一种均匀谱，其功率谱密度是一条水平线  

白噪声在数学上可描述为：如果随机过程$x(t)$的自相关函数为：
$$
R_x(\tau)=\sigma^2\delta (\tau)
$$
其中，$\sigma^2=E[x^2(t)]$为白噪声的方差，$\delta(\tau)$为Dirac函数，描述为
$$
\delta(\tau)=\begin{cases}\infity&\tau=0\\ 0&\tau\neq 0\end{cases}
$$
且
$$
\int^\infity_{-\infity}\delta(\tau)d\tau=1
$$
$\delta(\tau)$又叫做单位脉冲函数，狄拉克函数  

* 上述关系已经包含了白噪声均值为零的概念。（这是因为均值除t=0，其他点的值均为0， 所以均值为零。）  

* 由于$\delta(\tau)$的傅里叶变换为1，则白噪声过程$x(t)$的谱密度为常数$\sigma^2$，即
	$$
	S_x(\omega)=\sigma^2\ \ \ \ -\infity<\omega<\infity
	$$
	证明如下：

	由上述自相关函数通过维纳—辛钦公式，计算功率谱密度函数
	$$
	\begin{align}
	S_x(\omega)&=\int^{+\infity}_{-\infity}\sigma^2\delta(\tau)e^{-j\omega\tau}d\tau\\
	&=\sigma^2\int^{+\infity}_{-\infity}\delta(\tau)e^{-j\omega\tau}d\tau\\
	&=\sigma^2\int^{+\infity}_{-\infity}\delta(\tau)d\tau\\
	&=\sigma^2
	
	\end{align}
	$$

* 白噪声过程的功率在$-\infity\sim +\infity$的全频段内均匀分布  

<img src="/assets/images/系统辨识理论、方法及应用.assets/image-20200303190332868.png" alt="image-20200303190332868" style="zoom: 50%;" />

#### 2、白噪声的数学模型

##### (1) 频率上的定义

如果一个宽平稳过程，对所有的$\omega \in (-\infity,+\infity)$具有恒定的功率谱密度函数，即功率谱密度函数$S_x(\omega)=Const$，则称此过程为白噪声过程  

从功谱角度看，白噪声对不同频率的输入都能进行干扰，它的谱在各频率分量上都广泛存在，在各频率分量上有相同的功率  

**离散时间白噪声—白噪声序列**

协方差函数为
$$
R(n)=\frac{1}{2\pi}\int^\pi_{-\pi}c\times e^{jn\omega}d\omega=\frac{2c}{2\pi n}\sin n\pi=c\delta(n)
$$
式中， 是Kroneker- δ函数。表明：对不同时刻，过程是不相关的（或称$\delta $相关）。如果该过程还是高斯分布的，则它是独立随机过程，称之为高斯白噪声序列，其统计特性完全可以由均值和协方差函数决定。
所以，不相关的随机序列就是白噪声序列 。其方差为  
$$
Vat(x(0))\equiv c=const
$$
**连续时间白噪声—白噪声过程**

其协方差函数为
$$
R(\tau)=\frac{1}{2\pi}\int^\pi_{-\pi}c\times e^{j\tau \omega}d\omega=c\delta(\tau)
$$
式中， 是Kroneker- δ函数.表明：过程对不同时刻是不相关的（或者称为$\delta$相关）。
具有上式表达的协方差函数的不相关随机过程就是白噪声过程  

##### (2) 时域上的定义

如果一个随机过程$\{x(t),t\in T \}$，有均值和自协方差函数，如下
$$
\mu_x(t)=E\{X(t)\}=0\\
Cov\{x(t),x(\tau) \}=Q(t)\delta(t-\tau)
$$
则称此过程为零均值白噪声过程。$ Q(t)$是与白噪声强度有关的非负正定的常数阵，如果白噪声还是高斯分布，称之为零均值高斯白噪声过程  

白噪声过程的变化速度极快，其过去值和未来值之间毫无关系。白噪声的自相关函数是一个$\delta$函数，即  
$$
R_x(\tau)=\sigma^2\delta(\tau)
$$
当$\tau=0$时，$R_x(0)=\infity$，当$\tau\neq 0$时，$R_x(\tau)=0$

若实际的随机信号谱密度函数在所考虑的频率范围内，幅值恒定，称为有限频带白噪声  

<img src="/assets/images/系统辨识理论、方法及应用.assets/image-20200303192240749.png" alt="image-20200303192240749" style="zoom:50%;" />

**离散白噪声序列**

设随机序列$x_1,x_2,\cdots$，如果它们的均值为零，方差相同，且互不相关，即  
$$
\begin{align}
E[x_i]&=0\ \ \ \ (i=1,2,\cdots)\\
E[x_ix_j]&=\begin{cases}\sigma^2& i=j\\0&i\neq j\end{cases}
\end{align}
$$
则此随机序列称为离散白噪声序列  

**向量白噪声过程的推广**

如果一个$n$维向量随机过程$X(t)$满足：  
$$
\begin{cases}
E\{X(t)\}=0\\
Cov\{X(t),X(t,\tau)\}=E\{X(t)X^T(t+\tau)\}=Q\delta(\tau)
\end{cases}
$$
其中，$Q$是正定的常数阵， $\delta(\tau) $是Dirac常数，那么$X(t)$就是向量白噪声过程  

### (二) 产生方法

理论上，只要有了一种具有连续分布的白噪声数，就可以通过函数变换的方法产生其他任意分布的白噪声随机数。在具有连续分布的白噪声随机数中，$(0,1)$均匀分布的白噪声随机数是最简单、最基本的一种  

通常用数学方法产生$(0,1)$均匀分布的随机数称为伪随机数，它可以用乘同余法和混合同余法产生  

#### 1、产生随机正整数序列

用如下的递推同余式发生器产生正整数序列$\{z_i\}$
$$
z_i=(az_{i-1}+C)(\mod m),\ \ \ \ i=1,2,\cdots
$$
式子的含义是：$z_i×a$，加上$C$，其和被$m$除，取其余数为$z_i$。其中，$z_i$为第$i$个随机数，$a$为乘子，$C$为增量，m为模数。$z_0$称为初值或随机数源，它们均为非负整数。

可以得到$z_i$满足关系：
$$
0\leq z_i\leq m-1
$$
为了得到$[0,1]$区间上所需要的随机数，可令
$$
x_i=z_i/m
$$
这样产生的序列${x_i}$是伪随机序列  

从表中，可以看到随机发生器的几个特点：

* 产生的$z_i$位于$[0,m-1]$区间，因而$x_i$位于$(0,1)$区间；
* 适当选择$a$、$C$和$m$，可使$z_i$循环产生。无论$z_0$取何值，其循环顺序是相同的，若循环周期等于$m$，则称其循环具有满周期；
* 适当选择$a$、$C$和$m$，可保证$z_i$在$[0,m-1]$区间上一个周内每个整数正好出现一次，从而保证了均匀性；
* 加大$m$值，可提高$x_i$的均匀性  

如果$m$足够大，且循环具有满周期，那么可以预计，所得到的$x_i$在$(0,1)$区间上是相当均匀分布的，且值相当密。这样就可足够近似与真正的$(0,1)$区间上均匀分布的$U (0,1)  $ 

#### 2、利用标准均匀分布随机数产生标准正态分布随机数

在得到$(0,1)$上均匀分布的随机数$\{x_i\}$后，为获得各种不同分布的随机噪声$\{y_i\}$，则必须对$\{x_i\} $进行整形 

统计近似抽样法：

设$\{x_i\}$是$(0,1)$均匀分布的随机序列，则有
$$
\mu_x=E[x_i]=\int^1_0 x_ip(x_i)dx_i=\frac{1}{2}x_i^2\Big|^1_0=\frac{1}{2}\\
\sigma_x^2=Var[x_i]=\int^1_0 (x_i-\frac{1}{2})^2p(x_i)dx_i=\frac{1}{3}(x_i-\frac{1}{2})^3\Big|^1_0=\frac{1}{12}
$$
根据中心极限定理，当$N\rightarrow \infity$时，
$$
x=\frac{\sum\limits^N_{i=1}x_i-N\mu_x}{\sqrt{N\sigma_x^2}}=\frac{\sum\limits^N_{i=1}x_i-\frac{N}{2}}{\sqrt{N/12}}\sim N(0,1)
$$
则$(0,1)$均匀分布的随机变量就转化为$(0,1)$正态分布的随机变量了。$N$为总体中抽取的样本数  

 若$y\sim N(\mu_y,\sigma_y^2)$为所要产生的正态分布随机变量，经标准化处理：
$$
\frac{y-\mu_y}{\sqrt{\sigma_y^2}}\sim N(0,1)
$$
故
$$
\frac{y-\mu_y}{\sqrt{\sigma_y^2}}=\frac{\sum\limits^N_{i=1}x_i-\frac{N}{2}}{\sqrt{N/12}}
$$
即
$$
y=\mu_y+\sigma_y\frac{\sum\limits^N_{i=1}x_i-\frac{N}{2}}{\sqrt{N/12}}
$$

### (三) 伪随机二位式信号

上述白噪声信号由于没有周期性，要较精确地获得它的相关函数，需要很长时间。为了克服上述缺点，人
们在实践中找到了一些新的信号，统称为伪随机信号。

在SI中，伪随机信号可以有许多构成形式，其中，最常用也是最容易形成的是伪随机二位式信号(prbs，Pseudo-Random Binary Sequence )，亦称M序列（自相关函数的形状）。

如果这个序列中的每个随机变量只有1和-1两种状态，则称此随机序列为离散二位式白噪声序列  

##### 1、PRBS波形

<img src="/assets/images/系统辨识理论、方法及应用.assets/image-20200303201053871.png" alt="image-20200303201053871" style="zoom:50%;" />

具有二位式特性，类似于矩形波，但宽度不等。其周期$T=N\Delta t$，。持续长的个数少些，持续时间短的个数多些。持续$\Delta t$的个数约占$N/4$，持续时间为$2\Delta t $的个数约占$N/8$，持续时间为$3\Delta t $的个数约占$N/16$

当序列$x_i(i=1,2,\cdots,N)$充分长时，即N充分大时，
离散二位式白噪声序列具有以下三个概率性质：  

* 在序列中1出现的次数与-1出现的次数几乎相等。

* 在序列中总的游程个数平均为$(N+1)/2$个，1的游程与-1的游程大约各占一半。即大约为$(N+1)/4$个（$N$为奇数，表示序列的个数）  

* 对于离散二位式无穷随机序列$x1,x2,\cdots,$它的相关函数为
	$$
	R_{xx}(\tau)=E[x_ix_{i+\tau}]=\begin{cases}1&(\tau=0)\\0&(\tau=1,2,\cdots)\end{cases}
	$$

若干个1（或若干个-1）的连续排列称为“游程”。一个游程中含有1或-1的个数称为游程长度。例如，一个周期长为15的二位式序列1,1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,1, -1，游程总数为8，其中的游程长度为1的共有四个，占总游程数的1/2，游程长度为2的有两个，占总游程数的1/4，游程长度为3和4的都只有一个，各占总游程数的1/8，其中1与-1的个数分别为8和7，只相差1  

##### 2、PRBS性质

* 信号有两个电平，分别为$+a\sim -a$，在时间区间$\Delta t $内是固定的，而且仅在有限个时刻，$t=0,\Delta t,2\Delta t,\cdots$上信号才能从一个电平转换到另一个电平；
* 在任意特定的间隔上，信号的电平是确定的。因此，伪随机二位式信号是确定性的，从而实验是可以重复进行的；
* 伪随机二位式信号是周期性的信号，其周期为$T=N\Delta t$，$N$是一个奇整数  
* 在任何一个周期内，有$(N+1)/2$个间隔出现一个电平，而其余$(N-1)/2$个间隔出现另一个电平  
* PRBS移动若干位后，再和原来的PRBS对应位相加（模二加法），所得结果仍然是PRBS，只相当于原来的PRBS移动几位的效果  
* $M$序列的周期长度$N_p= (2n-1)\Delta t$
*   一个周期内，逻辑0状态总比逻辑1状态少1个。逻辑1状态出现的次数为$(T+1)/2$；逻辑0状态出现的次数为$(T-1)/2  $
* 序列中，某状态连续出现的段称为“游程”长度。一个n级移位寄存器生成的$M$序列，在一个$T$内有$2^n-1$段游程  

##### 3、PRBS产生

PRBS可以通过带反馈的移位寄存器产生，框图为：  

<img src="/assets/images/系统辨识理论、方法及应用.assets/image-20200303202149091.png" alt="image-20200303202149091" style="zoom: 67%;" />

上图表示一个n级移位寄存器，它带有一个反馈通道，该反馈通道将第k级及第n级的状态（只有两个状态，逻辑1和逻辑0）按模2加法相加，然后反馈到第一级的输入端。

模2加法原则：当所得到的新序列中的码为逻辑1状态，则表示相应的两个输入信号的码的电平符号是相异的；而当新序列中的码为逻辑0状态，则其相应的两个输入信号的码的电平符号是相同的。----“异或”  

这个电路的四级寄存器为$A_1，A_2，A_3，A_4$，其中$A_3$和$A_4$的状态作模2相加，然后反馈到$A_1$的输入端，如果所有寄存器初始状态都是$1$，第一个移位脉冲输入，使四个寄存器的状态变为$0111$,第二个移位脉冲输入，则寄存器的为0011，…，一个周期的变化规律为：

$1111（初态)→0111→0011→0001→1000→0100→0010→1001\\ →1100→0110→1011→0101→1010→1101→1110→1111$

一个周期中产生15种不同的状态，如果取$A_4$的状态作为输出的伪随机信号，则这个随机序列为
$111100010011010  $

如果将反馈取自第二级（k=2），与第4级输出的模2门相加后，一个周期的变化规律为
$1111（初态)→0111→0011→1001→1100→1110→1111$
如果$A_4$状态作为输出，所得到的序列为$111100$，该序列的周期长度为$T=6\Delta t$ 。

由此，同样级数的移位寄存器，因反馈选择的不同，所得到的序列的周期长度就不一样  

当移位脉冲来到时，第i-1级状态就移到第i级，第1级的状态由模2加法门的输出决定，最后可以将第n级移出的内容作为伪随机二位式信号输出（输出信号可取任何一级的输出）。

模2加法门的两个输入中，除其中一个输入为最后一级的状态外，另一个输入取哪一级（即k的取值）的状态，取决于所需输出的伪随机二位式信号的规律（周期的长短以及每个周期内逻辑状态的变化顺序）。如果k选择的合适，其输出将是一个周期长度为最长的PRBS  

一个n级的移位寄存器，每级有两个状态，总共可能产生的不同状态组合有$2^n$种。除去各级全为0的组合状态外（各级全为0的状态是不希望出现的，因为如果各级全为0，则每次经模2加法门反馈到第一级输入端的状态总是0，移位寄存器的输出状态就是恒为0的信号，必须避免）。因此对于一个n级的移位寄存器，它能形成序列
的最大可能长度为$2^n-1$个状态的组合。如果一个n级的移位寄存器生成序列的周期长度$T$达到$T= 2^n-1$，则称这个序列为二位式最大长度序列，或称$M$序列  

以下是4级的移位寄存器生成的最大长度二位式序列（M序列）  ：

<img src="/assets/images/系统辨识理论、方法及应用.assets/image-20200303202946158.png" alt="image-20200303202946158" style="zoom:50%;" />

##### 4、PRBS的数字特征

**自相关函数**

M序列具有周期性，其自相关函数为：
$$
\begin{cases}
a^2[1-\frac{|\tau|(N+1)}{\Delta tN}]&当-\Delta t<\tau<\Delta \tau\\
\frac{a^2}{N}&当\Delta t\leq |\tau|\leq (N-1)\Delta t
\end{cases}
$$
表明这个尖脉冲有幅值时间不足一个$\Delta t$

为方便起见，取$\Delta t=1$，则M序列的相关函数为：
$$
R_x(\tau)=\begin{cases}a^2&\tau=0\\-\frac{a^2}{N}&0<\tau\leq N-1\end{cases}
$$
N很大时，M序列的相关函数与离散白噪声的相关函数相接近，故可用它作为测试信号  

伪随机噪声的自相关函数接近于白噪声的自相关函数（ 函数），即这类噪声的自相关函数呈尖脉冲形，脉冲的中心处有一峰值，脉冲两边则很陡地降为0，而在绝大部分时间内，自相关函数是平坦的。且伪随机噪声是周期性信号，它有一个重复周期T。当N足够大时，可近似为白噪声的自相关函数。  

**功率谱密度**

$R_x(\tau)$为偶函数，且以周期$T=N\Delta t$重复，则
$$
\begin{align}
S_x(\omega)&=\int^\infity_{-\infity}R_x(\tau)e^{-j\tau\omega}d\tau=\int^{\frac{\tau}{2}}_{-\frac{\tau}{2}}R_x(\tau)e^{-j\tau\omega}d\tau\\
&=2\int^{\frac{\tau}{2}}_0R_x(\tau)e^{-j\tau\omega}d\tau\\
&=2\int^{\Delta}_0a^2[1-\frac{\tau}{\Delta t}\times \frac{N+1}{N}]\cos\omega \tau d\tau-2\int^{\frac{N}{2}\Delta t}_{\Delta t}\frac{a^2}{N}\cos\omega\tau d\tau
\end{align}
$$
PRBS的功率谱密度函数是一条$(\frac{\sin x}{x})^2$的包络线  

在工程上，如果在某一频率范围内，$S_x(\omega)$仅下降3dB，就可以认为$S_x(\omega)$基本上是平坦的，可把PRBS当做白噪声来处理。  

在低频段$(\omega=\frac{2\pi}{N\Delta t}\sim\frac{2\pi}{3\Delta t})$，PRBS的谱密度函数从$\frac{a^2(N+1)\Delta t}{N^2}$下降至$\frac{a^2(N+1)\Delta t}{\sqrt{2}N^2}$（下降了3dB），这样，就定量地表示了PRBS对于白噪声的近似程度  

##### 5、PRBS的特点

* 该信号具有周期性；
* 信号取+a的数量和-a的数量应尽可能相等。
* 某状态连续出现的段称为“游程”长度。
* 信号的自相关函数为一个三角脉冲，当N足够大时，可以近似白噪声的自相关函数。
* 信号的功率谱密度在频率$\omega=\frac{2\pi}{N\Delta t}\sim\frac{2\pi}{3\Delta t}$范围内，可近似为白噪声的功率谱密度。
* 利用移位相加（模二加法），可得滞后PRBS，这个性质可用来产生互不相关的PRBS，作为多输入多输出系统辨识的输入信号。  