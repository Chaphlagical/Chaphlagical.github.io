---
bg: "2019-10-12.jpg"
layout: post
title:  "频率响应法"
crawlertitle: "频率响应法"
summary: "频率响应法"
date:   2019-10-12 20:37:01 +0700
categories: posts
tags: ['自动控制原理']
author: Chaf
---

本文介绍频率响应法

## 一、伯德图

Matlab的bode命令可以计算连续线性定常系统频率响应的幅值和相角

```matlab
bode(num,den)
bode(num,den,w)
bode(A,B,C,D)
bode(A,B,C,D,w)
bode(A,B,C,D,iu,w)
bode(sys)
```

左边带变量时：

```matlab
[msg,phase,w]=bode(num,den,w)
```

msg和phase矩阵包含系统频率响应的幅值和相角，此时相角单位为度，用下列语句可把幅值转为分贝：

```matlab
magdb=20*log10(mag)
```

若想指明频率范围，可采用命令：

```matlab
w=logspace(d1,d2)
w=logspace(d1,d2,n)
```

命令将生成$10^{d1}$到$10^{d2}$之间n个在对数上等距的点（没加n默认50个），将w带入bode命令中即可。

示例：

* 考虑系统$G(s)=\frac{25}{s^2+4s+25}$对应的伯德图

```matlab
%G(s)=25/(s^2+4s+25)的bode图
num=[25];
den=[2 4 25];
bode(num,den)
title('Bode Diagram of G(s)=25/(s^2+4s+25)');
```

![](/assets/images/control_system/frequence_response/1.jpg)

* 考虑系统$G(s)=\frac{9(s^2+0.2s+1)}{s(s^2+1.2s+9)}$的bode图

```matlab
%G(s)=(9(s^2+0.2s+1))/(s(s^2+1.2s+9))的bode图
num=[9 1.8 9];
den=[1 1.2 9 0];
bode(num,den)
title('Bode Diagram of G(s)=(9(s^2+0.2s+1))/(s(s^2+1.2s+9))');
```

* 考虑状态空间表示的系统：

$\begin{bmatrix}\dot{x_1}\\\dot{x_2}\end{bmatrix}=\begin{bmatrix}0&1\\ -25&-4\end{bmatrix}\begin{bmatrix}x_1\\ x_2\end{bmatrix}+\begin{bmatrix}0\\ 25\end{bmatrix}u\\\\ y=\begin{bmatrix}1&0\end{bmatrix}\begin{bmatrix}x_1\\ x_2\end{bmatrix}$

```matlab
% 状态空间表示系统的bode图
A=[0 1;-25 -4];
B=[0;25];
C=[1 0];
D=[0];
bode(A,B,C,D);
title('Bode Diagram');
```

![](/assets/images/control_system/frequence_response/3.jpg)

## 二、奈奎斯特图

Matlab的nyquist命令可以计算连续时间的线性定常系统的频率响应：

```matlab
nyquist(num,den,w)
nyquist(A,B,C,D)
nyquist(A,B,C,D,w)
nyquist(A,B,C,D,iu,w)
nyquist(sys)
```

左端含变量表示为：

```matlab
[re,im,w]=nyquist(sys)
```

矩阵re和im分别表示系统频率响应的实部和虚部，它们都是在向量w中指定的频率点上计算而来的。

示例：

* 考虑系统$G(s)=\frac{1}{s^2+0.8s+1}$的奈奎斯特图

```matlab
%G(s)=1/(s^2+0.8s+1)的奈奎斯特图
num=[1];
den=[1 0.8 1];
nyquist(num,den)
grid
title('Nyquist Plot of G(s)=1/(s^2+0.8s+1)');
```

![](/assets/images/control_system/frequence_response/4.jpg)

**注意**：当运算中出现“被零除”，得到的奈奎斯特图可能是错的，例如$G(s)=\frac{1}{s(s+1)}$

若以下述程序绘制时会出现错误的结果：

```matlab
%G(s)=1/(s(s+1))的奈奎斯特图
num=[1];
den=[1 1 0];
nyquist(num,den)
grid
title('Nyquist Plot of G(s)=1/(s(s+1))');
```

![](/assets/images/control_system/frequence_response/5.jpg)

应当进行修正以得到正确结果：

```matlab
%G(s)=1/(s(s+1))的奈奎斯特图
num=[1];
den=[1 1 0];
nyquist(num,den)
v=[-2 2 -5 5];axis(v)
grid
title('Nyquist Plot of G(s)=1/(s(s+1))');
```

![](/assets/images/control_system/frequence_response/6.jpg)

* 考虑以状态空间方程定义的系统的奈奎斯特图： 

$\begin{bmatrix}\dot{x_1}\\\dot{x_2}\end{bmatrix}=\begin{bmatrix}0&1\\ -25&-4\end{bmatrix}+\begin{bmatrix}0\\ 25\end{bmatrix}u\\\\   y=\begin{bmatrix}1&0\end{bmatrix}\begin{bmatrix}x_1\\ x_2\end{bmatrix}+\begin{bmatrix}0\end{bmatrix}u$

```matlab
%状态空间表示系统的奈奎斯特图
A=[0 1;-25 -4];
B=[0;25];
C=[1 0];
D=[0];
nyquist(A,B,C,D)
grid
title('Nyquist Plot')
```

![](/assets/images/control_system/frequence_response/7.jpg)

* 考虑以状态空间方程定义的系统的奈奎斯特图：

$\begin{bmatrix}\dot{x_1}\\\dot{x_2}\end{bmatrix}=\begin{bmatrix}-1&-1\\ 6.5&0\end{bmatrix}+\begin{bmatrix}1&1\\ 1&0\end{bmatrix}\begin{bmatrix}x_1\\ x_2\end{bmatrix}\\\begin{bmatrix}y_1\\ y_2\end{bmatrix}=\begin{bmatrix}1&0\\0&1\end{bmatrix}\begin{bmatrix}x_1\\ x_2\end{bmatrix}+\begin{bmatrix}0&0\\ 0&0\end{bmatrix}\begin{bmatrix}u_1\\ u_2\end{bmatrix}$

![](/assets/images/control_system/frequence_response/8.jpg)

* 简单传递函数的奈奎斯特图

![](/assets/images/control_system/frequence_response/9.jpg)

![](/assets/images/control_system/frequence_response/10.jpg)

![](/assets/images/control_system/frequence_response/11.jpg)

![](/assets/images/control_system/frequence_response/12.jpg)

![](/assets/images/control_system/frequence_response/13.jpg)

## 三、尼柯尔斯图

尼柯尔斯图可用命令nichols进行绘制：

```matlab
nichols(sys)
nichols(sys,w) 
[mag,phase,w] = nichols(sys)
[mag,phase] = nichols(sys,w)
```

* 常用传递函数的尼柯尔斯图：

![](/assets/images/control_system/frequence_response/14.jpg)

![](/assets/images/control_system/frequence_response/15.jpg)

![](/assets/images/control_system/frequence_response/16.jpg)

