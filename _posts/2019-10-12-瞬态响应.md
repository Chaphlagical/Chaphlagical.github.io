---
title: 瞬态响应法
tags: 自动控制原理
article_header:
  type: cover
  image:
    src: /assets/images/auto.jpg
---

<!--more-->

## 一、二阶系统

![](/assets/images/control_system/response/1.png)

闭环系统传递函数：

$T(s)=\frac{\omega_n^2}{s^2+2\zeta\omega_n s+\omega^2}$

### (一) 动态特性

$0<\zeta<1$，欠阻尼系统  ，闭环极点为左半S平面的一对共轭复极点，瞬态响应是振荡的 

 $T(s)=\frac{\omega_n^2}{s^2+2\zeta\omega_n s+\omega^2}=\frac{\omega_n^2}{(s+\zeta\omega_n+j\omega_d)(s+\zeta\omega_n-j\omega_d)}$ 

**阻尼自然振荡频率**：$\omega_d=\omega_n\sqrt{1-\zeta^2}$

**闭环系统具有一对稳定的共轭复极点**：$s_{1,2}=-\zeta \omega_n\pm j\omega_n\sqrt{1-\zeta^2}=-\zeta\omega_n\pm j\omega_d$ 

**阶跃响应时域表达式**：$y(t)=1-\frac{e^{-\zeta\omega_n t}}{\sqrt{1-\zeta^2}}sin(\omega_n\sqrt{1-\zeta^2}t+cos^{-1}\zeta),t\geq0$ 

令$\beta=\sqrt{1-\zeta^2}，\theta=cos^{-1}\zeta$，则有：

$y(t)=1-\frac{1}{\beta}e^{-\zeta\omega_n t}sin(\omega_n \beta t+\theta),t\geq0$

**阶跃响应的跟踪误差**：$e(t)=\frac{1}{\beta}e^{\zeta\omega_n t}sin(\omega_n\beta t+\theta),t\geq0$

**稳态跟踪误差**：$e_{ss}=0$

### (二) 系统性能

#### 1、允许误差调整时间

**2%允许误差调整：**

$e^{-\zeta\omega_n T_s}\leq0.02\beta<0.02$

$\zeta\omega_nT_s\approx4$

$T_s\approx\frac{4}{\zeta\omega_n}$

**5%允许误差调整时间：**

$T_s\approx \frac{3}{\zeta\omega_n}$

#### 2、0%~100%上升时间

$T_r=\frac{\pi-\theta}{\omega_n\beta}=\frac{\pi-cos^{-1}\zeta}{\omega_n\sqrt{1-\zeta^2}}$

#### 3、峰值时间

$\frac{dy(T_j)}{dt}=0$

$\omega_n\beta T_j=\omega_d T_j=j\pi,j=1,2,3,...$

#### 4、第一次超调峰值时间

$T_p=\frac{\pi}{\omega_n\sqrt{1-\zeta^2}}$

#### 5、最大超调量

$\sigma=e^{-\frac{\zeta\pi}{\sqrt{1-\zeta^2}}}$

$M_{pt}=1+\sigma$

**百分比超调量**：$P.O.=100e^{-\frac{\zeta\pi}{\sqrt{1-\zeta^2}}}(\%)$ 

#### 6、衰减比

$\eta=(M_{pt}-fv):(M_3-fv)$

### (三) 附加零极点的影响

#### 1、附加极点

第三个极点是稳定的负实极点，它使系统的响应
更加平缓，响应速度减慢，超调量减小，过渡过
程时间延长  

当$|1/\gamma|≥10|\zeta\omega_n|$时，共轭复极点的实部小于负实
极点实部的1/10，共轭复极点是一对主导极点 ,  三阶系统可近似为二阶系统  

#### 2、二阶最佳系统

$\zeta=\frac{\sqrt{2}}{2}$

#### 3、附加零点

当$a>>\zeta\omega_n$对阶跃响应影响不大

## 二、性能准则

**误差绝对值积分**：$IAE=\int ^T_0|e(t)|dt$

**时间加权误差绝对值积分**：$ITAE=\int^T_0t|e(t)|dt$ 

**时间加权误差平方积分**：$ITSE=\int^T_0te^2(t)dt$

## 三、Matlab实现

### (一)单位阶跃响应

#### 1、传递函数系统的单位阶跃响应

使用命令：

```matlab
c=step(num,den,t)
```

或者

```matlab
[y,x,t]=step(num,den,t)
plot(t,y)
```

示例：

对$G(s)=\frac{25}{s^2+4s+25}$

```matlab
%G(s)=25/(s^2+4s+25)的阶跃响应
num=[25];
den=[1 4 25];
t=0:0.01:3;
[y,x,t]=step(num,den,t);
plot(t,y);
grid
title('Unit-Step Response of G(s)=25/(s^2+4s+25)')
xlabel('t Sec')
ylabel('Output')
```

![](/assets/images/control_system/response/1.jpg)  

#### 2、绘制单位阶跃响应曲线的三维图

考虑$\frac{C(s)}{R(s)}=\frac{1}{s^2+2\zeta s+1}$ 当$\zeta$取0，0.2，0.4，0.6，0.8，1.0时的单位阶跃响应曲线及其三维图

```matlab
%1/(s^2+2ζ*s+1)在ζ取0，0.2，0.4，0.6，0.8，1.0时的单位阶跃响应曲线及其三维图
t=0:0.2:10;
zeta=[0 0.2 0.4 0.6 0.8 1];
for n=1:6;
    num=[1];
    den=[1 2*zeta(n) 1];
    [y(1:51,n),x,t]=step(num,den,t);
end

%绘制二维曲线
plot(t,y)
grid
title('Plot of Unit-Step Response Curves with \omega_n and \zeta = 0, 0.2, 0.4, 0.6, 0.8, 1')
xlabel('t (sec)')
ylabel('Response')
text(4.1,1.86,'\zeta=0')
text(3.5,1.5,'0.2')
text(3.5,1.24,'0.4')
text(3.5,1.08,'0.6')
text(3.5,0.95,'0.8')
text(3.5,0.86,'1.0')

%绘制三维曲面
mesh(t,zeta,y')
title('Three-Dimensional Plot of Unit-Step Response Curves')
xlabel('t Sec')
ylabel('\zeta')
zlabel('Reasponse')
```

![](/assets/images/control_system/response/2.jpg)

![](/assets/images/control_system/response/3.jpg)

#### 3、求上升时间、峰值时间、最大过调量和调整时间

考虑$\frac{C(s)}{R(s)}=\frac{1}{s^2+2\zeta s+1}$

 ```matlab
%1/(s^2+2ζ*s+1)瞬态响应的指标
num=[25];
den=[1 6 25];
t=0:0.005:5;
[y,x,t]=step(num,den,t);
r=1;while y(r)<num(end)/den(end)+0.0001;r=r+1;end;
rise_time=(r-1)*0.005%上升时间
[ymax,tp]=max(y);
peak_time=(tp-1)*0.005%峰值时间
max_overshoot=ymax-num(end)/den(end)%最大过调量
s=1001;while y(s)>num(end)/den(end)-0.02 & y(s)<num(end)/den(end)+0.02;s=s-1;end;
settling_time=(s-1)*0.005%调整时间
 ```

### (二)脉冲响应

可使用下列命令的一个：

```matlab
impulse(num,den)
impulse(A,B,C,D)
[y,x,t]=impulse(num,den)
[y,x,t]=impulse(num,den,t)
[y,x,t]=impulse(A,B,C,D)
[y,x,t]=impulse(A,B,C,D,u)
[y,x,t]=impulse(A,B,C,D,iu,t)
```

示例：

对于$G(s)=\frac{1}{s^2+0.2s+1}$ 

```matlab
%G(s)=1/(s^2+0.2s+1)的脉冲响应
num=[1];
den=[1 0.2 1];
impulse(num,den);
grid
title('Unit-impulse Response of G(s)=1/(s^2+0.2s+1)')
```

![](/assets/images/control_system/response/4.jpg)

### (三)斜坡响应

#### 1、传递函数表示

考虑$G(s)=\frac{C(s)}{R(S)}=\frac{2s+1}{s^2+s+1}$，对于单位斜坡输入量$R(s)=\frac{1}{s^2}$，有$C(s)=\frac{2s+1}{(s^2+s+1)s}$，因此：

```matlab
%Unit-Ramp response
num=[2 1]
den=[1 1 1]
den(end+1)=0
t=0:0.1:10
c=step(num,den,t);
plot(t,c,'o',t,t,'-')
grid
title('Unit-Ramp Response Curve for System G(s)=(2s+1)/(s^2+s+1)')
xlabel('t Sec')
ylabel('Input and Output')
```

![](/assets/images/control_system/response/5.jpg)

#### 2、状态空间表示

系统的状态空间表示方程：

$\dot{\boldsymbol{x}}=\boldsymbol{Ax}+\boldsymbol{Bu}\\\\ \boldsymbol{y}=\boldsymbol{Cx}+\boldsymbol{Du}$  

取

$\boldsymbol{A}=\begin{bmatrix}0 & 1\\\\ -1&-1\end{bmatrix}, \boldsymbol{B}=\begin{bmatrix}0\\\\ 1\end{bmatrix}, \boldsymbol{x}(0)=\boldsymbol{0}\\ \boldsymbol{C}=\begin{bmatrix}1& 0\end{bmatrix}, \boldsymbol{D}=\begin{bmatrix}0\end{bmatrix}$  

由于斜坡响应可表示为$z=\int_0^tydt$，定义$z=x_3$ ，则有$\dot{x_3}=\dot{z}=y=x_1$

可得新的状态空间方程：

$\begin{bmatrix}\dot{x_1}\\\\\dot{x_2}\\\\\dot{x_3}\end{bmatrix}=\begin{bmatrix}0&1&0\\\\ -1&-1&0\\\\ 1&0&0\end{bmatrix}\begin{bmatrix}x_1\\\\ x_2\\\\ x_3\end{bmatrix}+\begin{bmatrix}0\\\\ 1\\\\ 0\end{bmatrix}u\\ z=\begin{bmatrix}0&0&1\end{bmatrix}\begin{bmatrix}x_1\\\\ x_2\\\\ x_3\end{bmatrix}$ 

```matlab
%Unit-Ramp response
A=[0,1;-1,-1];
B=[0;1];
C=[1,0];
D=[0];
AA=[A zeros(2,1);C 0];
BB=[B;0];
CC=[0 0 1];
DD=[0];

[z,x,t]=step(AA,BB,CC,DD);
x3=[0,0,1]*x';
plot(t,x3,'o',t,t,'-')
grid
title('Unit-Ramp Response')
xlabel('t Sec')
ylabel('Input and Output')
```

![](/assets/images/control_system/response/6.jpg)

### (四)对任意信号的响应

对任意信号的响应可以应用命令lsim:

```matlab
lsim(num,den,r,t)
lsim(A,C,B,D,u,t)
y=lsim(num,den,r,t)
y=lsim(A,C,B,D,u,t)
```

示例：

* 求$G(s)=\frac{2s+1}{s^2+s+1}$的单位斜坡响应

```matlab
%求G(s)=(2s+1)/(s^2+s+1)的单位斜坡响应
num=[2 1];
den=[2 1 1];
t=0:0.01:10;
r=t;
y=lsim(num,den,r,t);
plot(t,y,'o',t,r,'-')
grid
title('Unit-Ramp Response')
xlabel('t Sec')
ylabel('Unit-Ramp input and System Output')
text(6.3,4.6,'Unit-Ramp Input')
text(4.75,9.0,'Output');
```

![](/assets/images/control_system/response/7.jpg)

* 求下述系统：

$\begin{bmatrix}\dot{x_1}\\\\\dot{x_2}\end{bmatrix}=\begin{bmatrix}-1&0.5\\\\ -1&0\end{bmatrix}\begin{bmatrix}x_1\\\\ x_2\end{bmatrix}+\begin{bmatrix}0\\\\ 1\end{bmatrix}u\\\\ y=\begin{bmatrix}1&0\end{bmatrix}\begin{bmatrix}x_1\\\\ x_2\end{bmatrix}$

输入$u=e^{-t}$时的响应

```matlab
%求任意输入的响应
A=[-1 0.5;-1,0];
B=[0;1];
C=[1 0]
D=[0]
t=0:0.01:12;
u=exp(-t);
y=lsim(A,B,C,D,u,t);
plot(t,y,'o',t,u,'-')
grid
title('Response')
xlabel('t Sec')
ylabel('input and System Output')
text(6.3,4.6,'Input')
text(4.75,9.0,'Output');
```

![](/assets/images/control_system/response/8.jpg)

