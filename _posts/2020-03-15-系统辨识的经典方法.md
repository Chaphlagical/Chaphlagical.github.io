---
title: 系统辨识的经典方法
tags: 系统辨识
article_header:
  type: cover
  image:
    src: /assets/images/SI.jpg
---

<!--more-->

## 一、阶跃响应法SI

### (一) 基本原理

当在辨识对象上施加一个阶跃扰动信号，然后测得对象的响应随时间变化的曲线，根据此，通过图解法（并非寻求解析公式的方法）来求出被辨识对象的传递函数（数学模型），称之为阶跃响应法SI。  

求解步骤：

* 实验测取系统阶跃响应（Step Response）  
	* 通过操作使系统工作在所需测试的负荷下，稳定运
		行一段时间后，快速改变系统的输入量，并用数据采集
		系统同时记录下系统的输入、输出的变化曲线，经过一
		段时间后，系统进入新的稳态，实验就可结束，得到系
		统的阶跃响应曲线。  
* 由阶跃响应，求系统的传递函数  
	* 几乎所有的方法都是在假定传函结构已知的情况下，通过图解和计算的方法，利用响应曲线上少量特征参数则可推算出传递函数的参数  

### (二) 近似法求一阶惯性环节系统的参数

一阶系统的传递函数为：
$$
G(s)=\frac{K}{Ts+1}
$$
<img src="/assets/images/系统辨识的经典方法.assets/image-20200310162101642.png" alt="image-20200310162101642" style="zoom: 80%;" />



若阶跃响应曲线在输入发生跃变的时刻，其斜率不为零而为最大值，然后逐渐上升到稳态值，如上图所示  

我们要辨识的参数为$K$和$T$，后者称为时间常数。  

当被识对象被阶跃信号激励时，此时$R(s)=\frac{K}{s}$，则
$$
Y(s)=\frac{K}{s(Ts+1)}=K(\frac{1}{s}-\frac{T}{Ts+1})
$$
进行拉氏反变换得
$$
y(t)=K(1-e^{-\frac{1}{T}t})
$$
单位阶跃响应曲线是一条单调上升的指数曲线，其终值为$K$

当$t=T$时，$y(T)=K(1-e^{-1})=0.632K$

故阶跃响应曲线$y(t)$达到其终值63.2%的时间，就是系统的时间常数$T  $

还有一种求$T$的方法，我们发现在$t=0$点处，曲线$y(t)$的斜率为
$$
\frac{dy(t)}{dt}\Bigg|_{t=0}=\frac{K}{T}e^{-\frac{t}{T}}\Bigg|_{t=0}=\frac{K}{T}
$$
那么如果已知了$K$，又从图中计算出斜率，就可以推算时间常数$T  $

类似的，当$t=2T$时，代入，知
$$
y(2T)=K(1-e^{-2})=0.87K
$$
当$t=T/2$时，代入，知$y(T/2)=K(1-e^{-1/2})=0.39K$

### (三) 近似法求带滞后的一阶惯性环节系统的参数

系统得传递函数为
$$
G(s)=\frac{K}{1+Ts}e^{-\tau s}
$$
![image-20200310162757854](/assets/images/系统辨识的经典方法.assets/image-20200310162757854.png)

我们要辨识的参数为$K$、$T$和$\tau$

对K的求取和前面相同，即$K=y(\infin)$ 

应用图解法（Graphic Interpretation）求解$T$、$\tau$ 

可通过响应曲线的拐点P作切线LPM。切线与时间轴交于L点，与稳态值的渐近线交与M点。

$\overline{OL}$即为该对象的纯滞后时间$\tau$  。

切线LPM在时间轴上的投影即为时间常数$T$。

将$y(t)$修改成对其稳态值 的相对值y0(t)，这样可近似地认为
$$
y_0(t)=\begin{cases}0&t<\tau\\ 1-e^{-\frac{t-\tau}{T}}&t\geq \tau \end{cases}
$$
在响应曲线上选择不同时刻$t_1$和$t_2$的$y_0(t)$的值，则有  
$$
y_0(t_1)=1-e^\frac{t_1-\tau}{T}\\
y_0(t_2)=1-e^\frac{t_2-\tau}{T}
$$
联立求解上述方程组，可求得$T$和$\tau$ 

### (四) 用Laplace变换法求被辨识系统的传递函数

若阶跃响应出现不规则的形状时，上述方法不再适用。就需选择Laplace变换
法（根据终值定理，利用阶跃数据，求传递函数）  

![image-20200310163247405](/assets/images/系统辨识的经典方法.assets/image-20200310163247405.png)

设传递函数的表达式为：  
$$
G(s)=\frac{C(s)}{R(s)}=\frac{b_ms^m+b_{m-1}s^{m-1}+\cdots+b_1s+b_0}{a_ns^n+a_{n-1}s^{n-1}+\cdots+a_1s+1}
$$
则$K_0=\lim\limits_{t\rightarrow \infin}y(t)=\lim\limits_{s\rightarrow \infin}sY(s)$

注意到考察的是阶跃响应的$y(t)$，而  
$$
Y(s)=G(s)\frac{1}{s}
$$
故
$$
K_0=\lim\limits_{s\rightarrow 0 }G(s)=b_0
$$
定义：
$$
g_1(t)=\int^t_0[K_0-g(\tau)]d\tau
$$
则
$$
L[g_1(t)]=\frac{1}{s}[K_0-G(s)]=G_1(s)
$$
那么
$$
K_1=\lim\limits_{t\rightarrow \infin}y_1(t)=\lim\limits_{s\rightarrow 0 }G_1(s)=K_0a_1-b_1
$$
同理，

定义：
$$
g_2(t)=\int^t_0[K_1-g(\tau)]d\tau
$$
则
$$
L[g_2(t)]=\frac{1}{s}[K_1-G_1(s)]=G_2(s)
$$
那么
$$
K_2=\lim\limits_{t\rightarrow \infin}g_2(t)=\lim\limits_{s\rightarrow 0 }G_2(s)=K_1a_1-K_0a_2+b_2
$$
以此类推，得
$$
K_r=\lim\limits_{t\rightarrow \infin}g_r(t)=\lim\limits_{s\rightarrow 0 }G_r(s)=(-1)^rb_r+K_{r-1}a_1-K_{r-2}a_2+\cdots+(-1)^{r-1}K_0a_r
$$
联立上述几式，构成一个线性方程组  

也就是说，$b_0,b_1,\cdots,b_m$和$a_1,\cdots,a_n$为待定参数；$K_r$，$r=1,2,\cdots,n+m$分别是$g(t)$,$g_r(t)$的稳态值。当系统阶次较低时，可求取系统的传递函数  

## 二、频率响应法

**定义：**频率特性又称频率响应，它是系统（或元件）对不同频率正弦输入信号的响应特性。

**结论：**设线性系统的输入为一频率为w的正弦信号，在稳态时，系统的输出具有和输入相同频率的正弦函数  

**证明：**

设线性系统的传递函数为$\frac{C(s)}{R(s)}=G(s)=\frac{U(s)}{V(s)}$，已知输入为$r(t)=A\sin\omega t$，则
$$
R(s)=\frac{A\omega}{s^2+\omega^2}
$$
则
$$
\begin{align}
C(s)&=\frac{U(s)}{V(s)}\frac{A\omega}{s^2+\omega^2}\\
&=\frac{U(s)}{(s+p_1)(s+p_2)\cdots(s+p_n)}\frac{A\omega}{s^2+\omega^2}
\end{align}
$$


其中$-p_1,-p_2,\cdots,-p_n$为$G(s)$的极点，对于稳定系统，这些极点都位于$S$的左半平面，即$\Re[-p_i]<0$ 

改写上式，则
$$
C(s)=\frac{a}{s+j\omega}+\frac{\overline{a}}{s-j\omega}+\sum\limits^n_{i=1}\frac{b_i}{s+p_i}
$$
取拉氏反变换
$$
c(t)=ae^{-j\omega t}+\overline{a}e^{j\omega t}+\sum\limits^n_{i=1}b_i e^{-p_i t}
$$

当$t\rightarrow\infty$时，系统响应的瞬态分量为$\sum\limits^n_{i=1}b_ie^{pt_1}\rightarrow 0$

则稳态分量为$c(t)=ae^{-j\omega t}+\overline{a}e^{j\omega t}$

应用留数定理，
$$
Res[C(s),-j\omega]=\frac{G(s)A\omega}{(s^2+\omega^2)'}e^{st}\Bigg|_{s=-j\omega}=G(-j\omega)\frac{A\omega}{-2j\omega}e^{-j\omega t}
$$

$$
Res[C(s),j\omega]=\frac{G(s)A\omega}{(s^2+\omega^2)'}e^{st}\Bigg|_{s=j\omega}=G(j\omega)\frac{A\omega}{2j\omega}e^{j\omega t}
$$

因此
$$
\begin{cases}
a=G(-j\omega)\frac{-A}{2j}\\
\overline{a}=G(j\omega)\frac{A}{2j}
\end{cases}
$$
由于$G(j\omega)$为一个复数矢量，可表示为
$$
G(j\omega)=P(\omega)+jQ(\omega)=|G(j\omega)|e^{j\varphi(\omega)}
$$
则$|G(j\omega)|=\sqrt{P^2(\omega)+Q^2(\omega)}$，$\varphi(\omega)=\arctan\frac{P(\omega)}{Q(\omega)}$

显然，$P(\omega)$和$|G(\omega)|$为$\omega$的偶函数，$Q(\omega)$和$\varphi(\omega)$为$\omega$的奇函数

故$G(-j\omega)$和$G(j\omega)$互为共轭复数，$G(-j\omega)=|G(j\omega)|e^{-j\varphi(\omega)}$

代入$c(t)$的表达式，则
$$
\begin{align}
c(t)&=A|G(j\omega)|\frac{-e^{j[\omega t+\varphi(\omega)]+e^{j[\omega t+\varphi(\omega)]}}}{2j}\\
&=A|G(j\omega)|\sin[\omega t+\varphi(\omega)]
\end{align}
$$
证明了线性系统稳态输出是和输入具有相同频率的正弦信号，其输出和输入的幅值比为$|G(j\omega)|$，输入与输出的相位差为$\varphi(\omega)=\arg G(j\omega)=\angle{G(j\omega)}$  

但一般系统收到的输入信号不一定是正弦信号时，则可通过傅里叶级数展开可知，当信号是周期变化时，可以采用Fourier级数，将它展开成许多不同频率的正弦函数之和，即
$$
f(x)=\frac{a_0}{2}+\sum\limits_{n=1}^{\infty}(a_n\cos nx+b_n\sin nx)
$$
其中，
$$
a_n=\frac{1}{\pi}\int^\pi_{-\pi}f(x)\cos nxdx\\
b_n=\frac{1}{\pi}\int^\pi_{-\pi}f(x)\sin nx dx
$$
当输入信号是非周期函数时，可以用Fourier积分，将其表示成具有连续频谱的正弦信号的作用之和，再考
虑线性系统叠加原理，故频率响应同样可以用于研究非周期信号  
$$
\int^t_{-\infty}x(t)dt\rightarrow \frac{1}{j2\pi f}\cdot X(f)
$$
当系统的传递函数无法由分析获得时，可以实验来得到系统的频率响应。例如，在输入端加不同$\omega $的正弦信号，测量系统稳态输出正弦信号的幅值比和相位差，可得到频响  

当系统不稳定时，由于瞬态分量不能衰减而扩散，用实验求取是不可能了，但要强调的是，它的稳态分量仍旧是正弦的，仅仅是由于瞬态分量的扩散而观察不到稳态分量而已。而频率响应的概念，对不稳定的系统同样是适用的  

系统的频率响应$G(j\omega) $的解析式往往是很难找到的，对于一个稳定的过程来说，通常可以根据实验数据推算出它的频率响应曲线  

若被辨识对象的动态响应用频率响应描述时，一般表达为  
$$
G(j\omega)=\frac{Y(s)}{U(s)}\Bigg|_{s=j\omega}=\frac{Y(j\omega)}{U(j\omega)}
$$
其中，$Y(j\omega) $是被辨识对象输出量的Fourier变换，$U(j\omega)$是被辨识对象输入量的Fourier变换  

若输入信号为正弦量$u(t)=U_0\sin(\omega t+\theta_1)$，表示当被辨识对象的输入端加入一个频率为$w$，幅度为U0，相位为的正弦信号$u(t)$，可得到对象的稳态响应为  
$$
y(t)=Y_0\sin(\omega t+\theta_2)=U_0A(\omega)\sin(\omega t+\theta_2)
$$
即对象的输出信号$y(t)$将以同样的频率$\omega$ 作正弦波变动，其幅度为$Y_0=U_0A(\omega)$，相位为$\theta_2$

其输出幅度与输入幅度比$A(\omega)=\frac{Y_0}{U_0}$也是随频率而变的，称为幅频特性；输出相位与输入相位之差$\varphi(\omega)=\theta_2-\theta_1$也是随频率而变的，称为相频特性  

因此，频率响应$G(j\omega)$与幅频特性$A(\omega) $和相频特性$\varphi(\omega)$的关系可描述为：
$$
G(j\omega)=A(\omega)e^{j\varphi(\omega)}
$$

$$
\begin{align}
Y(j\omega)&=\int^\infty_0y(t)e^{-j\omega t}dt=\int^\infty_0U_0A(\omega)\sin[\omega t+\varphi(\omega)+\theta_1](\cos\omega t-j\sin\omega t)dt\\
&=\int^\infty_0 U_0A(\omega)\sin[\omega t+\varphi(\omega)+\theta_1]\cos\omega t dt-j\int^\infty_0U_0A(\omega) \sin[\omega t+\varphi(\omega)+\theta_1]\sin\omega tdt\\
&=Re(\omega)+jIm(\omega)
\end{align}
$$

$Re(\omega)$称为实频特性，$Im(\omega)$称为虚频特性

由上述关系，对输出信号$y(t)$用频率为$\omega$的信号进行调制，然后在整个时间区间上积分，就可得到实频特性$Re(\omega) $ 和虚频特性$Im(\omega)$ ，再通过运算，就可得到对象传递函数的幅频特性$A(\omega)$和相频特性$\varphi(\omega)$   

工程上常采用的最简单方法是直接曲线记录法：在对象的输入端施加一个正弦波激励信号，然后用记录设备同时记录对象的输入和输出，每次用一个不同频率的正弦波测试，重复多次  

对这些数据进行处理，将每个频率下的输出和输入的振幅计算出来，并求出此值；这就是频率特性上在该频率下的幅值。将每个频率下的输出和输入相位差计算出来，这就是频率特性上在该频率下的相位。最后，将其幅值及相位按所需坐标绘制成图，即为该对象的频率特性  

### 实验测取频率响应

**一阶环节或一阶滞后环节**

<img src="/assets/images/系统辨识的经典方法.assets/image-20200315100826076.png" alt="image-20200315100826076" style="zoom:50%;" />
$$
\begin{align}
G(s)&=\frac{K}{Ts+1}\\
G(s)&=\frac{K}{Ts+1}\exp(-\tau s)
\end{align}
$$
其中，
$$
K=10^{\frac{b}{20}},T=\frac{1}{\omega_c},\varphi'=-\arctan(\omega T),\tau=\frac{1}{n}\sum\limits^n_i\frac{\varphi_i-\varphi_i'}{\omega_i}
$$

### 由频率响应法求系统传递函数

线性动态系统的传函可以写成以频率为自变量的多项式之比。设待求传递函数$G(j\omega)$可写为  
$$
G(j\omega)=\frac{B(j\omega)}{A(j\omega)}=\frac{b_0+b_1(j\omega)+b_2(j\omega)^2+\cdots+b_{n_b}(j\omega)^{n_b}}{1+a_1(j\omega)+a_2(j\omega)^2+\cdots+a_{n_a}(j\omega)^{n_a}},n_a\geq n_b
$$
辨识的目的，即估算传递函数的待定系数$a_i$，$b_i$，使频率响应$G(j\omega)$与实验数据之间的误差平方最小。 曲
线在每一选定频率$\omega_k$时，实测频率响应曲线$G'(j\omega)$与求得的传递函数$G(j\omega)=\frac{B(j\omega)}{A(j\omega)}$的误差为   
$$
\varepsilon_k=G'(j\omega)-\frac{B(j\omega)}{A(j\omega)}
$$
定义$E(j\omega)$为全部采样频率$\omega_k$上误差$\varepsilon_k$的平方和，即
$$
E(j\omega)=\sum\limits_{k=0}^l\varepsilon_k^2
$$
进一步定义一个广义误差$e_k$，为
$$
e_k=\varepsilon_k A(j\omega_k)=G'(j\omega_k)A(j\omega_k)-B(j\omega_k)=e_{ik}+je_{jk}
$$
令$G'(j\omega)$也为复数形式：
$$
G'(j\omega_k)=R(\omega_k)+jI(\omega_k)
$$
则广义误差表示为
$$
e_k=[R(\omega_k)+jI(\omega_k)][1+\sum\limits^{n_a}_{i=1}a_i(j\omega)^i]-\sum\limits^{n_b}_{i=0}b_i(j\omega)^i
$$
其中，
$$
\begin{align}
e_{ik}=&-b_0+\omega_k^2b_2-\omega_k^4b_4+\cdots\\
&-\omega_kI(\omega_k)a_1-\omega_k^2R(\omega_k)a_2+\omega_k^3I(\omega_k)a_3+\omega_k^4I(\omega_k)a_4-\cdots+R(\omega_k)\\
e_{jk}=&-\omega_kb_0+\omega_kb_1+\cdots+\\
&\omega_kR(\omega_k)a_1-\omega_k^2I(\omega_k)a_2+\omega_k^3R(\omega_k)a_3+\omega_k^4I(\omega_k)a_4+\cdots+I(\omega_k)
\end{align}
$$
定义误差准则$J$为全部采样$\omega$上误差$e_k$的平方和，即  
$$
J=\sum\limits^N_{k=1}e_k^2=\sum\limits_{k=1}^N(e_{ik}^2+e_{jk}^2)
$$
若极小化上式误差准则$J$，即对$a_i$及$b_i$分别求偏导，则
$$
\begin{cases}
\frac{\partial J}{\partial a_i}=\sum\limits^N_{k=1}[2e_{ik}(\frac{\partial e_{ik}}{\partial a_i})+2e_{jk}(\frac{\partial e_{jk}}{\partial a_i})]=0&i=1,2,\cdots,n_a\\
\frac{\partial J}{\partial b_i}=\sum\limits^N_{k=1}[2e_{ik}(\frac{\partial e_{ik}}{\partial b_i})+2e_{jk}(\frac{\partial e_{jk}}{\partial b_i})]=0&i=1,2,\cdots,n_b
\end{cases}
$$
可以得到$n_a+n_b+1$个式子，为简化表达式，定义下列元素
$$
\begin{cases}
V_i=\sum\limits^N_{k=0}\omega_k^i\\
T_i=\sum\limits^N_{k=0}\omega_k^iI(\omega_k)\\
S_i=\sum\limits^N_{i=0}\omega_k^iR(\omega_k)\\
U_i=\sum\limits^N_{k=0}\omega_k^i[R(\omega_k)^2+I(\omega_k)^2]
\end{cases}
$$
由求偏导得出的方差组可列写成如下形式：
$$
\boldsymbol P \boldsymbol X=\boldsymbol Q\\
\begin{align}
\boldsymbol X&=\begin{bmatrix}b_0&b_1&\cdots&b_{n_b}&a_1&a_2&\cdots&a_{n_a} \end{bmatrix}\\
\boldsymbol Q&=\begin{bmatrix}S_0&T_1&S_2&T_3&\cdots&0&U_2&0&\cdots\end{bmatrix}\\
\boldsymbol P&=\begin{bmatrix}
V_0&0&-V_2&0&\cdots&T_1&S_2&-T_3&-S_4&\cdots\\
0&V_2&0&-V_4&\cdots&-S_2&T_3&S_4&T_5&\cdots\\
V_2&0&-V_4&0&\cdots&T_3&S_4&-T_5&-S_6&\cdots\\
0&V_4&0&-V_6&\cdots&-S_4&T_5&S_6&T_7&\cdots\\
&&&&&\vdots\\
T_1&-S_2&-T_3&S_4&\cdots&U_2&0&-U_4&0&\cdots\\
S_2&T_3&-S_4&-T_5&\cdots&0&U_4&0&-U_6&\cdots\\
T_3&-S_4&-T_5&S_6&\cdots&U_4&0&-U_6&0&\cdots
\end{bmatrix}
\end{align}
$$
联立求解上述方程组，即可求得$a_i$和$b_j$系数

频率响应法SI能直接从实测频响曲线$G'(j\omega)$ 拟合出传递函数。因为求解一组代数方程，肯定有解  

其局限性是：

* 方法是建立在对系数逐项求导的基础上，所以计算比较繁琐
* 必须预先知道传递函数的阶次，或对阶次事先做一定估计
* 当$\omega_k $的范围延伸到好几十倍频时，$\boldsymbol P$中所含低频成分元素就会变得很小，使低频段不能得到很好的拟
	合  

## 三、相关分析法

* 经典的线性系统辨识方法
	* 阶跃响应法、频率响应法、相关分析法	
	* 得到系统的非参数模型，进而估计参数模型
* 前两个经典方法的局限性
	* 只适用于某些特殊对象或者低阶简单系统
	* 参数估计的精度有限，估计方法缺乏一般性
* 相关分析法的重要性
	* 设计随机输入的方法也适用于近代辨识方法
	* 强调抗扰性  

采用相关分析法获得被辨识系统的脉冲响应函数是在线辨识非参数模型的一种有效方法，其主要特点是：
辨识过程可以在被辨识系统正常运行状态下进行，且应用白噪声作激励信号，其激励幅值不需很大，所以对系
统正常运行状态影响不大，当过程存在噪声干扰时，只要输入激励信号与干扰噪声是独立统计的，辨识过程就
可不受干扰噪声的影响。另外，相关分析法不需要被辨识系统的验前知识。故利用相关分析法辨识过程的脉冲
响应可以收到满意的效果  

### 基本原理

<img src="/assets/images/系统辨识的经典方法.assets/image-20200315160220334.png" alt="image-20200315160220334" style="zoom:50%;" />

* $u(t)$为被辨识系统的输入激励信号；
* $Y(t)$为被辨识系统的实际输出信号；
* $z(t)$为含有噪声的系统输出量测信号；
* $v(t)$为均值为零的量测噪声  

辨识要解决的问题是：从$u(t)$，$y(t)$估计$g(t)  $

根据卷积定理，若起始条件为零，输出$y(t)$和输入$u(t)$之间，有下列卷积关系：
$$
y(t)=\int^\infty_0g(\lambda)u(t-\lambda)d\lambda\\
z(t)=y(t)+v(t)
$$
这里， 为被辨识对象的脉冲响应函数（也就是传递函数$G(s)$的拉式反变换，也称权函数），由于被辨识系统的输出$z(t)$受到观测噪声$v(t)$的污染，有  
$$
z(t)=y(t)+v(t)=\int^\infty_0g(\lambda)u(t-\lambda)d\lambda+v(t)
$$
以$u(t-\tau)$乘以上式左右两边，再取数学期望，有  
$$
\begin{align}
&\lim\limits_{T\rightarrow\infty}\frac{1}{T}\int^T_0z(t)u(t-\tau)dt\\
=&\int^\infty_0g(\lambda)d\lambda[\lim\limits_{T\rightarrow\infty}\frac{1}{T}\int^T_0u(t-\lambda)u(t-\tau)dt]+\lim\limits_{T\rightarrow\infty}\frac{1}{T}\int^T_0v(t)u(t-\tau)dt
\end{align}
$$
输入量$u(t)$的自相关函数$R_{uu}(\tau)$为  
$$
R_{uu}(\tau)=\lim\limits_{T\rightarrow\infty}\frac{1}{T}\int^T_0u(t)u(t-\tau)dt
$$
则原式写为
$$
R_{uz}(\tau)=\int^\infty_0g(\lambda)R_{uu}(\tau-\lambda)d\lambda
$$
或
$$
R_{uz}(\tau)=\int^\infty_0g(\lambda)R_{uu}(\lambda-\tau)d\tau
$$
这就是著名的Wiener-Hopf方程。将该式与卷积分式相比较，可以看出：一个具有脉冲响应函数为$g(t)$的被识对象，如果其输入量是信号$u(t)$的自相关函数$R_{uu}(\tau )$，则其响应就等于输入信号$u(t)$与相应的输出量测信号$z(t)$之间的互相关函数$R_{uz}(\tau)$，其对应关系如下图所示

<img src="/assets/images/系统辨识的经典方法.assets/image-20200315161238265.png" alt="image-20200315161238265" style="zoom:50%;" />

由此可见，在应用相关分析法求解被识对象的脉冲响应函数，关键在于如何求出$R_{uu}(\tau)$和$R_{uz}(\tau) $，然后可通过求解卷积方程，便有可能获得被识对象的脉冲响应函数  

一般情况下，求解Wiener-Hopf方程是比较困难的。但是当我们注意到，当被识对象的输入信号采用白噪声，方程就容易求解了。因为白噪声的自相关函数是一个Derac函数，即
$$
R_{uu}(\tau)=\sigma_u^2\delta(\tau)
$$
表示一个函数与Derac函数的卷积就是函数本身，则
$$
R_{uz}(\tau)=\int^\infty_0g(\lambda)\sigma_u^2\delta(\tau-\lambda)d\lambda=\sigma^2_ug(\tau)
$$
该式表明，当输入测试信号为白噪声时，输入信号与输出量测信号之间的互相关函数与脉冲响应函数成比例，或
$$
g(\tau)=\frac{1}{\sigma^2_u}R_{uz}(\tau)
$$
即被识对象输入为白噪声测试信号时，只要测出输入信号与输出信号间的互相关函数，便可求出被识对象的脉冲响应函数$g(\tau)$。

必须注意到：采用相关分析法辨识对象有一个显著的优点，即
$$
\begin{align}
R_{uy}(\tau)&=\lim\limits_{T\rightarrow\infty}\frac{1}{T}\int^T_0y(t)u(t-\tau)dt\\
&=\lim\limits_{T\rightarrow\infty}\frac{1}{T}\int^T_0[z(t)-v(t)]u(t-\tau)dt\\
&=\lim\limits_{T\rightarrow\infty}\frac{1}{T}\int^T_0z(t)u(t-\tau)dt-\lim\limits_{T\rightarrow\infty}\frac{1}{T}\int^T_0v(t)u(t-\tau)dt\\
&=R_{uz}(\tau)-R_{uv}(\tau)
\end{align}
$$
若输入量$u(t)$和观测噪声$v(t)$相互独立，则有  
$$
R_{uv}(\tau)=\lim\limits_{T\rightarrow\infty}\frac{1}{T}\int^T_0v(t)u(t-\tau)dt=0
$$
有等价关系：
$$
R_{uy}(\tau)=R_{uz}(\tau)
$$
通过相关分析，所得到的量测信号$z(t)$与输入信号$u(t)$之间的互相关函数$R_{uz}(\tau) $ ，在一定条件下，等价于系
统输出$y(t)$与输入$u(t)$之间的互相关函数$R_{uy}(\tau) $。表明，相关分析法有滤波的作用--若存在随机干扰，只要选择
与干扰互不相关的输入测试信号，就可以克服随机干扰的影响  

由于白噪声的整个能量分布在一个很广的频率范围内，激励信号的幅值不需要很大，因此，不会使被识对象过分地偏离正常运行状态（不会使之进入非线性区）  

所以，白噪声作为输入激励信号对正常运行状态的影响不是很大

* 只要输入激励信号与干扰噪声是统计独立的，辨识工作就可以不受干扰噪声的影响
* 相关分析方法不需要有关于被辨识对象的验前知识（频率响应法需要估计系统的阶次）  

然而，当利用白噪声作为测试信号时，为了准确地测出互相关函数，必须在较长的时间内进行积分。从理论上讲，这个时间应当趋于无穷大，这显然是不实用的。

上述理论上所提出的“白噪声”，也是理论的抽象，它在工程上是不易实现的。因此，工程上常常采用易于实现的M序列作为辨识输入信号，它具有近似白噪声的性质  

据学过的知识，M序列是周期$T_p=N_p\Delta t $，自相关函数近似于$\delta$函数的一种随机干扰序列，其统计性质
近似于白噪声，若选择$N_p$使M序列的循环周期大于过渡过程时间，即  
$$
(N_p-1)\Delta t>T
$$
这里，$T$是被识对象的过渡过程时间。不等式表明，被识对象的脉冲响应函数$g(t)$在时间$(N_p-1)\Delta t$内已完
全衰减  

设对于被辨识对象的输入输出信号进行采样的周期$T_0$等于产生M序列的时钟脉冲的周期$\Delta t$，为书写简单，令$\Delta t=1 s$ 

在离散时间情况下，考虑上述假定，令
$$
\tau=m\Delta t=m\\
t=k\Delta t=k\\
\lambda=j\Delta t=j
$$
那么，Wiener-Hopf方程的离散形式为
$$
R_{uz}(m)=\sum\limits^{N_p-1}_{j=0}g(j)R_{uu}(m-j)
$$
其中，
$$
R_{uz}(m)=\frac{1}{N_p}\sum\limits_{k=0}^{N_p-1}u(k-m)z(k)\\
R_{uu}(m-j)=\frac{1}{N_p}\sum\limits_{k=0}^{N_p-1}u(k-m)u(k-j)
$$
又由前面的知识，M序列的自相关函数为  
$$
R_{uu}(m-j)=
\begin{cases}
a^2&m-j=0\\
-\frac{a^2}{N_p}&1\leq (m-j)\leq N_p-1
\end{cases}
$$
代入原式有
$$
\begin{align}
R_{uz}(m)&=\sum\limits^{N_p-1}_{j=0}g(j)R_{uu}(m-j)\\
&=a^2g(m)-\frac{a^2}{N_p}[\sum\limits^{m-1}_{j=0}g(j)+\sum\limits^{N_p}_{j=m+1}g(j)]\\
&=a^2g(m)+\frac{a^2}{N_p}g(m)-\frac{a^2}{N_p}\sum\limits^{N_p-1}_{j=0}g(j)\\
&=\frac{N_p+1}{N_p}a^2g(m)-\frac{a^2}{N_p}\sum\limits^{N_p-1}_{j=0}g(j)
\end{align}
$$
令$c=\frac{a^2}{N_p}\sum\limits^{N_p-1}_{j=0}g(j)$，则上式表示为
$$
R_{uz}(m)=\frac{N_p+1}{N_p}a^2g(m)-c\tag1
$$
对于一个稳定过程而言，有
$$
\begin{align}
\sum\limits^{N_p-1}_{m=0}R_{uz}(m)&=\frac{N_p+1}{N_p}a^2\sum\limits^{N_p-1}_{m=0}g(m)-N_pc\\
&=(\frac{N_p+1}{N_p}-1)a^2\sum\limits^{N_p-1}_{m=0}g(m)\\
&=\frac{a^2}{N_p}\sum\limits^{N_p-1}_{m=0}g(m)=c
\end{align}
$$
因此有
$$
\hat{g}(m)=\frac{N_p}{N_p+1}\cdot\frac{1}{a^2}[R_{uz}(m)+c]\tag2
$$
根据所求出的各点的$R_{uz}(m)$值，按此式就可以估算出较精确的$g(m)$值，上式描述了M序列辨识系统的脉冲响应估计值与互相关函数之间的关系  

对于一个稳定过程来说，脉冲响应是有界的，在一个周期内脉冲响应值之和必然是常数，所以$c$是一个常数，当$m$很大时，$g(m)$趋于零，根据$(1)$式  
$$
c=-R_{uz}(\infty)
$$
由此，一旦通过计算得到各采样点的互相关函数值，就可以画出互相关函数曲线，根据这个曲线的稳态值，就可以确定$c$。从而根据$(1)$式，求得各采样点的脉冲响应的估计值  

脉冲响应函数与相关函数有如下关系：  

<img src="/assets/images/系统辨识的经典方法.assets/image-20200315170957674.png" alt="image-20200315170957674" style="zoom:50%;" />

当$N_p$足够大时，由$(2)$式，$c$值可以忽略不计，有
$$
\hat{g}(m)=\frac{N_p}{N_p+1}\cdot \frac{1}{a^2}R_{uz}(m)
$$
由此所估计的$g(m)$的过程变得简单迅速  

为提高辨识脉冲响应的精度，可以：
① 可以取较大的$N_p$值，也可减小$\Delta t$，目的是使M序列趋近于白噪声；
② 设法提高计算互相关函数的精度，可以采取输入多周期的M序列的方法  